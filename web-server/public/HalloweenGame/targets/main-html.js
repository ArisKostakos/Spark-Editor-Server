/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(gl){function x(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function Xk(a){return a instanceof Array?function(){return A.iter(a)}:"function"==typeof a.iterator?u(a,a.iterator):a.iterator}function u(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=hl++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var h={},l=function(){return w.__string_rec(this,"")},xb=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};h.EReg=xb;xb.__name__=["EReg"];xb.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw new p("EReg::matched");},matchedPos:function(){if(null==this.r.m)throw new p("No string matched");
return{pos:this.r.m.index,len:this.r.m[0].length}},replace:function(a,b){return a.replace(this.r,b)},__class__:xb};var A=function(){};h.HxOverrides=A;A.__name__=["HxOverrides"];A.strDate=function(a){switch(a.length){case 8:var a=a.split(":"),b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return b=a.split(" "),a=b[0].split("-"),b=b[1].split(":"),new Date(a[0],a[1]-1,a[2],b[0],b[1],
b[2]);default:throw new p("Invalid date format : "+a);}};A.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};A.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};A.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};A.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};
var Tf=function(){};h.Lambda=Tf;Tf.__name__=["Lambda"];Tf.array=function(a){for(var b=[],a=Xk(a)();a.hasNext();){var c=a.next();b.push(c)}return b};Tf.count=function(a,b){var c=0;if(null==b)for(var d=Xk(a)();d.hasNext();)d.next(),c++;else for(d=Xk(a)();d.hasNext();){var e=d.next();b(e)&&c++}return c};var af=function(){this.length=0};h.List=af;af.__name__=["List"];af.prototype={add:function(a){a=[a];null==this.h?this.h=a:this.q[1]=a;this.q=a;this.length++},iterator:function(){return new oi(this.h)},
__class__:af};var oi=function(a){this.head=a;this.val=null};h["_List.ListIterator"]=oi;oi.__name__=["_List","ListIterator"];oi.prototype={hasNext:function(){return null!=this.head},next:function(){this.val=this.head[0];this.head=this.head[1];return this.val},__class__:oi};Math.__name__=["Math"];var da=function(){};h.Reflect=da;da.__name__=["Reflect"];da.field=function(a,b){try{return a[b]}catch(c){return c instanceof p&&(c=c.val),null}};da.setField=function(a,b,c){a[b]=c};da.getProperty=function(a,
b){var c;return null==a?null:a.__properties__&&(c=a.__properties__["get_"+b])?a[c]():a[b]};da.callMethod=function(a,b,c){return b.apply(a,c)};da.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};da.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)};da.compare=function(a,b){return a==b?0:a>b?1:-1};da.isEnumValue=function(a){return null!=a&&null!=a.__enum__};da.deleteField=
function(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))return!1;delete a[b];return!0};da.copy=function(a){for(var b={},c=0,d=da.fields(a);c<d.length;){var e=d[c];++c;da.setField(b,e,da.field(a,e))}return b};var r=function(){};h.Std=r;r.__name__=["Std"];r.is=function(a,b){return w.__instanceof(a,b)};r.instance=function(a,b){return a instanceof b?a:null};r.string=function(a){return w.__string_rec(a,"")};r["int"]=function(a){return a|0};r.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==
A.cca(a,1)||88==A.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};r.parseFloat=function(a){return parseFloat(a)};r.random=function(a){return 0>=a?0:Math.floor(Math.random()*a)};var Xb=function(){this.b=""};h.StringBuf=Xb;Xb.__name__=["StringBuf"];Xb.prototype={add:function(a){this.b+=r.string(a)},addSub:function(a,b,c){this.b=null==c?this.b+A.substr(a,b,null):this.b+A.substr(a,b,c)},__class__:Xb};var fa=function(){};h.StringTools=fa;fa.__name__=["StringTools"];fa.htmlEscape=function(a,b){a=a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;");
return b?a.split('"').join("&quot;").split("'").join("&#039;"):a};fa.isSpace=function(a,b){var c=A.cca(a,b);return 8<c&&14>c||32==c};fa.ltrim=function(a){for(var b=a.length,c=0;c<b&&fa.isSpace(a,c);)c++;return 0<c?A.substr(a,c,b-c):a};fa.rtrim=function(a){for(var b=a.length,c=0;c<b&&fa.isSpace(a,b-c-1);)c++;return 0<c?A.substr(a,0,b-c):a};fa.trim=function(a){return fa.ltrim(fa.rtrim(a))};fa.replace=function(a,b,c){return a.split(b).join(c)};fa.fastCodeAt=function(a,b){return a.charCodeAt(b)};var aa=
h.ValueType={__ename__:["ValueType"],__constructs__:"TNull,TInt,TFloat,TBool,TObject,TFunction,TClass,TEnum,TUnknown".split(",")};aa.TNull=["TNull",0];aa.TNull.toString=l;aa.TNull.__enum__=aa;aa.TInt=["TInt",1];aa.TInt.toString=l;aa.TInt.__enum__=aa;aa.TFloat=["TFloat",2];aa.TFloat.toString=l;aa.TFloat.__enum__=aa;aa.TBool=["TBool",3];aa.TBool.toString=l;aa.TBool.__enum__=aa;aa.TObject=["TObject",4];aa.TObject.toString=l;aa.TObject.__enum__=aa;aa.TFunction=["TFunction",5];aa.TFunction.toString=l;
aa.TFunction.__enum__=aa;aa.TClass=function(a){a=["TClass",6,a];a.__enum__=aa;a.toString=l;return a};aa.TEnum=function(a){a=["TEnum",7,a];a.__enum__=aa;a.toString=l;return a};aa.TUnknown=["TUnknown",8];aa.TUnknown.toString=l;aa.TUnknown.__enum__=aa;aa.__empty_constructs__=[aa.TNull,aa.TInt,aa.TFloat,aa.TBool,aa.TObject,aa.TFunction,aa.TUnknown];var Y=function(){};h.Type=Y;Y.__name__=["Type"];Y.getClassName=function(a){a=a.__name__;return null==a?null:a.join(".")};Y.getEnumName=function(a){return a.__ename__.join(".")};
Y.resolveClass=function(a){a=h[a];return null==a||!a.__name__?null:a};Y.resolveEnum=function(a){a=h[a];return null==a||!a.__ename__?null:a};Y.createInstance=function(a,b){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],
b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw new p("Too many arguments");}};Y.createEmptyInstance=function(a){function b(){}b.prototype=a.prototype;return new b};Y.createEnum=function(a,b,c){var d=da.field(a,b);if(null==d)throw new p("No such constructor "+b);if(da.isFunction(d)){if(null==c)throw new p("Constructor "+b+" need parameters");return da.callMethod(a,d,c)}if(null!=c&&0!=c.length)throw new p("Constructor "+b+" does not need parameters");return d};Y.getEnumConstructs=function(a){return a.__constructs__.slice()};
Y["typeof"]=function(a){switch(typeof a){case "boolean":return aa.TBool;case "string":return aa.TClass(String);case "number":return Math.ceil(a)==a%2147483648?aa.TInt:aa.TFloat;case "object":if(null==a)return aa.TNull;var b=a.__enum__;if(null!=b)return aa.TEnum(b);a=w.getClass(a);return null!=a?aa.TClass(a):aa.TObject;case "function":return a.__name__||a.__ename__?aa.TObject:aa.TFunction;case "undefined":return aa.TNull;default:return aa.TUnknown}};Y.allEnums=function(a){return a.__empty_constructs__};
var q=function(a){this.nodeType=a;this.children=[];this.attributeMap=new M};h.Xml=q;q.__name__=["Xml"];q.parse=function(a){return Pd.parse(a)};q.createElement=function(a){var b=new q(q.Element);if(b.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+b.nodeType);b.nodeName=a;return b};q.createPCData=function(a){var b=new q(q.PCData);if(b.nodeType==q.Document||b.nodeType==q.Element)throw new p("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};q.createCData=function(a){var b=
new q(q.CData);if(b.nodeType==q.Document||b.nodeType==q.Element)throw new p("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};q.createComment=function(a){var b=new q(q.Comment);if(b.nodeType==q.Document||b.nodeType==q.Element)throw new p("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};q.createDocType=function(a){var b=new q(q.DocType);if(b.nodeType==q.Document||b.nodeType==q.Element)throw new p("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};q.createProcessingInstruction=
function(a){var b=new q(q.ProcessingInstruction);if(b.nodeType==q.Document||b.nodeType==q.Element)throw new p("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};q.createDocument=function(){return new q(q.Document)};q.prototype={get_nodeName:function(){if(this.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);return this.nodeName},set_nodeName:function(a){if(this.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);
return this.nodeName=a},get_nodeValue:function(){if(this.nodeType==q.Document||this.nodeType==q.Element)throw new p("Bad node type, unexpected "+this.nodeType);return this.nodeValue},get:function(a){if(this.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.get(a)},set:function(a,b){if(this.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);this.attributeMap.set(a,b)},remove:function(a){if(this.nodeType!=
q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);this.attributeMap.remove(a)},exists:function(a){if(this.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.exists(a)},attributes:function(){if(this.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.keys()},elements:function(){if(this.nodeType!=q.Document&&this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+
this.nodeType);for(var a=[],b=0,c=this.children;b<c.length;){var d=c[b];++b;d.nodeType==q.Element&&a.push(d)}return A.iter(a)},elementsNamed:function(a){if(this.nodeType!=q.Document&&this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+this.nodeType);for(var b=[],c=0,d=this.children;c<d.length;){var e=d[c];++c;var f;if(f=e.nodeType==q.Element){if(e.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+e.nodeType);f=e.nodeName==a}f&&b.push(e)}return A.iter(b)},
firstChild:function(){if(this.nodeType!=q.Document&&this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+this.nodeType);return this.children[0]},firstElement:function(){if(this.nodeType!=q.Document&&this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+this.nodeType);for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;if(c.nodeType==q.Element)return c}return null},addChild:function(a){if(this.nodeType!=q.Document&&
this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+this.nodeType);null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=q.Document&&this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+this.nodeType);return A.remove(this.children,a)?(a.parent=null,!0):!1},insertChild:function(a,b){if(this.nodeType!=q.Document&&this.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+
this.nodeType);null!=a.parent&&A.remove(a.parent.children,a);this.children.splice(b,0,a);a.parent=this},__class__:q,__properties__:{get_nodeValue:"get_nodeValue",set_nodeName:"set_nodeName",get_nodeName:"get_nodeName"}};var id=function(){};h["flambe.util.Disposable"]=id;id.__name__=["flambe","util","Disposable"];id.prototype={__class__:id};var T=function(){this._flags=0;this.owner=this.next=null};h["flambe.Component"]=T;T.__name__=["flambe","Component"];T.__interfaces__=[id];T.prototype={onAdded:function(){},
onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&this.owner.remove(this)},get_name:function(){return null},__class__:T,__properties__:{get_name:"get_name"}};var Ua=function(){this.zOrder=0;this.parent=this.firstChild=this.next=this.firstComponent=null;this._compMap={}};h["flambe.Entity"]=Ua;Ua.__name__=["flambe","Entity"];Ua.__interfaces__=[id];Ua.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),
c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},addChild:function(a,
b,c){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=this;if(b){for(var b=null,d=this.firstChild;null!=d;)b=d,d=d.next;if(null!=b)if(null==c&&(c=b.zOrder),b.zOrder<=c)b.next=a;else{b=this.firstChild;for(d=null;null!=b;)if(b.zOrder>c){null!=d?(d.next=a,a.next=b):(a.next=this.firstChild,this.firstChild=a);break}else d=b,b=b.next}else this.firstChild=a,null==c&&(c=0)}else c=null==this.firstChild?0:this.firstChild.zOrder-1,a.next=this.firstChild,this.firstChild=a;a.zOrder=c;return this},
setZOrder:function(a){this.zOrder!=a&&(this.zOrder=a,this.parent.addChild(this,!0,this.zOrder))},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();this.disposeChildren()},__class__:Ua};
var gk=function(){};h["flambe.util.PackageLog"]=gk;gk.__name__=["flambe","util","PackageLog"];var pi=function(){};h["flambe.platform.Platform"]=pi;pi.__name__=["flambe","platform","Platform"];pi.prototype={__class__:pi};var Vc=function(){};h["flambe.platform.html.HtmlPlatform"]=Vc;Vc.__name__=["flambe","platform","html","HtmlPlatform"];Vc.__interfaces__=[pi];Vc.prototype={init:function(){var a=this;U.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){c instanceof p&&(c=c.val)}b.setAttribute("tabindex",
"0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor="transparent";this._stage=new pe(b);this._pointer=new nb;this._mouse=new Uf(this._pointer,b);this._renderer=this.createRenderer(b);this.mainLoop=new Qd;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow="hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,e=function(c){if(!(1E3>c.timeStamp-d)){var e=b.getBoundingClientRect(),f=a.getX(c,e),
e=a.getY(c,e);switch(c.type){case "mousedown":c.target==b&&(c.preventDefault(),a._mouse.submitDown(f,e,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(f,e);break;case "mouseup":a._mouse.submitUp(f,e,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(f,e,"mousewheel"==c.type?c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",e,!1);window.addEventListener("mousemove",e,!1);window.addEventListener("mouseup",e,!1);b.addEventListener("mousewheel",
e,!1);b.addEventListener("DOMMouseScroll",e,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var f="undefined"!=typeof window.ontouchstart,e="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(f||e){var i=new Vf(this._pointer,f?4:window.navigator.msMaxTouchPoints);this._touch=i;e=function(b){var c;c=f?b.changedTouches:[b];var e=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();
U.SHOULD_HIDE_MOBILE_BROWSER&&U.hideMobileBrowser();for(b=0;b<c.length;){var Ca=c[b];++b;var o=a.getX(Ca,e),g=a.getY(Ca,e);i.submitDown((f?Ca.identifier:Ca.pointerId)|0,o,g)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)Ca=c[b],++b,o=a.getX(Ca,e),g=a.getY(Ca,e),i.submitMove((f?Ca.identifier:Ca.pointerId)|0,o,g);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)Ca=c[b],++b,o=a.getX(Ca,e),g=a.getY(Ca,
e),i.submitUp((f?Ca.identifier:Ca.pointerId)|0,o,g)}};f?(b.addEventListener("touchstart",e,!1),b.addEventListener("touchmove",e,!1),b.addEventListener("touchend",e,!1),b.addEventListener("touchcancel",e,!1)):(b.addEventListener("MSPointerDown",e,!1),b.addEventListener("MSPointerMove",e,!1),b.addEventListener("MSPointerUp",e,!1))}else this._touch=new Wf;var Ca=window.onerror;window.onerror=function(a,b,c){G.uncaughtError.emit(a);return null!=Ca?Ca(a,b,c):!1};var o=U.loadExtension("hidden",window.document);
null!=o.value?(e=function(){G.hidden.set__(da.field(window.document,o.field))},e(null),window.document.addEventListener(o.prefix+"visibilitychange",e,!1)):(e=function(a){G.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",e,!1),window.addEventListener("pagehide",e,!1));G.hidden.get_changed().connect(function(b){b||(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var g=U.loadExtension("requestAnimationFrame").value;if(null!=g){var h=window.performance,j=null!=h&&
U.polyfill("now",h);j?this._lastUpdate=h.now():ha.logger.warn("No monotonic timer support, falling back to the system date",null);var k=null,k=function(c){a.update(j?h.now():c);g(k,b)};g(k,b)}else ha.logger.warn("No requestAnimationFrame support, falling back to setInterval",null),window.setInterval(function(){a.update(Date.now())},16);ha.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new za(this,a)).promise},getStage:function(){return this._stage},
getStorage:function(){if(null==this._storage){var a=hk.getLocalStorage();null!=a?this._storage=new Xf(a):(ha.logger.warn("localStorage is unavailable, falling back to unpersisted storage",null),this._storage=new Yf)}return this._storage},createLogHandler:function(a){return Dd.isSupported()?new Dd(a):null},getTime:function(){return Date.now()/1E3},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;G.hidden._value?ha.logger.warn("Time spend paused: "+b,null):this._skipFrame?this._skipFrame=
!1:(this.mainLoop.update(b),Wc.onRender())},getPointer:function(){return this._pointer},getMouse:function(){return this._mouse},getKeyboard:function(){var a=this;if(null==this._keyboard){this._keyboard=new kc;var b=function(b){switch(b.type){case "keydown":a._keyboard.submitDown(b.keyCode)&&b.preventDefault();break;case "keyup":a._keyboard.submitUp(b.keyCode)}};this._canvas.addEventListener("keydown",b,!1);this._canvas.addEventListener("keyup",b,!1)}return this._keyboard},getExternal:function(){null==
this._external&&(this._external=new Zf);return this._external},getRenderer:function(){return this._renderer},getX:function(a,b){return(a.clientX-b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-b.top)*this._stage.get_height()/b.height},createRenderer:function(a){try{var b=ik.getContextWebGL(a,{depth:!1,failIfMajorPerformanceCaveat:!0});if(null!=b)if(U.detectSlowDriver(b))ha.logger.warn("Detected a slow WebGL driver, falling back to canvas",null);else return new $f(this._stage,
b)}catch(c){c instanceof p&&(c=c.val)}return new qe(a)},__class__:Vc};var Qa=function(a,b){this._value=a;this._changed=null!=b?new Xc(b):null};h["flambe.util.Value"]=Qa;Qa.__name__=["flambe","util","Value"];Qa.prototype={watch:function(a){a(this._value,this._value);return this.get_changed().connect(a)},get__:function(){return this._value},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=
new Xc);return this._changed},__class__:Qa,__properties__:{get_changed:"get_changed",set__:"set__",get__:"get__"}};var Rd=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};h["flambe.util.SignalConnection"]=Rd;Rd.__name__=["flambe","util","SignalConnection"];Rd.__interfaces__=[id];Rd.prototype={once:function(){this.stayInList=!1;return this},dispose:function(){null!=this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:Rd};var Ea=function(a){this._head=
null!=a?new Rd(this,a):null;this._deferredTasks=null};h["flambe.util.SignalBase"]=Ea;Ea.__name__=["flambe","util","SignalBase"];Ea.prototype={hasListeners:function(){return null!=this._head},connectImpl:function(a,b){var c=this,d=new Rd(this,a);this._head==Ea.DISPATCHING_SENTINEL?this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==Ea.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):this.listRemove(a)},defer:function(a){for(var b=
null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new qi(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=Ea.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;for(this._deferredTasks=null;null!=a;)a.fn(),a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=null,c=this._head;null!=c;){if(c==
a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:Ea};var Xc=function(a){Ea.call(this,a)};h["flambe.util.Signal2"]=Xc;Xc.__name__=["flambe","util","Signal2"];Xc.__super__=Ea;Xc.prototype=x(Ea.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a,b){var c=this;this._head==Ea.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,b),
d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:Xc});var ma=function(a){Ea.call(this,a)};h["flambe.util.Signal1"]=ma;ma.__name__=["flambe","util","Signal1"];ma.__super__=Ea;ma.prototype=x(Ea.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==Ea.DISPATCHING_SENTINEL?this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},emitImpl:function(a){for(var b=this.willEmit(),c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),
c=c._next;this.didEmit(b)},__class__:ma});var Q=function(a,b){this._behavior=null;Qa.call(this,a,b)};h["flambe.animation.AnimatedFloat"]=Q;Q.__name__=["flambe","animation","AnimatedFloat"];Q.__super__=Qa;Q.prototype=x(Qa.prototype,{set__:function(a){this._behavior=null;return Qa.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(Qa.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&(this._behavior=null))},animate:function(a,b,c,d){this.set__(a);this.animateTo(b,
c,d)},animateTo:function(a,b,c){this.set_behavior(new Ed(this._value,a,b,c))},animateBy:function(a,b,c){this.set_behavior(new Ed(this._value,this._value+a,b,c))},set_behavior:function(a){this._behavior=a;this.update(0);return a},__class__:Q,__properties__:x(Qa.prototype.__properties__,{set_behavior:"set_behavior"})});var G=function(){};h["flambe.System"]=G;G.__name__=["flambe","System"];G.init=function(){G._calledInit||(G._platform.init(),G._calledInit=!0)};var bf=function(a){this._handler=a};h["flambe.util.Logger"]=
bf;bf.__name__=["flambe","util","Logger"];bf.prototype={info:function(a,b){this.log(fb.Info,a,b)},warn:function(a,b){this.log(fb.Warn,a,b)},error:function(a,b){this.log(fb.Error,a,b)},log:function(a,b,c){null!=this._handler&&(null==b&&(b=""),null!=c&&(b=pb.withFields(b,c)),this._handler.log(a,b))},__class__:bf};var ha=function(){};h["flambe.Log"]=ha;ha.__name__=["flambe","Log"];ha.info=function(a,b){ha.logger.info(a,b)};ha.__super__=gk;ha.prototype=x(gk.prototype,{__class__:ha});var ri=function(){this._realDt=
0};h["flambe.SpeedAdjuster"]=ri;ri.__name__=["flambe","SpeedAdjuster"];ri.__super__=T;ri.prototype=x(T.prototype,{get_name:function(){return"SpeedAdjuster_4"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},__class__:ri});var si=function(){};h["flambe.animation.Behavior"]=si;si.__name__=["flambe","animation","Behavior"];si.prototype={__class__:si};var ca=function(){};h["flambe.animation.Ease"]=ca;ca.__name__=["flambe","animation","Ease"];ca.linear=function(a){return a};
ca.quadIn=function(a){return a*a};ca.quadOut=function(a){return a*(2-a)};ca.quadInOut=function(a){return 0.5>=a?2*a*a:1-2*--a*a};ca.quadOutIn=function(a){return 0.5>a?-0.5*(a*=2)*(a-2):0.5*(a=2*a-1)*a+0.5};ca.cubeIn=function(a){return a*a*a};ca.cubeOut=function(a){return 1+--a*a*a};ca.cubeInOut=function(a){return 0.5>=a?4*a*a*a:1+4*--a*a*a};ca.cubeOutIn=function(a){return 0.5*((a=2*a-1)*a*a+1)};ca.quartIn=function(a){return a*a*a*a};ca.quartOut=function(a){return 1- --a*a*a*a};ca.quartInOut=function(a){return 0.5>=
a?8*a*a*a*a:(1-(a=2*a-2)*a*a*a)/2+0.5};ca.quartOutIn=function(a){return 0.5>a?-0.5*(a=2*a-1)*a*a*a+0.5:0.5*(a=2*a-1)*a*a*a+0.5};ca.quintIn=function(a){return a*a*a*a*a};ca.quintOut=function(a){return(a-=1)*a*a*a*a+1};ca.quintInOut=function(a){return 1>(a*=2)?a*a*a*a*a/2:((a-=2)*a*a*a*a+2)/2};ca.quintOutIn=function(a){return 0.5*((a=2*a-1)*a*a*a*a+1)};ca.sineIn=function(a){return 1-Math.cos(1.5707963267948966*a)};ca.sineOut=function(a){return Math.sin(1.5707963267948966*a)};ca.sineInOut=function(a){return 0.5-
Math.cos(3.141592653589793*a)/2};ca.sineOutIn=function(a){return 0==a?0:1==a?1:0.5>a?0.5*Math.sin(3.141592653589793*a):-0.5*Math.cos(1.5707963267948966*(2*a-1))+1};ca.bounceIn=function(a){a=1-a;return 0.36363636363636365>a?1-7.5625*a*a:0.7272727272727273>a?1-(7.5625*(a-0.5454545454545454)*(a-0.5454545454545454)+0.75):0.9090909090909091>a?1-(7.5625*(a-0.8181818181818182)*(a-0.8181818181818182)+0.9375):1-(7.5625*(a-0.9545454545454546)*(a-0.9545454545454546)+0.984375)};ca.bounceOut=function(a){return 0.36363636363636365>
a?7.5625*a*a:0.7272727272727273>a?7.5625*(a-0.5454545454545454)*(a-0.5454545454545454)+0.75:0.9090909090909091>a?7.5625*(a-0.8181818181818182)*(a-0.8181818181818182)+0.9375:7.5625*(a-0.9545454545454546)*(a-0.9545454545454546)+0.984375};ca.bounceInOut=function(a){if(0.5>a)return a=1-2*a,0.36363636363636365>a?(1-7.5625*a*a)/2:0.7272727272727273>a?(1-(7.5625*(a-0.5454545454545454)*(a-0.5454545454545454)+0.75))/2:0.9090909090909091>a?(1-(7.5625*(a-0.8181818181818182)*(a-0.8181818181818182)+0.9375))/2:
(1-(7.5625*(a-0.9545454545454546)*(a-0.9545454545454546)+0.984375))/2;a=2*a-1;return 0.36363636363636365>a?7.5625*a*a/2+0.5:0.7272727272727273>a?(7.5625*(a-0.5454545454545454)*(a-0.5454545454545454)+0.75)/2+0.5:0.9090909090909091>a?(7.5625*(a-0.8181818181818182)*(a-0.8181818181818182)+0.9375)/2+0.5:(7.5625*(a-0.9545454545454546)*(a-0.9545454545454546)+0.984375)/2+0.5};ca.circIn=function(a){return 1-Math.sqrt(1-a*a)};ca.circOut=function(a){--a;return Math.sqrt(1-a*a)};ca.circInOut=function(a){return 0.5>=
a?(Math.sqrt(1-4*a*a)-1)/-2:(Math.sqrt(1-(2*a-2)*(2*a-2))+1)/2};ca.circOutIn=function(a){return 0.5>a?0.5*Math.sqrt(1-(a=2*a-1)*a):-0.5*(Math.sqrt(1-(a=2*a-1)*a)-1-1)};ca.expoIn=function(a){return Math.pow(2,10*(a-1))};ca.expoOut=function(a){return-Math.pow(2,-10*a)+1};ca.expoInOut=function(a){return 0.5>a?Math.pow(2,10*(2*a-1))/2:(-Math.pow(2,-10*(2*a-1))+2)/2};ca.expoOutIn=function(a){return 0.5>a?0.5*(1-Math.pow(2,-20*a)):0.5==a?0.5:0.5*(Math.pow(2,20*(a-1))+1)};ca.backIn=function(a){return a*
a*(2.70158*a-1.70158)};ca.backOut=function(a){return 1- --a*a*(-2.70158*a-1.70158)};ca.backInOut=function(a){a*=2;if(1>a)return a*a*(2.70158*a-1.70158)/2;a-=2;return(1-a*a*(-2.70158*a-1.70158))/2+0.5};ca.elasticIn=function(a){return-(Math.pow(2,10*(a-=1))*Math.sin(6.283185307179586*(a-0.06366197723675814*Math.asin(1))/0.4))};ca.elasticOut=function(a){return Math.pow(2,-10*a)*Math.sin(6.283185307179586*(a-0.06366197723675814*Math.asin(1))/0.4)+1};ca.elasticInOut=function(a){return 0.5>a?-0.5*Math.pow(2,
10*(a-=0.5))*Math.sin(6.283185307179586*(a-0.1)/0.4):0.5*Math.pow(2,-10*(a-=0.5))*Math.sin(6.283185307179586*(a-0.1)/0.4)+1};var Ed=function(a,b,c,d){this._from=a;this._to=b;this._duration=c;this.elapsed=0;this._easing=null!=d?d:ca.linear};h["flambe.animation.Tween"]=Ed;Ed.__name__=["flambe","animation","Tween"];Ed.__interfaces__=[si];Ed.prototype={update:function(a){this.elapsed+=a;return this.elapsed>=this._duration?this._to:this._from+(this._to-this._from)*this._easing(this.elapsed/this._duration)},
isComplete:function(){return this.elapsed>=this._duration},__class__:Ed};var ee=function(){};h["flambe.asset.Asset"]=ee;ee.__name__=["flambe","asset","Asset"];ee.__interfaces__=[id];ee.prototype={__class__:ee};var D=h["flambe.asset.AssetFormat"]={__ename__:["flambe","asset","AssetFormat"],__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(",")};D.WEBP=["WEBP",0];D.WEBP.toString=l;D.WEBP.__enum__=D;D.JXR=["JXR",1];D.JXR.toString=l;D.JXR.__enum__=D;D.PNG=["PNG",2];D.PNG.toString=
l;D.PNG.__enum__=D;D.JPG=["JPG",3];D.JPG.toString=l;D.JPG.__enum__=D;D.GIF=["GIF",4];D.GIF.toString=l;D.GIF.__enum__=D;D.DDS=["DDS",5];D.DDS.toString=l;D.DDS.__enum__=D;D.PVR=["PVR",6];D.PVR.toString=l;D.PVR.__enum__=D;D.PKM=["PKM",7];D.PKM.toString=l;D.PKM.__enum__=D;D.MP3=["MP3",8];D.MP3.toString=l;D.MP3.__enum__=D;D.M4A=["M4A",9];D.M4A.toString=l;D.M4A.__enum__=D;D.OPUS=["OPUS",10];D.OPUS.toString=l;D.OPUS.__enum__=D;D.OGG=["OGG",11];D.OGG.toString=l;D.OGG.__enum__=D;D.WAV=["WAV",12];D.WAV.toString=
l;D.WAV.__enum__=D;D.Data=["Data",13];D.Data.toString=l;D.Data.__enum__=D;D.__empty_constructs__=[D.WEBP,D.JXR,D.PNG,D.JPG,D.GIF,D.DDS,D.PVR,D.PKM,D.MP3,D.M4A,D.OPUS,D.OGG,D.WAV,D.Data];var ti=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};h["flambe.asset.AssetEntry"]=ti;ti.__name__=["flambe","asset","AssetEntry"];ti.prototype={__class__:ti};var ag=function(){};h["flambe.asset.AssetPack"]=ag;ag.__name__=["flambe","asset","AssetPack"];ag.__interfaces__=[id];ag.prototype={__class__:ag};
var bg=function(){};h["flambe.asset.File"]=bg;bg.__name__=["flambe","asset","File"];bg.__interfaces__=[ee];bg.prototype={__class__:bg};var Sd=function(){this._localBase=this._remoteBase=null;this._entries=[]};h["flambe.asset.Manifest"]=Sd;Sd.__name__=["flambe","asset","Manifest"];Sd.inferFormat=function(a){var b=pb.getUrlExtension(a);if(null!=b)switch(b.toLowerCase()){case "gif":return D.GIF;case "jpg":case "jpeg":return D.JPG;case "jxr":case "wdp":return D.JXR;case "png":return D.PNG;case "webp":return D.WEBP;
case "dds":return D.DDS;case "pvr":return D.PVR;case "pkm":return D.PKM;case "m4a":return D.M4A;case "mp3":return D.MP3;case "ogg":return D.OGG;case "opus":return D.OPUS;case "wav":return D.WAV}else ha.logger.warn("No file extension for asset, it will be loaded as data",["url",a]);return D.Data};Sd.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=Sd.inferFormat(b));a=new ti(a,b,d,c);this._entries.push(a);return a},iterator:function(){return A.iter(this._entries)},getFullURL:function(a){var b;
b=null!=this.get_remoteBase()&&Sd._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?pb.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},get_remoteBase:function(){return this._remoteBase},__class__:Sd,__properties__:{get_remoteBase:"get_remoteBase",get_localBase:"get_localBase"}};var ia=h["flambe.display.BlendMode"]={__ename__:["flambe","display","BlendMode"],__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(",")};ia.Normal=["Normal",
0];ia.Normal.toString=l;ia.Normal.__enum__=ia;ia.Add=["Add",1];ia.Add.toString=l;ia.Add.__enum__=ia;ia.Multiply=["Multiply",2];ia.Multiply.toString=l;ia.Multiply.__enum__=ia;ia.Screen=["Screen",3];ia.Screen.toString=l;ia.Screen.__enum__=ia;ia.Mask=["Mask",4];ia.Mask.toString=l;ia.Mask.__enum__=ia;ia.Copy=["Copy",5];ia.Copy.toString=l;ia.Copy.__enum__=ia;ia.__empty_constructs__=[ia.Normal,ia.Add,ia.Multiply,ia.Screen,ia.Mask,ia.Copy];var xc=h["flambe.display.EmitterType"]={__ename__:["flambe","display",
"EmitterType"],__constructs__:["Gravity","Radial"]};xc.Gravity=["Gravity",0];xc.Gravity.toString=l;xc.Gravity.__enum__=xc;xc.Radial=["Radial",1];xc.Radial.toString=l;xc.Radial.__enum__=xc;xc.__empty_constructs__=[xc.Gravity,xc.Radial];var L=function(a,b){this._file=a.getFile(b+".pex");for(var c=q.parse(this._file.toString()),d=0,e=0,f=b.lastIndexOf("/"),f=0<=f?A.substr(b,0,f+1):"",c=c.firstElement().elements();c.hasNext();){var i=c.next();if(i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+
i.nodeType));switch(i.nodeName.toLowerCase()){case "texture":this.texture=a.getTexture(f+pb.removeFileExtension(i.get("name")));break;case "angle":this.angle=L.getFloat(i,"value");break;case "anglevariance":this.angleVariance=L.getFloat(i,"value");break;case "blendfuncdestination":e=r["int"](L.getFloat(i,"value"));break;case "blendfuncsource":d=r["int"](L.getFloat(i,"value"));break;case "duration":this.duration=L.getFloat(i,"value");break;case "emittertype":this.type=0==r["int"](L.getFloat(i,"value"))?
xc.Gravity:xc.Radial;break;case "finishcolor":this.alphaEnd=L.getFloat(i,"alpha");break;case "finishcolorvariance":this.alphaEndVariance=L.getFloat(i,"alpha");break;case "finishparticlesize":this.sizeEnd=L.getFloat(i,"value");break;case "finishparticlesizevariance":this.sizeEndVariance=L.getFloat(i,"value");break;case "gravity":this.gravityX=L.getFloat(i,"x");this.gravityY=L.getFloat(i,"y");break;case "maxparticles":this.maxParticles=r["int"](L.getFloat(i,"value"));break;case "maxradius":this.maxRadius=
L.getFloat(i,"value");break;case "maxradiusvariance":this.maxRadiusVariance=L.getFloat(i,"value");break;case "minradius":this.minRadius=L.getFloat(i,"value");break;case "particlelifespan":this.lifespan=L.getFloat(i,"value");break;case "particlelifespanvariance":this.lifespanVariance=L.getFloat(i,"value");break;case "radialaccelvariance":this.radialAccelVariance=L.getFloat(i,"value");break;case "radialacceleration":this.radialAccel=L.getFloat(i,"value");break;case "rotatepersecond":this.rotatePerSecond=
L.getFloat(i,"value");break;case "rotatepersecondvariance":this.rotatePerSecondVariance=L.getFloat(i,"value");break;case "rotationend":this.rotationEnd=L.getFloat(i,"value");break;case "rotationendvariance":this.rotationEndVariance=L.getFloat(i,"value");break;case "rotationstart":this.rotationStart=L.getFloat(i,"value");break;case "rotationstartvariance":this.rotationStartVariance=L.getFloat(i,"value");break;case "sourcepositionvariance":this.emitXVariance=L.getFloat(i,"x");this.emitYVariance=L.getFloat(i,
"y");break;case "speed":this.speed=L.getFloat(i,"value");break;case "speedvariance":this.speedVariance=L.getFloat(i,"value");break;case "startcolor":this.alphaStart=L.getFloat(i,"alpha");break;case "startcolorvariance":this.alphaStartVariance=L.getFloat(i,"alpha");break;case "startparticlesize":this.sizeStart=L.getFloat(i,"value");break;case "startparticlesizevariance":this.sizeStartVariance=L.getFloat(i,"value");break;case "tangentialaccelvariance":this.tangentialAccelVariance=L.getFloat(i,"value");
break;case "tangentialacceleration":this.tangentialAccel=L.getFloat(i,"value")}}0>=this.lifespan&&(this.lifespan=this.duration);1==d&&1==e?this.blendMode=ia.Add:1==d&&771==e?this.blendMode=null:(0!=d||0!=e)&&ha.logger.warn("Unsupported particle blend functions",["emitter",b,"source",d,"dest",e])};h["flambe.display.EmitterMold"]=L;L.__name__=["flambe","display","EmitterMold"];L.getFloat=function(a,b){return r.parseFloat(a.get(b))};L.prototype={createEmitter:function(){return new ua(this)},__class__:L};
var jd=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};h["flambe.math.Point"]=jd;jd.__name__=["flambe","math","Point"];jd.prototype={__class__:jd};var E=function(){this._sinCache=this._cosCache=0;this.blendMode=this.scissor=null;var a=this;T.call(this);this._flags|=182;this._localMatrix=new Ib;var b=function(){a._flags|=24};this.x=new Q(0,b);this.y=new Q(0,b);this.rotation=new Q(0,function(){a._flags|=152});this.scaleX=new Q(1,b);this.scaleY=new Q(1,b);this.anchorX=new Q(0,b);this.anchorY=
new Q(0,b);this.alpha=new Q(1)};h["flambe.display.Sprite"]=E;E.__name__=["flambe","display","Sprite"];E.hitTest=function(a,b,c){var d=a._compMap.Sprite_3;if(null!=d){if(6!=(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,c,E._scratchPoint)&&(b=E._scratchPoint.x,c=E._scratchPoint.y);var e=d.scissor;if(null!=e&&!e.contains(b,c))return null}a=E.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};E.getBounds=function(a,b){null==b&&(b=new Jb);b.set(1.79769313486231E308,
1.79769313486231E308,-1.79769313486231E308,-1.79769313486231E308);E.getBoundsImpl(a,null,b);b.width-=b.x;b.height-=b.y;return b};E.render=function(a,b){var c=a._compMap.Sprite_3;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),e=d.m02,f=d.m12;0!=(c._flags&32)&&(e=Math.round(e),f=Math.round(f));b.transform(d.m00,d.m10,d.m01,d.m11,e,f);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,
d.width,d.height);c.draw(b)}d=a._compMap.Director_8;if(null!=d){d=d.occludedScenes;for(e=0;e<d.length;)f=d[e],++e,E.render(f,b)}for(d=a.firstChild;null!=d;)e=d.next,E.render(d,b),d=e;null!=c&&b.restore()};E.hitTestBackwards=function(a,b,c){if(null!=a){var d=E.hitTestBackwards(a.next,b,c);return null!=d?d:E.hitTest(a,b,c)}return null};E.getBoundsImpl=function(a,b,c){var d=a._compMap.Sprite_3;if(null!=d){var b=null!=b?Ib.multiply(b,d.getLocalMatrix()):d.getLocalMatrix(),e=d.getNaturalWidth(),d=d.getNaturalHeight();
0<e&&0<d&&(E.extendRect(b,0,0,c),E.extendRect(b,e,0,c),E.extendRect(b,e,d,c),E.extendRect(b,0,d,c))}e=a._compMap.Director_8;if(null!=e)for(var e=e.occludedScenes,d=0,f=e.length;d<f;)E.getBoundsImpl(e[d],b,c),++d;for(a=a.firstChild;null!=a;)e=a.next,E.getBoundsImpl(a,b,c),a=e};E.extendRect=function(a,b,c,d){a=a.transform(b,c,E._scratchPoint);b=a.x;c=a.y;b<d.x&&(d.x=b);c<d.y&&(d.y=c);b>d.width&&(d.width=b);c>d.height&&(d.height=c)};E.__super__=T;E.prototype=x(T.prototype,{get_name:function(){return"Sprite_3"},
getNaturalWidth:function(){return 0},getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=a&&a<this.getNaturalWidth()&&0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){if(0!=(this._flags&8)){this._flags&=-9;if(0!=(this._flags&128)){this._flags&=-129;var a=3.141592653589793*this.rotation._value/180;this._sinCache=Math.sin(a);this._cosCache=Math.cos(a)}var a=this.scaleX._value,b=this.scaleY._value;this._localMatrix.set(this._cosCache*a,this._sinCache*a,-this._sinCache*
b,this._cosCache*b,this.x._value,this.y._value);this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value)}return this._localMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);return this},centerAnchor:function(){this.anchorX.set__(this.getNaturalWidth()/2);this.anchorY.set__(this.getNaturalHeight()/2);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},setAlpha:function(a){this.alpha.set__(a);return this},setScaleXY:function(a,b){this.scaleX.set__(a);
this.scaleY.set__(b);return this},disablePixelSnapping:function(){this.set_pixelSnapping(!1);return this},onAdded:function(){0!=(this._flags&64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},getParentSprite:function(){if(null==
this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_3;if(null!=b)return b;a=a.parent}return null},get_pointerDown:function(){null==this._pointerDown&&(this._pointerDown=new ma);return this._pointerDown},get_pointerMove:function(){null==this._pointerMove&&(this._pointerMove=new ma);return this._pointerMove},get_pointerUp:function(){null==this._pointerUp&&(this._pointerUp=new ma);return this._pointerUp},get_pointerIn:function(){null==this._pointerIn&&(this._pointerIn=
new ma);return this._pointerIn},get_pointerOut:function(){null==this._pointerOut&&(this._pointerOut=new ma);return this._pointerOut},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=G._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;null!=a._hoverConnection&&(a._hoverConnection.dispose(),a._hoverConnection=null)}))},set_visible:function(a){this._flags=
cg.set(this._flags,2,a);return a},set_pointerEnabled:function(a){this._flags=cg.set(this._flags,4,a);return a},set_pixelSnapping:function(a){this._flags=cg.set(this._flags,32,a);return a},onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&
this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=-65,null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=this._pointerUp&&this._pointerUp.emit(a)},__class__:E,__properties__:x(T.prototype.__properties__,{get_pointerOut:"get_pointerOut",get_pointerIn:"get_pointerIn",get_pointerUp:"get_pointerUp",get_pointerMove:"get_pointerMove",
get_pointerDown:"get_pointerDown",set_pointerEnabled:"set_pointerEnabled",set_pixelSnapping:"set_pixelSnapping",set_visible:"set_visible"})});var ua=function(a){this._emitElapsed=this._totalElapsed=0;this.enabled=!0;this.numParticles=0;E.call(this);this.texture=a.texture;this.blendMode=a.blendMode;this.type=a.type;this.alphaEnd=new Q(a.alphaEnd);this.alphaEndVariance=new Q(a.alphaEndVariance);this.alphaStart=new Q(a.alphaStart);this.alphaStartVariance=new Q(a.alphaStartVariance);this.angle=new Q(a.angle);
this.angleVariance=new Q(a.angleVariance);this.duration=a.duration;this.emitXVariance=new Q(a.emitXVariance);this.emitYVariance=new Q(a.emitYVariance);this.gravityX=new Q(a.gravityX);this.gravityY=new Q(a.gravityY);this.maxRadius=new Q(a.maxRadius);this.maxRadiusVariance=new Q(a.maxRadiusVariance);this.minRadius=new Q(a.minRadius);this.lifespan=new Q(a.lifespan);this.lifespanVariance=new Q(a.lifespanVariance);this.radialAccel=new Q(a.radialAccel);this.radialAccelVariance=new Q(a.radialAccelVariance);
this.rotatePerSecond=new Q(a.rotatePerSecond);this.rotatePerSecondVariance=new Q(a.rotatePerSecondVariance);this.rotationEnd=new Q(a.rotationEnd);this.rotationEndVariance=new Q(a.rotationEndVariance);this.rotationStart=new Q(a.rotationStart);this.rotationStartVariance=new Q(a.rotationStartVariance);this.sizeEnd=new Q(a.sizeEnd);this.sizeEndVariance=new Q(a.sizeEndVariance);this.sizeStart=new Q(a.sizeStart);this.sizeStartVariance=new Q(a.sizeStartVariance);this.speed=new Q(a.speed);this.speedVariance=
new Q(a.speedVariance);this.tangentialAccel=new Q(a.tangentialAccel);this.tangentialAccelVariance=new Q(a.tangentialAccelVariance);this.emitX=new Q(0);this.emitY=new Q(0);this._particles=Array(a.maxParticles);for(var a=0,b=this._particles.length;a<b;)this._particles[a]=new ui,++a};h["flambe.display.EmitterSprite"]=ua;ua.__name__=["flambe","display","EmitterSprite"];ua.random=function(a,b){0!=b&&(a+=b*(2*Math.random()-1));return a};ua.__super__=E;ua.prototype=x(E.prototype,{restart:function(){this.enabled=
!0;this._totalElapsed=0},onUpdate:function(a){E.prototype.onUpdate.call(this,a);this.alphaEnd.update(a);this.alphaEndVariance.update(a);this.alphaStart.update(a);this.alphaStartVariance.update(a);this.angle.update(a);this.angleVariance.update(a);this.emitX.update(a);this.emitXVariance.update(a);this.emitY.update(a);this.emitYVariance.update(a);this.gravityX.update(a);this.gravityY.update(a);this.lifespan.update(a);this.lifespanVariance.update(a);this.maxRadius.update(a);this.maxRadiusVariance.update(a);
this.minRadius.update(a);this.radialAccel.update(a);this.radialAccelVariance.update(a);this.rotatePerSecond.update(a);this.rotatePerSecondVariance.update(a);this.rotationEnd.update(a);this.rotationEndVariance.update(a);this.rotationStart.update(a);this.rotationStartVariance.update(a);this.sizeEnd.update(a);this.sizeEndVariance.update(a);this.sizeStart.update(a);this.sizeStartVariance.update(a);this.speed.update(a);this.speedVariance.update(a);this.tangentialAccel.update(a);this.tangentialAccelVariance.update(a);
for(var b=this.type==xc.Gravity,c=0;c<this.numParticles;){var d=this._particles[c];if(d.life>a){if(b){d.x+=d.velX*a;d.y+=d.velY*a;var e=this.gravityX._value,f=-this.gravityY._value;if(0!=d.radialAccel||0!=d.tangentialAccel)var i=d.x-d.emitX,Ca=d.y-d.emitY,o=Math.sqrt(i*i+Ca*Ca),i=i/o,Ca=Ca/o,e=e+i*d.radialAccel,f=f+Ca*d.radialAccel,o=i,e=e+-Ca*d.tangentialAccel,f=f+o*d.tangentialAccel;d.velX+=e*a;d.velY+=f*a}else d.radialRotation+=d.velRadialRotation*a,d.radialRadius+=d.velRadialRadius*a,e=d.radialRadius,
d.x=this.emitX._value-Math.cos(d.radialRotation)*e,d.y=this.emitY._value-Math.sin(d.radialRotation)*e,e<this.minRadius._value&&(d.life=0);d.scale+=d.velScale*a;d.rotation+=d.velRotation*a;d.alpha+=d.velAlpha*a;d.life-=a;++c}else--this.numParticles,c!=this.numParticles&&(this._particles[c]=this._particles[this.numParticles],this._particles[this.numParticles]=d)}if(this.enabled){if(0<this.duration&&(this._totalElapsed+=a,this._totalElapsed>=this.duration)){this.enabled=!1;return}b=this.lifespan._value/
this._particles.length;for(this._emitElapsed+=a;this._emitElapsed>=b;)this.numParticles<this._particles.length&&this.initParticle(this._particles[this.numParticles])&&++this.numParticles,this._emitElapsed-=b}},draw:function(a){for(var b=-this.texture.get_width()/2,c=0,d=this.numParticles;c<d;){var e=this._particles[c];a.save();a.translate(e.x,e.y);1>e.alpha&&a.multiplyAlpha(e.alpha);0!=e.rotation&&a.rotate(e.rotation);1!=e.scale&&a.scale(e.scale,e.scale);a.drawTexture(this.texture,b,b);a.restore();
++c}},initParticle:function(a){a.life=ua.random(this.lifespan._value,this.lifespanVariance._value);if(0>=a.life)return!1;a.emitX=this.emitX._value;a.emitY=this.emitY._value;var b=-Ra.toRadians(ua.random(this.angle._value,this.angleVariance._value)),c=ua.random(this.speed._value,this.speedVariance._value);a.velX=c*Math.cos(b);a.velY=c*Math.sin(b);a.radialAccel=ua.random(this.radialAccel._value,this.radialAccelVariance._value);a.tangentialAccel=ua.random(this.tangentialAccel._value,this.tangentialAccelVariance._value);
a.radialRadius=ua.random(this.maxRadius._value,this.maxRadiusVariance._value);a.velRadialRadius=-a.radialRadius/a.life;a.radialRotation=b;a.velRadialRotation=Ra.toRadians(ua.random(this.rotatePerSecond._value,this.rotatePerSecondVariance._value));this.type==xc.Gravity?(a.x=ua.random(this.emitX._value,this.emitXVariance._value),a.y=ua.random(this.emitY._value,this.emitYVariance._value)):(b=a.radialRadius,a.x=this.emitX._value-Math.cos(a.radialRotation)*b,a.y=this.emitY._value-Math.sin(a.radialRotation)*
b);c=this.texture.get_width();b=ua.random(this.sizeStart._value,this.sizeStartVariance._value)/c;c=ua.random(this.sizeEnd._value,this.sizeEndVariance._value)/c;a.scale=b;a.velScale=(c-b)/a.life;b=ua.random(this.rotationStart._value,this.rotationStartVariance._value);c=ua.random(this.rotationEnd._value,this.rotationEndVariance._value);a.rotation=b;a.velRotation=(c-b)/a.life;b=ua.random(this.alphaStart._value,this.alphaStartVariance._value);c=ua.random(this.alphaEnd._value,this.alphaEndVariance._value);
a.alpha=b;a.velAlpha=(c-b)/a.life;return!0},__class__:ua});var ui=function(){this.emitX=this.emitY=this.x=this.velX=this.y=this.velY=this.radialRadius=this.velRadialRadius=this.radialRotation=this.velRadialRotation=this.radialAccel=this.tangentialAccel=this.scale=this.velScale=this.rotation=this.velRotation=this.alpha=this.velAlpha=this.life=0};h["flambe.display._EmitterSprite.Particle"]=ui;ui.__name__=["flambe","display","_EmitterSprite","Particle"];ui.prototype={__class__:ui};var yb=function(a,
b,c){E.call(this);this.color=a;this.width=new Q(b);this.height=new Q(c)};h["flambe.display.FillSprite"]=yb;yb.__name__=["flambe","display","FillSprite"];yb.__super__=E;yb.prototype=x(E.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},getNaturalHeight:function(){return this.height._value},setSize:function(a,b){this.width.set__(a);this.height.set__(b);return this},onUpdate:function(a){E.prototype.onUpdate.call(this,
a);this.width.update(a);this.height.update(a)},__class__:yb});var dg=function(a){this._kernings=null;this.xOffset=this.yOffset=this.xAdvance=0;this.page=null;this.x=this.y=this.width=this.height=0;this.charCode=a};h["flambe.display.Glyph"]=dg;dg.__name__=["flambe","display","Glyph"];dg.prototype={draw:function(a,b,c){0<this.width&&a.drawSubTexture(this.page,b+this.xOffset,c+this.yOffset,this.x,this.y,this.width,this.height)},getKerning:function(a){return null!=this._kernings?r["int"](this._kernings.h[a]):
0},setKerning:function(a,b){null==this._kernings&&(this._kernings=new zb);this._kernings.h[a]=b},__class__:dg};var re=function(a,b){this.name=b;this._pack=a;this._file=a.getFile(b+".fnt");this.reload()};h["flambe.display.Font"]=re;re.__name__=["flambe","display","Font"];re.prototype={layoutText:function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=Ya.Left);return new Td(this,a,b,c,d,e)},reload:function(){this._glyphs=new zb;this._glyphs.h[re.NEWLINE.charCode]=re.NEWLINE;for(var a=
new se(this._file.toString()),b=new zb,c=this.name.lastIndexOf("/"),c=0<=c?A.substr(this.name,0,c+1):"",d=a.keywords();d.hasNext();)switch(d.next()){case "info":for(var e=a.pairs();e.hasNext();){var f=e.next();switch(f.key){case "size":this.size=f.getInt()}}break;case "common":for(e=a.pairs();e.hasNext();)switch(f=e.next(),f.key){case "lineHeight":this.lineHeight=f.getInt()}break;case "page":for(var e=0,f=null,i=a.pairs();i.hasNext();){var Ca=i.next();switch(Ca.key){case "id":e=Ca.getInt();break;
case "file":f=Ca.getString()}}f=this._pack.getTexture(c+pb.removeFileExtension(f));b.h[e]=f;break;case "char":e=null;for(f=a.pairs();f.hasNext();)switch(i=f.next(),i.key){case "id":e=new dg(i.getInt());break;case "x":e.x=i.getInt();break;case "y":e.y=i.getInt();break;case "width":e.width=i.getInt();break;case "height":e.height=i.getInt();break;case "page":i=i.getInt();e.page=b.h[i];break;case "xoffset":e.xOffset=i.getInt();break;case "yoffset":e.yOffset=i.getInt();break;case "xadvance":e.xAdvance=
i.getInt()}this._glyphs.h[e.charCode]=e;break;case "kerning":e=null;i=f=0;for(Ca=a.pairs();Ca.hasNext();){var o=Ca.next();switch(o.key){case "first":e=this._glyphs.h[o.getInt()];break;case "second":f=o.getInt();break;case "amount":i=o.getInt()}}null!=e&&0!=i&&e.setKerning(f,i)}},__class__:re};var Ya=h["flambe.display.TextAlign"]={__ename__:["flambe","display","TextAlign"],__constructs__:["Left","Center","Right"]};Ya.Left=["Left",0];Ya.Left.toString=l;Ya.Left.__enum__=Ya;Ya.Center=["Center",1];Ya.Center.toString=
l;Ya.Center.__enum__=Ya;Ya.Right=["Right",2];Ya.Right.toString=l;Ya.Right.__enum__=Ya;Ya.__empty_constructs__=[Ya.Left,Ya.Center,Ya.Right];var Td=function(a,b,c,d,e,f){this.lines=0;var i=this;this._font=a;this._glyphs=[];this._offsets=[];this._lineOffset=Math.round(a.lineHeight+f);this.bounds=new Jb;for(var Ca=[],f=b.length,o=0;o<f;){var g=o++,g=b.charCodeAt(g),h=a._glyphs.h[g];null!=h?this._glyphs.push(h):ha.logger.warn("Requested a missing character from font",["font",a.name,"charCode",g])}for(var b=
-1,j=0,k=0,a=a._glyphs.h[10],f=function(){i.bounds.width=Ra.max(i.bounds.width,j);i.bounds.height+=k;Ca[i.lines]=j;k=j=0;++i.lines},o=0;o<this._glyphs.length;)g=this._glyphs[o],this._offsets[o]=Math.round(j),(h=0<d&&j+g.width>d)||g==a?(h&&(0<=b?(this._glyphs[b]=a,j=this._offsets[b],o=b):this._glyphs.splice(o,0,a)),b=-1,k=this._lineOffset,f()):(32==g.charCode&&(b=o),j+=g.xAdvance+e,k=Ra.max(k,g.height+g.yOffset),o+1<this._glyphs.length&&(j+=g.getKerning(this._glyphs[o+1].charCode))),++o;f();e=0;a=
Td.getAlignOffset(c,Ca[0],d);b=1.79769313486231E308;f=-1.79769313486231E308;g=o=0;for(h=this._glyphs.length;g<h;){var l=this._glyphs[g];10==l.charCode&&(e+=this._lineOffset,++o,a=Td.getAlignOffset(c,Ca[o],d));this._offsets[g]+=a;var m=e+l.yOffset,b=b<m?b:m,f=Ra.max(f,m+l.height);++g}this.bounds.x=Td.getAlignOffset(c,this.bounds.width,d);this.bounds.y=b;this.bounds.height=f-b};h["flambe.display.TextLayout"]=Td;Td.__name__=["flambe","display","TextLayout"];Td.getAlignOffset=function(a,b,c){switch(a[1]){case 0:return 0;
case 2:return c-b;case 1:return Math.round((c-b)/2)}};Td.prototype={draw:function(a){for(var b=0,c=0,d=this._glyphs.length;c<d;){var e=this._glyphs[c];10==e.charCode?b+=this._lineOffset:e.draw(a,this._offsets[c],b);++c}},__class__:Td};var se=function(a){this._configText=a;this._keywordPattern=new xb("([A-Za-z]+)(.*)","");this._pairPattern=new xb('([A-Za-z]+)=("[^"]*"|[^\\s]+)',"")};h["flambe.display._Font.ConfigParser"]=se;se.__name__=["flambe","display","_Font","ConfigParser"];se.advance=function(a,
b){var c=b.matchedPos();return A.substr(a,c.pos+c.len,a.length)};se.prototype={keywords:function(){var a=this,b=this._configText;return{next:function(){b=se.advance(b,a._keywordPattern);a._pairText=a._keywordPattern.matched(2);return a._keywordPattern.matched(1)},hasNext:function(){return a._keywordPattern.match(b)}}},pairs:function(){var a=this,b=this._pairText;return{next:function(){b=se.advance(b,a._pairPattern);return new vi(a._pairPattern.matched(1),a._pairPattern.matched(2))},hasNext:function(){return a._pairPattern.match(b)}}},
__class__:se};var vi=function(a,b){this.key=a;this._value=b};h["flambe.display._Font.ConfigPair"]=vi;vi.__name__=["flambe","display","_Font","ConfigPair"];vi.prototype={getInt:function(){return r.parseInt(this._value)},getString:function(){return 34!=this._value.charCodeAt(0)?null:A.substr(this._value,1,this._value.length-2)},__class__:vi};var wi=function(){};h["flambe.display.Graphics"]=wi;wi.__name__=["flambe","display","Graphics"];wi.prototype={__class__:wi};var fe=function(a){E.call(this);this.texture=
a};h["flambe.display.ImageSprite"]=fe;fe.__name__=["flambe","display","ImageSprite"];fe.__super__=E;fe.prototype=x(E.prototype,{draw:function(a){null!=this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:fe});var lc=h["flambe.display.Orientation"]={__ename__:["flambe","display","Orientation"],__constructs__:["Portrait","Landscape"]};
lc.Portrait=["Portrait",0];lc.Portrait.toString=l;lc.Portrait.__enum__=lc;lc.Landscape=["Landscape",1];lc.Landscape.toString=l;lc.Landscape.__enum__=lc;lc.__empty_constructs__=[lc.Portrait,lc.Landscape];var eg=function(){};h["flambe.display.Texture"]=eg;eg.__name__=["flambe","display","Texture"];eg.__interfaces__=[ee];eg.prototype={__class__:eg,__properties__:{get_height:"get_height",get_width:"get_width"}};var jk=function(){};h["flambe.display.SubTexture"]=jk;jk.__name__=["flambe","display","SubTexture"];
jk.__interfaces__=[eg];var mc=function(a,b){null==b&&(b="");this._layout=null;var c=this;E.call(this);this._font=a;this._text=b;this._align=Ya.Left;this._flags|=256;var d=function(){c._flags|=256};this.wrapWidth=new Q(0,d);this.letterSpacing=new Q(0,d);this.lineSpacing=new Q(0,d)};h["flambe.display.TextSprite"]=mc;mc.__name__=["flambe","display","TextSprite"];mc.__super__=E;mc.prototype=x(E.prototype,{draw:function(a){this.updateLayout();this._layout.draw(a)},getNaturalWidth:function(){this.updateLayout();
return 0<this.wrapWidth._value?this.wrapWidth._value:this._layout.bounds.width},getNaturalHeight:function(){this.updateLayout();var a=this._layout.lines*(this._font.lineHeight+this.lineSpacing._value),b=this._layout.bounds.height;return a>b?a:b},containsLocal:function(a,b){this.updateLayout();return this._layout.bounds.contains(a,b)},setWrapWidth:function(a){this.wrapWidth.set__(a);return this},setLetterSpacing:function(a){this.letterSpacing.set__(a);return this},setLineSpacing:function(a){this.lineSpacing.set__(a);
return this},setAlign:function(a){this.set_align(a);return this},set_text:function(a){a!=this._text&&(this._text=a,this._flags|=256);return a},set_font:function(a){a!=this._font&&(this._font=a,this._flags|=256);return a},set_align:function(a){a!=this._align&&(this._align=a,this._flags|=256);return a},updateLayout:function(){0!=(this._flags&256)&&(this._flags&=-257,this._layout=this._font.layoutText(this._text,this._align,this.wrapWidth._value,this.letterSpacing._value,this.lineSpacing._value))},onUpdate:function(a){E.prototype.onUpdate.call(this,
a);this.wrapWidth.update(a);this.letterSpacing.update(a);this.lineSpacing.update(a)},__class__:mc,__properties__:x(E.prototype.__properties__,{set_align:"set_align",set_font:"set_font",set_text:"set_text"})});var j=h["flambe.input.Key"]={__ename__:["flambe","input","Key"],__constructs__:"A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,Number0,Number1,Number2,Number3,Number4,Number5,Number6,Number7,Number8,Number9,Numpad0,Numpad1,Numpad2,Numpad3,Numpad4,Numpad5,Numpad6,Numpad7,Numpad8,Numpad9,NumpadAdd,NumpadDecimal,NumpadDivide,NumpadEnter,NumpadMultiply,NumpadSubtract,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12,F13,F14,F15,Left,Up,Right,Down,Alt,Backquote,Backslash,Backspace,CapsLock,Comma,Command,Control,Delete,End,Enter,Equals,Escape,Home,Insert,LeftBracket,Minus,PageDown,PageUp,Period,Quote,RightBracket,Semicolon,Shift,Slash,Space,Tab,Menu,Search,Unknown".split(",")};
j.A=["A",0];j.A.toString=l;j.A.__enum__=j;j.B=["B",1];j.B.toString=l;j.B.__enum__=j;j.C=["C",2];j.C.toString=l;j.C.__enum__=j;j.D=["D",3];j.D.toString=l;j.D.__enum__=j;j.E=["E",4];j.E.toString=l;j.E.__enum__=j;j.F=["F",5];j.F.toString=l;j.F.__enum__=j;j.G=["G",6];j.G.toString=l;j.G.__enum__=j;j.H=["H",7];j.H.toString=l;j.H.__enum__=j;j.I=["I",8];j.I.toString=l;j.I.__enum__=j;j.J=["J",9];j.J.toString=l;j.J.__enum__=j;j.K=["K",10];j.K.toString=l;j.K.__enum__=j;j.L=["L",11];j.L.toString=l;j.L.__enum__=
j;j.M=["M",12];j.M.toString=l;j.M.__enum__=j;j.N=["N",13];j.N.toString=l;j.N.__enum__=j;j.O=["O",14];j.O.toString=l;j.O.__enum__=j;j.P=["P",15];j.P.toString=l;j.P.__enum__=j;j.Q=["Q",16];j.Q.toString=l;j.Q.__enum__=j;j.R=["R",17];j.R.toString=l;j.R.__enum__=j;j.S=["S",18];j.S.toString=l;j.S.__enum__=j;j.T=["T",19];j.T.toString=l;j.T.__enum__=j;j.U=["U",20];j.U.toString=l;j.U.__enum__=j;j.V=["V",21];j.V.toString=l;j.V.__enum__=j;j.W=["W",22];j.W.toString=l;j.W.__enum__=j;j.X=["X",23];j.X.toString=
l;j.X.__enum__=j;j.Y=["Y",24];j.Y.toString=l;j.Y.__enum__=j;j.Z=["Z",25];j.Z.toString=l;j.Z.__enum__=j;j.Number0=["Number0",26];j.Number0.toString=l;j.Number0.__enum__=j;j.Number1=["Number1",27];j.Number1.toString=l;j.Number1.__enum__=j;j.Number2=["Number2",28];j.Number2.toString=l;j.Number2.__enum__=j;j.Number3=["Number3",29];j.Number3.toString=l;j.Number3.__enum__=j;j.Number4=["Number4",30];j.Number4.toString=l;j.Number4.__enum__=j;j.Number5=["Number5",31];j.Number5.toString=l;j.Number5.__enum__=
j;j.Number6=["Number6",32];j.Number6.toString=l;j.Number6.__enum__=j;j.Number7=["Number7",33];j.Number7.toString=l;j.Number7.__enum__=j;j.Number8=["Number8",34];j.Number8.toString=l;j.Number8.__enum__=j;j.Number9=["Number9",35];j.Number9.toString=l;j.Number9.__enum__=j;j.Numpad0=["Numpad0",36];j.Numpad0.toString=l;j.Numpad0.__enum__=j;j.Numpad1=["Numpad1",37];j.Numpad1.toString=l;j.Numpad1.__enum__=j;j.Numpad2=["Numpad2",38];j.Numpad2.toString=l;j.Numpad2.__enum__=j;j.Numpad3=["Numpad3",39];j.Numpad3.toString=
l;j.Numpad3.__enum__=j;j.Numpad4=["Numpad4",40];j.Numpad4.toString=l;j.Numpad4.__enum__=j;j.Numpad5=["Numpad5",41];j.Numpad5.toString=l;j.Numpad5.__enum__=j;j.Numpad6=["Numpad6",42];j.Numpad6.toString=l;j.Numpad6.__enum__=j;j.Numpad7=["Numpad7",43];j.Numpad7.toString=l;j.Numpad7.__enum__=j;j.Numpad8=["Numpad8",44];j.Numpad8.toString=l;j.Numpad8.__enum__=j;j.Numpad9=["Numpad9",45];j.Numpad9.toString=l;j.Numpad9.__enum__=j;j.NumpadAdd=["NumpadAdd",46];j.NumpadAdd.toString=l;j.NumpadAdd.__enum__=j;j.NumpadDecimal=
["NumpadDecimal",47];j.NumpadDecimal.toString=l;j.NumpadDecimal.__enum__=j;j.NumpadDivide=["NumpadDivide",48];j.NumpadDivide.toString=l;j.NumpadDivide.__enum__=j;j.NumpadEnter=["NumpadEnter",49];j.NumpadEnter.toString=l;j.NumpadEnter.__enum__=j;j.NumpadMultiply=["NumpadMultiply",50];j.NumpadMultiply.toString=l;j.NumpadMultiply.__enum__=j;j.NumpadSubtract=["NumpadSubtract",51];j.NumpadSubtract.toString=l;j.NumpadSubtract.__enum__=j;j.F1=["F1",52];j.F1.toString=l;j.F1.__enum__=j;j.F2=["F2",53];j.F2.toString=
l;j.F2.__enum__=j;j.F3=["F3",54];j.F3.toString=l;j.F3.__enum__=j;j.F4=["F4",55];j.F4.toString=l;j.F4.__enum__=j;j.F5=["F5",56];j.F5.toString=l;j.F5.__enum__=j;j.F6=["F6",57];j.F6.toString=l;j.F6.__enum__=j;j.F7=["F7",58];j.F7.toString=l;j.F7.__enum__=j;j.F8=["F8",59];j.F8.toString=l;j.F8.__enum__=j;j.F9=["F9",60];j.F9.toString=l;j.F9.__enum__=j;j.F10=["F10",61];j.F10.toString=l;j.F10.__enum__=j;j.F11=["F11",62];j.F11.toString=l;j.F11.__enum__=j;j.F12=["F12",63];j.F12.toString=l;j.F12.__enum__=j;j.F13=
["F13",64];j.F13.toString=l;j.F13.__enum__=j;j.F14=["F14",65];j.F14.toString=l;j.F14.__enum__=j;j.F15=["F15",66];j.F15.toString=l;j.F15.__enum__=j;j.Left=["Left",67];j.Left.toString=l;j.Left.__enum__=j;j.Up=["Up",68];j.Up.toString=l;j.Up.__enum__=j;j.Right=["Right",69];j.Right.toString=l;j.Right.__enum__=j;j.Down=["Down",70];j.Down.toString=l;j.Down.__enum__=j;j.Alt=["Alt",71];j.Alt.toString=l;j.Alt.__enum__=j;j.Backquote=["Backquote",72];j.Backquote.toString=l;j.Backquote.__enum__=j;j.Backslash=
["Backslash",73];j.Backslash.toString=l;j.Backslash.__enum__=j;j.Backspace=["Backspace",74];j.Backspace.toString=l;j.Backspace.__enum__=j;j.CapsLock=["CapsLock",75];j.CapsLock.toString=l;j.CapsLock.__enum__=j;j.Comma=["Comma",76];j.Comma.toString=l;j.Comma.__enum__=j;j.Command=["Command",77];j.Command.toString=l;j.Command.__enum__=j;j.Control=["Control",78];j.Control.toString=l;j.Control.__enum__=j;j.Delete=["Delete",79];j.Delete.toString=l;j.Delete.__enum__=j;j.End=["End",80];j.End.toString=l;j.End.__enum__=
j;j.Enter=["Enter",81];j.Enter.toString=l;j.Enter.__enum__=j;j.Equals=["Equals",82];j.Equals.toString=l;j.Equals.__enum__=j;j.Escape=["Escape",83];j.Escape.toString=l;j.Escape.__enum__=j;j.Home=["Home",84];j.Home.toString=l;j.Home.__enum__=j;j.Insert=["Insert",85];j.Insert.toString=l;j.Insert.__enum__=j;j.LeftBracket=["LeftBracket",86];j.LeftBracket.toString=l;j.LeftBracket.__enum__=j;j.Minus=["Minus",87];j.Minus.toString=l;j.Minus.__enum__=j;j.PageDown=["PageDown",88];j.PageDown.toString=l;j.PageDown.__enum__=
j;j.PageUp=["PageUp",89];j.PageUp.toString=l;j.PageUp.__enum__=j;j.Period=["Period",90];j.Period.toString=l;j.Period.__enum__=j;j.Quote=["Quote",91];j.Quote.toString=l;j.Quote.__enum__=j;j.RightBracket=["RightBracket",92];j.RightBracket.toString=l;j.RightBracket.__enum__=j;j.Semicolon=["Semicolon",93];j.Semicolon.toString=l;j.Semicolon.__enum__=j;j.Shift=["Shift",94];j.Shift.toString=l;j.Shift.__enum__=j;j.Slash=["Slash",95];j.Slash.toString=l;j.Slash.__enum__=j;j.Space=["Space",96];j.Space.toString=
l;j.Space.__enum__=j;j.Tab=["Tab",97];j.Tab.toString=l;j.Tab.__enum__=j;j.Menu=["Menu",98];j.Menu.toString=l;j.Menu.__enum__=j;j.Search=["Search",99];j.Search.toString=l;j.Search.__enum__=j;j.Unknown=function(a){a=["Unknown",100,a];a.__enum__=j;a.toString=l;return a};j.__empty_constructs__=[j.A,j.B,j.C,j.D,j.E,j.F,j.G,j.H,j.I,j.J,j.K,j.L,j.M,j.N,j.O,j.P,j.Q,j.R,j.S,j.T,j.U,j.V,j.W,j.X,j.Y,j.Z,j.Number0,j.Number1,j.Number2,j.Number3,j.Number4,j.Number5,j.Number6,j.Number7,j.Number8,j.Number9,j.Numpad0,
j.Numpad1,j.Numpad2,j.Numpad3,j.Numpad4,j.Numpad5,j.Numpad6,j.Numpad7,j.Numpad8,j.Numpad9,j.NumpadAdd,j.NumpadDecimal,j.NumpadDivide,j.NumpadEnter,j.NumpadMultiply,j.NumpadSubtract,j.F1,j.F2,j.F3,j.F4,j.F5,j.F6,j.F7,j.F8,j.F9,j.F10,j.F11,j.F12,j.F13,j.F14,j.F15,j.Left,j.Up,j.Right,j.Down,j.Alt,j.Backquote,j.Backslash,j.Backspace,j.CapsLock,j.Comma,j.Command,j.Control,j.Delete,j.End,j.Enter,j.Equals,j.Escape,j.Home,j.Insert,j.LeftBracket,j.Minus,j.PageDown,j.PageUp,j.Period,j.Quote,j.RightBracket,
j.Semicolon,j.Shift,j.Slash,j.Space,j.Tab,j.Menu,j.Search];var xi=function(){this.init(0,null)};h["flambe.input.KeyboardEvent"]=xi;xi.__name__=["flambe","input","KeyboardEvent"];xi.prototype={init:function(a,b){this.id=a;this.key=b},__class__:xi};var Da=h["flambe.input.MouseButton"]={__ename__:["flambe","input","MouseButton"],__constructs__:["Left","Middle","Right","Unknown"]};Da.Left=["Left",0];Da.Left.toString=l;Da.Left.__enum__=Da;Da.Middle=["Middle",1];Da.Middle.toString=l;Da.Middle.__enum__=
Da;Da.Right=["Right",2];Da.Right.toString=l;Da.Right.__enum__=Da;Da.Unknown=function(a){a=["Unknown",3,a];a.__enum__=Da;a.toString=l;return a};Da.__empty_constructs__=[Da.Left,Da.Middle,Da.Right];var Kb=h["flambe.input.MouseCursor"]={__ename__:["flambe","input","MouseCursor"],__constructs__:["Default","Button","None"]};Kb.Default=["Default",0];Kb.Default.toString=l;Kb.Default.__enum__=Kb;Kb.Button=["Button",1];Kb.Button.toString=l;Kb.Button.__enum__=Kb;Kb.None=["None",2];Kb.None.toString=l;Kb.None.__enum__=
Kb;Kb.__empty_constructs__=[Kb.Default,Kb.Button,Kb.None];var fg=function(){this.init(0,0,0,null)};h["flambe.input.MouseEvent"]=fg;fg.__name__=["flambe","input","MouseEvent"];fg.prototype={clone:function(){var a=new fg;a.init(this.id,this.viewX,this.viewY,this.button);return a},init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:fg};var te=h["flambe.input.EventSource"]={__ename__:["flambe","input","EventSource"],__constructs__:["Mouse","Touch"]};te.Mouse=function(a){a=
["Mouse",0,a];a.__enum__=te;a.toString=l;return a};te.Touch=function(a){a=["Touch",1,a];a.__enum__=te;a.toString=l;return a};te.__empty_constructs__=[];var gg=function(){this.init(0,0,0,null,null)};h["flambe.input.PointerEvent"]=gg;gg.__name__=["flambe","input","PointerEvent"];gg.prototype={clone:function(){var a=null,a=this.source;switch(a[1]){case 0:a=te.Mouse(a[2].clone());break;default:a=this.source}var b=new gg;b.init(this.id,this.viewX,this.viewY,this.hit,a);return b},init:function(a,b,c,d,
e){this.id=a;this.viewX=b;this.viewY=c;this.hit=d;this.source=e;this._stopped=!1},__class__:gg};var yi=function(a){this.id=a;this._source=te.Touch(this)};h["flambe.input.TouchPoint"]=yi;yi.__name__=["flambe","input","TouchPoint"];yi.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:yi};var Ra=function(){};h["flambe.math.FMath"]=Ra;Ra.__name__=["flambe","math","FMath"];Ra.toRadians=function(a){return 3.141592653589793*a/180};Ra.max=function(a,b){return a>b?a:b};Ra.min=function(a,b){return a<
b?a:b};Ra.clamp=function(a,b,c){return a<b?b:a>c?c:a};var Ib=function(){this.identity()};h["flambe.math.Matrix"]=Ib;Ib.__name__=["flambe","math","Matrix"];Ib.multiply=function(a,b,c){null==c&&(c=new Ib);var d=a.m00*b.m00+a.m01*b.m10,e=a.m00*b.m01+a.m01*b.m11,f=a.m00*b.m02+a.m01*b.m12+a.m02;c.m00=d;c.m01=e;c.m02=f;d=a.m10*b.m00+a.m11*b.m10;e=a.m10*b.m01+a.m11*b.m11;f=a.m10*b.m02+a.m11*b.m12+a.m12;c.m10=d;c.m11=e;c.m12=f;return c};Ib.prototype={set:function(a,b,c,d,e,f){this.m00=a;this.m01=c;this.m02=
e;this.m10=b;this.m11=d;this.m12=f},identity:function(){this.set(1,0,0,1,0,0)},compose:function(a,b,c,d,e){var f=Math.sin(e),e=Math.cos(e);this.set(e*c,f*c,-f*d,e*d,a,b)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},invert:function(){var a=this.determinant();if(0==a)return!1;this.set(this.m11/a,-this.m01/a,-this.m10/a,this.m00/a,(this.m01*this.m12-this.m11*this.m02)/a,(this.m10*this.m02-this.m00*this.m12)/a);return!0},transform:function(a,b,c){null==c&&
(c=new jd);c.x=a*this.m00+b*this.m01+this.m02;c.y=a*this.m10+b*this.m11+this.m12;return c},transformArray:function(a,b,c){for(var d=0;d<b;){var e=a[d],f=a[d+1];c[d++]=e*this.m00+f*this.m01+this.m02;c[d++]=e*this.m10+f*this.m11+this.m12}},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},clone:function(a){null==a&&
(a=new Ib);a.set(this.m00,this.m10,this.m01,this.m11,this.m02,this.m12);return a},__class__:Ib};var Jb=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};h["flambe.math.Rectangle"]=Jb;Jb.__name__=["flambe","math","Rectangle"];Jb.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>
b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},clone:function(a){null==a&&(a=new Jb);a.set(this.x,this.y,this.width,this.height);return a},equals:function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},__class__:Jb};var bb=function(){this._disposed=!1};h["flambe.platform.BasicAsset"]=bb;bb.__name__=["flambe","platform","BasicAsset"];bb.__interfaces__=[ee];bb.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},
onDisposed:function(){null},__class__:bb};var ge=function(a,b){var c=this;this.manifest=b;this._platform=a;this.promise=new hg;this._bytesLoaded=new M;this._pack=new ig(b,this);var d=Tf.array(b);if(0==d.length)this.handleSuccess();else{for(var e=new M,f=0;f<d.length;){var i=d[f];++f;var Ca=e.get(i.name);null==Ca&&(Ca=[],e.set(i.name,Ca));Ca.push(i)}this._assetsRemaining=Tf.count(e);for(d=new cf(e,e.arrayKeys());d.hasNext();)e=[d.next()],this.pickBestEntry(e[0],function(a){return function(d){if(null!=
d){var e=b.getFullURL(d);try{c.loadEntry(e,d)}catch(f){f instanceof p&&(f=f.val),c.handleError(d,"Unexpected error: "+r.string(f))}e=c.promise;e.set_total(e._total+d.bytes)}else d=a[0][0],ge.isAudio(d.format)?(ha.logger.warn("Could not find a supported audio format to load",["name",d.name]),c.handleLoad(d,Yb.getInstance())):c.handleError(d,"Could not find a supported format to load")}}(e))}};h["flambe.platform.BasicAssetPackLoader"]=ge;ge.__name__=["flambe","platform","BasicAssetPackLoader"];ge.isAudio=
function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};ge.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var e=c[d];++d;for(var f=0;f<a.length;){var i=a[f];++f;if(i.format==e){b(i);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=
this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var e=d.next(),c=c+e;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},handleError:function(a,b){ha.logger.warn("Error loading asset pack",
["error",b,"url",a.url]);this.promise.error.emit(pb.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:ge};var ig=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new M;this.sounds=new M;this.files=new M};h["flambe.platform._BasicAssetPackLoader.BasicAssetPack"]=ig;ig.__name__=["flambe","platform","_BasicAssetPackLoader","BasicAssetPack"];ig.__interfaces__=[ag];ig.prototype=
{getTexture:function(a,b){null==b&&(b=!0);var c=this.textures.get(a);if(null==c&&b)throw new p(pb.withFields("Missing texture",["name",a]));return c},getSound:function(a,b){null==b&&(b=!0);var c=this.sounds.get(a);if(null==c&&b)throw new p(pb.withFields("Missing sound",["name",a]));return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&b)throw new p(pb.withFields("Missing file",["name",a]));return c},dispose:function(){if(!this.disposed){this.disposed=!0;for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();
this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();this.files=null;this.loader.onDisposed()}},__class__:ig};var ue=function(a){this._disposed=!1;this._content=a};h["flambe.platform.BasicFile"]=ue;ue.__name__=["flambe","platform","BasicFile"];ue.__interfaces__=[bg];ue.__super__=bb;ue.prototype=x(bb.prototype,{toString:function(){return this._content},onDisposed:function(){this._content=null},__class__:ue});
var zi=function(){};h["flambe.subsystem.KeyboardSystem"]=zi;zi.__name__=["flambe","subsystem","KeyboardSystem"];zi.prototype={__class__:zi};var kc=function(){this.down=new ma;this.up=new ma;this.backButton=new yc;this._keyStates=new zb};h["flambe.platform.BasicKeyboard"]=kc;kc.__name__=["flambe","platform","BasicKeyboard"];kc.__interfaces__=[zi];kc.prototype={isDown:function(a){return this.isCodeDown(df.toKeyCode(a))},isCodeDown:function(a){return this._keyStates.h.hasOwnProperty(a)},submitDown:function(a){if(16777238==
a)return null!=this.backButton._head?(this.backButton.emit(),!0):!1;this._keyStates.h.hasOwnProperty(a)||(this._keyStates.h[a]=!0,kc._sharedEvent.init(kc._sharedEvent.id+1,df.toKey(a)),this.down.emit(kc._sharedEvent));return!0},submitUp:function(a){this._keyStates.h.hasOwnProperty(a)&&(this._keyStates.remove(a),kc._sharedEvent.init(kc._sharedEvent.id+1,df.toKey(a)),this.up.emit(kc._sharedEvent))},__class__:kc};var Ai=function(){};h["flambe.subsystem.MouseSystem"]=Ai;Ai.__name__=["flambe","subsystem",
"MouseSystem"];Ai.prototype={__class__:Ai};var nc=function(a){this._pointer=a;this._source=te.Mouse(nc._sharedEvent);this.down=new ma;this.move=new ma;this.up=new ma;this.scroll=new ma;this._y=this._x=0;this._cursor=Kb.Default;this._buttonStates=new zb};h["flambe.platform.BasicMouse"]=nc;nc.__name__=["flambe","platform","BasicMouse"];nc.__interfaces__=[Ai];nc.prototype={isDown:function(a){return this.isCodeDown(ef.toButtonCode(a))},submitDown:function(a,b,c){this._buttonStates.h.hasOwnProperty(c)||
(this._buttonStates.h[c]=!0,this.prepare(a,b,ef.toButton(c)),this._pointer.submitDown(a,b,this._source),this.down.emit(nc._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,b,this._source);this.move.emit(nc._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.h.hasOwnProperty(c)&&(this._buttonStates.remove(c),this.prepare(a,b,ef.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(nc._sharedEvent))},submitScroll:function(a,b,c){this._x=a;
this._y=b;if(null==this.scroll._head)return!1;this.scroll.emit(c);return!0},isCodeDown:function(a){return this._buttonStates.h.hasOwnProperty(a)},prepare:function(a,b,c){this._x=a;this._y=b;nc._sharedEvent.init(nc._sharedEvent.id+1,a,b,c)},__class__:nc};var Bi=function(){};h["flambe.subsystem.PointerSystem"]=Bi;Bi.__name__=["flambe","subsystem","PointerSystem"];Bi.prototype={__class__:Bi,__properties__:{get_y:"get_y",get_x:"get_x"}};var nb=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=
0);this.down=new ma;this.move=new ma;this.up=new ma;this._x=a;this._y=b;this._isDown=c};h["flambe.platform.BasicPointer"]=nb;nb.__name__=["flambe","platform","BasicPointer"];nb.__interfaces__=[Bi];nb.prototype={get_x:function(){return this._x},get_y:function(){return this._y},isDown:function(){return this._isDown},submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],e=E.hitTest(G.root,a,b);if(null!=e){var f=e.owner;do{var i=f._compMap.Sprite_3;null!=i&&d.push(i);
f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerDown(nb._sharedEvent),nb._sharedEvent._stopped)return;this.down.emit(nb._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],e=E.hitTest(G.root,a,b);if(null!=e){var f=e.owner;do{var i=f._compMap.Sprite_3;null!=i&&d.push(i);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerMove(nb._sharedEvent),nb._sharedEvent._stopped)return;this.move.emit(nb._sharedEvent)}},
submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,b,c);this._isDown=!1;var d=[],e=E.hitTest(G.root,a,b);if(null!=e){var f=e.owner;do{var i=f._compMap.Sprite_3;null!=i&&d.push(i);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerUp(nb._sharedEvent),nb._sharedEvent._stopped)return;this.up.emit(nb._sharedEvent)}},prepare:function(a,b,c,d){this._x=a;this._y=b;nb._sharedEvent.init(nb._sharedEvent.id+1,a,b,c,d)},__class__:nb,__properties__:{get_y:"get_y",
get_x:"get_x"}};var kd=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=!1;this.root=a;this._width=b;this._height=c};h["flambe.platform.BasicTexture"]=kd;kd.__name__=["flambe","platform","BasicTexture"];kd.__interfaces__=[jk];kd.__super__=bb;kd.prototype=x(bb.prototype,{subTexture:function(a,b,c,d){c=this.root.createTexture(c,d);c._parent=this;c._x=a;c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},onDisposed:function(){null==this._parent&&this.root.dispose()},
get_width:function(){return this._width},get_height:function(){return this._height},__class__:kd,__properties__:{get_height:"get_height",get_width:"get_width"}});var kk=function(){};h["flambe.subsystem.TouchSystem"]=kk;kk.__name__=["flambe","subsystem","TouchSystem"];var Vf=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new zb;this._points=[];this.down=new ma;this.move=new ma;this.up=new ma};h["flambe.platform.BasicTouch"]=Vf;Vf.__name__=["flambe","platform","BasicTouch"];
Vf.__interfaces__=[kk];Vf.prototype={submitDown:function(a,b,c){if(!this._pointMap.h.hasOwnProperty(a)){var d=new yi(a);d.init(b,c);this._pointMap.h[a]=d;this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},submitMove:function(a,b,c){a=this._pointMap.h[a];null!=a&&(a.init(b,c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,b,c){var d=this._pointMap.h[a];null!=d&&(d.init(b,
c),this._pointMap.remove(a),A.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:Vf};var ye=function(){};h["flambe.sound.Sound"]=ye;ye.__name__=["flambe","sound","Sound"];ye.__interfaces__=[ee];ye.prototype={__class__:ye};var Yb=function(){this._disposed=!1;this._playback=new jg(this)};h["flambe.platform.DummySound"]=Yb;Yb.__name__=["flambe","platform","DummySound"];Yb.__interfaces__=[ye];Yb.getInstance=function(){null==
Yb._instance&&(Yb._instance=new Yb);return Yb._instance};Yb.__super__=bb;Yb.prototype=x(bb.prototype,{play:function(){return this._playback},loop:function(){return this._playback},onDisposed:function(){},__class__:Yb});var ze=function(){};h["flambe.sound.Playback"]=ze;ze.__name__=["flambe","sound","Playback"];ze.__interfaces__=[id];ze.prototype={__class__:ze,__properties__:{get_complete:"get_complete"}};var jg=function(a){this._sound=a;this.volume=new Q(0);this._complete=new Qa(!0)};h["flambe.platform.DummyPlayback"]=
jg;jg.__name__=["flambe","platform","DummyPlayback"];jg.__interfaces__=[ze];jg.prototype={get_complete:function(){return this._complete},dispose:function(){},__class__:jg,__properties__:{get_complete:"get_complete"}};var kg=function(){};h["flambe.subsystem.StorageSystem"]=kg;kg.__name__=["flambe","subsystem","StorageSystem"];kg.prototype={__class__:kg,__properties__:{get_supported:"get_supported"}};var Yf=function(){this.clear()};h["flambe.platform.DummyStorage"]=Yf;Yf.__name__=["flambe","platform",
"DummyStorage"];Yf.__interfaces__=[kg];Yf.prototype={get_supported:function(){return!1},set:function(a,b){this._hash.set(a,b);return!0},get:function(a,b){return this._hash.exists(a)?this._hash.get(a):b},remove:function(a){this._hash.remove(a)},clear:function(){this._hash=new M},__class__:Yf,__properties__:{get_supported:"get_supported"}};var Wf=function(){this.down=new ma;this.move=new ma;this.up=new ma};h["flambe.platform.DummyTouch"]=Wf;Wf.__name__=["flambe","platform","DummyTouch"];Wf.__interfaces__=
[kk];Wf.prototype={__class__:Wf};var ff=function(){this._entries=[]};h["flambe.platform.EventGroup"]=ff;ff.__name__=["flambe","platform","EventGroup"];ff.__interfaces__=[id];ff.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);this._entries.push(new Ci(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,b=this._entries;a<b.length;){var c=b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,
!1)}this._entries=[]},__class__:ff};var Ci=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};h["flambe.platform._EventGroup.Entry"]=Ci;Ci.__name__=["flambe","platform","_EventGroup","Entry"];Ci.prototype={__class__:Ci};var gf=function(){};h["flambe.platform.InternalGraphics"]=gf;gf.__name__=["flambe","platform","InternalGraphics"];gf.__interfaces__=[wi];gf.prototype={__class__:gf};var Di=function(){};h["flambe.subsystem.RendererSystem"]=Di;Di.__name__=["flambe","subsystem","RendererSystem"];
Di.prototype={__class__:Di,__properties__:{get_type:"get_type"}};var hf=function(){};h["flambe.platform.InternalRenderer"]=hf;hf.__name__=["flambe","platform","InternalRenderer"];hf.__interfaces__=[Di];hf.prototype={__class__:hf};var df=function(){};h["flambe.platform.KeyCodes"]=df;df.__name__=["flambe","platform","KeyCodes"];df.toKey=function(a){switch(a){case 65:return j.A;case 66:return j.B;case 67:return j.C;case 68:return j.D;case 69:return j.E;case 70:return j.F;case 71:return j.G;case 72:return j.H;
case 73:return j.I;case 74:return j.J;case 75:return j.K;case 76:return j.L;case 77:return j.M;case 78:return j.N;case 79:return j.O;case 80:return j.P;case 81:return j.Q;case 82:return j.R;case 83:return j.S;case 84:return j.T;case 85:return j.U;case 86:return j.V;case 87:return j.W;case 88:return j.X;case 89:return j.Y;case 90:return j.Z;case 48:return j.Number0;case 49:return j.Number1;case 50:return j.Number2;case 51:return j.Number3;case 52:return j.Number4;case 53:return j.Number5;case 54:return j.Number6;
case 55:return j.Number7;case 56:return j.Number8;case 57:return j.Number9;case 96:return j.Numpad0;case 97:return j.Numpad1;case 98:return j.Numpad2;case 99:return j.Numpad3;case 100:return j.Numpad4;case 101:return j.Numpad5;case 102:return j.Numpad6;case 103:return j.Numpad7;case 104:return j.Numpad8;case 105:return j.Numpad9;case 107:return j.NumpadAdd;case 110:return j.NumpadDecimal;case 111:return j.NumpadDivide;case 108:return j.NumpadEnter;case 106:return j.NumpadMultiply;case 109:return j.NumpadSubtract;
case 112:return j.F1;case 113:return j.F2;case 114:return j.F3;case 115:return j.F4;case 116:return j.F5;case 117:return j.F6;case 118:return j.F7;case 119:return j.F8;case 120:return j.F9;case 121:return j.F10;case 122:return j.F11;case 123:return j.F12;case 37:return j.Left;case 38:return j.Up;case 39:return j.Right;case 40:return j.Down;case 18:return j.Alt;case 192:return j.Backquote;case 220:return j.Backslash;case 8:return j.Backspace;case 20:return j.CapsLock;case 188:return j.Comma;case 15:return j.Command;
case 17:return j.Control;case 46:return j.Delete;case 35:return j.End;case 13:return j.Enter;case 187:return j.Equals;case 27:return j.Escape;case 36:return j.Home;case 45:return j.Insert;case 219:return j.LeftBracket;case 189:return j.Minus;case 34:return j.PageDown;case 33:return j.PageUp;case 190:return j.Period;case 222:return j.Quote;case 221:return j.RightBracket;case 186:return j.Semicolon;case 16:return j.Shift;case 191:return j.Slash;case 32:return j.Space;case 9:return j.Tab;case 16777234:return j.Menu;
case 16777247:return j.Search}return j.Unknown(a)};df.toKeyCode=function(a){switch(a[1]){case 0:return 65;case 1:return 66;case 2:return 67;case 3:return 68;case 4:return 69;case 5:return 70;case 6:return 71;case 7:return 72;case 8:return 73;case 9:return 74;case 10:return 75;case 11:return 76;case 12:return 77;case 13:return 78;case 14:return 79;case 15:return 80;case 16:return 81;case 17:return 82;case 18:return 83;case 19:return 84;case 20:return 85;case 21:return 86;case 22:return 87;case 23:return 88;
case 24:return 89;case 25:return 90;case 26:return 48;case 27:return 49;case 28:return 50;case 29:return 51;case 30:return 52;case 31:return 53;case 32:return 54;case 33:return 55;case 34:return 56;case 35:return 57;case 36:return 96;case 37:return 97;case 38:return 98;case 39:return 99;case 40:return 100;case 41:return 101;case 42:return 102;case 43:return 103;case 44:return 104;case 45:return 105;case 46:return 107;case 47:return 110;case 48:return 111;case 49:return 108;case 50:return 106;case 51:return 109;
case 52:return 112;case 53:return 113;case 54:return 114;case 55:return 115;case 56:return 116;case 57:return 117;case 58:return 118;case 59:return 119;case 60:return 120;case 61:return 121;case 62:return 122;case 63:return 123;case 64:return 124;case 65:return 125;case 66:return 126;case 67:return 37;case 68:return 38;case 69:return 39;case 70:return 40;case 71:return 18;case 72:return 192;case 73:return 220;case 74:return 8;case 75:return 20;case 76:return 188;case 77:return 15;case 78:return 17;
case 79:return 46;case 80:return 35;case 81:return 13;case 82:return 187;case 83:return 27;case 84:return 36;case 85:return 45;case 86:return 219;case 87:return 189;case 88:return 34;case 89:return 33;case 90:return 190;case 91:return 222;case 92:return 221;case 93:return 186;case 94:return 16;case 95:return 191;case 96:return 32;case 97:return 9;case 98:return 16777234;case 99:return 16777247;case 100:return a[2]}};var Qd=function(){this._tickables=[]};h["flambe.platform.MainLoop"]=Qd;Qd.__name__=
["flambe","platform","MainLoop"];Qd.updateEntity=function(a,b){var c=a._compMap.SpeedAdjuster_4;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,Qd.updateEntity(c,b),c=d};Qd.prototype={update:function(a){if(0>=a)ha.logger.warn("Zero or negative time elapsed since the last frame!",["dt",a]);else{1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=
this._tickables[b];null==c||c.update(a)?this._tickables.splice(b,1):++b}G.volume.update(a);Qd.updateEntity(G.root,a)}},addTickable:function(a){this._tickables.push(a)},__class__:Qd};var Ei=function(){};h["flambe.platform.MathUtil"]=Ei;Ei.__name__=["flambe","platform","MathUtil"];Ei.nextPowerOfTwo=function(a){for(var b=1;b<a;)b<<=1;return b};var ef=function(){};h["flambe.platform.MouseCodes"]=ef;ef.__name__=["flambe","platform","MouseCodes"];ef.toButton=function(a){switch(a){case 0:return Da.Left;
case 1:return Da.Middle;case 2:return Da.Right}return Da.Unknown(a)};ef.toButtonCode=function(a){switch(a[1]){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return a[2]}};var lg=function(){};h["flambe.platform.TextureRoot"]=lg;lg.__name__=["flambe","platform","TextureRoot"];lg.prototype={__class__:lg};var mg=function(){};h["flambe.platform.Tickable"]=mg;mg.__name__=["flambe","platform","Tickable"];mg.prototype={__class__:mg};var ng=function(a,b){this._firstDraw=!1;this._canvasCtx=a.getContext("2d",
{alpha:b})};h["flambe.platform.html.CanvasGraphics"]=ng;ng.__name__=["flambe","platform","html","CanvasGraphics"];ng.__interfaces__=[gf];ng.prototype={save:function(){this._canvasCtx.save()},translate:function(a,b){this._canvasCtx.translate(a|0,b|0)},scale:function(a,b){this._canvasCtx.scale(a,b)},rotate:function(a){this._canvasCtx.rotate(3.141592653589793*a/180)},transform:function(a,b,c,d,e,f){this._canvasCtx.transform(a,b,c,d,e,f)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,
b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,e,f,i){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawSubTexture(a,b,c,d,e,f,i),this._canvasCtx.globalCompositeOperation="source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+e|0,f|0,i|0,b|0,c|0,f|0,i|0)},fillRect:function(a,b,c,d,e){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.fillRect(a,b,
c,d,e),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=(16777215&a).toString(16);6>a.length;)a="0"+r.string(a);this._canvasCtx.fillStyle="#"+r.string(a);this._canvasCtx.fillRect(b|0,c|0,d|0,e|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=
b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},onResize:function(){},__class__:ng};var qe=function(a){this.graphics=new ng(a,!0);this._hasGPU=new Qa(!0)};h["flambe.platform.html.CanvasRenderer"]=qe;qe.__name__=["flambe","platform","html","CanvasRenderer"];qe.__interfaces__=[hf];qe.prototype={get_type:function(){return gb.Canvas},createTextureFromImage:function(a){a=
new jf(qe.CANVAS_TEXTURES?U.createCanvas(a):a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},__class__:qe,__properties__:{get_type:"get_type"}};var og=function(a,b,c){kd.call(this,a,b,c)};h["flambe.platform.html.CanvasTexture"]=og;og.__name__=["flambe","platform","html","CanvasTexture"];og.__super__=kd;og.prototype=
x(kd.prototype,{__class__:og});var jf=function(a){this._graphics=null;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};h["flambe.platform.html.CanvasTextureRoot"]=jf;jf.__name__=["flambe","platform","html","CanvasTextureRoot"];jf.__interfaces__=[lg];jf.__super__=bb;jf.prototype=x(bb.prototype,{createTexture:function(a,b){return new og(this,a,b)},onDisposed:function(){this._graphics=this.image=null},__class__:jf});var za=function(a,b){ge.call(this,a,b)};h["flambe.platform.html.HtmlAssetPackLoader"]=
za;za.__name__=["flambe","platform","html","HtmlAssetPackLoader"];za.detectImageFormats=function(a){var b=[D.PNG,D.JPG,D.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(D.WEBP);--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var e;e=window.document.createElement("img");e.onload=e.onerror=function(){1==e.width&&b.unshift(D.JXR);--c;0==c&&a(b)};e.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};
za.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==a||null==u(a,a.canPlayType))return ha.logger.warn("Audio is not supported at all in this browser!",null),[];var b=new xb("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",""),c=window.navigator.userAgent;if(!va.get_supported()&&b.match(c))return ha.logger.warn("HTML5 audio is blacklisted for this browser",["userAgent",c]),[];for(var b=[{format:D.M4A,mimeType:"audio/mp4; codecs=mp4a"},{format:D.MP3,mimeType:"audio/mpeg"},
{format:D.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:D.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:D.WAV,mimeType:"audio/wav"}],c=[],d=0;d<b.length;){var e=b[d];++d;var f="";try{f=a.canPlayType(e.mimeType)}catch(i){i instanceof p&&(i=i.val)}""!=f&&c.push(e.format)}return c};za.supportsBlob=function(){if(za._detectBlobSupport){za._detectBlobSupport=!1;if((new xb("\\bSilk\\b","")).match(window.navigator.userAgent)||null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",".",!0);if(""!=
a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;za._URL=U.loadExtension("URL").value}return null!=za._URL&&null!=za._URL.createObjectURL};za.__super__=ge;za.prototype=x(ge.prototype,{loadEntry:function(a,b){var c=this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var e=new ff;e.addDisposingListener(d,"load",function(){za.supportsBlob()&&za._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);
null!=a?c.handleLoad(b,a):c.handleTextureError(b)});e.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});za.supportsBlob()?this.download(a,b,"blob",function(a){d.src=za._URL.createObjectURL(a)}):d.src=a;break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});break;case 8:case 9:case 10:case 11:case 12:if(va.get_supported())this.download(a,
b,"arraybuffer",function(d){va.ctx.decodeAudioData(d,function(a){c.handleLoad(b,new va(a))},function(){ha.logger.warn("Couldn't decode Web Audio, ignoring this asset",["url",a]);c.handleLoad(b,Yb.getInstance())})});else{var f;f=window.document.createElement("audio");f.preload="auto";var i=++za._mediaRefCount;null==za._mediaElements&&(za._mediaElements=new zb);za._mediaElements.h[i]=f;e=new ff;e.addDisposingListener(f,"canplaythrough",function(){za._mediaElements.remove(i);c.handleLoad(b,new kf(f))});
e.addDisposingListener(f,"error",function(){za._mediaElements.remove(i);var d=f.error.code;3==d||4==d?(ha.logger.warn("Couldn't decode HTML5 audio, ignoring this asset",["url",a,"code",d]),c.handleLoad(b,Yb.getInstance())):c.handleError(b,"Failed to load audio: "+f.error.code)});e.addListener(f,"progress",function(){if(0<f.buffered.length&&0<f.duration){var a=f.buffered.end(0)/f.duration;c.handleProgress(b,a*b.bytes|0)}});f.src=a;f.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,
new ue(a))})}},getAssetFormats:function(a){var b=this;null==za._supportedFormats&&(za._supportedFormats=new hg,za.detectImageFormats(function(a){za._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(za.detectAudioFormats()).concat([D.Data]))}));za._supportedFormats.get(a)},download:function(a,b,c,d){var e=this,f=null,i=null,g=0,o=!1,h=function(){o&&(o=!1,window.clearInterval(g))},j=3,k=function(){--j;return 0<=j?(ha.logger.warn("Retrying asset download",
["url",b.url]),i(),!0):!1},i=function(){h();null!=f&&f.abort();f=new XMLHttpRequest;f.open("GET",a,!0);f.responseType=c;var i=0;f.onprogress=function(a){o||(o=!0,g=window.setInterval(function(){4!=f.readyState&&5E3<Date.now()-i&&!k()&&(h(),e.handleError(b,"Download stalled"))},1E3));i=Date.now();e.handleProgress(b,a.loaded)};f.onerror=function(){if(0!=f.status||!k())h(),e.handleError(b,"HTTP error "+f.status)};f.onload=function(){var a=f.response;null==a&&(a=f.responseText);h();d(a)};f.send()};i()},
__class__:za});var Fi=function(){};h["flambe.subsystem.ExternalSystem"]=Fi;Fi.__name__=["flambe","subsystem","ExternalSystem"];Fi.prototype={__class__:Fi};var Zf=function(){};h["flambe.platform.html.HtmlExternal"]=Zf;Zf.__name__=["flambe","platform","html","HtmlExternal"];Zf.__interfaces__=[Fi];Zf.prototype={call:function(a,b){null==b&&(b=[]);for(var c=window,d=c,e=0,f=a.split(".");e<f.length;){var i=f[e];++e;c=d;d=da.field(c,i)}return da.callMethod(c,d,b)},__class__:Zf};var Gi=function(){};h["flambe.util.LogHandler"]=
Gi;Gi.__name__=["flambe","util","LogHandler"];Gi.prototype={__class__:Gi};var Dd=function(a){this._tagPrefix=a+": "};h["flambe.platform.html.HtmlLogHandler"]=Dd;Dd.__name__=["flambe","platform","html","HtmlLogHandler"];Dd.__interfaces__=[Gi];Dd.isSupported=function(){return"object"==typeof console&&null!=console.info};Dd.prototype={log:function(a,b){b=this._tagPrefix+b;switch(a[1]){case 0:console.info(b);break;case 1:console.warn(b);break;case 2:console.error(b)}},__class__:Dd};var Uf=function(a,
b){nc.call(this,a);this._canvas=b};h["flambe.platform.html.HtmlMouse"]=Uf;Uf.__name__=["flambe","platform","html","HtmlMouse"];Uf.__super__=nc;Uf.prototype=x(nc.prototype,{__class__:Uf});var kf=function(a){this._disposed=!1;this.audioElement=a};h["flambe.platform.html.HtmlSound"]=kf;kf.__name__=["flambe","platform","html","HtmlSound"];kf.__interfaces__=[ye];kf.__super__=bb;kf.prototype=x(bb.prototype,{play:function(a){null==a&&(a=1);return new lf(this,a,!1)},loop:function(a){null==a&&(a=1);return new lf(this,
a,!0)},onDisposed:function(){this.audioElement=null},__class__:kf});var lf=function(a,b,c){var d=this;this._sound=a;this._tickableAdded=!1;this._clonedElement=window.document.createElement("audio");this._clonedElement.loop=c;this._clonedElement.src=a.audioElement.src;this.volume=new Q(b,function(){d.updateVolume()});this.updateVolume();this._complete=new Qa(!1);this.playAudio();G.hidden._value&&this.set_paused(!0)};h["flambe.platform.html._HtmlSound.HtmlPlayback"]=lf;lf.__name__=["flambe","platform",
"html","_HtmlSound","HtmlPlayback"];lf.__interfaces__=[mg,ze];lf.prototype={set_paused:function(a){this._clonedElement.paused!=a&&(a?this._clonedElement.pause():this.playAudio());return a},get_complete:function(){return this._complete},update:function(a){this.volume.update(a);this._complete.set__(this._clonedElement.ended);return this._complete._value||this._clonedElement.paused?(this._tickableAdded=!1,this._volumeBinding.dispose(),this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);
this._complete.set__(!0)},playAudio:function(){var a=this;this._clonedElement.play();this._tickableAdded||(Vc.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._volumeBinding=G.volume.get_changed().connect(function(){a.updateVolume()}),this._hideBinding=G.hidden.get_changed().connect(function(b){b?(a._wasPaused=a._clonedElement.paused,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},updateVolume:function(){this._clonedElement.volume=G.volume._value*this.volume._value},__class__:lf,__properties__:{get_complete:"get_complete",
set_paused:"set_paused"}};var Hi=function(){};h["flambe.subsystem.StageSystem"]=Hi;Hi.__name__=["flambe","subsystem","StageSystem"];Hi.prototype={__class__:Hi,__properties__:{get_height:"get_height",get_width:"get_width"}};var pe=function(a){var b=this;this._canvas=a;this.resize=new yc;this.scaleFactor=pe.computeScaleFactor();1!=this.scaleFactor&&(ha.logger.info("Reversing device DPI scaling",["scaleFactor",this.scaleFactor]),U.setVendorStyle(this._canvas,"transform-origin","top left"),U.setVendorStyle(this._canvas,
"transform","scale("+1/this.scaleFactor+")"));U.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){U.callLater(u(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",u(this,this.onWindowResize),!1);this.onWindowResize(null);this.orientation=new Qa(null);null!=window.orientation&&(window.addEventListener("orientationchange",u(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new Qa(!1);U.addVendorListener(window.document,
"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};h["flambe.platform.html.HtmlStage"]=pe;pe.__name__=["flambe","platform","html","HtmlStage"];pe.__interfaces__=[Hi];pe.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d",null),b=U.loadExtension("backingStorePixelRatio",b).value;null==b&&(b=1);a/=b;b=window.screen.height;return 1136<a*window.screen.width||1136<a*b?1:a};pe.prototype={get_width:function(){return this._canvas.width},
get_height:function(){return this._canvas.height},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;this._canvas.width=c|0;this._canvas.height=d|0;this.resize.emit();return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+100+"px";b.width=
window.innerWidth+"px";b.overflow="visible";U.callLater(function(){U.hideMobileBrowser();U.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(U.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==U.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],window.document).value)},__class__:pe,__properties__:{get_height:"get_height",get_width:"get_width"}};var Xf=function(a){this._storage=
a};h["flambe.platform.html.HtmlStorage"]=Xf;Xf.__name__=["flambe","platform","html","HtmlStorage"];Xf.__interfaces__=[kg];Xf.prototype={get_supported:function(){return!0},set:function(a,b){var c;try{var d=new Yc;d.useCache=!0;d.useEnumIndex=!1;d.serialize(b);c=d.toString()}catch(e){return e instanceof p&&(e=e.val),ha.logger.warn("Storage serialization failed",["message",e]),!1}try{this._storage.setItem("flambe:"+a,c)}catch(f){return f instanceof p&&(f=f.val),ha.logger.warn("localStorage.setItem failed",
["message",f.message]),!1}return!0},get:function(a,b){var c=null;try{c=this._storage.getItem("flambe:"+a)}catch(d){d instanceof p&&(d=d.val),ha.logger.warn("localStorage.getItem failed",["message",d.message])}if(null!=c)try{return hb.run(c)}catch(e){e instanceof p&&(e=e.val),ha.logger.warn("Storage unserialization failed",["message",e])}return b},remove:function(a){try{this._storage.removeItem("flambe:"+a)}catch(b){b instanceof p&&(b=b.val),ha.logger.warn("localStorage.removeItem failed",["message",
b.message])}},clear:function(){try{this._storage.clear()}catch(a){a instanceof p&&(a=a.val),ha.logger.warn("localStorage.clear failed",["message",a.message])}},__class__:Xf,__properties__:{get_supported:"get_supported"}};var U=function(){};h["flambe.platform.html.HtmlUtil"]=U;U.__name__=["flambe","platform","html","HtmlUtil"];U.callLater=function(a,b){null==b&&(b=0);window.setTimeout(a,b)};U.hideMobileBrowser=function(){window.scrollTo(1,0)};U.loadExtension=function(a,b){null==b&&(b=window);var c=
da.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+A.substr(a,1,null),d=0,e=U.VENDOR_PREFIXES;d<e.length;){var f=e[d];++d;var i=f+c,g=da.field(b,i);if(null!=g)return{prefix:f,field:i,value:g}}return{prefix:null,field:null,value:null}};U.loadFirstExtension=function(a,b){for(var c=0;c<a.length;){var d=a[c];++c;d=U.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};U.polyfill=function(a,b){null==b&&(b=window);var c=U.loadExtension(a,
b).value;if(null==c)return!1;b[a]=c;return!0};U.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,e=U.VENDOR_PREFIXES;d<e.length;){var f=e[d];++d;a.setProperty("-"+f+"-"+b,c)}a.setProperty(b,c)};U.addVendorListener=function(a,b,c,d){for(var e=0,f=U.VENDOR_PREFIXES;e<f.length;){var i=f[e];++e;a.addEventListener(i+b,c,d)}a.addEventListener(b,c,d)};U.orientation=function(a){switch(a){case -90:case 90:return lc.Landscape;default:return lc.Portrait}};U.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");
c.width=a;c.height=b;return c};U.createCanvas=function(a){var b=U.createEmptyCanvas(a.width,a.height),c=b.getContext("2d",null);c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};U.detectSlowDriver=function(a){if(0<=window.navigator.platform.indexOf("Win")&&null!=window.chrome){for(var b=0,a=a.getSupportedExtensions();b<a.length;){var c=a[b];++b;if(0<=c.indexOf("WEBGL_compressed_texture"))return!1}return!0}return!1};U.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){ha.logger.warn("Monkey patching around Android sin/cos bug",
null);var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==a?1:b(a)}}};var va=function(a){this._disposed=!1;this.buffer=a};h["flambe.platform.html.WebAudioSound"]=va;va.__name__=["flambe","platform","html","WebAudioSound"];va.__interfaces__=[ye];va.__properties__={get_supported:"get_supported"};va.get_supported=function(){if(va._detectSupport){va._detectSupport=!1;var a=U.loadExtension("AudioContext").value;null!=a&&(va.ctx=new a,va.gain=va.createGain(),
va.gain.connect(va.ctx.destination),G.volume.watch(function(a){va.gain.gain.value=a}))}return null!=va.ctx};va.createGain=function(){return null!=va.ctx.createGain?va.ctx.createGain():va.ctx.createGainNode()};va.start=function(a,b){null!=a.start?a.start(b):a.noteOn(b)};va.__super__=bb;va.prototype=x(bb.prototype,{play:function(a){null==a&&(a=1);return new mf(this,a,!1)},loop:function(a){null==a&&(a=1);return new mf(this,a,!0)},get_duration:function(){return this.buffer.duration},onDisposed:function(){this.buffer=
null},__class__:va,__properties__:{get_duration:"get_duration"}});var mf=function(a,b,c){var d=this;this._sound=a;this._head=va.gain;this._complete=new Qa(!1);this._sourceNode=va.ctx.createBufferSource();this._sourceNode.buffer=a.buffer;this._sourceNode.loop=c;this._sourceNode.onended=function(){d._complete.set__(!0)};va.start(this._sourceNode,0);this.playAudio();this.volume=new Q(b,function(a){d.setVolume(a)});1!=b&&this.setVolume(b);G.hidden._value&&this.set_paused(!0)};h["flambe.platform.html._WebAudioSound.WebAudioPlayback"]=
mf;mf.__name__=["flambe","platform","html","_WebAudioSound","WebAudioPlayback"];mf.__interfaces__=[mg,ze];mf.prototype={set_paused:function(a){a!=0<=this._pausedAt&&(a?(this._sourceNode.disconnect(),this._pausedAt=this.get_position()):this.playAudio());return a},get_complete:function(){return this._complete},get_position:function(){return this._complete._value?this._sound.get_duration():0<=this._pausedAt?this._pausedAt:(va.ctx.currentTime-this._startedAt)%this._sound.get_duration()},update:function(a){this.volume.update(a);
3==this._sourceNode.playbackState&&this._complete.set__(!0);return this._complete._value||0<=this._pausedAt?(this._tickableAdded=!1,this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},setVolume:function(a){null==this._gainNode&&(this._gainNode=va.createGain(),this.insertNode(this._gainNode));this._gainNode.gain.value=a},insertNode:function(a){0<=this._pausedAt||(this._sourceNode.disconnect(),this._sourceNode.connect(a));a.connect(this._head);this._head=
a},playAudio:function(){var a=this;this._sourceNode.connect(this._head);this._startedAt=va.ctx.currentTime;this._pausedAt=-1;this._tickableAdded||(Vc.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._hideBinding=G.hidden.get_changed().connect(function(b){b?(a._wasPaused=0<=a._pausedAt,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},__class__:mf,__properties__:{get_position:"get_position",get_complete:"get_complete",set_paused:"set_paused"}};var Ii=function(a){this._quads=this._maxQuads=
this._dataOffset=this._backbufferWidth=this._backbufferHeight=0;this._pendingSetScissor=!1;this._lastBlendMode=this._lastRenderTarget=this._lastShader=this._lastTexture=this._lastScissor=this._currentBlendMode=this._currentShader=this._currentTexture=this._currentRenderTarget=null;this._gl=a;a.clearColor(0,0,0,0);a.enable(3042);a.pixelStorei(37441,1);this._vertexBuffer=a.createBuffer();a.bindBuffer(34962,this._vertexBuffer);this._quadIndexBuffer=a.createBuffer();a.bindBuffer(34963,this._quadIndexBuffer);
this._drawTextureShader=new pg(a);this._drawPatternShader=new qg(a);this._fillRectShader=new rg(a);this.resize(16)};h["flambe.platform.html.WebGLBatcher"]=Ii;Ii.__name__=["flambe","platform","html","WebGLBatcher"];Ii.prototype={resizeBackbuffer:function(a,b){this._gl.viewport(0,0,a,b);this._backbufferWidth=a;this._backbufferHeight=b},willRender:function(){this._gl.clear(16384)},didRender:function(){this.flush()},bindTexture:function(a){this.flush();this._currentTexture=this._lastTexture=null;this._gl.bindTexture(3553,
a)},deleteTexture:function(a){null!=this._lastTexture&&this._lastTexture.root==a&&(this.flush(),this._currentTexture=this._lastTexture=null);this._gl.deleteTexture(a.nativeTexture)},deleteFramebuffer:function(a){a==this._lastRenderTarget&&(this.flush(),this._currentRenderTarget=this._lastRenderTarget=null);this._gl.deleteFramebuffer(a.framebuffer)},prepareDrawTexture:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawTextureShader)},
prepareFillRect:function(a,b,c){return this.prepareQuad(6,a,b,c,this._fillRectShader)},prepareQuad:function(a,b,c,d,e){b!=this._lastRenderTarget&&(this.flush(),this._lastRenderTarget=b);c!=this._lastBlendMode&&(this.flush(),this._lastBlendMode=c);e!=this._lastShader&&(this.flush(),this._lastShader=e);if(null!=d||null!=this._lastScissor)if(null==d||null==this._lastScissor||!this._lastScissor.equals(d))this.flush(),this._lastScissor=null!=d?d.clone(this._lastScissor):null,this._pendingSetScissor=!0;
this._quads>=this._maxQuads&&this.resize(2*this._maxQuads);++this._quads;b=this._dataOffset;this._dataOffset+=4*a;return b},flush:function(){if(!(1>this._quads)){this._lastRenderTarget!=this._currentRenderTarget&&this.bindRenderTarget(this._lastRenderTarget);if(this._lastBlendMode!=this._currentBlendMode){switch(this._lastBlendMode[1]){case 0:this._gl.blendFunc(1,771);break;case 1:this._gl.blendFunc(1,1);break;case 2:this._gl.blendFunc(774,771);break;case 3:this._gl.blendFunc(1,769);break;case 4:this._gl.blendFunc(0,
770);break;case 5:this._gl.blendFunc(1,0)}this._currentBlendMode=this._lastBlendMode}this._pendingSetScissor&&(null!=this._lastScissor?(this._gl.enable(3089),this._gl.scissor(this._lastScissor.x|0,this._lastScissor.y|0,this._lastScissor.width|0,this._lastScissor.height|0)):this._gl.disable(3089),this._pendingSetScissor=!1);this._lastTexture!=this._currentTexture&&(this._gl.bindTexture(3553,this._lastTexture.root.nativeTexture),this._currentTexture=this._lastTexture);this._lastShader!=this._currentShader&&
(this._lastShader.useProgram(),this._lastShader.prepare(),this._currentShader=this._lastShader);if(this._lastShader==this._drawPatternShader){var a=this._lastTexture,b=a.root;this._drawPatternShader.setRegion(a.rootX/b.width,a.rootY/b.height,a._width/b.width,a._height/b.height)}this._gl.bufferData(34962,this.data.subarray(0,this._dataOffset),35040);this._gl.drawElements(4,6*this._quads,5123,0);this._dataOffset=this._quads=0}},resize:function(a){this.flush();if(!(1024<a)){this._maxQuads=a;this.data=
new Float32Array(24*a);this._gl.bufferData(34962,4*this.data.length,35040);for(var b=new Uint16Array(6*a),c=0;c<a;){var d=c++;b[6*d]=4*d;b[6*d+1]=4*d+1;b[6*d+2]=4*d+2;b[6*d+3]=4*d+2;b[6*d+4]=4*d+3;b[6*d+5]=4*d}this._gl.bufferData(34963,b,35044)}},bindRenderTarget:function(a){null!=a?(this._gl.bindFramebuffer(36160,a.framebuffer),this._gl.viewport(0,0,a.width,a.height)):(this._gl.bindFramebuffer(36160,null),this._gl.viewport(0,0,this._backbufferWidth,this._backbufferHeight));this._lastRenderTarget=
this._currentRenderTarget=a},__class__:Ii};var oc=function(a,b){this._inverseProjection=this._stateList=null;null==oc._scratchQuadArray&&(oc._scratchQuadArray=new Float32Array(8));this._batcher=a;this._renderTarget=b};h["flambe.platform.html.WebGLGraphics"]=oc;oc.__name__=["flambe","platform","html","WebGLGraphics"];oc.__interfaces__=[gf];oc.prototype={save:function(){var a=this._stateList,b=this._stateList.next;null==b&&(b=new sg,b.prev=a,a.next=b);a.matrix.clone(b.matrix);b.alpha=a.alpha;b.blendMode=
a.blendMode;b.scissor=null!=a.scissor?a.scissor.clone(b.scissor):null;this._stateList=b},translate:function(a,b){var c=this._stateList.matrix;c.m02+=c.m00*a+c.m01*b;c.m12+=c.m10*a+c.m11*b},scale:function(a,b){var c=this._stateList.matrix;c.m00*=a;c.m10*=a;c.m01*=b;c.m11*=b},rotate:function(a){var b=this._stateList.matrix,a=3.141592653589793*a/180,c=Math.sin(a),a=Math.cos(a),d=b.m00,e=b.m10,f=b.m01,i=b.m11;b.m00=d*a+f*c;b.m10=e*a+i*c;b.m01=f*a-d*c;b.m11=i*a-e*c},transform:function(a,b,c,d,e,f){var i=
this._stateList;oc._scratchMatrix.set(a,b,c,d,e,f);Ib.multiply(i.matrix,oc._scratchMatrix,i.matrix)},restore:function(){this._stateList=this._stateList.prev},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,e,f,i){var g=this._stateList,o=a.root,b=this.transformQuad(b,c,f,i),c=o.width,o=o.height,d=(a.rootX+d)/c,e=(a.rootY+e)/o,f=d+f/c,i=e+i/o,c=g.alpha,a=this._batcher.prepareDrawTexture(this._renderTarget,g.blendMode,g.scissor,
a),g=this._batcher.data;g[a]=b[0];g[++a]=b[1];g[++a]=d;g[++a]=e;g[++a]=c;g[++a]=b[2];g[++a]=b[3];g[++a]=f;g[++a]=e;g[++a]=c;g[++a]=b[4];g[++a]=b[5];g[++a]=f;g[++a]=i;g[++a]=c;g[++a]=b[6];g[++a]=b[7];g[++a]=d;g[++a]=i;g[++a]=c},fillRect:function(a,b,c,d,e){var f=this._stateList,b=this.transformQuad(b,c,d,e),c=(a&16711680)/16711680,d=(a&65280)/65280,a=(a&255)/255,e=f.alpha,f=this._batcher.prepareFillRect(this._renderTarget,f.blendMode,f.scissor),i=this._batcher.data;i[f]=b[0];i[++f]=b[1];i[++f]=c;i[++f]=
d;i[++f]=a;i[++f]=e;i[++f]=b[2];i[++f]=b[3];i[++f]=c;i[++f]=d;i[++f]=a;i[++f]=e;i[++f]=b[4];i[++f]=b[5];i[++f]=c;i[++f]=d;i[++f]=a;i[++f]=e;i[++f]=b[6];i[++f]=b[7];i[++f]=c;i[++f]=d;i[++f]=a;i[++f]=e},multiplyAlpha:function(a){this._stateList.alpha*=a},setBlendMode:function(a){this._stateList.blendMode=a},applyScissor:function(a,b,c,d){var e=this._stateList,f=oc._scratchQuadArray;f[0]=a;f[1]=b;f[2]=a+c;f[3]=b+d;e.matrix.transformArray(f,4,f);this._inverseProjection.transformArray(f,4,f);a=f[0];b=
f[1];c=f[2]-a;d=f[3]-b;0>c&&(a+=c,c=-c);0>d&&(b+=d,d=-d);e.applyScissor(a,b,c,d)},willRender:function(){this._batcher.willRender()},didRender:function(){this._batcher.didRender()},onResize:function(a,b){this._stateList=new sg;var c;c=null!=this._renderTarget?-1:1;this._stateList.matrix.set(2/a,0,0,-2*c/b,-1,c);this._inverseProjection=new Ib;this._inverseProjection.set(2/a,0,0,2/b,-1,-1);this._inverseProjection.invert()},transformQuad:function(a,b,c,d){var c=a+c,d=b+d,e=oc._scratchQuadArray;e[0]=a;
e[1]=b;e[2]=c;e[3]=b;e[4]=c;e[5]=d;e[6]=a;e[7]=d;this._stateList.matrix.transformArray(e,8,e);return e},__class__:oc};var sg=function(){this.scissor=this.prev=this.next=null;this.matrix=new Ib;this.alpha=1;this.blendMode=ia.Normal};h["flambe.platform.html._WebGLGraphics.DrawingState"]=sg;sg.__name__=["flambe","platform","html","_WebGLGraphics","DrawingState"];sg.prototype={applyScissor:function(a,b,c,d){if(null!=this.scissor)var e=Ra.max(this.scissor.x,a),f=Ra.max(this.scissor.y,b),c=Ra.min(this.scissor.x+
this.scissor.width,a+c),d=Ra.min(this.scissor.y+this.scissor.height,b+d),a=e,b=f,c=c-e,d=d-f;else this.scissor=new Jb;this.scissor.set(Math.round(a),Math.round(b),Math.round(c),Math.round(d))},__class__:sg};var $f=function(a,b){var c=this;this._hasGPU=new Qa(!0);this.gl=b;b.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();ha.logger.warn("WebGL context lost",null);c._hasGPU.set__(!1)},!1);b.canvas.addEventListener("webglcontextrestore",function(){ha.logger.warn("WebGL context restored",
null);c.init();c._hasGPU.set__(!0)},!1);a.resize.connect(u(this,this.onResize));this.init()};h["flambe.platform.html.WebGLRenderer"]=$f;$f.__name__=["flambe","platform","html","WebGLRenderer"];$f.__interfaces__=[hf];$f.prototype={get_type:function(){return gb.WebGL},createTextureFromImage:function(a){if(this.gl.isContextLost())return null;var b=new Fd(this,a.width,a.height);b.uploadImageData(a);return b.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){this.gl.isContextLost();
return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},onResize:function(){var a=this.gl.canvas.width,b=this.gl.canvas.height;this.batcher.resizeBackbuffer(a,b);this.graphics.onResize(a,b)},init:function(){this.batcher=new Ii(this.gl);this.graphics=new oc(this.batcher,null);this.onResize()},__class__:$f,__properties__:{get_type:"get_type"}};var tg=function(a,b,c){kd.call(this,a,b,c)};h["flambe.platform.html.WebGLTexture"]=tg;tg.__name__=["flambe",
"platform","html","WebGLTexture"];tg.__super__=kd;tg.prototype=x(kd.prototype,{__class__:tg});var Fd=function(a,b,c){this.framebuffer=this._graphics=null;this._disposed=!1;this._renderer=a;this.width=Ra.max(2,Ei.nextPowerOfTwo(b));this.height=Ra.max(2,Ei.nextPowerOfTwo(c));b=a.gl;this.nativeTexture=b.createTexture();a.batcher.bindTexture(this.nativeTexture);b.texParameteri(3553,10242,33071);b.texParameteri(3553,10243,33071);b.texParameteri(3553,10240,9729);b.texParameteri(3553,10241,9729)};h["flambe.platform.html.WebGLTextureRoot"]=
Fd;Fd.__name__=["flambe","platform","html","WebGLTextureRoot"];Fd.__interfaces__=[lg];Fd.drawBorder=function(a,b,c){var d=a.getContext("2d",null);d.drawImage(a,b-1,0,1,c,b,0,1,c);d.drawImage(a,0,c-1,b,1,0,c,b,1)};Fd.__super__=bb;Fd.prototype=x(bb.prototype,{createTexture:function(a,b){return new tg(this,a,b)},uploadImageData:function(a){if(this.width!=a.width||this.height!=a.height){var b=U.createEmptyCanvas(this.width,this.height);b.getContext("2d",null).drawImage(a,0,0);Fd.drawBorder(b,a.width,
a.height);a=b}this._renderer.batcher.bindTexture(this.nativeTexture);this._renderer.gl.texImage2D(3553,0,6408,6408,5121,a)},onDisposed:function(){var a=this._renderer.batcher;a.deleteTexture(this);null!=this.framebuffer&&a.deleteFramebuffer(this);this._graphics=this.framebuffer=this.nativeTexture=null},__class__:Fd});var kb=function(a,b,c){c="#ifdef GL_ES\nprecision mediump float;\n#endif\n"+c;this._gl=a;this._program=a.createProgram();a.attachShader(this._program,kb.createShader(a,35633,b));a.attachShader(this._program,
kb.createShader(a,35632,c));a.linkProgram(this._program);a.useProgram(this._program)};h["flambe.platform.shader.ShaderGL"]=kb;kb.__name__=["flambe","platform","shader","ShaderGL"];kb.createShader=function(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};kb.prototype={useProgram:function(){this._gl.useProgram(this._program)},prepare:function(){null},getAttribLocation:function(a){return this._gl.getAttribLocation(this._program,a)},getUniformLocation:function(a){return this._gl.getUniformLocation(this._program,
a)},__class__:kb};var qg=function(a){kb.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}","varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nuniform mediump vec4 u_region;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\n}");
this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.u_region=this.getUniformLocation("u_region");this.setTexture(0)};h["flambe.platform.shader.DrawPatternGL"]=qg;qg.__name__=["flambe","platform","shader","DrawPatternGL"];qg.__super__=kb;qg.prototype=x(kb.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},setRegion:function(a,b,c,d){this._gl.uniform4f(this.u_region,
a,b,c,d)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:qg});var pg=function(a){kb.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.setTexture(0)};h["flambe.platform.shader.DrawTextureGL"]=pg;pg.__name__=["flambe","platform","shader","DrawTextureGL"];pg.__super__=kb;pg.prototype=
x(kb.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:pg});var rg=function(a){kb.call(this,a,"attribute highp vec2 a_pos;\nattribute lowp vec3 a_rgb;\nattribute lowp float a_alpha;\nvarying lowp vec4 v_color;\nvoid main (void) {\nv_color = vec4(a_rgb*a_alpha, a_alpha);\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying lowp vec4 v_color;\nvoid main (void) {\ngl_FragColor = v_color;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_rgb=this.getAttribLocation("a_rgb");this.a_alpha=this.getAttribLocation("a_alpha")};h["flambe.platform.shader.FillRectGL"]=rg;rg.__name__=["flambe","platform","shader","FillRectGL"];rg.__super__=kb;rg.prototype=x(kb.prototype,{prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_rgb);this._gl.enableVertexAttribArray(this.a_alpha);
this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,24,0);this._gl.vertexAttribPointer(this.a_rgb,3,5126,!1,24,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,24,20)},__class__:rg});var Ji=function(){this._transitor=null};h["flambe.scene.Director"]=Ji;Ji.__name__=["flambe","scene","Director"];Ji.__super__=T;Ji.prototype=x(T.prototype,{get_name:function(){return"Director_8"},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<
b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&this.completeTransition()},get_topScene:function(){var a=this.scenes.length;return 0<a?this.scenes[a-1]:null},show:function(a){a=a._compMap.Scene_10;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_10;if(null==b||b.opaque)break}this.occludedScenes=0<this.scenes.length?
this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),this._transitor=null,this.invalidateVisibility())},__class__:Ji,__properties__:x(T.prototype.__properties__,{get_topScene:"get_topScene"})});var lk=function(){};h["flambe.scene._Director.Transitor"]=lk;lk.__name__=["flambe","scene","_Director","Transitor"];lk.prototype={update:function(a){return this._transition.update(a)},complete:function(){this._transition.complete();
this._onComplete()},__class__:lk};var Ki=function(){};h["flambe.scene.Scene"]=Ki;Ki.__name__=["flambe","scene","Scene"];Ki.__super__=T;Ki.prototype=x(T.prototype,{get_name:function(){return"Scene_10"},__class__:Ki});var mk=function(){};h["flambe.scene.Transition"]=mk;mk.__name__=["flambe","scene","Transition"];mk.prototype={update:function(){return!0},complete:function(){},__class__:mk};var gb=h["flambe.subsystem.RendererType"]={__ename__:["flambe","subsystem","RendererType"],__constructs__:["Stage3D",
"WebGL","Canvas"]};gb.Stage3D=["Stage3D",0];gb.Stage3D.toString=l;gb.Stage3D.__enum__=gb;gb.WebGL=["WebGL",1];gb.WebGL.toString=l;gb.WebGL.__enum__=gb;gb.Canvas=["Canvas",2];gb.Canvas.toString=l;gb.Canvas.__enum__=gb;gb.__empty_constructs__=[gb.Stage3D,gb.WebGL,gb.Canvas];var ug=function(){};h["flambe.swf.Symbol"]=ug;ug.__name__=["flambe","swf","Symbol"];ug.prototype={__class__:ug};var vg=function(a,b){this._name=a.symbol;var c=a.rect;this.texture=b.subTexture(c[0],c[1],c[2],c[3]);c=a.origin;null!=
c?(this.anchorX=c[0],this.anchorY=c[1]):this.anchorY=this.anchorX=0};h["flambe.swf.BitmapSymbol"]=vg;vg.__name__=["flambe","swf","BitmapSymbol"];vg.__interfaces__=[ug];vg.prototype={createSprite:function(){var a=new fe(this.texture);a.setAnchor(this.anchorX,this.anchorY);return a},__class__:vg};var Li=function(a,b,c){this._file=a.getFile(b);var d=JSON.parse(this._file.toString());this._symbols=new M;this.frameRate=d.frameRate;for(var b=[],e=0,f=d.movies;e<f.length;){var i=f[e];++e;i=new wg(this,i);
b.push(i);this._symbols.set(i._name,i)}d=d.textureGroups;(1!=d[0].scaleFactor||1<d.length)&&ha.logger.warn("Flambe doesn't support Flump's Additional Scale Factors. Use Base Scales and load from different asset packs instead.",null);d=d[0].atlases;for(e=0;e<d.length;){var g=d[e];++e;f=a.getTexture(c+"."+pb.removeFileExtension(g.file));i=0;for(g=g.textures;i<g.length;){var o=g[i];++i;o=new vg(o,f);this._symbols.set(o._name,o)}}for(a=0;a<b.length;){d=b[a];++a;c=0;for(d=d.layers;c<d.length;){e=d[c];
++c;e=e.keyframes;f=e.length;for(i=0;i<f;){o=i++;g=e[o];if(null!=g.symbolName){var h=this._symbols.get(g.symbolName);g.symbol=h}if(g.tweened&&1==g.duration&&o+1<f&&(o=e[o+1],!o.visible||null==o.symbolName))g.visible=!1}}}};h["flambe.swf.Library"]=Li;Li.__name__=["flambe","swf","Library"];Li.prototype={createSprite:function(a,b){null==b&&(b=!0);var c=this._symbols.get(a);if(null==c){if(b)throw new p(pb.withFields("Missing symbol",["name",a]));return null}return c.createSprite()},__class__:Li};var xg=
function(a){this._oneshotSprite=this._loopingSprite=null;T.call(this);this._lib=a;this._root=new Ua;this.movie=new Qa(null);this.setCache(!0)};h["flambe.swf.MoviePlayer"]=xg;xg.__name__=["flambe","swf","MoviePlayer"];xg.__super__=T;xg.prototype=x(T.prototype,{get_name:function(){return"MoviePlayer_5"},setCache:function(a){this._cache=a?new M:null;return this},play:function(a,b){null==b&&(b=!0);if(b||null==this._oneshotSprite||this._oneshotSprite.symbol._name!=a)this._oneshotSprite=this.playFromCache(a);
return this},loop:function(a,b){null==b&&(b=!0);if(b||null==this._loopingSprite||this._loopingSprite.symbol._name!=a)this._oneshotSprite=null,this._loopingSprite=this.playFromCache(a);return this},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this._root.dispose();this._oneshotSprite=this._loopingSprite=null;this.movie.set__(null)},onUpdate:function(a){null!=this._oneshotSprite&&this._oneshotSprite._position+a>this._oneshotSprite.symbol.duration&&(this._oneshotSprite=null,
this.setCurrent(this._loopingSprite))},playFromCache:function(a){var b;null!=this._cache?(b=this._cache.get(a),null!=b?b.set_position(0):(b=this.createMovie(a),this._cache.set(a,b))):b=this.createMovie(a);return this.setCurrent(b)},createMovie:function(a){a=this._lib.createSprite(a,!0);null!=this._decorator&&this._decorator(a);return a},setCurrent:function(a){this._root.add(a);return this.movie.set__(a)},__class__:xg});var nf=function(a){this._looped=null;E.call(this);this.symbol=a;this.speed=new Q(1);
this._animators=Array(a.layers.length);for(var b=0,c=this._animators.length;b<c;){var d=b++;this._animators[d]=new Mi(a.layers[d])}this._position=this._frame=0;this["goto"](1)};h["flambe.swf.MovieSprite"]=nf;nf.__name__=["flambe","swf","MovieSprite"];nf.__super__=E;nf.prototype=x(E.prototype,{onAdded:function(){E.prototype.onAdded.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.addChild(c.content)}},onRemoved:function(){E.prototype.onRemoved.call(this);for(var a=0,
b=this._animators;a<b.length;){var c=b[a];++a;this.owner.removeChild(c.content)}},onUpdate:function(a){E.prototype.onUpdate.call(this,a);this.speed.update(a);switch(this._flags&768){case 0:this._position+=this.speed._value*a;this._position>this.symbol.duration&&(this._position%=this.symbol.duration,null!=this._looped&&this._looped.emit());break;case 512:this._flags&=-513}this["goto"](this._position*this.symbol.frameRate)},"goto":function(a){if(this._frame!=a){if(a<this._frame)for(var b=0,c=this._animators;b<
c.length;){var d=c[b];++b;d.needsKeyframeUpdate=!0;d.keyframeIdx=0}b=0;for(c=this._animators;b<c.length;)d=c[b],++b,d.composeFrame(a);this._frame=a}},set_position:function(a){return this._position=Ra.clamp(a,0,this.symbol.duration)},set_pixelSnapping:function(a){for(var b=0,c=this._animators;b<c.length;){var d=c[b];++b;d.setPixelSnapping(a)}return E.prototype.set_pixelSnapping.call(this,a)},rewind:function(){this._position=0;this._flags|=512},__class__:nf,__properties__:x(E.prototype.__properties__,
{set_position:"set_position"})});var Mi=function(a){this.keyframeIdx=0;this.needsKeyframeUpdate=!1;this.layer=a;this.content=new Ua;if(a.empty)this._sprites=null;else{this._sprites=Array(a.keyframes.length);for(var b=0,c=this._sprites.length;b<c;){var d=b++,e=a.keyframes[d];this._sprites[d]=0<d&&a.keyframes[d-1].symbol==e.symbol?this._sprites[d-1]:null==e.symbol?new E:e.symbol.createSprite()}this.content.add(this._sprites[0])}};h["flambe.swf._MovieSprite.LayerAnimator"]=Mi;Mi.__name__=["flambe","swf",
"_MovieSprite","LayerAnimator"];Mi.prototype={composeFrame:function(a){if(null!=this._sprites){var b=this.layer.keyframes,c=b.length-1;if(a>this.layer.frames)this.content._compMap.Sprite_3.set_visible(!1),this.keyframeIdx=c,this.needsKeyframeUpdate=!0;else{for(;this.keyframeIdx<c&&b[this.keyframeIdx+1].index<=a;)++this.keyframeIdx,this.needsKeyframeUpdate=!0;var d;this.needsKeyframeUpdate?(this.needsKeyframeUpdate=!1,d=this._sprites[this.keyframeIdx],d!=this.content._compMap.Sprite_3&&((null==d?null:
w.getClass(d))==nf&&d.rewind(),this.content.add(d))):d=this.content._compMap.Sprite_3;var e=b[this.keyframeIdx],f=e.visible&&null!=e.symbol;d.set_visible(f);if(f){var f=e.x,i=e.y,g=e.scaleX,o=e.scaleY,h=e.skewX,j=e.skewY,k=e.alpha;if(e.tweened&&this.keyframeIdx<c){a=(a-e.index)/e.duration;c=e.ease;if(0!=c){var l;0>c?(l=1-a,l=1-l*l,c=-c):l=a*a;a=c*l+(1-c)*a}b=b[this.keyframeIdx+1];f+=(b.x-f)*a;i+=(b.y-i)*a;g+=(b.scaleX-g)*a;o+=(b.scaleY-o)*a;h+=(b.skewX-h)*a;j+=(b.skewY-j)*a;k+=(b.alpha-k)*a}b=d.getLocalMatrix();
a=0;c=1;l=0;var m=1;0!=h&&(a=Math.sin(h),c=Math.cos(h));0!=j&&(l=Math.sin(j),m=Math.cos(j));b.set(m*g,l*g,-a*o,c*o,f,i);b.translate(-e.pivotX,-e.pivotY);d.alpha.set__(k)}}}},setPixelSnapping:function(a){if(null!=this._sprites)for(var b=0,c=this._sprites;b<c.length;){var d=c[b];++b;d.set_pixelSnapping(a)}},__class__:Mi};var wg=function(a,b){this._name=b.id;this.frameRate=a.frameRate;this.frames=0;this.layers=Array(b.layers.length);for(var c=0,d=this.layers.length;c<d;){var e=c++,f=new Ni(b.layers[e]);
this.frames=Math.max(f.frames,this.frames);this.layers[e]=f}this.duration=this.frames/this.frameRate};h["flambe.swf.MovieSymbol"]=wg;wg.__name__=["flambe","swf","MovieSymbol"];wg.__interfaces__=[ug];wg.prototype={createSprite:function(){return new nf(this)},__class__:wg};var Ni=function(a){this.empty=!0;this.name=a.name;var b=null;this.keyframes=Array(a.keyframes.length);for(var c=0,d=this.keyframes.length;c<d;){var e=c++,b=new Oi(a.keyframes[e],b);this.keyframes[e]=b;this.empty=this.empty&&null==
b.symbolName}this.frames=null!=b?b.index+b.duration:0};h["flambe.swf.MovieLayer"]=Ni;Ni.__name__=["flambe","swf","MovieLayer"];Ni.prototype={__class__:Ni};var Oi=function(a,b){this.ease=0;this.visible=this.tweened=!0;this.alpha=1;this.skewX=this.skewY=this.pivotX=this.pivotY=0;this.scaleX=this.scaleY=1;this.x=this.y=0;this.symbol=null;this.index=null!=b?b.index+b.duration:0;this.duration=a.duration;this.label=a.label;this.symbolName=a.ref;var c=a.loc;null!=c&&(this.x=c[0],this.y=c[1]);c=a.scale;null!=
c&&(this.scaleX=c[0],this.scaleY=c[1]);c=a.skew;null!=c&&(this.skewX=c[0],this.skewY=c[1]);c=a.pivot;null!=c&&(this.pivotX=c[0],this.pivotY=c[1]);null!=a.alpha&&(this.alpha=a.alpha);null!=a.visible&&(this.visible=a.visible);null!=a.tweened&&(this.tweened=a.tweened);null!=a.ease&&(this.ease=a.ease)};h["flambe.swf.MovieKeyframe"]=Oi;Oi.__name__=["flambe","swf","MovieKeyframe"];Oi.prototype={__class__:Oi};var cg=function(){};h["flambe.util.BitSets"]=cg;cg.__name__=["flambe","util","BitSets"];cg.set=
function(a,b,c){return c?a|b:a&~b};var fb=h["flambe.util.LogLevel"]={__ename__:["flambe","util","LogLevel"],__constructs__:["Info","Warn","Error"]};fb.Info=["Info",0];fb.Info.toString=l;fb.Info.__enum__=fb;fb.Warn=["Warn",1];fb.Warn.toString=l;fb.Warn.__enum__=fb;fb.Error=["Error",2];fb.Error.toString=l;fb.Error.__enum__=fb;fb.__empty_constructs__=[fb.Info,fb.Warn,fb.Error];var Pi=function(a){this._capacity=2147483647;this._allocator=a;this._freeObjects=[]};h["flambe.util.Pool"]=Pi;Pi.__name__=["flambe",
"util","Pool"];Pi.prototype={take:function(){return 0<this._freeObjects.length?this._freeObjects.pop():this._allocator()},put:function(a){this._freeObjects.length<this._capacity&&this._freeObjects.push(a)},setSize:function(a){if(this._freeObjects.length>a)this._freeObjects.length=a;else for(var a=a-this._freeObjects.length,b=0;b<a;)b++,this._freeObjects.push(this._allocator());return this},__class__:Pi};var hg=function(){this.success=new ma;this.error=new ma;this.progressChanged=new yc;this.hasResult=
!1;this._total=this._progress=0};h["flambe.util.Promise"]=hg;hg.__name__=["flambe","util","Promise"];hg.prototype={set_result:function(a){if(this.hasResult)throw new p("Promise result already assigned");this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},set_progress:function(a){this._progress!=a&&(this._progress=a,this.progressChanged.emit());return a},set_total:function(a){this._total!=a&&(this._total=
a,this.progressChanged.emit());return a},__class__:hg,__properties__:{set_total:"set_total",set_progress:"set_progress",set_result:"set_result"}};var yc=function(a){Ea.call(this,a)};h["flambe.util.Signal0"]=yc;yc.__name__=["flambe","util","Signal0"];yc.__super__=Ea;yc.prototype=x(Ea.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==Ea.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=
this.willEmit(),b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;this.didEmit(a)},__class__:yc});var qi=function(a){this.next=null;this.fn=a};h["flambe.util._SignalBase.Task"]=qi;qi.__name__=["flambe","util","_SignalBase","Task"];qi.prototype={__class__:qi};var pb=function(){};h["flambe.util.Strings"]=pb;pb.__name__=["flambe","util","Strings"];pb.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?A.substr(a,b+1,null):null};pb.removeFileExtension=function(a){var b=a.lastIndexOf(".");
return 0<b?A.substr(a,0,b):a};pb.getUrlExtension=function(a){var b=a.lastIndexOf("?");0<=b&&(a=A.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=A.substr(a,b+1,null));return pb.getFileExtension(a)};pb.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};pb.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var e=b[d],f=b[d+1];if(r.is(f,Error)){var i=f.stack;null!=i&&(f=i)}a+=e+"="+r.string(f);d+=2}a+="]"}return a};
var Ae=function(){};h["haxe.IMap"]=Ae;Ae.__name__=["haxe","IMap"];Ae.prototype={__class__:Ae};var Qi=function(a,b){this.high=a;this.low=b};h["haxe._Int64.___Int64"]=Qi;Qi.__name__=["haxe","_Int64","___Int64"];Qi.prototype={__class__:Qi};var Yc=function(){this.buf=new Xb;this.cache=[];this.useCache=Yc.USE_CACHE;this.useEnumIndex=Yc.USE_ENUM_INDEX;this.shash=new M;this.scount=0};h["haxe.Serializer"]=Yc;Yc.__name__=["haxe","Serializer"];Yc.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=
this.shash.get(a);null!=b?(this.buf.b+="R",this.buf.b=null==b?this.buf.b+"null":this.buf.b+(""+b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=encodeURIComponent(a),this.buf.b=null==a.length?this.buf.b+"null":this.buf.b+(""+a.length),this.buf.b+=":",this.buf.b=null==a?this.buf.b+"null":this.buf.b+(""+a))},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;c<d;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",this.buf.b=null==e?this.buf.b+"null":this.buf.b+
(""+e),!0}this.cache.push(a);return!1},serializeFields:function(a){for(var b=0,c=da.fields(a);b<c.length;){var d=c[b];++b;this.serializeString(d);this.serialize(da.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=Y["typeof"](a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:if(0==a){this.buf.b+="z";break}this.buf.b+="i";this.buf.b=null==a?this.buf.b+"null":this.buf.b+(""+a);break;case 2:isNaN(a)?this.buf.b+="k":isFinite(a)?(this.buf.b+="d",this.buf.b=null==a?this.buf.b+"null":this.buf.b+
(""+a)):this.buf.b=0>a?this.buf.b+"m":this.buf.b+"p";break;case 3:this.buf.b=a?this.buf.b+"t":this.buf.b+"f";break;case 6:b=b[2];if(b==String){this.serializeString(a);break}if(this.useCache&&this.serializeRef(a))break;switch(b){case Array:b=0;this.buf.b+="a";for(var c=a.length,d=0;d<c;){var e=d++;null==a[e]?b++:(0<b&&(1==b?this.buf.b+="n":(this.buf.b+="u",this.buf.b=null==b?this.buf.b+"null":this.buf.b+(""+b)),b=0),this.serialize(a[e]))}0<b&&(1==b?this.buf.b+="n":(this.buf.b+="u",this.buf.b=null==
b?this.buf.b+"null":this.buf.b+(""+b)));this.buf.b+="h";break;case af:this.buf.b+="l";a=a.h;for(b=null;null!=a;)b=a[0],a=a[1],this.serialize(b);this.buf.b+="h";break;case Date:this.buf.b+="v";this.buf.add(a.getTime());break;case M:this.buf.b+="b";for(b=a.keys();b.hasNext();)c=b.next(),this.serializeString(c),this.serialize(null!=Oa[c]?a.getReserved(c):a.h[c]);this.buf.b+="h";break;case zb:this.buf.b+="q";for(b=a.keys();b.hasNext();)c=b.next(),this.buf.b+=":",this.buf.b=null==c?this.buf.b+"null":this.buf.b+
(""+c),this.serialize(a.h[c]);this.buf.b+="h";break;case Fa:this.buf.b+="M";for(b=a.keys();b.hasNext();)c=b.next(),d=da.field(c,"__id__"),da.deleteField(c,"__id__"),this.serialize(c),c.__id__=d,this.serialize(a.h[c.__id__]);this.buf.b+="h";break;case zc:d=0;e=a.length-2;b=new Xb;for(c=Yc.BASE64;d<e;){var f=a.get(d++),i=a.get(d++),g=a.get(d++);b.add(c.charAt(f>>2));b.add(c.charAt((f<<4|i>>4)&63));b.add(c.charAt((i<<2|g>>6)&63));b.add(c.charAt(g&63))}d==e?(e=a.get(d++),a=a.get(d++),b.add(c.charAt(e>>
2)),b.add(c.charAt((e<<4|a>>4)&63)),b.add(c.charAt(a<<2&63))):d==e+1&&(a=a.get(d++),b.add(c.charAt(a>>2)),b.add(c.charAt(a<<4&63)));a=b.b;this.buf.b+="s";this.buf.b=null==a.length?this.buf.b+"null":this.buf.b+(""+a.length);this.buf.b+=":";this.buf.b=null==a?this.buf.b+"null":this.buf.b+(""+a);break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(Y.getClassName(b)),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+=
"c",this.serializeString(Y.getClassName(b)),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 4:if(w.__instanceof(a,al))a=Y.getClassName(a),this.buf.b+="A",this.serializeString(a);else if(w.__instanceof(a,bl))this.buf.b+="B",this.serializeString(Y.getEnumName(a));else{if(this.useCache&&this.serializeRef(a))break;this.buf.b+="o";this.serializeFields(a)}break;case 7:b=b[2];if(this.useCache){if(this.serializeRef(a))break;this.cache.pop()}this.buf.b=this.useEnumIndex?this.buf.b+"j":
this.buf.b+"w";this.serializeString(Y.getEnumName(b));this.useEnumIndex?(this.buf.b+=":",this.buf.b+=r.string(a[1])):this.serializeString(a[0]);this.buf.b+=":";b=a.length;this.buf.b+=r.string(b-2);for(c=2;c<b;)d=c++,this.serialize(a[d]);this.useCache&&this.cache.push(a);break;case 5:throw new p("Cannot serialize function");default:throw new p("Cannot serialize "+r.string(a));}},__class__:Yc};var hb=function(a){this.buf=a;this.length=a.length;this.pos=0;this.scache=[];this.cache=[];a=hb.DEFAULT_RESOLVER;
null==a&&(a=Y,hb.DEFAULT_RESOLVER=a);this.setResolver(a)};h["haxe.Unserializer"]=hb;hb.__name__=["haxe","Unserializer"];hb.initCodes=function(){for(var a=[],b=0,c=hb.BASE64.length;b<c;){var d=b++;a[hb.BASE64.charCodeAt(d)]=d}return a};hb.run=function(a){return(new hb(a)).unserialize()};hb.prototype={setResolver:function(a){this.resolver=null==a?{resolveClass:function(){return null},resolveEnum:function(){return null}}:a},get:function(a){return this.buf.charCodeAt(a)},readDigits:function(){for(var a=
0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45==d){if(this.pos!=c)break;b=!0}else{if(48>d||57<d)break;a=10*a+(d-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return r.parseFloat(A.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new p("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=
this.unserialize();if("string"!=typeof b)throw new p("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.get(this.pos++))throw new p("Invalid enum format");var c=this.readDigits();if(0==c)return Y.createEnum(a,b);for(var d=[];0<c--;)d.push(this.unserialize());return Y.createEnum(a,b,d)},unserialize:function(){switch(this.get(this.pos++)){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();
case 100:return this.readFloat();case 121:var a=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<a)throw new p("Invalid string length");var b=A.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 107:return NaN;case 109:return-Infinity;case 112:return Infinity;case 97:a=[];for(this.cache.push(a);;){b=this.buf.charCodeAt(this.pos);if(104==b){this.pos++;break}117==b?(this.pos++,b=this.readDigits(),a[a.length+b-1]=
null):a.push(this.unserialize())}return a;case 111:return a={},this.cache.push(a),this.unserializeObject(a),a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw new p("Invalid reference");return this.cache[a];case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw new p("Invalid string reference");return this.scache[a];case 120:throw new p(this.unserialize());case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new p("Class not found "+a);a=Y.createEmptyInstance(b);
this.cache.push(a);this.unserializeObject(a);return a;case 119:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new p("Enum not found "+a);a=this.unserializeEnum(b,this.unserialize());this.cache.push(a);return a;case 106:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new p("Enum not found "+a);this.pos++;var c=this.readDigits(),d=Y.getEnumConstructs(b)[c];if(null==d)throw new p("Unknown enum index "+a+"@"+c);a=this.unserializeEnum(b,d);this.cache.push(a);
return a;case 108:a=new af;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)a.add(this.unserialize());this.pos++;return a;case 98:a=new M;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 113:a=new zb;this.cache.push(a);for(b=this.get(this.pos++);58==b;)b=this.readDigits(),a.set(b,this.unserialize()),b=this.get(this.pos++);if(104!=b)throw new p("Invalid IntMap format");return a;case 77:a=new Fa;for(this.cache.push(a);104!=
this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(a=A.substr(this.buf,this.pos,19),a=A.strDate(a),this.pos+=
19):(a=this.readFloat(),b=new Date,b.setTime(a),a=b),this.cache.push(a),a;case 115:a=this.readDigits();d=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<a)throw new p("Invalid bytes length");var e=hb.CODES;null==e&&(e=hb.initCodes(),hb.CODES=e);for(var f=this.pos,i=a&3,g=f+(a-i),b=zc.alloc(3*(a>>2)+(2<=i?i-1:0)),c=0;f<g;){var o=e[fa.fastCodeAt(d,f++)],h=e[fa.fastCodeAt(d,f++)];b.set(c++,o<<2|h>>4);o=e[fa.fastCodeAt(d,f++)];b.set(c++,h<<4|o>>2);h=e[fa.fastCodeAt(d,f++)];b.set(c++,o<<6|h)}2<=
i&&(h=e[fa.fastCodeAt(d,f++)],g=e[fa.fastCodeAt(d,f++)],b.set(c++,h<<2|g>>4),3==i&&(d=e[fa.fastCodeAt(d,f++)],b.set(c++,g<<4|d>>2)));this.pos+=a;this.cache.push(b);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new p("Class not found "+a);a=Y.createEmptyInstance(b);this.cache.push(a);a.hxUnserialize(this);if(103!=this.get(this.pos++))throw new p("Invalid custom data");return a;case 65:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new p("Class not found "+
a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new p("Enum not found "+a);return b}this.pos--;throw new p("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:hb};var Ri=function(){};h["haxe.crypto.Crc32"]=Ri;Ri.__name__=["haxe","crypto","Crc32"];Ri.make=function(a){for(var b=-1,c=a.b.bufferValue,d=0,a=a.length;d<a;){for(var e=d++,e=(b^c.bytes[e])&255,f=0;8>f;)f++,e=1==(e&1)?e>>>1^-306674912:e>>>1;b=b>>>8^e}return b^-1};var yg=function(){};
h["haxe.ds.BalancedTree"]=yg;yg.__name__=["haxe","ds","BalancedTree"];yg.prototype={set:function(a,b){this.root=this.setLoop(a,b,this.root)},get:function(a){for(var b=this.root;null!=b;){var c=this.compare(a,b.key);if(0==c)return b.value;b=0>c?b.left:b.right}return null},remove:function(a){try{return this.root=this.removeLoop(a,this.root),!0}catch(b){b instanceof p&&(b=b.val);if(w.__instanceof(b,String))return!1;throw b;}},exists:function(a){for(var b=this.root;null!=b;){var c=this.compare(a,b.key);
if(0==c)return!0;b=0>c?b.left:b.right}return!1},iterator:function(){var a=[];this.iteratorLoop(this.root,a);return A.iter(a)},keys:function(){var a=[];this.keysLoop(this.root,a);return A.iter(a)},setLoop:function(a,b,c){if(null==c)return new rb(null,a,b,null);var d=this.compare(a,c.key);if(0==d)return new rb(c.left,a,b,c.right,null==c?0:c._height);if(0>d)return this.balance(this.setLoop(a,b,c.left),c.key,c.value,c.right);a=this.setLoop(a,b,c.right);return this.balance(c.left,c.key,c.value,a)},removeLoop:function(a,
b){if(null==b)throw new p("Not_found");var c=this.compare(a,b.key);return 0==c?this.merge(b.left,b.right):0>c?this.balance(this.removeLoop(a,b.left),b.key,b.value,b.right):this.balance(b.left,b.key,b.value,this.removeLoop(a,b.right))},iteratorLoop:function(a,b){null!=a&&(this.iteratorLoop(a.left,b),b.push(a.value),this.iteratorLoop(a.right,b))},keysLoop:function(a,b){null!=a&&(this.keysLoop(a.left,b),b.push(a.key),this.keysLoop(a.right,b))},merge:function(a,b){if(null==a)return b;if(null==b)return a;
var c=this.minBinding(b);return this.balance(a,c.key,c.value,this.removeMinBinding(b))},minBinding:function(a){if(null==a)throw new p("Not_found");return null==a.left?a:this.minBinding(a.left)},removeMinBinding:function(a){return null==a.left?a.right:this.balance(this.removeMinBinding(a.left),a.key,a.value,a.right)},balance:function(a,b,c,d){var e;e=null==a?0:a._height;var f;f=null==d?0:d._height;return e>f+2?function(){var b=a.left;return null==b?0:b._height}(this)>=function(){var b=a.right;return null==
b?0:b._height}(this)?new rb(a.left,a.key,a.value,new rb(a.right,b,c,d)):new rb(new rb(a.left,a.key,a.value,a.right.left),a.right.key,a.right.value,new rb(a.right.right,b,c,d)):f>e+2?function(){var a=d.right;return null==a?0:a._height}(this)>function(){var a=d.left;return null==a?0:a._height}(this)?new rb(new rb(a,b,c,d.left),d.key,d.value,d.right):new rb(new rb(a,b,c,d.left.left),d.left.key,d.left.value,new rb(d.left.right,d.key,d.value,d.right)):new rb(a,b,c,d,(e>f?e:f)+1)},compare:function(a,b){return da.compare(a,
b)},__class__:yg};var rb=function(a,b,c,d,e){null==e&&(e=-1);this.left=a;this.key=b;this.value=c;this.right=d;this._height=-1==e?(function(a){a=a.left;return null==a?0:a._height}(this)>function(a){a=a.right;return null==a?0:a._height}(this)?function(a){a=a.left;return null==a?0:a._height}(this):function(a){a=a.right;return null==a?0:a._height}(this))+1:e};h["haxe.ds.TreeNode"]=rb;rb.__name__=["haxe","ds","TreeNode"];rb.prototype={__class__:rb};var ea=function(){};h["haxe.ds.EnumValueMap"]=ea;ea.__name__=
["haxe","ds","EnumValueMap"];ea.__interfaces__=[Ae];ea.__super__=yg;ea.prototype=x(yg.prototype,{compare:function(a,b){var c=a[1]-b[1];if(0!=c)return c;var c=a.slice(2),d=b.slice(2);return 0==c.length&&0==d.length?0:this.compareArgs(c,d)},compareArgs:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(var c=0,d=a.length;c<d;){var e=c++,e=this.compareArg(a[e],b[e]);if(0!=e)return e}return 0},compareArg:function(a,b){return da.isEnumValue(a)&&da.isEnumValue(b)?this.compare(a,b):a instanceof Array&&
null==a.__enum__&&b instanceof Array&&null==b.__enum__?this.compareArgs(a,b):da.compare(a,b)},__class__:ea});var zb=function(){this.h={}};h["haxe.ds.IntMap"]=zb;zb.__name__=["haxe","ds","IntMap"];zb.__interfaces__=[Ae];zb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&
a.push(b|0);return A.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref[this.it.next()]}}},__class__:zb};var Fa=function(){this.h={};this.h.__keys__={}};h["haxe.ds.ObjectMap"]=Fa;Fa.__name__=["haxe","ds","ObjectMap"];Fa.__interfaces__=[Ae];Fa.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++Fa.count);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=
this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return A.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref[this.it.next().__id__]}}},__class__:Fa};var cf=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=
b.length};h["haxe.ds._StringMap.StringMapIterator"]=cf;cf.__name__=["haxe","ds","_StringMap","StringMapIterator"];cf.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:cf};var M=function(){this.h={}};h["haxe.ds.StringMap"]=M;M.__name__=["haxe","ds","StringMap"];M.__interfaces__=[Ae];M.prototype={set:function(a,b){null!=Oa[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=Oa[a]?this.getReserved(a):this.h[a]},
exists:function(a){return null!=Oa[a]?this.existsReserved(a):this.h.hasOwnProperty(a)},setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(null!=Oa[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},keys:function(){var a=
this.arrayKeys();return A.iter(a)},arrayKeys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new cf(this,this.arrayKeys())},__class__:M};var zc=function(a){this.length=a.byteLength;this.b=new nk(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};h["haxe.io.Bytes"]=zc;zc.__name__=["haxe","io","Bytes"];zc.alloc=function(a){return new zc(new ok(a))};zc.ofString=
function(a){for(var b=[],c=0;c<a.length;){var d=fa.fastCodeAt(a,c++);55296<=d&&56319>=d&&(d=d-55232<<10|fa.fastCodeAt(a,c++)&1023);127>=d?b.push(d):(2047>=d?b.push(192|d>>6):(65535>=d?b.push(224|d>>12):(b.push(240|d>>18),b.push(128|d>>12&63)),b.push(128|d>>6&63)),b.push(128|d&63))}return new zc((new nk(b)).buffer)};zc.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=b&255},__class__:zc};var lb=h["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow",
"OutsideBounds","Custom"]};lb.Blocked=["Blocked",0];lb.Blocked.toString=l;lb.Blocked.__enum__=lb;lb.Overflow=["Overflow",1];lb.Overflow.toString=l;lb.Overflow.__enum__=lb;lb.OutsideBounds=["OutsideBounds",2];lb.OutsideBounds.toString=l;lb.OutsideBounds.__enum__=lb;lb.Custom=function(a){a=["Custom",3,a];a.__enum__=lb;a.toString=l;return a};lb.__empty_constructs__=[lb.Blocked,lb.Overflow,lb.OutsideBounds];var Ac=function(){};h["haxe.io.FPHelper"]=Ac;Ac.__name__=["haxe","io","FPHelper"];Ac.i32ToFloat=
function(a){var b=a>>>23&255,c=a&8388607;return 0==c&&0==b?0:(1-(a>>>31<<1))*(1+Math.pow(2,-23)*c)*Math.pow(2,b-127)};Ac.floatToI32=function(a){if(0==a)return 0;var b;b=0>a?-a:a;var c=Math.floor(Math.log(b)/0.6931471805599453);-127>c?c=-127:128<c&&(c=128);b=Math.round(8388608*(b/Math.pow(2,c)-1))&8388607;return(0>a?-2147483648:0)|c+127<<23|b};Ac.i64ToDouble=function(a,b){var c=(b>>20&2047)-1023,d=4294967296*(b&1048575)+2147483648*(a>>>31)+(a&2147483647);return 0==d&&-1023==c?0:(1-(b>>>31<<1))*(1+
Math.pow(2,-52)*d)*Math.pow(2,c)};Ac.doubleToI64=function(a){var b=Ac.i64tmp;if(0==a)b.low=0,b.high=0;else{var c;c=0>a?-a:a;var d=Math.floor(Math.log(c)/0.6931471805599453);c=4503599627370496*(c/Math.pow(2,d)-1);c=Math.round(c);b.low=c|0;b.high=(0>a?-2147483648:0)|d+1023<<20|c/4294967296|0}return b};var Lb=h["haxe.xml.Filter"]={__ename__:["haxe","xml","Filter"],__constructs__:["FInt","FBool","FEnum","FReg"]};Lb.FInt=["FInt",0];Lb.FInt.toString=l;Lb.FInt.__enum__=Lb;Lb.FBool=["FBool",1];Lb.FBool.toString=
l;Lb.FBool.__enum__=Lb;Lb.FEnum=function(a){a=["FEnum",2,a];a.__enum__=Lb;a.toString=l;return a};Lb.FReg=function(a){a=["FReg",3,a];a.__enum__=Lb;a.toString=l;return a};Lb.__empty_constructs__=[Lb.FInt,Lb.FBool];var Bc=h["haxe.xml.Attrib"]={__ename__:["haxe","xml","Attrib"],__constructs__:["Att"]};Bc.Att=function(a,b,c){a=["Att",0,a,b,c];a.__enum__=Bc;a.toString=l;return a};Bc.__empty_constructs__=[];var O=h["haxe.xml.Rule"]={__ename__:["haxe","xml","Rule"],__constructs__:"RNode,RData,RMulti,RList,RChoice,ROptional".split(",")};
O.RNode=function(a,b,c){a=["RNode",0,a,b,c];a.__enum__=O;a.toString=l;return a};O.RData=function(a){a=["RData",1,a];a.__enum__=O;a.toString=l;return a};O.RMulti=function(a,b){var c=["RMulti",2,a,b];c.__enum__=O;c.toString=l;return c};O.RList=function(a,b){var c=["RList",3,a,b];c.__enum__=O;c.toString=l;return c};O.RChoice=function(a){a=["RChoice",4,a];a.__enum__=O;a.toString=l;return a};O.ROptional=function(a){a=["ROptional",5,a];a.__enum__=O;a.toString=l;return a};O.__empty_constructs__=[];var V=
h["haxe.xml._Check.CheckResult"]={__ename__:["haxe","xml","_Check","CheckResult"],__constructs__:"CMatch,CMissing,CExtra,CElementExpected,CDataExpected,CExtraAttrib,CMissingAttrib,CInvalidAttrib,CInvalidData,CInElement".split(",")};V.CMatch=["CMatch",0];V.CMatch.toString=l;V.CMatch.__enum__=V;V.CMissing=function(a){a=["CMissing",1,a];a.__enum__=V;a.toString=l;return a};V.CExtra=function(a){a=["CExtra",2,a];a.__enum__=V;a.toString=l;return a};V.CElementExpected=function(a,b){var c=["CElementExpected",
3,a,b];c.__enum__=V;c.toString=l;return c};V.CDataExpected=function(a){a=["CDataExpected",4,a];a.__enum__=V;a.toString=l;return a};V.CExtraAttrib=function(a,b){var c=["CExtraAttrib",5,a,b];c.__enum__=V;c.toString=l;return c};V.CMissingAttrib=function(a,b){var c=["CMissingAttrib",6,a,b];c.__enum__=V;c.toString=l;return c};V.CInvalidAttrib=function(a,b,c){a=["CInvalidAttrib",7,a,b,c];a.__enum__=V;a.toString=l;return a};V.CInvalidData=function(a,b){var c=["CInvalidData",8,a,b];c.__enum__=V;c.toString=
l;return c};V.CInElement=function(a,b){var c=["CInElement",9,a,b];c.__enum__=V;c.toString=l;return c};V.__empty_constructs__=[V.CMatch];var W=function(){};h["haxe.xml.Check"]=W;W.__name__=["haxe","xml","Check"];W.isBlank=function(a){return a.nodeType==q.PCData&&W.blanks.match(function(){if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);return a.nodeValue}(this))||a.nodeType==q.Comment};W.filterMatch=function(a,b){switch(b[1]){case 0:return W.filterMatch(a,
Lb.FReg(new xb("[0-9]+","")));case 1:return W.filterMatch(a,Lb.FEnum(["true","false","0","1"]));case 2:for(var c=b[2],d=0;d<c.length;){var e=c[d];++d;if(a==e)return!0}return!1;case 3:return b[2].match(a)}};W.isNullable=function(a){switch(a[1]){case 2:var b=a[2];return!0!=a[3]||W.isNullable(b);case 3:a=a[2];for(b=0;b<a.length;){var c=a[b];++b;if(!W.isNullable(c))return!1}return!0;case 4:a=a[2];for(b=0;b<a.length;)if(c=a[b],++b,W.isNullable(c))return!0;return!1;case 1:return!1;case 0:return!1;case 5:return!0}};
W.check=function(a,b){switch(b[1]){case 0:var c=b[4],d=b[3],e=b[2],f;if(!(f=a.nodeType!=q.Element)){if(a.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+a.nodeType);f=a.nodeName!=e}if(f)return V.CElementExpected(e,a);d=null==d?[]:d.slice();for(e=a.attributes();e.hasNext();){f=e.next();for(var i=!1,g=0;g<d.length;){var o=d[g];++g;var h=o[3],j=o[2];if(f==j){if(null!=h&&!W.filterMatch(a.get(f),h))return V.CInvalidAttrib(j,a,h);A.remove(d,o);i=!0}}if(!i)return V.CExtraAttrib(f,
a)}for(e=0;e<d.length;)if(f=d[e],++e,i=f[2],null==f[4])return V.CMissingAttrib(i,a);null==c&&(c=O.RList([]));c=W.checkList(function(){if(a.nodeType!=q.Document&&a.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+a.nodeType);return A.iter(a.children)}(this),c);if(c!=V.CMatch)return V.CInElement(a,c);for(c=0;c<d.length;)e=d[c],++c,a.set(e[2],e[4]);return V.CMatch;case 1:return c=b[2],a.nodeType!=q.PCData&&a.nodeType!=q.CData?V.CDataExpected(a):null!=c&&!W.filterMatch(function(){if(a.nodeType==
q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);return a.nodeValue}(this),c)?V.CInvalidData(a,c):V.CMatch;case 4:c=b[2];if(0==c.length)throw new p("No choice possible");for(d=0;d<c.length;)if(e=c[d],++d,W.check(a,e)==V.CMatch)return V.CMatch;return W.check(a,c[0]);case 5:return W.check(a,b[2]);default:throw new p("Unexpected "+r.string(b));}};W.checkList=function(a,b){switch(b[1]){case 3:for(var c=b[3],d=b[2].slice();a.hasNext();){var e=a.next();if(!W.isBlank(e)){for(var f=
!1,i=0;i<d.length;){var g=d[i];++i;var o=W.checkList(A.iter([e]),g);if(o==V.CMatch){f=!0;switch(g[1]){case 2:i=g[2];if(g[3])for(var o=0,h=d.length;o<h;){var j=o++;d[j]==g&&(d[j]=O.RMulti(i))}break;default:A.remove(d,g)}break}else if(c&&!W.isNullable(g))return o}if(!f)return V.CExtra(e)}}for(c=0;c<d.length;)if(e=d[c],++c,!W.isNullable(e))return V.CMissing(e);return V.CMatch;case 2:d=b[3];c=b[2];for(e=!1;a.hasNext();)if(f=a.next(),!W.isBlank(f)){e=W.checkList(A.iter([f]),c);if(e!=V.CMatch)return e;
e=!0}return d&&!e?V.CMissing(c):V.CMatch;default:for(d=!1;a.hasNext();)if(c=a.next(),!W.isBlank(c)){d=W.check(c,b);if(d!=V.CMatch)return d;d=!0;break}if(!d)switch(b[1]){case 5:break;default:return V.CMissing(b)}for(;a.hasNext();)if(d=a.next(),!W.isBlank(d))return V.CExtra(d);return V.CMatch}};W.makeWhere=function(a){if(0==a.length)return"";for(var b="In ",c=!0,d=0;d<a.length;){var e=a[d];++d;c?c=!1:b+=".";if(e.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+e.nodeType);
b+=e.nodeName}return b+": "};W.makeString=function(a){if(a.nodeType==q.Element){if(a.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+a.nodeType);return"element "+a.nodeName}if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);a=a.nodeValue.split("\r").join("\\r").split("\n").join("\\n").split("\t").join("\\t");return 20<a.length?A.substr(a,0,17)+"...":a};W.makeRule=function(a){switch(a[1]){case 0:return"element "+a[2];case 1:return"data";
case 2:return W.makeRule(a[2]);case 3:return W.makeRule(a[2][0]);case 4:return W.makeRule(a[2][0]);case 5:return W.makeRule(a[2])}};W.makeError=function(a,b){null==b&&(b=[]);switch(a[1]){case 0:throw new p("assert");case 1:var c=a[2];return W.makeWhere(b)+"Missing "+W.makeRule(c);case 2:return c=a[2],W.makeWhere(b)+"Unexpected "+W.makeString(c);case 3:var c=a[3],d=a[2];return W.makeWhere(b)+W.makeString(c)+" while expected element "+d;case 4:return c=a[2],W.makeWhere(b)+W.makeString(c)+" while data expected";
case 5:return c=a[2],b.push(a[3]),W.makeWhere(b)+"unexpected attribute "+c;case 6:return c=a[2],b.push(a[3]),W.makeWhere(b)+"missing required attribute "+c;case 7:return c=a[2],b.push(a[3]),W.makeWhere(b)+"invalid attribute value for "+c;case 8:return c=a[2],W.makeWhere(b)+"invalid data format for "+W.makeString(c);case 9:return c=a[3],b.push(a[2]),W.makeError(c,b)}};W.checkNode=function(a,b){var c=W.checkList(A.iter([a]),b);if(c!=V.CMatch)throw new p(W.makeError(c));};var Si=function(a){this.__x=
a};h["haxe.xml._Fast.NodeAccess"]=Si;Si.__name__=["haxe","xml","_Fast","NodeAccess"];Si.prototype={resolve:function(a){var b=this.__x.elementsNamed(a).next();if(null==b)throw b=this.__x.nodeType==q.Document?"Document":this.__x.get_nodeName(),new p(b+" is missing element "+a);return new Be(b)},__class__:Si};var Ti=function(a){this.__x=a};h["haxe.xml._Fast.AttribAccess"]=Ti;Ti.__name__=["haxe","xml","_Fast","AttribAccess"];Ti.prototype={resolve:function(a){if(this.__x.nodeType==q.Document)throw new p("Cannot access document attribute "+
a);var b=this.__x.get(a);if(null==b)throw new p(this.__x.get_nodeName()+" is missing attribute "+a);return b},__class__:Ti};var Ui=function(a){this.__x=a};h["haxe.xml._Fast.HasAttribAccess"]=Ui;Ui.__name__=["haxe","xml","_Fast","HasAttribAccess"];Ui.prototype={resolve:function(a){if(this.__x.nodeType==q.Document)throw new p("Cannot access document attribute "+a);return this.__x.exists(a)},__class__:Ui};var Vi=function(a){this.__x=a};h["haxe.xml._Fast.HasNodeAccess"]=Vi;Vi.__name__=["haxe","xml","_Fast",
"HasNodeAccess"];Vi.prototype={resolve:function(a){return this.__x.elementsNamed(a).hasNext()},__class__:Vi};var Wi=function(a){this.__x=a};h["haxe.xml._Fast.NodeListAccess"]=Wi;Wi.__name__=["haxe","xml","_Fast","NodeListAccess"];Wi.prototype={resolve:function(a){for(var b=new af,a=this.__x.elementsNamed(a);a.hasNext();){var c=a.next();b.add(new Be(c))}return b},__class__:Wi};var Be=function(a){if(a.nodeType!=q.Document&&a.nodeType!=q.Element)throw new p("Invalid nodeType "+a.nodeType);this.x=a;this.node=
new Si(a);this.nodes=new Wi(a);this.att=new Ti(a);this.has=new Ui(a);this.hasNode=new Vi(a)};h["haxe.xml.Fast"]=Be;Be.__name__=["haxe","xml","Fast"];Be.prototype={get_name:function(){return this.x.nodeType==q.Document?"Document":this.x.get_nodeName()},get_elements:function(){var a=this.x.elements();return{hasNext:u(a,a.hasNext),next:function(){var b=a.next();return null==b?null:new Be(b)}}},__class__:Be,__properties__:{get_elements:"get_elements",get_name:"get_name"}};var Pd=function(){};h["haxe.xml.Parser"]=
Pd;Pd.__name__=["haxe","xml","Parser"];Pd.parse=function(a,b){null==b&&(b=!1);var c=q.createDocument();Pd.doParse(a,b,0,c);return c};Pd.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,f=1,i=1,g=null,o=0,h=0,j=0,k=a.charCodeAt(c),l=new Xb,m=1,n=-1;k==k;){switch(f){case 0:switch(k){case 10:case 13:case 9:case 32:break;default:f=i;continue}break;case 1:switch(k){case 60:f=0;i=2;break;default:o=c;f=13;continue}break;case 13:60==k?(l.addSub(a,o,c-o),i=q.createPCData(l.b),l=new Xb,d.addChild(i),
h++,f=0,i=2):38==k&&(l.addSub(a,o,c-o),f=18,m=13,o=c+1);break;case 17:93==k&&93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2)&&(k=q.createCData(A.substr(a,o,c-o)),d.addChild(k),h++,c+=2,f=1);break;case 2:switch(k){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=A.substr(a,c,6).toUpperCase())throw new p("Expected <![CDATA[");c+=5;f=17}else if(68==a.charCodeAt(c+1)||100==a.charCodeAt(c+1)){if("OCTYPE"!=A.substr(a,c+2,6).toUpperCase())throw new p("Expected <!DOCTYPE");c+=8;f=16}else{if(45!=a.charCodeAt(c+
1)||45!=a.charCodeAt(c+2))throw new p("Expected <\!--");c+=2;f=15}o=c+1;break;case 63:f=14;o=c;break;case 47:if(null==d)throw new p("Expected node name");o=c+1;f=0;i=10;break;default:f=3;o=c;continue}break;case 3:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(c==o)throw new p("Expected node name");e=q.createElement(A.substr(a,o,c-o));d.addChild(e);h++;f=0;i=4;continue}break;case 4:switch(k){case 47:f=11;break;case 62:f=9;break;default:f=5;o=c;continue}break;case 5:if(!(97<=
k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(o==c)throw new p("Expected attribute name");g=A.substr(a,o,c-o);if(e.exists(g))throw new p("Duplicate attribute");f=0;i=6;continue}break;case 6:switch(k){case 61:f=0;i=7;break;default:throw new p("Expected =");}break;case 7:switch(k){case 34:case 39:l=new Xb;f=8;o=c+1;n=k;break;default:throw new p('Expected "');}break;case 8:switch(k){case 38:l.addSub(a,o,c-o);f=18;m=8;o=c+1;break;case 62:if(b)throw new p("Invalid unescaped "+
String.fromCharCode(k)+" in attribute value");k==n&&(l.addSub(a,o,c-o),i=l.b,l=new Xb,e.set(g,i),f=0,i=4);break;case 60:if(b)throw new p("Invalid unescaped "+String.fromCharCode(k)+" in attribute value");k==n&&(l.addSub(a,o,c-o),i=l.b,l=new Xb,e.set(g,i),f=0,i=4);break;default:k==n&&(l.addSub(a,o,c-o),i=l.b,l=new Xb,e.set(g,i),f=0,i=4)}break;case 9:o=c=Pd.doParse(a,b,c,e);f=1;break;case 11:switch(k){case 62:f=1;break;default:throw new p("Expected >");}break;case 12:switch(k){case 62:return 0==h&&
d.addChild(q.createPCData("")),c;default:throw new p("Expected >");}case 10:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(o==c)throw new p("Expected node name");i=A.substr(a,o,c-o);if(d.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+d.nodeType);if(i!=d.nodeName)throw new p("Expected </"+function(){if(d.nodeType!=q.Element)throw"Bad node type, expected Element but found "+d.nodeType;return d.nodeName}(this)+">");f=0;i=12;continue}break;
case 15:45==k&&45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2)&&(k=q.createComment(A.substr(a,o,c-o)),d.addChild(k),h++,c+=2,f=1);break;case 16:91==k?j++:93==k?j--:62==k&&0==j&&(k=q.createDocType(A.substr(a,o,c-o)),d.addChild(k),h++,f=1);break;case 14:63==k&&62==a.charCodeAt(c+1)&&(c++,k=A.substr(a,o+1,c-o-2),k=q.createProcessingInstruction(k),d.addChild(k),h++,f=1);break;case 18:if(59==k){o=A.substr(a,o,c-o);if(35==o.charCodeAt(0))o=120==o.charCodeAt(1)?r.parseInt("0"+A.substr(o,1,o.length-1)):r.parseInt(A.substr(o,
1,o.length-1)),l.b+=String.fromCharCode(o);else if(Pd.escapes.exists(o))l.add(Pd.escapes.get(o));else{if(b)throw new p("Undefined entity: "+o);l.b+=r.string("&"+o+";")}o=c+1;f=m}else if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)&&35!=k){if(b)throw new p("Invalid character in entity: "+String.fromCharCode(k));l.b+="&";l.addSub(a,o,c-o);c--;o=c+1;f=m}}k=fa.fastCodeAt(a,++c)}1==f&&(o=c,f=13);if(13==f){if(c!=o||0==h)l.addSub(a,o,c-o),a=q.createPCData(l.b),d.addChild(a),h++;
return c}if(!b&&18==f&&13==m)return l.b+="&",l.addSub(a,o,c-o),a=q.createPCData(l.b),d.addChild(a),h++,c;throw new p("Unexpected end");};var ld=function(a){this.output=new Xb;this.pretty=a};h["haxe.xml.Printer"]=ld;ld.__name__=["haxe","xml","Printer"];ld.print=function(a,b){null==b&&(b=!1);var c=new ld(b);c.writeNode(a,"");return c.output.b};ld.prototype={writeNode:function(a,b){switch(a.nodeType){case 2:this.output.b+=r.string(b+"<![CDATA[");this.write(fa.trim(function(){if(a.nodeType==q.Document||
a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);return a.nodeValue}(this)));this.output.b+="]]\>";this.pretty&&(this.output.b+="");break;case 3:var c;if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);c=a.nodeValue;c=(new xb("[\n\r\t]+","g")).replace(c,"");this.output.b=null==b?this.output.b+"null":this.output.b+(""+b);this.write(fa.trim("<\!--"+c+"--\>"));this.pretty&&(this.output.b+="");break;case 6:if(a.nodeType!=q.Document&&
a.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+a.nodeType);for(c=A.iter(a.children);c.hasNext();)this.writeNode(c.next(),b);break;case 0:this.output.b+=r.string(b+"<");this.write(function(){if(a.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+a.nodeType);return a.nodeName}(this));for(c=a.attributes();c.hasNext();){var d=c.next();this.output.b+=r.string(" "+d+'="');this.write(fa.htmlEscape(a.get(d),!0));this.output.b+='"'}if(this.hasChildren(a)){this.output.b+=
">";this.pretty&&(this.output.b+="");if(a.nodeType!=q.Document&&a.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+a.nodeType);for(c=A.iter(a.children);c.hasNext();)this.writeNode(c.next(),this.pretty?b+"\t":b);this.output.b+=r.string(b+"</");this.write(function(){if(a.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+a.nodeType);return a.nodeName}(this));this.output.b+=">"}else this.output.b+="/>";this.pretty&&(this.output.b+="");
break;case 1:if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);c=a.nodeValue;0!=c.length&&(this.write(b+fa.htmlEscape(c)),this.pretty&&(this.output.b+=""));break;case 5:this.write("<?"+function(){if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);return a.nodeValue}(this)+"?>");break;case 4:this.write("<!DOCTYPE "+function(){if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+
a.nodeType);return a.nodeValue}(this)+">")}},write:function(a){this.output.b=null==a?this.output.b+"null":this.output.b+(""+a)},hasChildren:function(a){if(a.nodeType!=q.Document&&a.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+a.nodeType);for(a=A.iter(a.children);a.hasNext();){var b=a.next();switch(b.nodeType){case 0:case 1:return!0;case 2:case 3:if(0!=fa.ltrim(function(){if(b.nodeType==q.Document||b.nodeType==q.Element)throw new p("Bad node type, unexpected "+
b.nodeType);return b.nodeValue}(this)).length)return!0}}return!1},__class__:ld};var p=function(a){Error.call(this);this.val=a;this.message=""+a;Error.captureStackTrace&&Error.captureStackTrace(this,p)};h["js._Boot.HaxeError"]=p;p.__name__=["js","_Boot","HaxeError"];p.__super__=Error;p.prototype=x(Error.prototype,{__class__:p});var w=function(){};h["js.Boot"]=w;w.__name__=["js","Boot"];w.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;
a=w.__nativeClassName(a);return null!=a?w.__resolveNativeClass(a):null};w.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+w.__string_rec(a[f],b)):c+w.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":
"")+w.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(i){return i instanceof p&&(i=i.val),"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)if(!e||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+w.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";
case "string":return a;default:return""+a}};w.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||w.__interfLoop(f,b))return!0}return w.__interfLoop(a.__super__,b)};w.__instanceof=function(a,b){if(null==b)return!1;switch(b){case il:return(a|0)===a;case cl:return"number"==typeof a;case dl:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;
case jl:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof b||w.__interfLoop(w.getClass(a),b))return!0}else{if("object"==typeof b&&w.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==al&&null!=a.__name__||b==bl&&null!=a.__ename__?!0:a.__enum__==b}};w.__cast=function(a,b){if(w.__instanceof(a,b))return a;throw new p("Cannot cast "+r.string(a)+" to "+r.string(b));};w.__nativeClassName=function(a){a=w.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==
a||"JSON"==a?null:a};w.__isNativeObj=function(a){return null!=w.__nativeClassName(a)};w.__resolveNativeClass=function(a){return Function("return typeof "+a+' != "undefined" ? '+a+" : null")()};var hk=function(){};h["js.Browser"]=hk;hk.__name__=["js","Browser"];hk.getLocalStorage=function(){try{var a=window.localStorage;a.getItem("");return a}catch(b){return b instanceof p&&(b=b.val),null}};var ik=function(){};h["js.html._CanvasElement.CanvasUtil"]=ik;ik.__name__=["js","html","_CanvasElement","CanvasUtil"];
ik.getContextWebGL=function(a,b){for(var c=0,d=["webgl","experimental-webgl"];c<d.length;){var e=d[c];++c;e=a.getContext(e,b);if(null!=e)return e}return null};var Zc=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;)this.a[b++]=0;this.byteLength=a}};h["js.html.compat.ArrayBuffer"]=Zc;Zc.__name__=["js","html","compat","ArrayBuffer"];Zc.sliceImpl=function(a,b){var c=new nk(this,a,null==b?null:b-a),d=new ok(c.byteLength);(new nk(d)).set(c);
return d};Zc.prototype={slice:function(a,b){return new Zc(this.a.slice(a,b))},__class__:Zc};var pk=function(a,b,c){this.buf=a;this.offset=null==b?0:b;this.length=null==c?a.byteLength-this.offset:c;if(0>this.offset||0>this.length||this.offset+this.length>a.byteLength)throw new p(lb.OutsideBounds);};h["js.html.compat.DataView"]=pk;pk.__name__=["js","html","compat","DataView"];pk.prototype={getInt8:function(a){a=this.buf.a[this.offset+a];return 128<=a?a-256:a},getUint8:function(a){return this.buf.a[this.offset+
a]},getInt16:function(a,b){var c=this.getUint16(a,b);return 32768<=c?c-65536:c},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a,d=this.buf.a[c++],e=this.buf.a[c++],f=this.buf.a[c++],c=this.buf.a[c++];return b?d|e<<8|f<<16|c<<24:c|f<<8|e<<16|d<<24},getUint32:function(a,b){var c=this.getInt32(a,b);return 0>c?c+4294967296:c},getFloat32:function(a,b){return Ac.i32ToFloat(this.getInt32(a,
b))},getFloat64:function(a,b){var c=this.getInt32(a,b),d=this.getInt32(a+4,b);return Ac.i64ToDouble(b?c:d,b?d:c)},setInt8:function(a,b){this.buf.a[a+this.offset]=0>b?b+128&255:b&255},setUint8:function(a,b){this.buf.a[a+this.offset]=b&255},setInt16:function(a,b,c){this.setUint16(a,0>b?b+65536:b,c)},setUint16:function(a,b,c){a+=this.offset;c?(this.buf.a[a]=b&255,this.buf.a[a++]=b>>8&255):(this.buf.a[a++]=b>>8&255,this.buf.a[a]=b&255)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,
b,c){a+=this.offset;c?(this.buf.a[a++]=b&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>>24):(this.buf.a[a++]=b>>>24,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b&255)},setFloat32:function(a,b,c){this.setUint32(a,Ac.floatToI32(b),c)},setFloat64:function(a,b,c){b=Ac.doubleToI64(b);c?(this.setUint32(a,b.low),this.setUint32(a,b.high)):(this.setUint32(a,b.high),this.setUint32(a,b.low))},__class__:pk};var md=function(){};h["js.html.compat.Uint8Array"]=
md;md.__name__=["js","html","compat","Uint8Array"];md._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new Zc(c)}else if(w.__instanceof(a,Zc))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new Zc(c);else throw new p("TODO "+r.string(a));c.subarray=md._subarray;
c.set=md._set;return c};md._set=function(a,b){if(w.__instanceof(a.buffer,Zc)){if(a.byteLength+b>this.byteLength)throw new p("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new p("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new p("TODO");};md._subarray=function(a,b){var c=md._new(this.slice(a,b));c.byteOffset=a;return c};var v=function(){};h["nape.Config"]=
v;v.__name__=["nape","Config"];var Cc=function(){this.zpp_inner=null};h["nape.callbacks.Callback"]=Cc;Cc.__name__=["nape","callbacks","Callback"];Cc.prototype={toString:function(){return""},__class__:Cc};var zg=function(){this.zpp_inner=null};h["nape.callbacks.BodyCallback"]=zg;zg.__name__=["nape","callbacks","BodyCallback"];zg.__super__=Cc;zg.prototype=x(Cc.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP"][this.zpp_inner.event-g.id_CbEvent_WAKE];a+=":"+this.zpp_inner.body.outer.toString();
return a+=" : listener: "+r.string(this.zpp_inner.listener.outer)},__class__:zg});var Dc=function(){this.zpp_inner=null};h["nape.callbacks.Listener"]=Dc;Dc.__name__=["nape","callbacks","Listener"];Dc.prototype={toString:function(){var a="BEGIN,END,WAKE,SLEEP,BREAK,PRE,ONGOING".split(",")[this.zpp_inner.event];if(this.zpp_inner.type==g.id_ListenerType_BODY)return"BodyListener{"+a+"::"+r.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}";if(this.zpp_inner.type==g.id_ListenerType_CONSTRAINT)return"ConstraintListener{"+
a+"::"+r.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}";var b=this.zpp_inner.interaction,c;switch(b.itype){case 1:c="COLLISION";break;case 2:c="SENSOR";break;case 4:c="FLUID";break;default:c="ALL"}return(this.zpp_inner.type==g.id_ListenerType_INTERACTION?"InteractionListener{"+a+"#"+c+"::"+r.string(b.outer_zni.zpp_inner_zn.options1.outer)+":"+r.string(b.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+c+"::"+r.string(b.outer_znp.zpp_inner_zn.options1.outer)+":"+
r.string(b.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},__class__:Dc};var Xi=function(){this.zpp_inner_zn=null};h["nape.callbacks.BodyListener"]=Xi;Xi.__name__=["nape","callbacks","BodyListener"];Xi.__super__=Dc;Xi.prototype=x(Dc.prototype,{__class__:Xi});var sb=function(){};h["nape.callbacks.CbEvent"]=sb;sb.__name__=["nape","callbacks","CbEvent"];sb.prototype={toString:function(){var a;null==g.CbEvent_PRE&&(g.internal=!0,g.CbEvent_PRE=new sb,g.internal=!1);
this==g.CbEvent_PRE?a="PRE":(null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new sb,g.internal=!1),this==g.CbEvent_BEGIN?a="BEGIN":(null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new sb,g.internal=!1),this==g.CbEvent_ONGOING?a="ONGOING":(null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new sb,g.internal=!1),this==g.CbEvent_END?a="END":(null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new sb,g.internal=!1),this==g.CbEvent_WAKE?a="WAKE":(null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=
new sb,g.internal=!1),this==g.CbEvent_SLEEP?a="SLEEP":(null==g.CbEvent_BREAK&&(g.internal=!0,g.CbEvent_BREAK=new sb,g.internal=!1),a=this==g.CbEvent_BREAK?"BREAK":""))))));return a},__class__:sb};var Gd=function(){this.zpp_inner=null;this.zpp_inner=new La;this.zpp_inner.outer=this};h["nape.callbacks.CbType"]=Gd;Gd.__name__=["nape","callbacks","CbType"];Gd.prototype={toString:function(){return this==La.ANY_BODY?"ANY_BODY":this==La.ANY_SHAPE?"ANY_SHAPE":this==La.ANY_COMPOUND?"ANY_COMPOUND":this==La.ANY_CONSTRAINT?
"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},__class__:Gd};var Zb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.callbacks.CbTypeIterator"]=Zb;Zb.__name__=["nape","callbacks","CbTypeIterator"];Zb.get=function(a){var b;null==Zb.zpp_pool?($c.internal=!0,b=new Zb,$c.internal=!1):(b=Zb.zpp_pool,Zb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Zb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();
this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Zb.zpp_pool;Zb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Zb};var Ag=function(){this.zpp_inner=null;this.zpp_inner=new $c;this.zpp_inner.outer=this};h["nape.callbacks.CbTypeList"]=Ag;Ag.__name__=["nape","callbacks","CbTypeList"];Ag.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=
this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();
for(c=Zb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Ag,__properties__:{get_length:"get_length"}};var Bg=function(){this.zpp_inner=null};h["nape.callbacks.ConstraintCallback"]=Bg;Bg.__name__=["nape","callbacks","ConstraintCallback"];Bg.__super__=Cc;Bg.prototype=x(Cc.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-g.id_CbEvent_WAKE];a+=":"+this.zpp_inner.constraint.outer.toString();
return a+=" : listener: "+r.string(this.zpp_inner.listener.outer)},__class__:Bg});var Yi=function(){this.zpp_inner_zn=null};h["nape.callbacks.ConstraintListener"]=Yi;Yi.__name__=["nape","callbacks","ConstraintListener"];Yi.__super__=Dc;Yi.prototype=x(Dc.prototype,{__class__:Yi});var Cg=function(){this.zpp_inner=null};h["nape.callbacks.InteractionCallback"]=Cg;Cg.__name__=["nape","callbacks","InteractionCallback"];Cg.__super__=Cc;Cg.prototype=x(Cc.prototype,{toString:function(){var a;a="Cb:"+"BEGIN,END,,,,,ONGOING".split(",")[this.zpp_inner.event];
a+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();a+=" : "+this.zpp_inner.wrap_arbiters.toString();return a+=" : listener: "+r.string(this.zpp_inner.listener.outer)},__class__:Cg});var he=function(a,b,c,d,e,f){null==f&&(f=0);this.zpp_inner=this.zpp_inner_zn=null;var i=-1;null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new sb,g.internal=!1);a==g.CbEvent_BEGIN?i=g.id_CbEvent_BEGIN:(null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new sb,g.internal=!1),a==
g.CbEvent_END?i=g.id_CbEvent_END:(null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new sb,g.internal=!1),a==g.CbEvent_ONGOING&&(i=g.id_CbEvent_ONGOING)));this.zpp_inner=this.zpp_inner_zn=new Ab(Ce.argument(c),Ce.argument(d),i,g.id_ListenerType_INTERACTION);this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zni=this;this.zpp_inner.precedence=f;this.zpp_inner_zn.handleri=e;this.set_interactionType(b)};h["nape.callbacks.InteractionListener"]=he;he.__name__=["nape","callbacks","InteractionListener"];
he.__super__=Dc;he.prototype=x(Dc.prototype,{get_interactionType:function(){var a=this.zpp_inner_zn.itype;if(a==g.id_InteractionType_COLLISION)return null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new Za,g.internal=!1),g.InteractionType_COLLISION;if(a==g.id_InteractionType_SENSOR)return null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new Za,g.internal=!1),g.InteractionType_SENSOR;if(a==g.id_InteractionType_FLUID)return null==g.InteractionType_FLUID&&
(g.internal=!0,g.InteractionType_FLUID=new Za,g.internal=!1),g.InteractionType_FLUID;return a==g.id_InteractionType_ANY?(null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new Za,g.internal=!1),g.InteractionType_ANY):null},set_interactionType:function(a){if(this.get_interactionType()!=a){var b=this.zpp_inner_zn;null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new Za,g.internal=!1);a==g.InteractionType_COLLISION?a=g.id_InteractionType_COLLISION:(null==g.InteractionType_SENSOR&&
(g.internal=!0,g.InteractionType_SENSOR=new Za,g.internal=!1),a==g.InteractionType_SENSOR?a=g.id_InteractionType_SENSOR:(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new Za,g.internal=!1),a=a==g.InteractionType_FLUID?g.id_InteractionType_FLUID:g.id_InteractionType_ANY));b.itype=a}return this.get_interactionType()},__class__:he,__properties__:{set_interactionType:"set_interactionType",get_interactionType:"get_interactionType"}});var Za=function(){};h["nape.callbacks.InteractionType"]=
Za;Za.__name__=["nape","callbacks","InteractionType"];Za.prototype={toString:function(){var a;null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new Za,g.internal=!1);this==g.InteractionType_COLLISION?a="COLLISION":(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new Za,g.internal=!1),this==g.InteractionType_SENSOR?a="SENSOR":(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new Za,g.internal=!1),this==g.InteractionType_FLUID?
a="FLUID":(null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new Za,g.internal=!1),a=this==g.InteractionType_ANY?"ANY":"")));return a},__class__:Za};var Ec=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.callbacks.ListenerIterator"]=Ec;Ec.__name__=["nape","callbacks","ListenerIterator"];Ec.get=function(a){var b;null==Ec.zpp_pool?(pc.internal=!0,b=new Ec,pc.internal=!1):(b=Ec.zpp_pool,Ec.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=
!1;return b};Ec.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Ec.zpp_pool;Ec.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Ec};var Zi=function(){this.zpp_inner=null;this.zpp_inner=new pc;this.zpp_inner.outer=this};h["nape.callbacks.ListenerList"]=Zi;Zi.__name__=["nape","callbacks","ListenerList"];Zi.prototype=
{get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=
this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),
this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):
this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Ec.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Zi,__properties__:{get_length:"get_length"}};var De=function(){};h["nape.callbacks.ListenerType"]=De;De.__name__=["nape","callbacks","ListenerType"];De.prototype={toString:function(){var a;null==g.ListenerType_BODY&&(g.internal=!0,g.ListenerType_BODY=
new De,g.internal=!1);this==g.ListenerType_BODY?a="BODY":(null==g.ListenerType_CONSTRAINT&&(g.internal=!0,g.ListenerType_CONSTRAINT=new De,g.internal=!1),this==g.ListenerType_CONSTRAINT?a="CONSTRAINT":(null==g.ListenerType_INTERACTION&&(g.internal=!0,g.ListenerType_INTERACTION=new De,g.internal=!1),this==g.ListenerType_INTERACTION?a="INTERACTION":(null==g.ListenerType_PRE&&(g.internal=!0,g.ListenerType_PRE=new De,g.internal=!1),a=this==g.ListenerType_PRE?"PRE":"")));return a},__class__:De};var of=
function(a,b){this.zpp_inner=null;this.zpp_inner=new Ce;this.zpp_inner.outer=this;null!=a&&this.including(a);null!=b&&this.excluding(b)};h["nape.callbacks.OptionType"]=of;of.__name__=["nape","callbacks","OptionType"];of.prototype={including:function(a){this.zpp_inner.append(this.zpp_inner.includes,a);return this},excluding:function(a){this.zpp_inner.append(this.zpp_inner.excludes,a);return this},toString:function(){null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes();var a=this.zpp_inner.wrap_includes.toString();
null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes();return"@{"+a+" excluding "+this.zpp_inner.wrap_excludes.toString()+"}"},__class__:of};var Dg=function(){this.zpp_inner=null};h["nape.callbacks.PreCallback"]=Dg;Dg.__name__=["nape","callbacks","PreCallback"];Dg.__super__=Cc;Dg.prototype=x(Cc.prototype,{toString:function(){var a;a="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());a+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();
return a+=" : listnener: "+r.string(this.zpp_inner.listener.outer)},__class__:Dg});var ib=function(){};h["nape.callbacks.PreFlag"]=ib;ib.__name__=["nape","callbacks","PreFlag"];ib.prototype={toString:function(){var a;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ib,g.internal=!1);this==g.PreFlag_ACCEPT?a="ACCEPT":(null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ib,g.internal=!1),this==g.PreFlag_IGNORE?a="IGNORE":(null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=
new ib,g.internal=!1),this==g.PreFlag_ACCEPT_ONCE?a="ACCEPT_ONCE":(null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=new ib,g.internal=!1),a=this==g.PreFlag_IGNORE_ONCE?"IGNORE_ONCE":"")));return a},__class__:ib};var $i=function(){this.zpp_inner_zn=null};h["nape.callbacks.PreListener"]=$i;$i.__name__=["nape","callbacks","PreListener"];$i.__super__=Dc;$i.prototype=x(Dc.prototype,{__class__:$i});var qk=function(){};h["nape.constraint.Constraint"]=qk;qk.__name__=["nape","constraint",
"Constraint"];qk.prototype={toString:function(){return"{Constraint}"},__class__:qk};var Fc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.constraint.ConstraintIterator"]=Fc;Fc.__name__=["nape","constraint","ConstraintIterator"];Fc.get=function(a){var b;null==Fc.zpp_pool?(qc.internal=!0,b=new Fc,qc.internal=!1):(b=Fc.zpp_pool,Fc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Fc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();
var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Fc.zpp_pool;Fc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Fc};var aj=function(){this.zpp_inner=null;this.zpp_inner=new qc;this.zpp_inner.outer=this};h["nape.constraint.ConstraintList"]=aj;aj.__name__=["nape","constraint","ConstraintList"];aj.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&
(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},
remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Fc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==
d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:aj,__properties__:{get_length:"get_length"}};var ie=function(){this.zpp_inner=null};h["nape.dynamics.Arbiter"]=ie;ie.__name__=["nape","dynamics","Arbiter"];ie.prototype={get_state:function(){var a=this.zpp_inner.immState;if(a==(g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS))return null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ib,g.internal=!1),g.PreFlag_ACCEPT;switch(a){case 1:return null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=
new ib,g.internal=!1),g.PreFlag_ACCEPT_ONCE;default:if(a==(g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS))return null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ib,g.internal=!1),g.PreFlag_IGNORE;null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=new ib,g.internal=!1);return g.PreFlag_IGNORE_ONCE}},toString:function(){var a;a=this.zpp_inner.type==pa.COL?"CollisionArbiter":this.zpp_inner.type==pa.FLUID?"FluidArbiter":"SensorArbiter";return this.zpp_inner.cleared?a+"(object-pooled)":
a+"("+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|"+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==pa.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()},__class__:ie,__properties__:{get_state:"get_state"}};var $b=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.dynamics.ArbiterIterator"]=
$b;$b.__name__=["nape","dynamics","ArbiterIterator"];$b.get=function(a){var b;null==$b.zpp_pool?(rc.internal=!0,b=new $b,rc.internal=!1):(b=$b.zpp_pool,$b.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};$b.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=$b.zpp_pool;$b.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},
__class__:$b};var bj=function(){this.zpp_inner=null;this.zpp_inner=new rc;this.zpp_inner.outer=this};h["nape.dynamics.ArbiterList"]=bj;bj.__name__=["nape","dynamics","ArbiterList"];bj.prototype={zpp_gl:function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.head;null!=a;)a.elt.active&&this.zpp_inner.user_length++,a=a.next}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();
this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite){this.zpp_inner.at_index=0;for(this.zpp_inner.at_ite=this.zpp_inner.inner.head;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=a;){this.zpp_inner.at_index++;for(this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elt.wrapper()},
iterator:function(){this.zpp_vm();return $b.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:bj};var pf=function(){};h["nape.dynamics.ArbiterType"]=pf;pf.__name__=["nape","dynamics","ArbiterType"];pf.prototype={toString:function(){var a;null==g.ArbiterType_COLLISION&&(g.internal=!0,g.ArbiterType_COLLISION=new pf,g.internal=!1);this==g.ArbiterType_COLLISION?
a="COLLISION":(null==g.ArbiterType_SENSOR&&(g.internal=!0,g.ArbiterType_SENSOR=new pf,g.internal=!1),this==g.ArbiterType_SENSOR?a="SENSOR":(null==g.ArbiterType_FLUID&&(g.internal=!0,g.ArbiterType_FLUID=new pf,g.internal=!1),a=this==g.ArbiterType_FLUID?"FLUID":""));return a},__class__:pf};var Eg=function(){this.zpp_inner=null};h["nape.dynamics.CollisionArbiter"]=Eg;Eg.__name__=["nape","dynamics","CollisionArbiter"];Eg.__super__=ie;Eg.prototype=x(ie.prototype,{__class__:Eg});var cj=function(){this.zpp_inner=
null};h["nape.dynamics.Contact"]=cj;cj.__name__=["nape","dynamics","Contact"];cj.prototype={toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:cj};var sc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.dynamics.ContactIterator"]=sc;sc.__name__=["nape","dynamics","ContactIterator"];sc.get=function(a){var b;null==sc.zpp_pool?(qf.internal=!0,b=new sc,qf.internal=!1):(b=sc.zpp_pool,
sc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};sc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=sc.zpp_pool;sc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:sc};var rk=function(){this.zpp_inner=null};h["nape.dynamics.ContactList"]=rk;rk.__name__=["nape","dynamics","ContactList"];
rk.prototype={get_length:function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.next;null!=a;){var b=a;b.active&&b.arbiter.active&&this.zpp_inner.user_length++;a=a.next}}return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite){this.zpp_inner.at_index=0;for(this.zpp_inner.at_ite=
this.zpp_inner.inner.next;;){var b=this.zpp_inner.at_ite;if(b.active&&b.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}for(;this.zpp_inner.at_index!=a;){this.zpp_inner.at_index++;for(this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){b=this.zpp_inner.at_ite;if(b.active&&b.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}}return this.zpp_inner.at_ite.wrapper()},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=sc.get(this);c.hasNext();){var d;
c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:rk,__properties__:{get_length:"get_length"}};var Fg=function(){this.zpp_inner=null};h["nape.dynamics.FluidArbiter"]=Fg;Fg.__name__=["nape","dynamics","FluidArbiter"];Fg.__super__=ie;Fg.prototype=x(ie.prototype,{__class__:Fg});var dj=function(a,b,c,d,e,f){null==f&&(f=-1);null==e&&(e=1);null==d&&(d=-1);null==c&&(c=1);null==b&&(b=-1);null==a&&(a=1);this.zpp_inner=null;null==tb.zpp_pool?
this.zpp_inner=new tb:(this.zpp_inner=tb.zpp_pool,tb.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;this.zpp_inner.collisionGroup!=a&&(this.zpp_inner.collisionGroup=a,this.zpp_inner.invalidate());this.zpp_inner.collisionGroup;this.zpp_inner.collisionMask!=b&&(this.zpp_inner.collisionMask=b,this.zpp_inner.invalidate());this.zpp_inner.collisionMask;this.zpp_inner.sensorGroup!=c&&(this.zpp_inner.sensorGroup=c,this.zpp_inner.invalidate());this.zpp_inner.sensorGroup;
this.zpp_inner.sensorMask!=d&&(this.zpp_inner.sensorMask=d,this.zpp_inner.invalidate());this.zpp_inner.sensorMask;this.zpp_inner.fluidGroup!=e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate());this.zpp_inner.fluidGroup;this.zpp_inner.fluidMask!=f&&(this.zpp_inner.fluidMask=f,this.zpp_inner.invalidate());this.zpp_inner.fluidMask};h["nape.dynamics.InteractionFilter"]=dj;dj.__name__=["nape","dynamics","InteractionFilter"];dj.prototype={__class__:dj};var sk=function(){this.zpp_inner=null};h["nape.dynamics.InteractionGroup"]=
sk;sk.__name__=["nape","dynamics","InteractionGroup"];sk.prototype={toString:function(){var a="InteractionGroup";this.zpp_inner.ignore&&(a+=":ignore");return a},__class__:sk};var Mb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.dynamics.InteractionGroupIterator"]=Mb;Mb.__name__=["nape","dynamics","InteractionGroupIterator"];Mb.get=function(a){var b;null==Mb.zpp_pool?(rf.internal=!0,b=new Mb,rf.internal=!1):(b=Mb.zpp_pool,Mb.zpp_pool=b.zpp_next);b.zpp_i=
0;b.zpp_inner=a;b.zpp_critical=!1;return b};Mb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Mb.zpp_pool;Mb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Mb};var tk=function(){this.zpp_inner=null};h["nape.dynamics.InteractionGroupList"]=tk;tk.__name__=["nape","dynamics","InteractionGroupList"];tk.prototype=
{get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=
this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Mb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:tk,__properties__:{get_length:"get_length"}};var uk=function(){this.zpp_inner=null};h["nape.geom.AABB"]=uk;uk.__name__=["nape","geom","AABB"];uk.prototype={toString:function(){this.zpp_inner.validate();return this.zpp_inner.toString()},
__class__:uk};var vk=function(){this.zpp_inner=null};h["nape.geom.ConvexResult"]=vk;vk.__name__=["nape","geom","ConvexResult"];vk.prototype={toString:function(){return"{ shape: "+r.string(this.zpp_inner.shape)+" toi: "+this.zpp_inner.toiDistance+" }"},__class__:vk};var ad=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.ConvexResultIterator"]=ad;ad.__name__=["nape","geom","ConvexResultIterator"];ad.get=function(a){var b;null==ad.zpp_pool?(sf.internal=
!0,b=new ad,sf.internal=!1):(b=ad.zpp_pool,ad.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};ad.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=ad.zpp_pool;ad.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:ad};var wk=function(){this.zpp_inner=null};h["nape.geom.ConvexResultList"]=
wk;wk.__name__=["nape","geom","ConvexResultList"];wk.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=
a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=ad.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:wk,__properties__:{get_length:"get_length"}};var ej=function(){this.zpp_inner=null};h["nape.geom.GeomPoly"]=ej;ej.__name__=["nape","geom","GeomPoly"];ej.prototype={toString:function(){var a=
"GeomPoly[",b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d!=this.zpp_inner.vertices&&(a+=",");a+="{"+d.x+","+d.y+"}";b=b.next}while(b!=c)}return a+"]"},__class__:ej};var bd=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.GeomPolyIterator"]=bd;bd.__name__=["nape","geom","GeomPolyIterator"];bd.get=function(a){var b;null==bd.zpp_pool?(tf.internal=!0,b=new bd,tf.internal=!1):(b=bd.zpp_pool,bd.zpp_pool=b.zpp_next);b.zpp_i=
0;b.zpp_inner=a;b.zpp_critical=!1;return b};bd.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=bd.zpp_pool;bd.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:bd};var xk=function(){this.zpp_inner=null};h["nape.geom.GeomPolyList"]=xk;xk.__name__=["nape","geom","GeomPolyList"];xk.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},
toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=bd.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:xk,__properties__:{get_length:"get_length"}};var yk=function(){this.zpp_inner=null};h["nape.geom.Mat23"]=yk;yk.__name__=["nape","geom","Mat23"];yk.prototype={toString:function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+
" tx: "+this.zpp_inner.tx+" ty: "+this.zpp_inner.ty+" }"},__class__:yk};var zk=function(){this.zpp_inner=null};h["nape.geom.MatMN"]=zk;zk.__name__=["nape","geom","MatMN"];zk.prototype={toString:function(){for(var a="{ ",b=!0,c=0,d=this.zpp_inner.m;c<d;){var e=c++;b||(a+="; ");for(var b=!1,f=0,i=this.zpp_inner.n;f<i;)var g=f++,a=a+(this.zpp_inner.x[e*this.zpp_inner.n+g]+" ")}return a+"}"},__class__:zk};var Ak=function(){this.zpp_inner=null};h["nape.geom.RayResult"]=Ak;Ak.__name__=["nape","geom","RayResult"];
Ak.prototype={toString:function(){return"{ shape: "+r.string(this.zpp_inner.shape)+" distance: "+this.zpp_inner.toiDistance+" ?inner: "+r.string(this.zpp_inner.inner)+" }"},__class__:Ak};var nd=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.RayResultIterator"]=nd;nd.__name__=["nape","geom","RayResultIterator"];nd.get=function(a){var b;null==nd.zpp_pool?(uf.internal=!0,b=new nd,uf.internal=!1):(b=nd.zpp_pool,nd.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=
a;b.zpp_critical=!1;return b};nd.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=nd.zpp_pool;nd.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:nd};var Bk=function(){this.zpp_inner=null};h["nape.geom.RayResultList"]=Bk;Bk.__name__=["nape","geom","RayResultList"];Bk.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},
toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=nd.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Bk,__properties__:{get_length:"get_length"}};var Va=function(a,b){null==b&&(b=0);null==a&&(a=0);this.zpp_inner=this.zpp_pool=null;this.zpp_inner=ja.get(a,b,null);this.zpp_inner.outer=this};h["nape.geom.Vec2"]=Va;Va.__name__=["nape","geom","Vec2"];Va.get=function(a,b,c){null==c&&(c=
!1);null==b&&(b=0);null==a&&(a=0);var d;null==vf.poolVec2?d=new Va:(d=vf.poolVec2,vf.poolVec2=d.zpp_pool,d.zpp_pool=null);if(null==d.zpp_inner)d.zpp_inner=ja.get(a,b,null),d.zpp_inner.outer=d;else{var e;d.zpp_inner.validate();if(e=d.zpp_inner.x==a)d.zpp_inner.validate(),e=d.zpp_inner.y==b;e||(d.zpp_inner.x=a,d.zpp_inner.y=b,d.zpp_inner.invalidate());d}d.zpp_inner.weak=c;return d};Va.prototype={dispose:function(){var a=this.zpp_inner;this.zpp_inner=this.zpp_inner.outer=null;this.zpp_pool=vf.poolVec2;
vf.poolVec2=this;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=ja.zpp_pool;ja.zpp_pool=a},set_x:function(a){this.zpp_inner.validate();this.zpp_inner.x!=a&&(this.zpp_inner.x=a,this.zpp_inner.invalidate());this.zpp_inner.validate();return this.zpp_inner.x},set_y:function(a){this.zpp_inner.validate();this.zpp_inner.y!=a&&(this.zpp_inner.y=a,this.zpp_inner.invalidate());this.zpp_inner.validate();return this.zpp_inner.y},set:function(a){var b=
this.setxy(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;return b},setxy:function(a,b){var c;this.zpp_inner.validate();if(c=this.zpp_inner.x==a)this.zpp_inner.validate(),c=this.zpp_inner.y==b;c||(this.zpp_inner.x=a,this.zpp_inner.y=b,this.zpp_inner.invalidate());return this},toString:function(){this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:Va,__properties__:{set_y:"set_y",
set_x:"set_x"}};var od=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.geom.Vec2Iterator"]=od;od.__name__=["nape","geom","Vec2Iterator"];od.get=function(a){var b;null==od.zpp_pool?(Ee.internal=!0,b=new od,Ee.internal=!1):(b=od.zpp_pool,od.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};od.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=
od.zpp_pool;od.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:od};var je=function(){this.zpp_inner=null;this.zpp_inner=new Ee;this.zpp_inner.outer=this};h["nape.geom.Vec2List"]=je;je.__name__=["nape","geom","Vec2List"];je.prototype={zpp_gl:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},
zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?
this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},empty:function(){return 0==this.zpp_gl()},iterator:function(){this.zpp_vm();return od.get(this)},
toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:je};var Ck=function(){this.zpp_inner=null};h["nape.geom.Vec3"]=Ck;Ck.__name__=["nape","geom","Vec3"];Ck.prototype={toString:function(){this.zpp_inner.validate();var a="{ x: "+this.zpp_inner.x+" y: ";this.zpp_inner.validate();a=a+this.zpp_inner.y+" z: ";this.zpp_inner.validate();return a+this.zpp_inner.z+
" }"},__class__:Ck};var wf=function(){};h["nape.geom.Winding"]=wf;wf.__name__=["nape","geom","Winding"];wf.prototype={toString:function(){var a;null==g.Winding_UNDEFINED&&(g.internal=!0,g.Winding_UNDEFINED=new wf,g.internal=!1);this==g.Winding_UNDEFINED?a="UNDEFINED":(null==g.Winding_CLOCKWISE&&(g.internal=!0,g.Winding_CLOCKWISE=new wf,g.internal=!1),this==g.Winding_CLOCKWISE?a="CLOCKWISE":(null==g.Winding_ANTICLOCKWISE&&(g.internal=!0,g.Winding_ANTICLOCKWISE=new wf,g.internal=!1),a=this==g.Winding_ANTICLOCKWISE?
"ANTICLOCKWISE":""));return a},__class__:wf};var pd=function(){this.zpp_inner_i=null};h["nape.phys.Interactor"]=pd;pd.__name__=["nape","phys","Interactor"];pd.prototype={get_userData:function(){null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={});return this.zpp_inner_i.userData},get_castShape:function(){return null!=this.zpp_inner_i.ishape?this.zpp_inner_i.ishape.outer:null},toString:function(){return""},__class__:pd,__properties__:{get_castShape:"get_castShape",get_userData:"get_userData"}};
var Hc=function(a,b){this.zpp_inner_i=this.zpp_inner=null;this.zpp_inner=new Gc;this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;null!=b?(b.zpp_inner.validate(),this.zpp_inner.posx=b.zpp_inner.x,b.zpp_inner.validate(),this.zpp_inner.posy=b.zpp_inner.y):(this.zpp_inner.posx=0,this.zpp_inner.posy=0);this.set_type(null==a?function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);return g.BodyType_DYNAMIC}(this):a);null!=b&&(b.zpp_inner.weak?
(b.dispose(),!0):!1);this.zpp_inner_i.insert_cbtype(La.ANY_BODY.zpp_inner)};h["nape.phys.Body"]=Hc;Hc.__name__=["nape","phys","Body"];Hc.__super__=pd;Hc.prototype=x(pd.prototype,{set_type:function(a){this.zpp_inner.immutable_midstep("Body::type");Gc.types[this.zpp_inner.type]!=a&&(null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1),a==g.BodyType_DYNAMIC?a=g.id_BodyType_DYNAMIC:(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1),a=a==
g.BodyType_KINEMATIC?g.id_BodyType_KINEMATIC:g.id_BodyType_STATIC),a==g.id_BodyType_STATIC&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,a):this.zpp_inner.type=a);return Gc.types[this.zpp_inner.type]},set_space:function(a){this.zpp_inner.immutable_midstep("Body::space");if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a){if(null!=
(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))this.zpp_inner.component.woken=!1;if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this);null!=a&&a.zpp_inner.wrap_bodies.add(this)}return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},get_position:function(){null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},set_position:function(a){null==
this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.set(a);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},set_velocity:function(a){null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();this.zpp_inner.wrap_vel.set(a);null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();return this.zpp_inner.wrap_vel},set_rotation:function(a){this.zpp_inner.immutable_midstep("Body::rotation");this.zpp_inner.rot!=a&&(this.zpp_inner.rot=
a,this.zpp_inner.invalidate_rot(),this.zpp_inner.wake());return this.zpp_inner.rot},set_angularVel:function(a){this.zpp_inner.angvel!=a&&(this.zpp_inner.angvel=a,this.zpp_inner.wake());return this.zpp_inner.angvel},set_allowRotation:function(a){this.zpp_inner.immutable_midstep("Body::"+(null==a?"null":""+a));!this.zpp_inner.norotate!=a&&(this.zpp_inner.norotate=!a,this.zpp_inner.invalidate_inertia());return!this.zpp_inner.norotate},set_inertia:function(a){this.zpp_inner.immutable_midstep("Body::inertia");
this.zpp_inner.inertiaMode=g.id_InertiaMode_FIXED;this.zpp_inner.cinertia=a;this.zpp_inner.invalidate_inertia();this.zpp_inner.validate_inertia();return this.zpp_inner.cinertia},applyImpulse:function(a,b,c){null==c&&(c=!1);if(c&&this.zpp_inner.component.sleeping)return a.zpp_inner.weak?(a.dispose(),!0):!1,null!=b&&(b.zpp_inner.weak?(b.dispose(),!0):!1),this;this.zpp_inner.validate_mass();var d=this.zpp_inner.imass,e=this.zpp_inner,f=this.zpp_inner.velx;a.zpp_inner.validate();e.velx=f+a.zpp_inner.x*
d;e=this.zpp_inner;f=this.zpp_inner.vely;a.zpp_inner.validate();e.vely=f+a.zpp_inner.y*d;if(null!=b){var i=0,d=0;b.zpp_inner.validate();i=b.zpp_inner.x-this.zpp_inner.posx;b.zpp_inner.validate();d=b.zpp_inner.y-this.zpp_inner.posy;this.zpp_inner.validate_inertia();e=this.zpp_inner;f=this.zpp_inner.angvel;a.zpp_inner.validate();i*=a.zpp_inner.y;a.zpp_inner.validate();e.angvel=f+(i-a.zpp_inner.x*d)*this.zpp_inner.iinertia;b.zpp_inner.weak?(b.dispose(),!0):!1}c||this.zpp_inner.type==g.id_BodyType_DYNAMIC&&
this.zpp_inner.wake();a.zpp_inner.weak?(a.dispose(),!0):!1;return this},applyAngularImpulse:function(a,b){null==b&&(b=!1);if(b&&this.zpp_inner.component.sleeping)return this;this.zpp_inner.validate_inertia();this.zpp_inner.angvel+=a*this.zpp_inner.iinertia;b||this.zpp_inner.type==g.id_BodyType_DYNAMIC&&this.zpp_inner.wake();return this},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==g.id_BodyType_DYNAMIC?"dynamic":this.zpp_inner.type==g.id_BodyType_STATIC?
"static":"kinematic"))+")#"+this.zpp_inner_i.id},__class__:Hc,__properties__:x(pd.prototype.__properties__,{set_inertia:"set_inertia",set_allowRotation:"set_allowRotation",set_angularVel:"set_angularVel",set_rotation:"set_rotation",set_velocity:"set_velocity",set_position:"set_position",get_position:"get_position",set_space:"set_space",set_type:"set_type"})});var qd=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.phys.BodyIterator"]=qd;qd.__name__=["nape",
"phys","BodyIterator"];qd.get=function(a){var b;null==qd.zpp_pool?(ac.internal=!0,b=new qd,ac.internal=!1):(b=qd.zpp_pool,qd.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};qd.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=qd.zpp_pool;qd.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:qd};
var fj=function(){this.zpp_inner=null;this.zpp_inner=new ac;this.zpp_inner.outer=this};h["nape.phys.BodyList"]=fj;fj.__name__=["nape","phys","BodyList"];fj.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?
null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?
null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==
a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=qd.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:fj,__properties__:{get_length:"get_length"}};var Ga=function(){};h["nape.phys.BodyType"]=
Ga;Ga.__name__=["nape","phys","BodyType"];Ga.prototype={toString:function(){var a;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);this==g.BodyType_STATIC?a="STATIC":(null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1),this==g.BodyType_DYNAMIC?a="DYNAMIC":(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1),a=this==g.BodyType_KINEMATIC?"KINEMATIC":""));return a},__class__:Ga};var gj=function(){this.zpp_inner=
null};h["nape.phys.Compound"]=gj;gj.__name__=["nape","phys","Compound"];gj.__super__=pd;gj.prototype=x(pd.prototype,{toString:function(){return"Compound"+this.zpp_inner_i.id},__class__:gj});var rd=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.phys.CompoundIterator"]=rd;rd.__name__=["nape","phys","CompoundIterator"];rd.get=function(a){var b;null==rd.zpp_pool?(Bb.internal=!0,b=new rd,Bb.internal=!1):(b=rd.zpp_pool,rd.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=
a;b.zpp_critical=!1;return b};rd.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=rd.zpp_pool;rd.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:rd};var hj=function(){this.zpp_inner=null;this.zpp_inner=new Bb;this.zpp_inner.outer=this};h["nape.phys.CompoundList"]=hj;hj.__name__=["nape","phys","CompoundList"];
hj.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,
this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=rd.get(this);c.hasNext();){var d;
c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:hj,__properties__:{get_length:"get_length"}};var Dk=function(){this.zpp_inner=null};h["nape.phys.FluidProperties"]=Dk;Dk.__name__=["nape","phys","FluidProperties"];Dk.prototype={toString:function(){return"{ density: "+1E3*this.zpp_inner.density+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+r.string(this.zpp_inner.wrap_gravity)+" }"},__class__:Dk};var xf=function(){};h["nape.phys.GravMassMode"]=
xf;xf.__name__=["nape","phys","GravMassMode"];xf.prototype={toString:function(){var a;null==g.GravMassMode_DEFAULT&&(g.internal=!0,g.GravMassMode_DEFAULT=new xf,g.internal=!1);this==g.GravMassMode_DEFAULT?a="DEFAULT":(null==g.GravMassMode_FIXED&&(g.internal=!0,g.GravMassMode_FIXED=new xf,g.internal=!1),this==g.GravMassMode_FIXED?a="FIXED":(null==g.GravMassMode_SCALED&&(g.internal=!0,g.GravMassMode_SCALED=new xf,g.internal=!1),a=this==g.GravMassMode_SCALED?"SCALED":""));return a},__class__:xf};var Gg=
function(){};h["nape.phys.InertiaMode"]=Gg;Gg.__name__=["nape","phys","InertiaMode"];Gg.prototype={toString:function(){var a;null==g.InertiaMode_DEFAULT&&(g.internal=!0,g.InertiaMode_DEFAULT=new Gg,g.internal=!1);this==g.InertiaMode_DEFAULT?a="DEFAULT":(null==g.InertiaMode_FIXED&&(g.internal=!0,g.InertiaMode_FIXED=new Gg,g.internal=!1),a=this==g.InertiaMode_FIXED?"FIXED":"");return a},__class__:Gg};var mb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.phys.InteractorIterator"]=
mb;mb.__name__=["nape","phys","InteractorIterator"];mb.get=function(a){var b;null==mb.zpp_pool?(yf.internal=!0,b=new mb,yf.internal=!1):(b=mb.zpp_pool,mb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};mb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=mb.zpp_pool;mb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},
__class__:mb};var Ek=function(){this.zpp_inner=null};h["nape.phys.InteractorList"]=Ek;Ek.__name__=["nape","phys","InteractorList"];Ek.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer_i},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=mb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Ek,__properties__:{get_length:"get_length"}};var Hg=function(){};
h["nape.phys.MassMode"]=Hg;Hg.__name__=["nape","phys","MassMode"];Hg.prototype={toString:function(){var a;null==g.MassMode_DEFAULT&&(g.internal=!0,g.MassMode_DEFAULT=new Hg,g.internal=!1);this==g.MassMode_DEFAULT?a="DEFAULT":(null==g.MassMode_FIXED&&(g.internal=!0,g.MassMode_FIXED=new Hg,g.internal=!1),a=this==g.MassMode_FIXED?"FIXED":"");return a},__class__:Hg};var ra=function(a,b,c,d,e){null==e&&(e=0.001);null==d&&(d=1);null==c&&(c=2);null==b&&(b=1);null==a&&(a=0);this.zpp_inner=null;null==na.zpp_pool?
this.zpp_inner=new na:(this.zpp_inner=na.zpp_pool,na.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;a!=this.zpp_inner.elasticity&&(this.zpp_inner.elasticity=a/1,this.zpp_inner.invalidate(na.WAKE|na.ARBITERS));this.zpp_inner.elasticity;b!=this.zpp_inner.dynamicFriction&&(this.zpp_inner.dynamicFriction=b/1,this.zpp_inner.invalidate(na.WAKE|na.ANGDRAG|na.ARBITERS));this.zpp_inner.dynamicFriction;c!=this.zpp_inner.staticFriction&&(this.zpp_inner.staticFriction=c/
1,this.zpp_inner.invalidate(na.WAKE|na.ARBITERS));this.zpp_inner.staticFriction;d!=1E3*this.zpp_inner.density&&(this.zpp_inner.density=d/1E3,this.zpp_inner.invalidate(na.WAKE|na.PROPS));1E3*this.zpp_inner.density;e!=this.zpp_inner.rollingFriction&&(this.zpp_inner.rollingFriction=e/1,this.zpp_inner.invalidate(na.WAKE|na.ARBITERS));this.zpp_inner.rollingFriction};h["nape.phys.Material"]=ra;ra.__name__=["nape","phys","Material"];ra.wood=function(){return new ra(0.4,0.2,0.38,0.7,0.005)};ra.steel=function(){return new ra(0.2,
0.57,0.74,7.8,0.001)};ra.ice=function(){return new ra(0.3,0.03,0.1,0.9,1.0E-4)};ra.rubber=function(){return new ra(0.8,1,1.4,1.5,0.01)};ra.glass=function(){return new ra(0.4,0.4,0.94,2.6,0.002)};ra.sand=function(){return new ra(-1,0.45,0.6,1.6,16)};ra.prototype={toString:function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+1E3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+
" }"},__class__:ra};var sd=function(){this.zpp_inner_i=this.zpp_inner=null};h["nape.shape.Shape"]=sd;sd.__name__=["nape","shape","Shape"];sd.__super__=pd;sd.prototype=x(pd.prototype,{get_body:function(){return null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},set_sensorEnabled:function(a){this.zpp_inner.immutable_midstep("Shape::sensorEnabled");this.zpp_inner.sensorEnabled=a;this.zpp_inner.wake();return this.zpp_inner.sensorEnabled},toString:function(){return(this.zpp_inner.type==g.id_ShapeType_CIRCLE?
"Circle":"Polygon")+"#"+this.zpp_inner_i.id},__class__:sd,__properties__:x(pd.prototype.__properties__,{set_sensorEnabled:"set_sensorEnabled",get_body:"get_body"})});var Jg=function(a,b,c,d){this.zpp_inner_zn=null;sd.call(this);this.zpp_inner_zn=new Ig;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;this.zpp_inner.immutable_midstep("Circle::radius");a!=this.zpp_inner_zn.radius&&(this.zpp_inner_zn.radius=a,
this.zpp_inner_zn.invalidate_radius());this.zpp_inner_zn.radius;null==b?(this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0):(b.zpp_inner.validate(),this.zpp_inner.localCOMx=b.zpp_inner.x,b.zpp_inner.validate(),this.zpp_inner.localCOMy=b.zpp_inner.y,b.zpp_inner.weak?(b.dispose(),!0):!1);null==c?(null==na.zpp_pool?this.zpp_inner.material=new na:(this.zpp_inner.material=na.zpp_pool,na.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null):(this.zpp_inner.immutable_midstep("Shape::material"),
this.zpp_inner.setMaterial(c.zpp_inner),this.zpp_inner.material.wrapper());null==d?(null==tb.zpp_pool?this.zpp_inner.filter=new tb:(this.zpp_inner.filter=tb.zpp_pool,tb.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null):(this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(d.zpp_inner),this.zpp_inner.filter.wrapper());this.zpp_inner_i.insert_cbtype(La.ANY_SHAPE.zpp_inner)};h["nape.shape.Circle"]=Jg;Jg.__name__=["nape","shape","Circle"];Jg.__super__=sd;
Jg.prototype=x(sd.prototype,{__class__:Jg});var ij=function(){this.zpp_inner=null};h["nape.shape.Edge"]=ij;ij.__name__=["nape","shape","Edge"];ij.prototype={toString:function(){if(null==this.zpp_inner.polygon)return"Edge(object-pooled)";if(null==this.zpp_inner.polygon.body)return this.zpp_inner.polygon.validate_laxi(),"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }";this.zpp_inner.polygon.validate_gaxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+
" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" }")+" }"},__class__:ij};var Ic=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};h["nape.shape.EdgeIterator"]=Ic;Ic.__name__=["nape","shape","EdgeIterator"];Ic.get=function(a){var b;null==Ic.zpp_pool?(zf.internal=!0,b=new Ic,zf.internal=!1):(b=Ic.zpp_pool,Ic.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Ic.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();
var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Ic.zpp_pool;Ic.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Ic};var Fk=function(){this.zpp_inner=null};h["nape.shape.EdgeList"]=Fk;Fk.__name__=["nape","shape","EdgeList"];Fk.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);
return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&a!=this.get_length()-1&&(a=this.get_length()-2-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();
for(c=Ic.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Fk,__properties__:{get_length:"get_length"}};var Nb=function(a,b,c){this.zpp_inner_zn=null;sd.call(this);this.zpp_inner_zn=new Kg;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;if(a instanceof Array&&null==a.__enum__)for(var d=0;d<a.length;){var e=
a[d];++d;var f=e;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(Va.get(function(){f.zpp_inner.validate();return f.zpp_inner.x}(this),function(){f.zpp_inner.validate();return f.zpp_inner.y}(this),!1))}else if(w.__instanceof(a,je))for(d=a.iterator();d.hasNext();){var i;d.zpp_critical=!1;i=d.zpp_inner.at(d.zpp_i++);null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(Va.get(function(){i.zpp_inner.validate();
return i.zpp_inner.x}(this),function(){i.zpp_inner.validate();return i.zpp_inner.y}(this),!1))}else if(w.__instanceof(a,ej)&&(d=a.zpp_inner.vertices,null!=d)){e=d;do{var g=Va.get(e.x,e.y,null),e=e.next;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(Va.get(function(){g.zpp_inner.validate();return g.zpp_inner.x}(this),function(){g.zpp_inner.validate();return g.zpp_inner.y}(this),!1));g.dispose()}while(e!=d)}if(a instanceof Array&&null==a.__enum__)for(d=
0;d<a.length;){var e=a[d],o;if(o=e.zpp_inner.weak)e.dispose(),o=!0;o?a.splice(d,1):d++}else if(w.__instanceof(a,je)){null!=a.zpp_inner._validate&&a.zpp_inner._validate();a=a.zpp_inner.inner;d=null;for(e=a.head;null!=e;)o=e.elt,o.outer.zpp_inner.weak?(e=a.erase(d),o.outer.zpp_inner.weak?(o.outer.dispose(),!0):!1):(d=e,e=e.next)}null==b?(null==na.zpp_pool?this.zpp_inner.material=new na:(this.zpp_inner.material=na.zpp_pool,na.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null):
(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(b.zpp_inner),this.zpp_inner.material.wrapper());null==c?(null==tb.zpp_pool?this.zpp_inner.filter=new tb:(this.zpp_inner.filter=tb.zpp_pool,tb.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null):(this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(c.zpp_inner),this.zpp_inner.filter.wrapper());this.zpp_inner_i.insert_cbtype(La.ANY_SHAPE.zpp_inner)};h["nape.shape.Polygon"]=Nb;
Nb.__name__=["nape","shape","Polygon"];Nb.rect=function(a,b,c,d,e){null==e&&(e=!1);return[Va.get(a,b,e),Va.get(a+c,b,e),Va.get(a+c,b+d,e),Va.get(a,b+d,e)]};Nb.box=function(a,b,c){null==c&&(c=!1);return Nb.rect(-a/2,-b/2,a,b,c)};Nb.regular=function(a,b,c,d,e){null==e&&(e=!1);null==d&&(d=0);for(var f=[],i=2*Math.PI/c,g=0;g<c;){var o=g++*i+d,o=Va.get(Math.cos(o)*a,Math.sin(o)*b,e);f.push(o)}return f};Nb.__super__=sd;Nb.prototype=x(sd.prototype,{__class__:Nb});var Jc=function(){this.zpp_next=null;this.zpp_critical=
!1;this.zpp_i=0;this.zpp_inner=null};h["nape.shape.ShapeIterator"]=Jc;Jc.__name__=["nape","shape","ShapeIterator"];Jc.get=function(a){var b;null==Jc.zpp_pool?(Cb.internal=!0,b=new Jc,Cb.internal=!1):(b=Jc.zpp_pool,Jc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Jc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Jc.zpp_pool;Jc.zpp_pool=this;this.zpp_inner=null;return!1},
next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Jc};var jj=function(){this.zpp_inner=null;this.zpp_inner=new Cb;this.zpp_inner.outer=this};h["nape.shape.ShapeList"]=jj;jj.__name__=["nape","shape","ShapeList"];jj.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&
(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):
(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?
(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();
this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Jc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:jj,
__properties__:{get_length:"get_length"}};var Lg=function(){};h["nape.shape.ShapeType"]=Lg;Lg.__name__=["nape","shape","ShapeType"];Lg.prototype={toString:function(){var a;null==g.ShapeType_CIRCLE&&(g.internal=!0,g.ShapeType_CIRCLE=new Lg,g.internal=!1);this==g.ShapeType_CIRCLE?a="CIRCLE":(null==g.ShapeType_POLYGON&&(g.internal=!0,g.ShapeType_POLYGON=new Lg,g.internal=!1),a=this==g.ShapeType_POLYGON?"POLYGON":"");return a},__class__:Lg};var Fe=function(){};h["nape.shape.ValidationResult"]=Fe;Fe.__name__=
["nape","shape","ValidationResult"];Fe.prototype={toString:function(){var a;null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new Fe,g.internal=!1);this==g.ValidationResult_VALID?a="VALID":(null==g.ValidationResult_DEGENERATE&&(g.internal=!0,g.ValidationResult_DEGENERATE=new Fe,g.internal=!1),this==g.ValidationResult_DEGENERATE?a="DEGENERATE":(null==g.ValidationResult_CONCAVE&&(g.internal=!0,g.ValidationResult_CONCAVE=new Fe,g.internal=!1),this==g.ValidationResult_CONCAVE?a=
"CONCAVE":(null==g.ValidationResult_SELF_INTERSECTING&&(g.internal=!0,g.ValidationResult_SELF_INTERSECTING=new Fe,g.internal=!1),a=this==g.ValidationResult_SELF_INTERSECTING?"SELF_INTERSECTING":"")));return a},__class__:Fe};var Ge=function(){};h["nape.space.Broadphase"]=Ge;Ge.__name__=["nape","space","Broadphase"];Ge.prototype={toString:function(){var a;null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new Ge,g.internal=!1);this==g.Broadphase_DYNAMIC_AABB_TREE?a=
"DYNAMIC_AABB_TREE":(null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new Ge,g.internal=!1),a=this==g.Broadphase_SWEEP_AND_PRUNE?"SWEEP_AND_PRUNE":"");return a},__class__:Ge};var lj=function(a,b){this.zpp_inner=null;this.zpp_inner=new kj(null==a?null:a.zpp_inner,b);this.zpp_inner.outer=this;null!=a&&(a.zpp_inner.weak?(a.dispose(),!0):!1)};h["nape.space.Space"]=lj;lj.__name__=["nape","space","Space"];lj.prototype={step:function(a,b,c){null==c&&(c=10);null==b&&(b=10);
this.zpp_inner.step(a,b,c)},__class__:lj};var ke=function(a){this.time=0;null!=a&&(this.id=a.has.resolve("id")?r.parseInt(a.att.resolve("id")):0,this.time=a.has.resolve("time")?r.parseInt(a.att.resolve("time")):0,this.curveType=a.has.resolve("curve_type")?Y.createEnum(sa,a.att.resolve("curve_type").toUpperCase()):sa.LINEAR,this.c1=a.has.resolve("c1")?r.parseFloat(a.att.resolve("c1")):0,this.c2=a.has.resolve("c2")?r.parseFloat(a.att.resolve("c2")):0)};h["spriter.definitions.TimelineKey"]=ke;ke.__name__=
["spriter","definitions","TimelineKey"];ke.prototype={copy:function(){return this.clone(new ke)},clone:function(a){a.id=this.id;a.time=this.time;a.curveType=this.curveType;a.c1=this.c1;a.c2=this.c2;return a},interpolate:function(a,b,c){this.linearKey(a,this.getTWithNextKey(a,b,c))},getTWithNextKey:function(a,b,c){if(this.curveType==sa.INSTANT||this.time==a.time)return 0;a=(c-this.time)/(a.time-this.time);return this.curveType==sa.LINEAR?a:this.curveType==sa.QUADRATIC?this.quadratic(0,this.c1,1,a):
this.curveType==sa.CUBIC?this.cubic(0,this.c1,this.c2,1,a):0},linear:function(a,b,c){return(b-a)*c+a},linearKey:function(){null},angleLinear:function(a,b,c,d){if(0==c)return a;0<c?0>b-a&&(b+=360):0>c&&0<b-a&&(b-=360);return this.linear(a,b,d)},quadratic:function(a,b,c,d){return this.linear(this.linear(a,b,d),this.linear(b,c,d),d)},cubic:function(a,b,c,d,e){return this.linear(this.quadratic(a,b,c,e),this.quadratic(b,c,d,e),e)},__class__:ke};var tc=function(a){ke.call(this,a);if(null!=a){var b;b=a.has.resolve("spin")?
r.parseInt(a.att.resolve("spin")):1;var a=a.hasNode.resolve("object")?a.node.resolve("object"):a.node.resolve("bone"),c;c=a.has.resolve("x")?r.parseFloat(a.att.resolve("x")):0;var d;d=a.has.resolve("y")?r.parseFloat(a.att.resolve("y")):0;var e;e=a.has.resolve("angle")?r.parseFloat(a.att.resolve("angle")):0;var f;f=a.has.resolve("scale_x")?r.parseFloat(a.att.resolve("scale_x")):1;var i;i=a.has.resolve("scale_y")?r.parseFloat(a.att.resolve("scale_y")):1;a=a.has.resolve("a")?r.parseFloat(a.att.resolve("a")):
1;this.info=new Hd(c,d,e,f,i,a,b)}};h["spriter.definitions.SpatialTimelineKey"]=tc;tc.__name__=["spriter","definitions","SpatialTimelineKey"];tc.__super__=ke;tc.prototype=x(ke.prototype,{copy:function(){return this.clone(new tc)},clone:function(a){ke.prototype.clone.call(this,a);a.info=this.info.copy();return a},linearSpatialInfo:function(a,b,c,d){this.info.x=this.linear(a.x,b.x,d);this.info.y=this.linear(a.y,b.y,d);this.info.angle=this.angleLinear(a.angle,b.angle,c,d);this.info.scaleX=this.linear(a.scaleX,
b.scaleX,d);this.info.scaleY=this.linear(a.scaleY,b.scaleY,d);this.info.a=this.linear(a.a,b.a,d)},paint:function(a,b){return new cd(a,b)},__class__:tc});var Id=function(a){this.paintDebugBones=!0;null!=a&&(this.length=a.has.resolve("length")?r.parseInt(a.att.resolve("length")):200,this.width=a.has.resolve("width")?r.parseInt(a.att.resolve("width")):10);tc.call(this,a)};h["spriter.definitions.BoneTimelineKey"]=Id;Id.__name__=["spriter","definitions","BoneTimelineKey"];Id.__super__=tc;Id.prototype=
x(tc.prototype,{copy:function(){return this.clone(new Id)},clone:function(a){tc.prototype.clone.call(this,a);a.length=this.length;a.width=this.width;a.paintDebugBones=this.paintDebugBones;return a},paint:function(a,b){return new cd(a,b)},linearKey:function(a,b){if(!w.__instanceof(a,Id))throw new p("keyB must be BoneTimelineKeys");var c;c=w.__cast(a,Id);this.linearSpatialInfo(this.info,c.info,this.info.spin,b);this.paintDebugBones&&(this.length=r["int"](this.linear(this.length,c.length,b)),this.width=
r["int"](this.linear(this.width,c.width,b)))},__class__:Id});var nj=function(a){this.maps=[];this.id=r.parseInt(a.att.resolve("id"));this.name=a.att.resolve("name");for(a=a.nodes.resolve("map").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.maps.push(new mj(a.val))};h["spriter.definitions.CharacterMap"]=nj;nj.__name__=["spriter","definitions","CharacterMap"];nj.prototype={__class__:nj};var oj=function(a){this.boneRefs=[];this.objectRefs=[];this.id=r.parseInt(a.att.resolve("id"));this.time=
a.has.resolve("time")?r.parseInt(a.att.resolve("time")):0;for(var b=a.nodes.resolve("bone_ref").iterator();null!=b.head;)b.val=b.head[0],b.head=b.head[1],this.boneRefs.push(new Mg(b.val));for(a=a.nodes.resolve("object_ref").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.objectRefs.push(new Mg(a.val))};h["spriter.definitions.MainlineKey"]=oj;oj.__name__=["spriter","definitions","MainlineKey"];oj.prototype={__class__:oj};var mj=function(a){this.folder=r.parseInt(a.att.resolve("folder"));
this.file=r.parseInt(a.att.resolve("file"));this.tarFolder=a.has.resolve("target_folder")?r.parseInt(a.att.resolve("target_folder")):-1;this.tarFile=a.has.resolve("target_file")?r.parseInt(a.att.resolve("target_file")):-1};h["spriter.definitions.MapInstruction"]=mj;mj.__name__=["spriter","definitions","MapInstruction"];mj.prototype={__class__:mj};var Ha=function(a,b){tc.call(this,a);null!=a&&(this.type=b,a=a.node.resolve("object"),this.useDefaultPivot=!a.has.resolve("pivot_x")&&!a.has.resolve("pivot_y"),
this.pivot_x=a.has.resolve("pivot_x")?r.parseFloat(a.att.resolve("pivot_x")):0,this.pivot_y=a.has.resolve("pivot_y")?r.parseFloat(a.att.resolve("pivot_y")):1)};h["spriter.definitions.ObjectTimelineKey"]=Ha;Ha.__name__=["spriter","definitions","ObjectTimelineKey"];Ha.__super__=tc;Ha.prototype=x(tc.prototype,{copy:function(){return this.clone(new Ha)},clone:function(a){tc.prototype.clone.call(this,a);a.useDefaultPivot=this.useDefaultPivot;a.pivot_x=this.pivot_x;a.pivot_y=this.pivot_y;a.type=this.type;
return a},paint:function(a,b){var c,d;this.useDefaultPivot?(c=a,d=b):(c=this.pivot_x,d=this.pivot_y);return new cd(c,d)},linearKey:function(a,b){if(!w.__instanceof(a,Ha))throw new p("keyB must be ObjectTimelineKey");var c;c=w.__cast(a,Ha);this.linearSpatialInfo(this.info,c.info,this.info.spin,b);this.useDefaultPivot||(this.pivot_x=this.linear(this.pivot_x,c.pivot_x,b),this.pivot_y=this.linear(this.pivot_y,c.pivot_y,b))},__class__:Ha});var cd=function(a,b){null==b&&(b=1);null==a&&(a=0);this.pivotX=
a;this.pivotY=b};h["spriter.definitions.PivotInfo"]=cd;cd.__name__=["spriter","definitions","PivotInfo"];cd.prototype={__class__:cd};var pj=function(a,b,c,d){this.p1=a;this.p2=b;this.p3=c;this.p4=d};h["spriter.definitions.Quadrilateral"]=pj;pj.__name__=["spriter","definitions","Quadrilateral"];pj.prototype={__class__:pj};var He=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};h["spriter.definitions.QuadPoint"]=He;He.__name__=["spriter","definitions","QuadPoint"];He.prototype={__class__:He};
var Mg=function(a){this.id=r.parseInt(a.att.resolve("id"));this.parent=a.has.resolve("parent")?r.parseInt(a.att.resolve("parent")):-1;this.timeline=r.parseInt(a.att.resolve("timeline"));this.key=r.parseInt(a.att.resolve("key"))};h["spriter.definitions.Ref"]=Mg;Mg.__name__=["spriter","definitions","Ref"];Mg.prototype={__class__:Mg};var P=h["spriter.definitions.MetaDispatch"]={__ename__:["spriter","definitions","MetaDispatch"],__constructs__:["ONCE","ONCE_PER_LOOP","ALWAYS"]};P.ONCE=["ONCE",0];P.ONCE.toString=
l;P.ONCE.__enum__=P;P.ONCE_PER_LOOP=["ONCE_PER_LOOP",1];P.ONCE_PER_LOOP.toString=l;P.ONCE_PER_LOOP.__enum__=P;P.ALWAYS=["ALWAYS",2];P.ALWAYS.toString=l;P.ALWAYS.__enum__=P;P.__empty_constructs__=[P.ONCE,P.ONCE_PER_LOOP,P.ALWAYS];var qj=function(){};h["spriter.interfaces.IScml"]=qj;qj.__name__=["spriter","interfaces","IScml"];qj.prototype={__class__:qj};var Og=function(a){this.metaDispatch=P.ONCE_PER_LOOP;this.endAnimRemoval=!0;this.currentEntity=this.currentAnimation="";if(null!=a){this.folders=[];
this.entities=new M;a=new Be(a.firstElement());"1.0"!=a.att.resolve("scml_version")&&null;for(a=a.get_elements();a.hasNext();){var b=a.next();if("folder"==b.get_name())this.folders.push(new Ng(b));else if("entity"==b.get_name()){var c=b.att.resolve("name"),d=new rj(b);this.entities.set(c,d);"0"==b.att.resolve("id")&&(this.currentEntity=b.att.resolve("name"),this.currentAnimation=b.node.resolve("animation").att.resolve("name"))}else if("tag_list"==b.get_name()){null==this.tags&&(this.tags=[]);for(b=
b.get_elements();b.hasNext();)this.tags.push(b.next().att.resolve("name"))}}this.activeCharacterMap=this.copyFolders()}};h["spriter.definitions.ScmlObject"]=Og;Og.__name__=["spriter","definitions","ScmlObject"];Og.__interfaces__=[qj];Og.prototype={getPivots:function(a,b){var c=this.activeCharacterMap[a].files[b];return null!=c?new cd(c.pivotX,c.pivotY):new cd},getFileName:function(a,b){var c=this.activeCharacterMap[a].files[b];return null!=c?c.name:null},onEndAnim:function(){if(null!=this.endAnimCallback){var a=
this.endAnimCallback;this.endAnimRemoval&&(this.endAnimCallback=null);a()}},onTag:function(a){null!=this.tagCallback&&this.tagCallback(this.tags[a])},onVar:function(a,b){var c=this.entities.get(this.currentEntity).variables[a];c.set(b)&&null!=this.varChangeCallback&&this.varChangeCallback(c)},setCurrentTime:function(a,b,c){var d=this.entities.get(this.currentEntity),e=d.animations.get(this.currentAnimation);this.spriterSpatialInfo=c;e.setCurrentTime(a,b,this,d)},copyFolders:function(){for(var a=[],
b=0,c=this.folders.length;b<c;){var d=b++;a[d]=this.folders[d].copy()}return a},__class__:Og};var Hd=function(a,b,c,d,e,f,i){null==i&&(i=1);null==f&&(f=1);null==e&&(e=1);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.scaleX=this.scaleY=this.a=this.spin=1;this.x=this.y=this.angle=0;this.x=a;this.y=b;this.angle=c;this.scaleX=d;this.scaleY=e;this.a=f;this.spin=i};h["spriter.definitions.SpatialInfo"]=Hd;Hd.__name__=["spriter","definitions","SpatialInfo"];Hd.prototype={unmapFromParent:function(a){var b,
c;c=0>a.scaleX*a.scaleY?360-this.angle+a.angle:this.angle+a.angle;var d=this.scaleX*a.scaleX,e=this.scaleY*a.scaleY,f=this.a*a.a;if(0!=this.x||0!=this.y){var i=this.x*a.scaleX,g=this.y*a.scaleY;b=Kc.toRadians(Kc.under360(a.angle));var o=Math.sin(b),h=Math.cos(b);b=i*h-g*o+a.x;a=i*o+g*h+a.y}else b=a.x,a=a.y;return new Hd(b,a,c,d,e,f,this.spin)},copy:function(){return new Hd(this.x,this.y,this.angle,this.scaleX,this.scaleY,this.a,this.spin)},__class__:Hd};var le=function(a){Ha.call(this,a);null!=a&&
(a=a.node.resolve("object"),this.folder=a.has.resolve("folder")?r.parseInt(a.att.resolve("folder")):0,this.file=a.has.resolve("file")?r.parseInt(a.att.resolve("file")):0)};h["spriter.definitions.SpriteTimelineKey"]=le;le.__name__=["spriter","definitions","SpriteTimelineKey"];le.__super__=Ha;le.prototype=x(Ha.prototype,{copy:function(){return this.clone(new le)},clone:function(a){Ha.prototype.clone.call(this,a);a.folder=this.folder;a.file=this.file;a.useDefaultPivot=this.useDefaultPivot;a.pivot_x=
this.pivot_x;a.pivot_y=this.pivot_y;return a},__class__:le});var Ia=h["spriter.definitions.LoopType"]={__ename__:["spriter","definitions","LoopType"],__constructs__:["LOOPING","NO_LOOPING"]};Ia.LOOPING=["LOOPING",0];Ia.LOOPING.toString=l;Ia.LOOPING.__enum__=Ia;Ia.NO_LOOPING=["NO_LOOPING",1];Ia.NO_LOOPING.toString=l;Ia.NO_LOOPING.__enum__=Ia;Ia.__empty_constructs__=[Ia.LOOPING,Ia.NO_LOOPING];var vj=function(a){this.loop=0;this.mainlineKeys=[];this.timelines=[];this.id=r.parseInt(a.att.resolve("id"));
this.name=a.att.resolve("name");this.length=r.parseInt(a.att.resolve("length"));this.loopType=a.has.resolve("looping")?"true"==a.att.resolve("looping")?Ia.LOOPING:Ia.NO_LOOPING:Ia.LOOPING;for(var b=a.node.resolve("mainline").nodes.resolve("key").iterator();null!=b.head;)b.val=b.head[0],b.head=b.head[1],this.mainlineKeys.push(new oj(b.val));for(b=a.nodes.resolve("timeline").iterator();null!=b.head;)b.val=b.head[0],b.head=b.head[1],this.timelines.push(new sj(b.val));if(a.hasNode.resolve("meta")){a=
a.node.resolve("meta");if(a.hasNode.resolve("tagline")){this.taglines=[];for(b=a.node.resolve("tagline").nodes.resolve("key").iterator();null!=b.head;)b.val=b.head[0],b.head=b.head[1],this.taglines.push(new tj(b.val))}if(a.hasNode.resolve("varline")){this.varlines=[];for(a=a.nodes.resolve("varline").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.varlines.push(new uj(a.val))}}};h["spriter.definitions.SpriterAnimation"]=vj;vj.__name__=["spriter","definitions","SpriterAnimation"];vj.prototype=
{setCurrentTime:function(a,b,c,d){var e;switch(this.loopType[1]){case 0:e=this.loop;this.loop=a/this.length|0;a%=this.length;this.updateCharacter(this.mainlineKeyFromTime(a),a,b,c,d);c.metaDispatch==P.ONCE_PER_LOOP&&e!=this.loop&&this.resetMetaDispatch();if(1==this.loop&&1>e)c.onEndAnim();break;case 1:if(a=r["int"](Math.min(a,this.length)),this.updateCharacter(this.mainlineKeyFromTime(a),a,b,c,d),a==this.length)c.onEndAnim()}},updateCharacter:function(a,b,c,d,e){for(var f=[],i,g,o,h=a.boneRefs.length,
j=0;j<h;)o=j++,g=a.boneRefs[o],i=this.keyFromRef(g,b),o=0<=g.parent?f[g.parent]:d.spriterSpatialInfo,o=i.info.unmapFromParent(o),f.push(o);this.points=[];this.boxes=[];h=a.objectRefs.length;for(j=0;j<h;){o=j++;g=a.objectRefs[o];i=this.keyFromRef(g,b);o=0<=g.parent?f[g.parent]:d.spriterSpatialInfo;o=i.info.unmapFromParent(o);var k;if(w.__instanceof(i,le)){var l;l=w.__cast(i,le);k=d.getPivots(l.folder,l.file);k=i.paint(k.pivotX,k.pivotY);i=d.getFileName(l.folder,l.file);null!=i&&c.addGraphic(d.spriterName,
g.timeline,g.key,i,o,k)}else k=new cd,k=i.paint(k.pivotX,k.pivotY),w.__cast(i,Ha).type==oa.POINT?this.points.push(c.compute(o,k,0,0)):(g=this.getTimelineName(g.timeline),g=e.boxes_info.get(g),this.boxes.push(c.computeRectCoordinates(o,k,g.width,g.height)))}if(null!=this.taglines){b=0;for(c=this.taglines;b<c.length;)if(e=c[b],++b,e.time==a.time)if(d.metaDispatch==P.ALWAYS)d.onTag(e.id);else d.metaDispatch==P.ONCE_PER_LOOP&&a.time!=e.get_lastDispatched()?(e.set_lastDispatched(a.time),d.onTag(e.id)):
d.metaDispatch==P.ONCE&&!e.get_dispatched()&&(e.set_lastDispatched(a.time),d.onTag(e.id))}if(null!=this.varlines){b=0;for(c=this.varlines;b<c.length;){e=c[b];++b;f=0;for(h=e.keys;f<h.length;)if(o=h[f],++f,o.time==a.time)if(d.metaDispatch==P.ALWAYS)d.onVar(e.id,o.value);else d.metaDispatch==P.ONCE_PER_LOOP&&a.time!=o.get_lastDispatched()?(o.set_lastDispatched(a.time),d.onVar(e.id,o.value)):d.metaDispatch==P.ONCE&&!o.get_dispatched()&&(o.set_lastDispatched(a.time),d.onVar(e.id,o.value))}}},mainlineKeyFromTime:function(a){for(var b=
0,c=this.mainlineKeys.length,d=0;d<c;){var e=d++;this.mainlineKeys[e].time<=a&&(b=e);if(this.mainlineKeys[e].time>=a)break}return this.mainlineKeys[b]},keyFromRef:function(a,b){var c=this.timelines[a.timeline],d=c.keys[a.key].copy();if(1==c.keys.length||d.curveType==sa.INSTANT)return d;var e=a.key+1;if(e>=c.keys.length)if(this.loopType==Ia.LOOPING)e=0;else return d;c=c.keys[e].copy();e=c.time;e<d.time&&(e+=this.length);d.interpolate(c,e,b);return d},getTimelineName:function(a){return this.timelines[a].name},
resetMetaDispatch:function(){if(null!=this.taglines)for(var a=0,b=this.taglines;a<b.length;){var c=b[a];++a;c.set_dispatched(!1)}},__class__:vj};var wj=function(a){null!=a&&(this.name=a.att.resolve("name"),this.pivotX=a.has.resolve("pivot_x")?r.parseFloat(a.att.resolve("pivot_x")):0,this.pivotY=a.has.resolve("pivot_y")?r.parseFloat(a.att.resolve("pivot_y")):0,this.width=a.has.resolve("w")?r.parseFloat(a.att.resolve("w")):0,this.height=a.has.resolve("h")?r.parseFloat(a.att.resolve("h")):0)};h["spriter.definitions.SpriterBox"]=
wj;wj.__name__=["spriter","definitions","SpriterBox"];wj.prototype={__class__:wj};var rj=function(a){this.characterMaps=new M;this.animations=new M;this.variables=[];this.boxes_info=new M;this.id=r.parseInt(a.att.resolve("id"));this.name=a.att.resolve("name");for(var b=a.nodes.resolve("character_map").iterator();null!=b.head;){var c;b.val=b.head[0];b.head=b.head[1];c=b.val;var d=c.att.resolve("name");c=new nj(c);this.characterMaps.set(d,c)}if(a.hasNode.resolve("var_defs"))for(b=a.node.resolve("var_defs").get_elements();b.hasNext();)switch(d=
b.next(),d.att.resolve("type")){case "int":this.variables.push(new Pg(d.att.resolve("name"),r.parseInt(d.att.resolve("default"))));break;case "string":this.variables.push(new Qg(d.att.resolve("name"),r.string(d.att.resolve("default"))));break;case "float":this.variables.push(new Rg(d.att.resolve("name"),r.parseFloat(d.att.resolve("default"))))}for(b=a.nodes.resolve("obj_info").iterator();null!=b.head;)b.val=b.head[0],b.head=b.head[1],c=b.val,d=c.att.resolve("name"),c=new wj(c),this.boxes_info.set(d,
c);for(a=a.nodes.resolve("animation").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],d=a.val,b=d.att.resolve("name"),d=new vj(d),this.animations.set(b,d)};h["spriter.definitions.SpriterEntity"]=rj;rj.__name__=["spriter","definitions","SpriterEntity"];rj.prototype={__class__:rj};var Sg=function(a){null!=a&&(this.id=r.parseInt(a.att.resolve("id")),this.name=a.att.resolve("name"),this.pivotX=a.has.resolve("pivot_x")?r.parseFloat(a.att.resolve("pivot_x")):0,this.pivotY=a.has.resolve("pivot_y")?
r.parseFloat(a.att.resolve("pivot_y")):1,this.width=a.has.resolve("width")?r.parseFloat(a.att.resolve("width")):0,this.height=a.has.resolve("height")?r.parseFloat(a.att.resolve("height")):0)};h["spriter.definitions.SpriterFile"]=Sg;Sg.__name__=["spriter","definitions","SpriterFile"];Sg.prototype={copy:function(){var a=new Sg;a.name=this.name;a.id=this.id;a.pivotX=this.pivotX;a.pivotY=this.pivotY;a.width=this.width;a.height=this.height;return a},__class__:Sg};var Ng=function(a){this.name="";this.files=
[];if(null!=a){this.id=r.parseInt(a.att.resolve("id"));a.hasNode.resolve("name")&&(this.name=a.att.resolve("name"));for(a=a.nodes.resolve("file").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.files.push(new Sg(a.val))}};h["spriter.definitions.SpriterFolder"]=Ng;Ng.__name__=["spriter","definitions","SpriterFolder"];Ng.prototype={copy:function(){var a=new Ng;a.name=this.name;a.id=this.id;for(var b=0,c=this.files.length;b<c;){var d=b++;a.files[d]=this.files[d].copy()}return a},__class__:Ng};
var oa=h["spriter.definitions.ObjectType"]={__ename__:["spriter","definitions","ObjectType"],__constructs__:"SPRITE,BONE,BOX,POINT,SOUND,ENTITY,VARIABLE".split(",")};oa.SPRITE=["SPRITE",0];oa.SPRITE.toString=l;oa.SPRITE.__enum__=oa;oa.BONE=["BONE",1];oa.BONE.toString=l;oa.BONE.__enum__=oa;oa.BOX=["BOX",2];oa.BOX.toString=l;oa.BOX.__enum__=oa;oa.POINT=["POINT",3];oa.POINT.toString=l;oa.POINT.__enum__=oa;oa.SOUND=["SOUND",4];oa.SOUND.toString=l;oa.SOUND.__enum__=oa;oa.ENTITY=["ENTITY",5];oa.ENTITY.toString=
l;oa.ENTITY.__enum__=oa;oa.VARIABLE=["VARIABLE",6];oa.VARIABLE.toString=l;oa.VARIABLE.__enum__=oa;oa.__empty_constructs__=[oa.SPRITE,oa.BONE,oa.BOX,oa.POINT,oa.SOUND,oa.ENTITY,oa.VARIABLE];var sj=function(a){this.keys=[];this.id=r.parseInt(a.att.resolve("id"));this.name=a.has.resolve("name")?a.att.resolve("name"):"";this.objectType=a.has.resolve("object_type")?Y.createEnum(oa,a.att.resolve("object_type").toUpperCase()):oa.SPRITE;switch(this.objectType[1]){case 0:for(a=a.nodes.resolve("key").iterator();null!=
a.head;)a.val=a.head[0],a.head=a.head[1],this.keys.push(new le(a.val));break;case 1:for(a=a.nodes.resolve("key").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.keys.push(new Id(a.val));break;case 3:for(a=a.nodes.resolve("key").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.keys.push(new Ha(a.val,this.objectType));break;case 2:for(a=a.nodes.resolve("key").iterator();null!=a.head;)a.val=a.head[0],a.head=a.head[1],this.keys.push(new Ha(a.val,this.objectType))}};h["spriter.definitions.SpriterTimeline"]=
sj;sj.__name__=["spriter","definitions","SpriterTimeline"];sj.prototype={__class__:sj};var tj=function(a){this._lastDispatched=-1;this._dispatched=!1;this.time=0;null!=a&&(this.id=a.has.resolve("id")?r.parseInt(a.att.resolve("id")):0,this.time=a.has.resolve("time")?r.parseInt(a.att.resolve("time")):0,a=a.node.resolve("tag"),this.t=r.parseInt(a.att.resolve("t")))};h["spriter.definitions.TaglineKey"]=tj;tj.__name__=["spriter","definitions","TaglineKey"];tj.prototype={set_lastDispatched:function(a){this._lastDispatched=
a;this._dispatched=-1!=a;return a},get_lastDispatched:function(){return this._lastDispatched},set_dispatched:function(a){this._dispatched=a;a||(this._lastDispatched=-1);return a},get_dispatched:function(){return this._dispatched},__class__:tj,__properties__:{set_lastDispatched:"set_lastDispatched",get_lastDispatched:"get_lastDispatched",set_dispatched:"set_dispatched",get_dispatched:"get_dispatched"}};var sa=h["spriter.definitions.CurveType"]={__ename__:["spriter","definitions","CurveType"],__constructs__:["INSTANT",
"LINEAR","QUADRATIC","CUBIC"]};sa.INSTANT=["INSTANT",0];sa.INSTANT.toString=l;sa.INSTANT.__enum__=sa;sa.LINEAR=["LINEAR",1];sa.LINEAR.toString=l;sa.LINEAR.__enum__=sa;sa.QUADRATIC=["QUADRATIC",2];sa.QUADRATIC.toString=l;sa.QUADRATIC.__enum__=sa;sa.CUBIC=["CUBIC",3];sa.CUBIC.toString=l;sa.CUBIC.__enum__=sa;sa.__empty_constructs__=[sa.INSTANT,sa.LINEAR,sa.QUADRATIC,sa.CUBIC];var uj=function(a){if(null!=a){this.id=r.parseInt(a.att.resolve("def"));this.keys=[];for(a=a.nodes.resolve("key").iterator();null!=
a.head;)a.val=a.head[0],a.head=a.head[1],this.keys.push(new xj(a.val))}};h["spriter.definitions.Varline"]=uj;uj.__name__=["spriter","definitions","Varline"];uj.prototype={__class__:uj};var xj=function(a){this._lastDispatched=-1;this._dispatched=!1;this.time=0;null!=a&&(this.id=a.has.resolve("id")?r.parseInt(a.att.resolve("id")):0,this.time=a.has.resolve("time")?r.parseInt(a.att.resolve("time")):0,this.value=a.att.resolve("val"))};h["spriter.definitions.VarlineKey"]=xj;xj.__name__=["spriter","definitions",
"VarlineKey"];xj.prototype={set_lastDispatched:function(a){this._lastDispatched=a;this._dispatched=-1!=a;return a},get_lastDispatched:function(){return this._lastDispatched},get_dispatched:function(){return this._dispatched},__class__:xj,__properties__:{set_lastDispatched:"set_lastDispatched",get_lastDispatched:"get_lastDispatched",get_dispatched:"get_dispatched"}};var yj=function(a,b,c,d){this.playbackSpeed=1;this.paused=!1;this.timeMS=0;this.scml=b;this.library=c;this.spriterName=a;this.scml.spriterName=
this.spriterName;this.info=d};h["spriter.engine.Spriter"]=yj;yj.__name__=["spriter","engine","Spriter"];yj.prototype={advanceTime:function(a){this.paused||(this.timeMS+=a*this.playbackSpeed|0);this.scml.setCurrentTime(this.timeMS,this.library,this.info)},playAnim:function(a,b,c){null==c&&(c=!0);if(null==a)return this.paused&&(this.paused=!1),this.timeMS=0,null!=b&&(this.scml.endAnimCallback=function(a,b,c,i){return function(){a(b,c,i)}}(b,this,this.scml.currentEntity,this.scml.currentAnimation),this.scml.endAnimRemoval=
c),!0;return this.scml.entities.get(this.scml.currentEntity).animations.exists(a)?(this.paused&&(this.paused=!1),this.timeMS=0,this.scml.currentAnimation=a,null!=b&&(this.scml.endAnimCallback=function(a,b,c,i){return function(){a(b,c,i)}}(b,this,this.scml.currentEntity,a),this.scml.endAnimRemoval=c),!0):!1},timeReset:function(){this.timeMS=0},__class__:yj};var Tg=function(a,b,c,d,e){null==e&&(e=1);T.call(this);this._pack=a;a=this._pack.getFile(b).toString();this._scml=new Og(q.parse(a));this.container=
(new Ua).add(new E);this._library=new Ud(this.container,this._pack,c);this.spriter=new yj(d,this._scml,this._library,new Hd);this.spriter.playbackSpeed=e};h["spriter.flambe.SpriterMovie"]=Tg;Tg.__name__=["spriter","flambe","SpriterMovie"];Tg.__super__=T;Tg.prototype=x(T.prototype,{get_name:function(){return"SpriterMovie_1"},onStart:function(){this.owner.addChild(this.container)},onUpdate:function(a){this._library.clear();this.spriter.advanceTime(1E3*a|0)},playAnim:function(a){this.spriter.playAnim(a);
return this},__class__:Tg});var Ug=function(a){this._basePath=a};h["spriter.library.AbstractLibrary"]=Ug;Ug.__name__=["spriter","library","AbstractLibrary"];Ug.prototype={addGraphic:function(){throw new p("must be overrided");},compute:function(a,b,c,d){var e=Kc.under360(a.angle),f=e*Math.PI/180,i=Math.sin(f),f=Math.cos(f),g=a.x,o=a.y,c=a.x-b.pivotX*c*a.scaleX,b=a.y+(1-b.pivotY)*d*a.scaleY;return new Hd((c-g)*f-(b-o)*i+g,-((c-g)*i+(b-o)*f+o),e,a.scaleX,a.scaleY,a.a,a.spin)},computeRectCoordinates:function(a,
b,c,d){var e=-Kc.under360(a.angle)*Math.PI/180,f=Math.sin(e),e=Math.cos(e),i=a.x,g=-a.y,o=i-c*a.scaleX*b.pivotX,b=g-d*a.scaleY*(1-b.pivotY),h=o+c*a.scaleX,j=b,h=(h-i)*e-(j-g)*f+i,j=(h-i)*f+(j-g)*e+g,c=o+c*a.scaleX,k=b+d*a.scaleY,c=(c-i)*e-(k-g)*f+i,k=(c-i)*f+(k-g)*e+g,d=b+d*a.scaleY,a=(o-i)*e-(d-g)*f+i,d=(a-i)*f+(d-g)*e+g,o=(o-i)*e-(b-g)*f+i;return new pj(new He(o,(o-i)*f+(b-g)*e+g),new He(h,j),new He(c,k),new He(a,d))},__class__:Ug};var Ud=function(a,b,c){this._basePath=c;this._pack=b;this._point=
new jd;this._matrix=new Ib;this._rootEntity=a;Ud._textures=new M;this._entityPool=(new Pi(function(){return new Ua})).setSize(25)};h["spriter.library.FlambeLibrary"]=Ud;Ud.__name__=["spriter","library","FlambeLibrary"];Ud.__super__=Ug;Ud.prototype=x(Ug.prototype,{getTexture:function(a){if(!Ud._textures.exists(this._basePath+"."+a)){var b=this._pack.getTexture(this._basePath+"."+a.substring(0,a.lastIndexOf(".")));Ud._textures.set(this._basePath+"."+a,b)}return Ud._textures.get(this._basePath+"."+a)},
clear:function(){for(;null!=this._rootEntity.firstChild;){var a=this._rootEntity.firstChild;this._rootEntity.removeChild(a);this._entityPool.put(a)}this._rootEntity.add(new E)},addGraphic:function(a,b,c,d,e,f){a=this.getTexture(d);e=this.compute(e,f,a.get_width(),a.get_height());f=new fe(a);f.disablePixelSnapping();f.getLocalMatrix().compose(e.x,e.y,e.scaleX,e.scaleY,Ra.toRadians(Kc.fixRotation(e.angle)));f.alpha.set__(e.a);this._rootEntity.addChild(this._entityPool.take().add(f))},__class__:Ud});
var Kc=function(){};h["spriter.util.SpriterUtil"]=Kc;Kc.__name__=["spriter","util","SpriterUtil"];Kc.toRadians=function(a){return a*Math.PI/180};Kc.fixRotation=function(a){0==a&&(a=360);return 360-a};Kc.under360=function(a){for(;360<a;)a-=360;for(;0>a;)a+=360;return a};var uc=function(a,b){this.name=a;this.def=this.value=b};h["spriter.vars.Variable"]=uc;uc.__name__=["spriter","vars","Variable"];uc.prototype={set:function(){return!1},__class__:uc};var Rg=function(a,b){uc.call(this,a,b)};h["spriter.vars.VariableFloat"]=
Rg;Rg.__name__=["spriter","vars","VariableFloat"];Rg.__super__=uc;Rg.prototype=x(uc.prototype,{set:function(a){var b=this.value;this.value=parseFloat(a);return b!=this.value?!0:!1},__class__:Rg});var Pg=function(a,b){uc.call(this,a,b)};h["spriter.vars.VariableInt"]=Pg;Pg.__name__=["spriter","vars","VariableInt"];Pg.__super__=uc;Pg.prototype=x(uc.prototype,{set:function(a){var b=this.value;this.value=r.parseInt(a);return b!=this.value?!0:!1},__class__:Pg});var Qg=function(a,b){uc.call(this,a,b)};h["spriter.vars.VariableString"]=
Qg;Qg.__name__=["spriter","vars","VariableString"];Qg.__super__=uc;Qg.prototype=x(uc.prototype,{set:function(a){var b=this.value;this.value=a;return b!=this.value?!0:!1},__class__:Qg});var t=function(){};h["tools.spark.Console"]=t;t.__name__=["tools","spark","Console"];t.warn=function(a,b){t._engineLogger.warn(a,b)};t.error=function(a,b){t._engineLogger.error(a,b)};t.de=function(a,b){t._engineLogger.error("DEBUG->"+a,b)};var Lc=function(){};h["tools.spark.Main"]=Lc;Lc.__name__=["tools","spark","Main"];
Lc.main=function(){Vg.init();Lc._loadClientConfig()};Lc._loadClientConfig=function(){var a=C.initiateBatch();a.addFile(Lc._getSkcUrl(),"config");a.successSignal.connect(Lc._onClientConfigLoaded).once();a.start()};Lc._onClientConfigLoaded=function(){if(!1==(new zj(C.getFile("config"))).parseClient())t._engineLogger.error("Failed to parse configuration file. Aborting...",null);else{s.init();Vg.createDisplayRenderers();for(var a=0,b=F.main.executeModules;a<b.length;){var c=b[a];++a;B.execute(c)}G.root.add(new Wg)}};
Lc._getSkcUrl=function(){try{var a=G._platform.getExternal().call("getMainSparkClientUrl");return null!=a.url?a.url:null!=a.user&&null!=a.project?"/assets/"+r.string(a.user)+"/project/"+r.string(a.project)+"/main.skc":"main.skc"}catch(b){return b instanceof p&&(b=b.val),"main.skc"}};var C=function(){};h["tools.spark.framework.Assets"]=C;C.__name__=["tools","spark","framework","Assets"];C.init=function(){C._loader=new Aj;C._loader.successSignal.connect(C._onLoaderSuccess);C._loader.errorSignal.connect(C._onLoaderError);
C._loader.progressSignal.connect(C._onLoaderProgress);C.successSignal=new yc;C.errorSignal=new ma;C.progressSignal=new Xc;C._cache=new M};C.initiateBatch=function(){return C._loader.startNewBatchLoad()};C.loadOrphanAsset=function(a,b,c){var d=r.string(a.type)+":"+r.string(a.name);if(C.fileLoaded(d))return t._engineLogger.warn("File ["+d+"] is already loaded. Ignoring...",null),null!=c&&c(),!1;var e=C.initiateBatch(),a="/assets/"+r.string(b.name)+"/"+r.string(a.type)+"/"+r.string(a.dir)+"/"+r.string(a.fileName)+
"."+r.string(a.fileExtension);t._engineLogger.info("Adding Orphan File ["+d+"]...",null);e.addFile(a,d);if(null!=c)e.successSignal.connect(c).once();e.start();return!0};C._onLoaderSuccess=function(){t._engineLogger.info("Assets: SUCCESS!",null);C.successSignal.emit()};C._onLoaderError=function(a){t._engineLogger.info("Assets: ERROR: "+a,null);C.errorSignal.emit(a)};C._onLoaderProgress=function(a,b){C.progressSignal.emit(a,b)};C.getAssetPackOf=function(a){try{return C._loader.getAssetPackOf(a)}catch(b){return b instanceof
p&&(b=b.val),t._engineLogger.error("ERROR: Could not find assetPack of: "+a,null),null}};C.assetLoaded=function(a){return C._cache.exists(a)?!0:C._loader.assetLoaded(a)};C.fileLoaded=function(a){return C._cache.exists(a)?!0:C._loader.assetLoaded(a)};C.getFile=function(a){try{return C._loader.getFile(a)}catch(b){return b instanceof p&&(b=b.val),t._engineLogger.error("ERROR: Could not find file: "+a,null),null}};C.scriptLoaded=function(a){return C._cache.exists("script:"+a)?!0:C._loader.assetLoaded("script:"+
a)};C.getScript=function(a){var b="script:"+a;if(C._cache.exists(b))return C._cache.get(b);try{return C._loader.getFile(b)}catch(c){return c instanceof p&&(c=c.val),t._engineLogger.error("ERROR: Could not find script: "+a,null),null}};C.cacheScript=function(a,b){var c="script:"+a;C._cache.exists(c)?(C.removeCachedScript(a),t._engineLogger.info("Cache Script: File existed in cache and disposed",null)):C._loader.assetLoaded(c)?(C.getFile(c).dispose(),t._engineLogger.info("Cache Script: File existed in flambe and disposed",
null)):t._engineLogger.info("Cache Script: File did not exist",null);var d=new ue(b);C._cache.set(c,d);return d};C.removeCachedScript=function(a){a="script:"+a;return C._cache.exists(a)?(C._cache.get(a).dispose(),C._cache.remove(a),!0):!1};C.textureLoaded=function(a){return C._loader.assetLoaded(a)};C.getTexture=function(a){try{return C._loader.getTexture(a)}catch(b){return b instanceof p&&(b=b.val),t._engineLogger.error("ERROR: Could not find texture: "+a,null),null}};C.soundLoaded=function(a){return C._loader.assetLoaded(a)};
C.getSound=function(a){try{return C._loader.getSound(a)}catch(b){return b instanceof p&&(b=b.val),t._engineLogger.error("ERROR: Could not find sound: "+a,null),null}};var Vg=function(){};h["tools.spark.framework.Framework"]=Vg;Vg.__name__=["tools","spark","framework","Framework"];Vg.init=function(){Object.defineProperty&&Object.defineProperty(Array.prototype,"__class__",{enumerable:!1});t._engineLogger=new bf(G._platform.createLogHandler("engine"));G.init();Xg.init();C.init();F.init();B.init()};Vg.createDisplayRenderers=
function(){Xg.createDisplayRenderers()};var B=function(){};h["tools.spark.framework.ModuleManager"]=B;B.__name__=["tools","spark","framework","ModuleManager"];B.init=function(){B._moduleStates=new M;B._modulesLoadQueue=[];B._modulesLoadQueueBytes=[];B._loadingBatch=!1;B.successSignal=new yc;B.errorSignal=new ma;B.progressSignal=new Xc};B.getBytesOnQueue=function(){for(var a=0,b=0,c=B._modulesLoadQueueBytes;b<c.length;){var d=c[b];++b;a+=d}return a};B._onLoaderSuccess=function(){B._disposeBatchLoaderSignals();
if(!1!=B._loadingBatch){B._loadingBatch=!1;var a=B._modulesLoadQueue[0];t._engineLogger.info("Module Loader: Success Loading Module: "+a,null);var b=R.LOADED;B._moduleStates.set(a,b);b;B._bytesLoaded+=B._modulesLoadQueueBytes[0];B._modulesLoadQueue.shift();B._modulesLoadQueueBytes.shift();B._executeModule(a);B._startLoadBatch()}};B._onLoaderError=function(a){B._disposeBatchLoaderSignals();t._engineLogger.error("Module Loader: ERROR: "+a,null);B.errorSignal.emit(a)};B._onLoaderProgress=function(a){B._percDone=
100*(B._bytesLoaded+a)/B._totalBytes|0;B.progressSignal.emit(B._percDone,B._totalBytes)};B.execute=function(a){B.isModuleLoaded(a)?(t._engineLogger.info("Module "+a+" already loaded",null),B.successSignal.emit(),B._executeModule(a)):(B._percDone=0,B._totalBytes=0,B._bytesLoaded=0,B._loadModule(a))};B.getModuleState=function(a){if(null==B._moduleStates.get(a)){var b=R.NOT_LOADED;B._moduleStates.set(a,b);b}return B._moduleStates.get(a)};B.isModuleLoaded=function(a){switch(B.getModuleState(a)[1]){case 0:case 1:return!1;
case 2:case 3:case 4:return!0}};B.isModuleExecuted=function(a){switch(B.getModuleState(a)[1]){case 0:case 1:case 2:return!1;case 3:case 4:return!0}};B.createAllPaths=function(a,b){F.main.setPath(a,"script",b+"script");F.main.setPath(a,"image",b+"image");F.main.setPath(a,"model",b+"model");F.main.setPath(a,"sound",b+"sound");F.main.setPath(a,"data",b+"data")};B.createNewModule=function(a,b,c,d){if(!1==F.main.modules.exists(a)){var e=new Af(a);null!=b&&(e.requiresModules=b);e.executeEntity=null!=c?
c:"none";null!=d&&(e.assets=d);F.main.modules.set(a,e);return e}t._engineLogger.warn("Project "+a+" already exists! Ignoring...",null);return null};B.createNewAsset=function(a,b,c,d,e,f,i,g){a=new Bf(a);null!=b&&(a.url=b);null!=c&&(a.type=c);null!=d&&(a.subtype=d);null!=e&&(a.location=e);null!=f&&(a.bytes=f);null!=i&&(a.condition=i);null!=g&&(a.forceLoadAsData=g);return a};B.addAssetToModule=function(a,b){if(!1==b.assets.exists(a.id)){b.assets.set(a.id,a);var c=R.NOT_LOADED;B._moduleStates.set(b.id,
c);c;return!0}t._engineLogger.warn("Asset "+a.id+" already exists in module "+b.id+". Ignoring...",null);return!1};B.loadModule=function(a){F.main.modules.exists(a)?B.getModuleState(a)==R.NOT_LOADED?B._loadModule(a):(t._engineLogger.info("Module "+a+" already loaded",null),B.successSignal.emit()):t._engineLogger.error("Module Manager: Error Loading Module! Module ["+a+"] not found!",null)};B._executeModule=function(a){if(B.isModuleExecuted(a))t._engineLogger.warn("Warning while trying to execute Module ["+
a+"]. Module already executed. Ignoring..",null);else if(B.isModuleExecutable(a)){s.logic.createAndRun(F.main.modules.get(a).executeEntity);var b=R.RUNNING;B._moduleStates.set(a,b);b}};B.isModuleExecutable=function(a){return"none"==F.main.modules.get(a).executeEntity?!1:!0};B._loadModule=function(a){t._engineLogger.info("Module Manager: Loading module "+a,null);if(F.main.modules.exists(a)){if(B.getModuleState(a)==R.NOT_LOADED){for(var b=0,c=F.main.modules.get(a).requiresModules;b<c.length;){var d=
c[b];++b;t._engineLogger.info("Module Manager: Loading required module "+d,null);B.getModuleState(d)==R.NOT_LOADED&&B._loadModule(d)}B._loadAssetsOfModule(a)}}else t._engineLogger.error("Module Manager: Error Loading Module! Module ["+a+"] not found!",null)};B._loadAssetsOfModule=function(a){var b=0,c;for(c=F.main.modules.get(a).assets.iterator();c.hasNext();)var d=c.next(),b=b+r.parseInt(d.bytes);c=R.LOADING;B._moduleStates.set(a,c);c;B._modulesLoadQueue.push(a);B._modulesLoadQueueBytes.push(b);
B._totalBytes+=b;!1==B._loadingBatch&&B._startLoadBatch()};B._startLoadBatch=function(){if(0<B._modulesLoadQueue.length){var a=B._modulesLoadQueue[0],b=C.initiateBatch();B._loaderSignalSuccess=b.successSignal.connect(B._onLoaderSuccess);B._loaderSignalError=b.errorSignal.connect(B._onLoaderError);B._loaderSignalProgress=b.progressSignal.connect(B._onLoaderProgress);for(a=F.main.modules.get(a).assets.iterator();a.hasNext();){var c=a.next();C.assetLoaded(c.id)?t._engineLogger.info("file already loaded: "+
c.id,null):(t._engineLogger.info("adding file: "+c.id,null),b.addFile(F.main.getPath(c.location,c.type)+"/"+c.url,c.id,"true"==c.forceLoadAsData?D.Data:null,r.parseInt(c.bytes)))}B._loadingBatch=!0;b.start()}else B.successSignal.emit()};B._disposeBatchLoaderSignals=function(){B._loaderSignalSuccess.dispose();B._loaderSignalError.dispose();B._loaderSignalProgress.dispose()};var F=function(){this.executeModules=[];this.sliced=new ea;this.paths=new M;this.modules=new M};h["tools.spark.framework.Project"]=
F;F.__name__=["tools","spark","framework","Project"];F.init=function(){F.main=new F;F._initNodeNamesMap()};F.getModules=function(){return F.main.modules};F._initNodeNamesMap=function(){F._typeToString=new ea;F._typeToString.set(n.CLIENT,"Client");"Client";F._typeToString.set(n.SERVER,"Server");"Server";F._typeToString.set(n.PROJECT,"Project");"Project";F._typeToString.set(n.SLICED,"Sliced");"Sliced";F._typeToString.set(n.PATHS,"Paths");"Paths";F._typeToString.set(n.ASSETS,"Assets");"Assets";F._typeToString.set(n.PROJECT_NAME,
"Name");"Name";F._typeToString.set(n.PROJECT_VERSION,"Version");"Version";F._typeToString.set(n.EXECUTE_AT_LAUNCH,"ExecuteAtLaunch");"ExecuteAtLaunch";F._typeToString.set(n.EXECUTE_MODULE,"ExecuteModule");"ExecuteModule";F._typeToString.set(n.SOUND_SERVICE,"Sound");"Sound";F._typeToString.set(n.LOGIC_SERVICE,"Logic");"Logic";F._typeToString.set(n.INPUT_SERVICE,"Input");"Input";F._typeToString.set(n.COMMUNICATIONS_SERVICE,"Comms");"Comms";F._typeToString.set(n.EVENT_SERVICE,"Event");"Event";F._typeToString.set(n.DISPLAY_SERVICE,
"Display");"Display";F._typeToString.set(n.PATH,"Path");"Path";F._typeToString.set(n.MODULE,"Module");"Module";F._typeToString.set(n.ASSET,"Asset");"Asset";F._typeToString.set(n.REQUIRES,"Requires");"Requires";F._typeToString.set(n.REQUIRES_MODULE,"RequiresModule");"RequiresModule"};F.prototype={setPath:function(a,b,c){if(null==this.paths.get(a)){var d=new M;this.paths.set(a,d);d}this.paths.get(a).set(b,c);c},getPath:function(a,b){return null==this.paths.get(a)?null:this.paths.get(a).get(b)},exportToXml:function(){var a=
s.logic.xml_createElement(F._typeToString.get(n.CLIENT)),b=s.logic.xml_createElement(F._typeToString.get(n.PROJECT));a.addChild(b);b.addChild(s.logic.xml_createElement(F._typeToString.get(n.PROJECT_NAME),this.name));b.addChild(s.logic.xml_createElement(F._typeToString.get(n.PROJECT_VERSION),this.version));var c=s.logic.xml_createElement(F._typeToString.get(n.EXECUTE_AT_LAUNCH));b.addChild(c);for(var b=0,d=this.executeModules;b<d.length;){var e=d[b];++b;c.addChild(s.logic.xml_createElement(F._typeToString.get(n.EXECUTE_MODULE),
e))}c=s.logic.xml_createElement(F._typeToString.get(n.SLICED));a.addChild(c);for(b=this.sliced.keys();b.hasNext();)d=b.next(),c.addChild(s.logic.xml_createElement(F._typeToString.get(d),this.sliced.get(d)));c=s.logic.xml_createElement(F._typeToString.get(n.PATHS));a.addChild(c);for(b=this.paths.keys();b.hasNext();)for(var d=b.next(),e=this.paths.get(d),f=e.keys();f.hasNext();){var i=f.next(),g=s.logic.xml_createElement(F._typeToString.get(n.PATH),null!=Oa[i]?e.getReserved(i):e.h[i]);g.set("location",
d);g.set("type",i);c.addChild(g)}c=s.logic.xml_createElement(F._typeToString.get(n.ASSETS));a.addChild(c);for(b=this.modules.iterator();b.hasNext();){e=b.next();d=s.logic.xml_createElement(F._typeToString.get(n.MODULE));c.addChild(d);d.set("id",e.id);null!=e.executeEntity&&d.set("executeEntity",e.executeEntity);if(0<e.requiresModules.length){f=s.logic.xml_createElement(F._typeToString.get(n.REQUIRES));d.addChild(f);i=0;for(g=e.requiresModules;i<g.length;){var o=g[i];++i;f.addChild(s.logic.xml_createElement(F._typeToString.get(n.REQUIRES_MODULE),
o))}}for(e=e.assets.iterator();e.hasNext();)f=e.next(),i=s.logic.xml_createElement(F._typeToString.get(n.ASSET),f.url),d.addChild(i),null!=f.id&&i.set("id",f.id),null!=f.type&&i.set("type",f.type),null!=f.subtype&&i.set("subtype",f.subtype),null!=f.location&&i.set("location",f.location),null!=f.bytes&&i.set("bytes",f.bytes),null!=f.condition&&i.set("condition",f.condition),null!=f.forceLoadAsData&&i.set("forceLoadAsData",f.forceLoadAsData)}return a},__class__:F};var Wg=function(){T.call(this)};h["tools.spark.framework.RootComponent"]=
Wg;Wg.__name__=["tools","spark","framework","RootComponent"];Wg.__super__=T;Wg.prototype=x(T.prototype,{get_name:function(){return"RootComponent_0"},onUpdate:function(a){s.dt=a;s.input.update();s.event.update();s.logic.update();s.display.update();s.comms.update()},__class__:Wg});var Bj=function(){};h["tools.spark.framework.assets.interfaces.IBatchLoader"]=Bj;Bj.__name__="tools,spark,framework,assets,interfaces,IBatchLoader".split(",");Bj.prototype={__class__:Bj};var Ie=function(){this.successSignal=
new yc;this.errorSignal=new ma;this.progressSignal=new Xc};h["tools.spark.framework.assets.ABatchLoader"]=Ie;Ie.__name__=["tools","spark","framework","assets","ABatchLoader"];Ie.__interfaces__=[Bj];Ie.prototype={addFile:function(a,b,c,d){null==d&&(d=5E4);null==b&&(b=a);t._engineLogger.info("BatchLoader: Requesting file "+a,null);this._addFile(b,a,c,d)},start:function(){},_addFile:function(){},__class__:Ie};var Bf=function(a){this.id=a};h["tools.spark.framework.assets.Asset"]=Bf;Bf.__name__=["tools",
"spark","framework","assets","Asset"];Bf.prototype={__class__:Bf};var R=h["tools.spark.framework.assets.EModuleState"]={__ename__:["tools","spark","framework","assets","EModuleState"],__constructs__:["NOT_LOADED","LOADING","LOADED","RUNNING","PAUSED"]};R.NOT_LOADED=["NOT_LOADED",0];R.NOT_LOADED.toString=l;R.NOT_LOADED.__enum__=R;R.LOADING=["LOADING",1];R.LOADING.toString=l;R.LOADING.__enum__=R;R.LOADED=["LOADED",2];R.LOADED.toString=l;R.LOADED.__enum__=R;R.RUNNING=["RUNNING",3];R.RUNNING.toString=
l;R.RUNNING.__enum__=R;R.PAUSED=["PAUSED",4];R.PAUSED.toString=l;R.PAUSED.__enum__=R;R.__empty_constructs__=[R.NOT_LOADED,R.LOADING,R.LOADED,R.RUNNING,R.PAUSED];var Yg=function(a){this._flambeLoader=a;this._manifest=new Sd;Ie.call(this)};h["tools.spark.framework.assets.FlambeBatchLoader"]=Yg;Yg.__name__=["tools","spark","framework","assets","FlambeBatchLoader"];Yg.__super__=Ie;Yg.prototype=x(Ie.prototype,{_addFile:function(a,b,c,d){this._manifest.add(a,b,d,c);this._flambeLoader.registerAsset(this._manifest,
a)},start:function(){A.iter(this._manifest._entries).hasNext()?(this._promise=G._platform.loadAssetPack(this._manifest),this._promiseSignalSuccess=this._promise.success.connect(u(this,this._onPromiseSuccess)),this._promiseSignalError=this._promise.error.connect(u(this,this._onPromiseError)),this._promiseSignalProgress=this._promise.progressChanged.connect(u(this,this._onPromiseProgress))):(t._engineLogger.info("Manifest is empty. Nothing loaded",null),this.successSignal.emit())},_onPromiseSuccess:function(a){this._disposePromiseSignals();
this._flambeLoader.registerBatchLoad(this._manifest,a);this.successSignal.emit()},_onPromiseError:function(a){this._disposePromiseSignals();this.errorSignal.emit(a)},_onPromiseProgress:function(){this.progressSignal.emit(this._promise._progress,this._promise._total)},_disposePromiseSignals:function(){this._promiseSignalSuccess.dispose();this._promiseSignalError.dispose();this._promiseSignalProgress.dispose()},__class__:Yg});var Aj=function(){this._init()};h["tools.spark.framework.assets.FlambeLoader"]=
Aj;Aj.__name__=["tools","spark","framework","assets","FlambeLoader"];Aj.prototype={_init:function(){this.successSignal=new yc;this.errorSignal=new ma;this.progressSignal=new Xc;this._assetInUse=new M;this._assetToBatchLoad=new M;this._batchLoadToAssetPack=new Fa},startNewBatchLoad:function(){return new Yg(this)},registerBatchLoad:function(a,b){this._batchLoadToAssetPack.set(a,b);b},registerAsset:function(a,b){this._assetToBatchLoad.set(b,a);a},assetLoaded:function(a){return this._assetToBatchLoad.exists(a)?
!0:!1},getAssetPackOf:function(a){return this._batchLoadToAssetPack.h[this._assetToBatchLoad.get(a).__id__]},getFile:function(a){return this._batchLoadToAssetPack.h[this._assetToBatchLoad.get(a).__id__].getFile(a)},getTexture:function(a){return this._batchLoadToAssetPack.h[this._assetToBatchLoad.get(a).__id__].getTexture(a)},getSound:function(a){return this._batchLoadToAssetPack.h[this._assetToBatchLoad.get(a).__id__].getSound(a)},__class__:Aj};var Af=function(a){this.id=a;this.requiresModules=[];
this.assets=new M};h["tools.spark.framework.assets.Module"]=Af;Af.__name__=["tools","spark","framework","assets","Module"];Af.prototype={__class__:Af};var zj=function(a){this._configFile=a;this._initNodeNamesMap();this._initNodeTypesMap();this._configValidator=new Cj(this._xmlNodeTypeToNodeName);this._configInstantiator=new Dj(this._xmlNodeTypeToNodeName)};h["tools.spark.framework.config.Config"]=zj;zj.__name__=["tools","spark","framework","config","Config"];zj.prototype={parseClient:function(){return this._parse(n.CLIENT)},
_parse:function(a){var b;t._engineLogger.info("Config: Parsing...",null);try{b=q.parse(this._configFile.toString())}catch(c){return c instanceof p&&(c=c.val),t._engineLogger.error(r.string(c),null),!1}b=b.firstElement();var d;if(b.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+b.nodeType));d=this._xmlNodeNameToNodeType.get(b.nodeName);if(d!=a)return t._engineLogger.error("Config file is not correct. Expected Root Child: "+r.string(a)+", got: "+r.string(d)+".",null),
!1;t._engineLogger.info("Config: Validating...",null);this._configValidator.init(a);if(!1==this._validateConfigNode(b))return t._engineLogger.error("Config file could not be validated",null),!1;t._engineLogger.info("Config: Instantiating...",null);this._configInstantiator.init(b,a);this._configInstantiator.instantiateProject();this._configInstantiator.instantiateSliced();this._configInstantiator.instantiatePaths();this._configInstantiator.instantiateAssets();t._engineLogger.info("Config: Completed!",
null);return!0},_validateConfigNode:function(a){var b;if(a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+a.nodeType));b=this._xmlNodeNameToNodeType.get(a.nodeName);if(this._configValidator.validateConfigNode(a,b))return!0;for(a=a.elements();a.hasNext()&&!(!1==this._validateConfigNode(a.next())););return!1},_initNodeNamesMap:function(){this._xmlNodeTypeToNodeName=new ea;this._xmlNodeTypeToNodeName.set(n.CLIENT,"Client");"Client";this._xmlNodeTypeToNodeName.set(n.SERVER,
"Server");"Server";this._xmlNodeTypeToNodeName.set(n.PROJECT,"Project");"Project";this._xmlNodeTypeToNodeName.set(n.SLICED,"Sliced");"Sliced";this._xmlNodeTypeToNodeName.set(n.PATHS,"Paths");"Paths";this._xmlNodeTypeToNodeName.set(n.ASSETS,"Assets");"Assets";this._xmlNodeTypeToNodeName.set(n.PROJECT_NAME,"Name");"Name";this._xmlNodeTypeToNodeName.set(n.PROJECT_VERSION,"Version");"Version";this._xmlNodeTypeToNodeName.set(n.EXECUTE_AT_LAUNCH,"ExecuteAtLaunch");"ExecuteAtLaunch";this._xmlNodeTypeToNodeName.set(n.EXECUTE_MODULE,
"ExecuteModule");"ExecuteModule";this._xmlNodeTypeToNodeName.set(n.SOUND_SERVICE,"Sound");"Sound";this._xmlNodeTypeToNodeName.set(n.LOGIC_SERVICE,"Logic");"Logic";this._xmlNodeTypeToNodeName.set(n.INPUT_SERVICE,"Input");"Input";this._xmlNodeTypeToNodeName.set(n.COMMUNICATIONS_SERVICE,"Comms");"Comms";this._xmlNodeTypeToNodeName.set(n.EVENT_SERVICE,"Event");"Event";this._xmlNodeTypeToNodeName.set(n.DISPLAY_SERVICE,"Display");"Display";this._xmlNodeTypeToNodeName.set(n.PATH,"Path");"Path";this._xmlNodeTypeToNodeName.set(n.MODULE,
"Module");"Module";this._xmlNodeTypeToNodeName.set(n.ASSET,"Asset");"Asset";this._xmlNodeTypeToNodeName.set(n.REQUIRES,"Requires");"Requires";this._xmlNodeTypeToNodeName.set(n.REQUIRES_MODULE,"RequiresModule");"RequiresModule"},_initNodeTypesMap:function(){this._xmlNodeNameToNodeType=new M;var a=this._xmlNodeTypeToNodeName.get(n.CLIENT),b=n.CLIENT;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.SERVER);b=n.SERVER;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.PROJECT);
b=n.PROJECT;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.SLICED);b=n.SLICED;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.PATHS);b=n.PATHS;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.ASSETS);b=n.ASSETS;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.PROJECT_NAME);b=n.PROJECT_NAME;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.PROJECT_VERSION);b=n.PROJECT_VERSION;
this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.EXECUTE_AT_LAUNCH);b=n.EXECUTE_AT_LAUNCH;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.EXECUTE_MODULE);b=n.EXECUTE_MODULE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.SOUND_SERVICE);b=n.SOUND_SERVICE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.LOGIC_SERVICE);b=n.LOGIC_SERVICE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.INPUT_SERVICE);
b=n.INPUT_SERVICE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.COMMUNICATIONS_SERVICE);b=n.COMMUNICATIONS_SERVICE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.EVENT_SERVICE);b=n.EVENT_SERVICE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.DISPLAY_SERVICE);b=n.DISPLAY_SERVICE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.PATH);b=n.PATH;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.MODULE);
b=n.MODULE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.ASSET);b=n.ASSET;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.REQUIRES);b=n.REQUIRES;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(n.REQUIRES_MODULE);b=n.REQUIRES_MODULE;this._xmlNodeNameToNodeType.set(a,b);b},__class__:zj};var Dj=function(a){this._xmlNodeTypeToNodeName=a};h["tools.spark.framework.config.ConfigInstantiator"]=Dj;Dj.__name__=["tools","spark",
"framework","config","ConfigInstantiator"];Dj.prototype={init:function(a,b){this._configNode=a;this._rootNodeType=b},instantiateProject:function(){var a=this._configNode.elementsNamed(this._xmlNodeTypeToNodeName.get(n.PROJECT)).next();F.main.name=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.PROJECT_NAME)).next().firstChild().get_nodeValue();F.main.version=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.PROJECT_VERSION)).next().firstChild().get_nodeValue();F.main.type=this._rootNodeType;for(a=
a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.EXECUTE_AT_LAUNCH)).next().elements();a.hasNext();){var b=a.next();F.main.executeModules.push(function(){if(b.nodeType!=q.Document&&b.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+b.nodeType));return b.children[0]}(this).get_nodeValue())}},instantiateSliced:function(){var a=this._configNode.elementsNamed(this._xmlNodeTypeToNodeName.get(n.SLICED)).next(),b=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.LOGIC_SERVICE)).next().firstChild().get_nodeValue();
F.main.sliced.set(n.LOGIC_SERVICE,b);b;b=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.COMMUNICATIONS_SERVICE)).next().firstChild().get_nodeValue();F.main.sliced.set(n.COMMUNICATIONS_SERVICE,b);b;b=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.EVENT_SERVICE)).next().firstChild().get_nodeValue();F.main.sliced.set(n.EVENT_SERVICE,b);b;F.main.type==n.CLIENT&&(b=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.SOUND_SERVICE)).next().firstChild().get_nodeValue(),F.main.sliced.set(n.SOUND_SERVICE,
b),b,b=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.INPUT_SERVICE)).next().firstChild().get_nodeValue(),F.main.sliced.set(n.INPUT_SERVICE,b),b,a=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.DISPLAY_SERVICE)).next().firstChild().get_nodeValue(),F.main.sliced.set(n.DISPLAY_SERVICE,a),a)},instantiatePaths:function(){for(var a=this._configNode.elementsNamed(this._xmlNodeTypeToNodeName.get(n.PATHS)).next().elements();a.hasNext();){var b=a.next();F.main.setPath(b.get("location"),b.get("type"),
function(){if(b.nodeType!=q.Document&&b.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+b.nodeType));return b.children[0]}(this).get_nodeValue())}},instantiateAssets:function(){for(var a=this._configNode.elementsNamed(this._xmlNodeTypeToNodeName.get(n.ASSETS)).next().elements();a.hasNext();){var b=a.next(),c=b.get("id"),b=this._instantiateModule(b);F.main.modules.set(c,b);b}},_instantiateModule:function(a){var b=new Af(a.get("id"));b.executeEntity=a.get("executeEntity");
if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.REQUIRES)).hasNext())for(var c=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.REQUIRES)).next().elements();c.hasNext();){var d=c.next();b.requiresModules.push(function(){if(d.nodeType!=q.Document&&d.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+d.nodeType));return d.children[0]}(this).get_nodeValue())}for(a=a.elementsNamed(this._xmlNodeTypeToNodeName.get(n.ASSET));a.hasNext();)c=this._instantiateAsset(a.next()),
b.assets.set(c.id,c),c;return b},_instantiateAsset:function(a){var b;if(a.nodeType!=q.Document&&a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+a.nodeType));var c=a.children[0].get_nodeValue();b="auto"==a.get("id")?a.get("type")+":"+fa.replace(c.substring(0,c.lastIndexOf(".")),"/","."):a.get("id");b=new Bf(b);b.url=c;b.type=a.get("type");b.subtype=a.get("subtype");b.location=a.get("location");b.bytes=a.get("bytes");b.condition=a.get("condition");b.forceLoadAsData=
a.get("forceLoadAsData");return b},__class__:Dj};var Cj=function(a){this._xmlNodeTypeToNodeName=a};h["tools.spark.framework.config.ConfigValidator"]=Cj;Cj.__name__=["tools","spark","framework","config","ConfigValidator"];Cj.prototype={init:function(a){this._initNodeRulesMap(a)},_initNodeRulesMap:function(a){this._xmlNodeTypeToNodeRule=new ea;var b=this._createRequiresModuleNodeRule();this._xmlNodeTypeToNodeRule.set(n.REQUIRES_MODULE,b);b;b=this._createRequiresNodeRule();this._xmlNodeTypeToNodeRule.set(n.REQUIRES,
b);b;b=this._createAssetNodeRule();this._xmlNodeTypeToNodeRule.set(n.ASSET,b);b;b=this._createModuleNodeRule();this._xmlNodeTypeToNodeRule.set(n.MODULE,b);b;b=this._createAssetsNodeRule();this._xmlNodeTypeToNodeRule.set(n.ASSETS,b);b;b=this._createPathNodeRule();this._xmlNodeTypeToNodeRule.set(n.PATH,b);b;b=this._createPathsNodeRule();this._xmlNodeTypeToNodeRule.set(n.PATHS,b);b;b=this._createSoundServiceNodeRule();this._xmlNodeTypeToNodeRule.set(n.SOUND_SERVICE,b);b;b=this._createLogicServiceNodeRule();
this._xmlNodeTypeToNodeRule.set(n.LOGIC_SERVICE,b);b;b=this._createInputServiceNodeRule();this._xmlNodeTypeToNodeRule.set(n.INPUT_SERVICE,b);b;b=this._createCommsServiceNodeRule();this._xmlNodeTypeToNodeRule.set(n.COMMUNICATIONS_SERVICE,b);b;b=this._createEventServiceNodeRule();this._xmlNodeTypeToNodeRule.set(n.EVENT_SERVICE,b);b;b=this._createDisplayServiceNodeRule();this._xmlNodeTypeToNodeRule.set(n.DISPLAY_SERVICE,b);b;b=this._createExecuteModuleNodeRule();this._xmlNodeTypeToNodeRule.set(n.EXECUTE_MODULE,
b);b;b=this._createExecuteAtLaunchNodeRule();this._xmlNodeTypeToNodeRule.set(n.EXECUTE_AT_LAUNCH,b);b;b=this._createProjectNameNodeRule();this._xmlNodeTypeToNodeRule.set(n.PROJECT_NAME,b);b;b=this._createProjectVersionNodeRule();this._xmlNodeTypeToNodeRule.set(n.PROJECT_VERSION,b);b;b=this._createProjectNodeRule();this._xmlNodeTypeToNodeRule.set(n.PROJECT,b);b;a==n.CLIENT?(a=this._createSlicedClientNodeRule(),this._xmlNodeTypeToNodeRule.set(n.SLICED,a),a,a=this._createClientNodeRule(),this._xmlNodeTypeToNodeRule.set(n.CLIENT,
a),a):a==n.SERVER&&(a=this._createSlicedServerNodeRule(),this._xmlNodeTypeToNodeRule.set(n.SLICED,a),a,a=this._createServerNodeRule(),this._xmlNodeTypeToNodeRule.set(n.SERVER,a),a)},validateConfigNode:function(a,b){if(null==this._xmlNodeTypeToNodeRule.get(b))return t._engineLogger.error("This Config Node Rule has not been created Yet!",null),!1;try{return W.checkNode(a,this._xmlNodeTypeToNodeRule.get(b)),!0}catch(c){c instanceof p&&(c=c.val);if(w.__instanceof(c,String))return t._engineLogger.error(c,
null),!1;throw c;}},_createClientNodeRule:function(){var a=O.RList([this._xmlNodeTypeToNodeRule.get(n.PROJECT),this._xmlNodeTypeToNodeRule.get(n.SLICED),this._xmlNodeTypeToNodeRule.get(n.PATHS),this._xmlNodeTypeToNodeRule.get(n.ASSETS)],!1);return O.RNode(this._xmlNodeTypeToNodeName.get(n.CLIENT),[],a)},_createServerNodeRule:function(){var a=O.RList([this._xmlNodeTypeToNodeRule.get(n.PROJECT),this._xmlNodeTypeToNodeRule.get(n.SLICED),this._xmlNodeTypeToNodeRule.get(n.PATHS),this._xmlNodeTypeToNodeRule.get(n.ASSETS)],
!1);return O.RNode(this._xmlNodeTypeToNodeName.get(n.SERVER),[],a)},_createProjectNodeRule:function(){var a=O.RList([this._xmlNodeTypeToNodeRule.get(n.PROJECT_NAME),this._xmlNodeTypeToNodeRule.get(n.PROJECT_VERSION),this._xmlNodeTypeToNodeRule.get(n.EXECUTE_AT_LAUNCH)],!1);return O.RNode(this._xmlNodeTypeToNodeName.get(n.PROJECT),[],a)},_createProjectNameNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.PROJECT_NAME),[],a)},_createProjectVersionNodeRule:function(){var a=
O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.PROJECT_VERSION),[],a)},_createExecuteAtLaunchNodeRule:function(){var a=O.RMulti(this._xmlNodeTypeToNodeRule.get(n.EXECUTE_MODULE),!0);return O.RNode(this._xmlNodeTypeToNodeName.get(n.EXECUTE_AT_LAUNCH),[],a)},_createExecuteModuleNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.EXECUTE_MODULE),[],a)},_createSlicedClientNodeRule:function(){var a=O.RList([this._xmlNodeTypeToNodeRule.get(n.SOUND_SERVICE),this._xmlNodeTypeToNodeRule.get(n.LOGIC_SERVICE),
this._xmlNodeTypeToNodeRule.get(n.INPUT_SERVICE),this._xmlNodeTypeToNodeRule.get(n.COMMUNICATIONS_SERVICE),this._xmlNodeTypeToNodeRule.get(n.EVENT_SERVICE),this._xmlNodeTypeToNodeRule.get(n.DISPLAY_SERVICE)],!1);return O.RNode(this._xmlNodeTypeToNodeName.get(n.SLICED),[],a)},_createSlicedServerNodeRule:function(){var a=O.RList([this._xmlNodeTypeToNodeRule.get(n.LOGIC_SERVICE),this._xmlNodeTypeToNodeRule.get(n.COMMUNICATIONS_SERVICE),this._xmlNodeTypeToNodeRule.get(n.EVENT_SERVICE)],!1);return O.RNode(this._xmlNodeTypeToNodeName.get(n.SLICED),
[],a)},_createSoundServiceNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.SOUND_SERVICE),[],a)},_createLogicServiceNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.LOGIC_SERVICE),[],a)},_createInputServiceNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.INPUT_SERVICE),[],a)},_createCommsServiceNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.COMMUNICATIONS_SERVICE),
[],a)},_createEventServiceNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.EVENT_SERVICE),[],a)},_createDisplayServiceNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.DISPLAY_SERVICE),[],a)},_createPathsNodeRule:function(){var a=O.RMulti(this._xmlNodeTypeToNodeRule.get(n.PATH),!0);return O.RNode(this._xmlNodeTypeToNodeName.get(n.PATHS),[],a)},_createPathNodeRule:function(){var a=O.RData(),b=[Bc.Att("location"),Bc.Att("type")];
return O.RNode(this._xmlNodeTypeToNodeName.get(n.PATH),b,a)},_createAssetsNodeRule:function(){var a=O.RMulti(this._xmlNodeTypeToNodeRule.get(n.MODULE),!0);return O.RNode(this._xmlNodeTypeToNodeName.get(n.ASSETS),[],a)},_createModuleNodeRule:function(){var a=O.RList([O.ROptional(this._xmlNodeTypeToNodeRule.get(n.REQUIRES)),O.RMulti(this._xmlNodeTypeToNodeRule.get(n.ASSET),!0)],!1),b=[Bc.Att("id"),Bc.Att("executeEntity",null,"none")];return O.RNode(this._xmlNodeTypeToNodeName.get(n.MODULE),b,a)},_createAssetNodeRule:function(){var a=
O.RData(),b=[Bc.Att("location"),Bc.Att("type"),Bc.Att("bytes"),Bc.Att("subtype",null,"none"),Bc.Att("id",null,"auto"),Bc.Att("condition",null,"always"),Bc.Att("forceLoadAsData",null,"false")];return O.RNode(this._xmlNodeTypeToNodeName.get(n.ASSET),b,a)},_createRequiresNodeRule:function(){var a=O.RMulti(this._xmlNodeTypeToNodeRule.get(n.REQUIRES_MODULE),!0);return O.RNode(this._xmlNodeTypeToNodeName.get(n.REQUIRES),[],a)},_createRequiresModuleNodeRule:function(){var a=O.RData();return O.RNode(this._xmlNodeTypeToNodeName.get(n.REQUIRES_MODULE),
[],a)},__class__:Cj};var n=h["tools.spark.framework.config.ENodeType"]={__ename__:["tools","spark","framework","config","ENodeType"],__constructs__:"CLIENT,SERVER,PROJECT,SLICED,PATHS,ASSETS,PROJECT_NAME,PROJECT_VERSION,EXECUTE_AT_LAUNCH,EXECUTE_MODULE,SOUND_SERVICE,LOGIC_SERVICE,INPUT_SERVICE,COMMUNICATIONS_SERVICE,EVENT_SERVICE,DISPLAY_SERVICE,PATH,MODULE,ASSET,REQUIRES,REQUIRES_MODULE".split(",")};n.CLIENT=["CLIENT",0];n.CLIENT.toString=l;n.CLIENT.__enum__=n;n.SERVER=["SERVER",1];n.SERVER.toString=
l;n.SERVER.__enum__=n;n.PROJECT=["PROJECT",2];n.PROJECT.toString=l;n.PROJECT.__enum__=n;n.SLICED=["SLICED",3];n.SLICED.toString=l;n.SLICED.__enum__=n;n.PATHS=["PATHS",4];n.PATHS.toString=l;n.PATHS.__enum__=n;n.ASSETS=["ASSETS",5];n.ASSETS.toString=l;n.ASSETS.__enum__=n;n.PROJECT_NAME=["PROJECT_NAME",6];n.PROJECT_NAME.toString=l;n.PROJECT_NAME.__enum__=n;n.PROJECT_VERSION=["PROJECT_VERSION",7];n.PROJECT_VERSION.toString=l;n.PROJECT_VERSION.__enum__=n;n.EXECUTE_AT_LAUNCH=["EXECUTE_AT_LAUNCH",8];n.EXECUTE_AT_LAUNCH.toString=
l;n.EXECUTE_AT_LAUNCH.__enum__=n;n.EXECUTE_MODULE=["EXECUTE_MODULE",9];n.EXECUTE_MODULE.toString=l;n.EXECUTE_MODULE.__enum__=n;n.SOUND_SERVICE=["SOUND_SERVICE",10];n.SOUND_SERVICE.toString=l;n.SOUND_SERVICE.__enum__=n;n.LOGIC_SERVICE=["LOGIC_SERVICE",11];n.LOGIC_SERVICE.toString=l;n.LOGIC_SERVICE.__enum__=n;n.INPUT_SERVICE=["INPUT_SERVICE",12];n.INPUT_SERVICE.toString=l;n.INPUT_SERVICE.__enum__=n;n.COMMUNICATIONS_SERVICE=["COMMUNICATIONS_SERVICE",13];n.COMMUNICATIONS_SERVICE.toString=l;n.COMMUNICATIONS_SERVICE.__enum__=
n;n.EVENT_SERVICE=["EVENT_SERVICE",14];n.EVENT_SERVICE.toString=l;n.EVENT_SERVICE.__enum__=n;n.DISPLAY_SERVICE=["DISPLAY_SERVICE",15];n.DISPLAY_SERVICE.toString=l;n.DISPLAY_SERVICE.__enum__=n;n.PATH=["PATH",16];n.PATH.toString=l;n.PATH.__enum__=n;n.MODULE=["MODULE",17];n.MODULE.toString=l;n.MODULE.__enum__=n;n.ASSET=["ASSET",18];n.ASSET.toString=l;n.ASSET.__enum__=n;n.REQUIRES=["REQUIRES",19];n.REQUIRES.toString=l;n.REQUIRES.__enum__=n;n.REQUIRES_MODULE=["REQUIRES_MODULE",20];n.REQUIRES_MODULE.toString=
l;n.REQUIRES_MODULE.__enum__=n;n.__empty_constructs__=[n.CLIENT,n.SERVER,n.PROJECT,n.SLICED,n.PATHS,n.ASSETS,n.PROJECT_NAME,n.PROJECT_VERSION,n.EXECUTE_AT_LAUNCH,n.EXECUTE_MODULE,n.SOUND_SERVICE,n.LOGIC_SERVICE,n.INPUT_SERVICE,n.COMMUNICATIONS_SERVICE,n.EVENT_SERVICE,n.DISPLAY_SERVICE,n.PATH,n.MODULE,n.ASSET,n.REQUIRES,n.REQUIRES_MODULE];var Cf=function(){};h["tools.spark.framework.space2_5D.interfaces.IBase2_5D"]=Cf;Cf.__name__="tools,spark,framework,space2_5D,interfaces,IBase2_5D".split(",");Cf.prototype=
{__class__:Cf};var Vd=function(a){this.gameEntity=a};h["tools.spark.framework.space2_5D.core.ABase2_5D"]=Vd;Vd.__name__="tools,spark,framework,space2_5D,core,ABase2_5D".split(",");Vd.__interfaces__=[Cf];Vd.prototype={setPosSize:function(a,b,c,d){!0==this.gameEntity.getState("layoutable")&&(null!=a&&this.gameEntity.setState("feedbackX",a),null!=b&&this.gameEntity.setState("feedbackY",b),null!=c&&this.gameEntity.setState("feedbackWidth",c),null!=d&&this.gameEntity.setState("feedbackHeight",d))},__class__:Vd};
var Zg=function(){};h["tools.spark.framework.space2_5D.interfaces.IObject2_5D"]=Zg;Zg.__name__="tools,spark,framework,space2_5D,interfaces,IObject2_5D".split(",");Zg.__interfaces__=[Cf];var Wd=function(a){this.gameEntity=a};h["tools.spark.framework.space2_5D.core.AObject2_5D"]=Wd;Wd.__name__="tools,spark,framework,space2_5D,core,AObject2_5D".split(",");Wd.__interfaces__=[Zg];Wd.__super__=Vd;Wd.prototype=x(Vd.prototype,{__class__:Wd});var $g=function(){};h["tools.spark.framework.space2_5D.interfaces.ICamera2_5D"]=
$g;$g.__name__="tools,spark,framework,space2_5D,interfaces,ICamera2_5D".split(",");$g.__interfaces__=[Zg];$g.prototype={__class__:$g};var Mc=function(a){this.gameEntity=a;this._initACamera2_5D()};h["tools.spark.framework.space2_5D.core.ACamera2_5D"]=Mc;Mc.__name__="tools,spark,framework,space2_5D,core,ACamera2_5D".split(",");Mc.__interfaces__=[$g];Mc.__super__=Wd;Mc.prototype=x(Wd.prototype,{_initACamera2_5D:function(){this._attachedToViews=new Fa},attachToView:function(a){this._attachedToViews.set(a,
a);a;return null},__class__:Mc});var Df=function(a){Mc.call(this,a)};h["tools.spark.framework.dom2_5D.DomCamera2_5D"]=Df;Df.__name__=["tools","spark","framework","dom2_5D","DomCamera2_5D"];Df.__super__=Mc;Df.prototype=x(Mc.prototype,{__class__:Df});var Ej=function(){};h["tools.spark.framework.space2_5D.interfaces.IObjectContainer2_5D"]=Ej;Ej.__name__="tools,spark,framework,space2_5D,interfaces,IObjectContainer2_5D".split(",");Ej.__interfaces__=[Zg];var vc=function(a){this.gameEntity=a;this.children=
[];this.childrenMap=new Fa};h["tools.spark.framework.space2_5D.core.AObjectContainer2_5D"]=vc;vc.__name__="tools,spark,framework,space2_5D,core,AObjectContainer2_5D".split(",");vc.__interfaces__=[Ej];vc.__super__=Wd;vc.prototype=x(Wd.prototype,{addChild:function(a){return!1==(null!=this.childrenMap.h.__keys__[a.__id__])?(this.children.push(a),this.childrenMap.set(a,!0),!0==this.gameEntity.getState("layoutable")&&s.display.invalidateLayout(),!0):!1},insertChild:function(a,b){return!1==(null!=this.childrenMap.h.__keys__[a.__id__])?
(this.children.splice(b,0,a),this.childrenMap.set(a,!0),!0==this.gameEntity.getState("layoutable")&&s.display.invalidateLayout(),!0):!1},removeChild:function(a){A.remove(this.children,a);this.childrenMap.remove(a);!0==this.gameEntity.getState("layoutable")&&s.display.invalidateLayout()},__class__:vc});var Je=function(){};h["tools.spark.framework.space2_5D.interfaces.IInstantiable2_5D"]=Je;Je.__name__="tools,spark,framework,space2_5D,interfaces,IInstantiable2_5D".split(",");Je.__interfaces__=[Ej];
Je.prototype={__class__:Je};var bc=function(a){vc.call(this,a);this._instances=new Fa;this._updateStateFunctions=new M;this._queryFunctions=new M;this.groupInstances=new Fa};h["tools.spark.framework.space2_5D.core.AInstantiable2_5D"]=bc;bc.__name__="tools,spark,framework,space2_5D,core,AInstantiable2_5D".split(",");bc.__interfaces__=[Je];bc.__super__=vc;bc.prototype=x(vc.prototype,{getInstance:function(a){return this._instances.h[a.__id__]},_updateState:function(a,b){if(null==b)for(var c=this._instances.keys();c.hasNext();){var d=
c.next();null!=this._updateStateFunctions.get(a)?this._updateStateFunctions.get(a)(this.gameEntity.getState(a),d):t._engineLogger.warn("State "+a+" does not have a function handler! Ignoring :(",null)}else null!=this._updateStateFunctions.get(a)?this._updateStateFunctions.get(a)(this.gameEntity.getState(a),b):t._engineLogger.warn("State "+a+" does not have a function handler! Ignoring :(",null)},query:function(a,b,c,d){null==d&&(d=!1);null==c?a=d?null:this._instances.keys().hasNext()?this._queryInstance(a,
b,this._instances.keys().next()):null:null!=this._queryFunctions.get(a)?a=this._queryFunctions.get(a)(b,c):(t._engineLogger.warn("Query "+a+" does not have a function handler! Returning null :(",null),a=null);return a},_queryInstance:function(a,b,c){if(null!=this._queryFunctions.get(a))return this._queryFunctions.get(a)(b,c);t._engineLogger.warn("Query "+a+" does not have a function handler! Returning null :(",null);return null},_updateLayoutGroup:function(a){if(null==a)for(a=this.groupInstances.keys();a.hasNext();)this.groupInstances.h[a.next().__id__].update();
else this.groupInstances.h[a.__id__].update()},_createChildrenOfInstance:function(a){for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;this._createChildOfInstance(d,a)}},createInstance:function(a){this._createChildrenOfInstance(a);return this._instances.h[a.__id__]},_createChildOfInstance:function(){},_removeChildOfInstance:function(){},update:function(){},addChild:function(a){if(vc.prototype.addChild.call(this,a))for(var b=this._instances.keys();b.hasNext();){var c=b.next();this._createChildOfInstance(a,
c);a.update(c)}return!0},insertChild:function(a,b){if(vc.prototype.insertChild.call(this,a,b))for(var c=this._instances.keys();c.hasNext();){var d=c.next();this._createChildOfInstance(a,d,b);a.update(d)}return!0},removeChild:function(a){vc.prototype.removeChild.call(this,a);for(var b=this._instances.keys();b.hasNext();){var c=b.next();this._removeChildOfInstance(a,c)}},__class__:bc});var ah=function(){};h["tools.spark.framework.space2_5D.interfaces.IEntity2_5D"]=ah;ah.__name__="tools,spark,framework,space2_5D,interfaces,IEntity2_5D".split(",");
ah.__interfaces__=[Je];ah.prototype={__class__:ah};var Ma=function(a){bc.call(this,a)};h["tools.spark.framework.space2_5D.core.AEntity2_5D"]=Ma;Ma.__name__="tools,spark,framework,space2_5D,core,AEntity2_5D".split(",");Ma.__interfaces__=[ah];Ma.__super__=bc;Ma.prototype=x(bc.prototype,{createInstance:function(a){if(!0==this.gameEntity.getState("layoutable")){var b=new Ke(this.gameEntity,"Entity",this);this.groupInstances.set(a,b);b}return bc.prototype.createInstance.call(this,a)},_createChildOfInstance:function(a,
b,c){null==c&&(c=-1);!0==a.gameEntity.getState("layoutable")&&(-1==c?this.groupInstances.h[b.__id__].children.push(a.groupInstances.h[b.__id__]):this.groupInstances.h[b.__id__].children.splice(c,0,a.groupInstances.h[b.__id__]))},_removeChildOfInstance:function(a,b){!0==a.gameEntity.getState("layoutable")&&A.remove(this.groupInstances.h[b.__id__].children,a.groupInstances.h[b.__id__])},__class__:Ma});var td=function(a){bc.call(this,a);this._initDomEntity2_5D()};h["tools.spark.framework.dom2_5D.DomEntity2_5D"]=
td;td.__name__=["tools","spark","framework","dom2_5D","DomEntity2_5D"];td.__super__=Ma;td.prototype=x(Ma.prototype,{_initDomEntity2_5D:function(){var a=u(this,this._updateNCmeshType);this._updateStateFunctions.set("NCmeshType",a);a;a=u(this,this._updateTouchable);this._updateStateFunctions.set("touchable",a);a;a=u(this,this._updateAcceptsKeyboardInput);this._updateStateFunctions.set("acceptsKeyboardInput",a);a;a=u(this,this._updateDraggable);this._updateStateFunctions.set("draggable",a);a;a=u(this,
this._updateDropTarget);this._updateStateFunctions.set("dropTarget",a);a;a=u(this,this._updateNCstyleable);this._updateStateFunctions.set("NCstyleable",a);a;a=u(this,this._updateVisibility);this._updateStateFunctions.set("visibility",a);a;a=u(this,this._updateOpacity);this._updateStateFunctions.set("opacity",a);a;a=u(this,this._updateDisplay);this._updateStateFunctions.set("display",a);a;a=u(this,this._updateText);this._updateStateFunctions.set("text",a);a;a=u(this,this._updateFontColor);this._updateStateFunctions.set("fontColor",
a);a;a=u(this,this._updateImageSrc);this._updateStateFunctions.set("src",a);a;a=u(this,this._updateFontSize);this._updateStateFunctions.set("fontSize",a);a;a=u(this,this._updateFontWeight);this._updateStateFunctions.set("fontWeight",a);a;a=u(this,this._updateOverflow);this._updateStateFunctions.set("overflow",a);a;a=u(this,this._updateWhiteSpace);this._updateStateFunctions.set("whiteSpace",a);a;a=u(this,this._updateWidth);this._updateStateFunctions.set("width",a);a;a=u(this,this._updateHeight);this._updateStateFunctions.set("height",
a);a;a=u(this,this._updateTop);this._updateStateFunctions.set("top",a);a;a=u(this,this._updateLeft);this._updateStateFunctions.set("left",a);a;a=u(this,this._updatePaddingLeft);this._updateStateFunctions.set("paddingLeft",a);a;a=u(this,this._updatePaddingRight);this._updateStateFunctions.set("paddingRight",a);a;a=u(this,this._updatePaddingTop);this._updateStateFunctions.set("paddingTop",a);a;a=u(this,this._updatePaddingBottom);this._updateStateFunctions.set("paddingBottom",a);a;a=u(this,this._updateBackgroundColor);
this._updateStateFunctions.set("backgroundColor",a);a;a=u(this,this._updateBorder);this._updateStateFunctions.set("border",a);a;a=u(this,this._updateBorderColor);this._updateStateFunctions.set("borderColor",a);a;a=u(this,this._updateBorderLeft);this._updateStateFunctions.set("borderLeft",a);a;a=u(this,this._updateBorderRight);this._updateStateFunctions.set("borderRight",a);a;a=u(this,this._updateBorderTop);this._updateStateFunctions.set("borderTop",a);a;a=u(this,this._updateBorderBottom);this._updateStateFunctions.set("borderBottom",
a);a;a=u(this,this._updatePointerEvents);this._updateStateFunctions.set("pointerEvents",a);a;a=u(this,this._updateZindex);this._updateStateFunctions.set("zIndex",a);a;a=u(this,this._updateZOrder);this._updateStateFunctions.set("command_zOrder",a);a;a=u(this,this._updateTransform);this._updateStateFunctions.set("transform",a);a;a=u(this,this._updateTransformScale);this._updateStateFunctions.set("transformScale",a);a;a=u(this,this._queryGlobalPosition);this._queryFunctions.set("globalPosition",a);a;
a=u(this,this._queryAbsoluteRect);this._queryFunctions.set("absoluteRect",a);a;a=u(this,this._queryGroupObject);this._queryFunctions.set("groupObject",a);a},createInstance:function(a){if(null!=this._instances.h[a.__id__])return this._instances.h[a.__id__];switch(this.gameEntity.getState("NCmeshType")){case "Div":var b;b=window.document.createElement("div");this._instances.set(a,b);b;this._instances.h[a.__id__].style.outline="0";break;case "Input":b=window.document.createElement("input");this._instances.set(a,
b);b;this._instances.h[a.__id__].onchange=u(this,this._onChange);this._instances.h[a.__id__].style.outline="0";break;case "Button":b=window.document.createElement("div");this._instances.set(a,b);b;this._instances.h[a.__id__].style.outline="0";break;case "Image":b=window.document.createElement("img");this._instances.set(a,b);b;break;case "Ace":b=window.document.createElement("div");this._instances.set(a,b);b;break;case "Tree":b=window.document.createElement("div");this._instances.set(a,b);b;break;
case "Scroller":b=window.document.createElement("div");this._instances.set(a,b);b;break;case "Video":b=window.document.createElement("video");this._instances.set(a,b);b;break;default:t._engineLogger.error("Unrecognised NCMeshType input. Creating a Div By Default.",null),b=window.document.createElement("div"),this._instances.set(a,b),b}this._instances.h[a.__id__].style.position="absolute";this.gameEntity.setState("displayObject",this._instances.h[a.__id__]);return Ma.prototype.createInstance.call(this,
a)},_createChildOfInstance:function(a,b,c){null==c&&(c=-1);this._instances.h[b.__id__].appendChild(w.__cast(a.createInstance(b),HTMLElement));Ma.prototype._createChildOfInstance.call(this,a,b,c)},_removeChildOfInstance:function(a,b){var c;c=w.__cast(a.getInstance(b),HTMLElement);this._instances.h[b.__id__]==c.parentElement?this._instances.h[b.__id__].removeChild(c):t._engineLogger.warn("Could not remove DOM Element. Element was not a child of parent",null);Ma.prototype._removeChildOfInstance.call(this,
a,b)},update:function(a){this._updateState("NCmeshType",a);!0==this.gameEntity.getState("NCstyleable")&&(this._updateState("NCstyleable",a),this._updateState("visibility",a),this._updateState("opacity",a),this._updateState("fontSize",a),this._updateState("fontWeight",a),this._updateState("fontColor",a),this._updateState("overflow",a),this._updateState("whiteSpace",a),this._updateState("backgroundColor",a),this._updateState("border",a),this._updateState("borderColor",a),this._updateState("borderLeft",
a),this._updateState("borderRight",a),this._updateState("borderTop",a),this._updateState("borderBottom",a),this._updateState("zIndex",a));this._updateState("display",a);this._updateState("touchable",a);this._updateState("pointerEvents",a);this._updateState("acceptsKeyboardInput",a);this._updateState("draggable",a);this._updateState("dropTarget",a);null!=this.gameEntity.getState("text")&&this._updateState("text",a);!0==this.gameEntity.getState("layoutable")&&this._updateLayoutGroup(a);for(var b=0,
c=this.children;b<c.length;){var d=c[b];++b;d.update(a)}},setPosSize:function(a,b,c,d,e){var f=this._instances.h[e.__id__];null!=f&&(null!=a&&(f.style.left=(null==a?"null":""+a)+"px"),null!=b&&(f.style.top=(null==b?"null":""+b)+"px"),null!=c&&(f.style.width=(null==c?"null":""+c)+"px"),null!=d&&(f.style.height=(null==d?"null":""+d)+"px"));Ma.prototype.setPosSize.call(this,a,b,c,d,e)},_updateNCstyleable:function(a,b){null!=this.gameEntity.getState("borderRadius")&&"Undefined"!=this.gameEntity.getState("borderRadius")&&
(this._instances.h[b.__id__].style.borderRadius=this.gameEntity.getState("borderRadius"));null!=this.gameEntity.getState("borderStyle")&&"Undefined"!=this.gameEntity.getState("borderStyle")&&(this._instances.h[b.__id__].style.borderStyle=this.gameEntity.getState("borderStyle"));null!=this.gameEntity.getState("borderWidth")&&"Undefined"!=this.gameEntity.getState("borderWidth")&&(this._instances.h[b.__id__].style.borderWidth=this.gameEntity.getState("borderWidth"));null!=this.gameEntity.getState("boxShadow")&&
"Undefined"!=this.gameEntity.getState("boxShadow")&&(this._instances.h[b.__id__].style.boxShadow=this.gameEntity.getState("boxShadow"));null!=this.gameEntity.getState("fontFamily")&&"Undefined"!=this.gameEntity.getState("fontFamily")&&(this._instances.h[b.__id__].style.fontFamily=this.gameEntity.getState("fontFamily"));null!=this.gameEntity.getState("textAlign")&&"Undefined"!=this.gameEntity.getState("textAlign")&&(this._instances.h[b.__id__].style.textAlign=this.gameEntity.getState("textAlign"));
null!=this.gameEntity.getState("textVerticalAlign")&&"Undefined"!=this.gameEntity.getState("textVerticalAlign")&&"middle"==this.gameEntity.getState("textVerticalAlign")&&(this._instances.h[b.__id__].style.lineHeight=r.string(this.gameEntity.getState("height"))+"px");null!=this.gameEntity.getState("textIndent")&&"Undefined"!=this.gameEntity.getState("textIndent")&&(this._instances.h[b.__id__].style.textIndent=this.gameEntity.getState("textIndent"));null!=this.gameEntity.getState("cursor")&&"Undefined"!=
this.gameEntity.getState("cursor")&&(this._instances.h[b.__id__].style.cursor=this.gameEntity.getState("cursor"));null!=this.gameEntity.getState("selectable")&&(!1==this.gameEntity.getState("selectable")?(this._instances.h[b.__id__].style.setProperty("-webkit-user-select","none"),this._instances.h[b.__id__].style.setProperty("-moz-user-select","none"),this._instances.h[b.__id__].style.setProperty("-ms-user-select","none"),this._instances.h[b.__id__].style.setProperty("user-select","none")):(this._instances.h[b.__id__].style.setProperty("-webkit-user-select",
"initial"),this._instances.h[b.__id__].style.setProperty("-moz-user-select","initial"),this._instances.h[b.__id__].style.setProperty("-ms-user-select","initial"),this._instances.h[b.__id__].style.setProperty("user-select","initial")))},_updateImageSrc:function(a,b){var c=this._instances.h[b.__id__];if("Undefined"!=a)if(-1==a.indexOf("http")&&-1==a.indexOf("//")){var d;d=F.main.modules.get("SparkEditor:References").assets.get(a);c.src=F.main.getPath(d.location,d.type)+"/"+d.url}else c.src=a},_updateWidth:function(a,
b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("width"),s.display.projectActiveSpaceReference.activeStageReference.layoutManager.validated=!1)},_updateHeight:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("height"),s.display.projectActiveSpaceReference.activeStageReference.layoutManager.validated=!1)},_updateTransform:function(a,b){this._instances.h[b.__id__].style.setProperty("-ms-transform",a);this._instances.h[b.__id__].style.setProperty("-webkit-transform",
a);this._instances.h[b.__id__].style.setProperty("transform",a)},_updateTransformScale:function(a,b){this._instances.h[b.__id__].style.setProperty("zoom",a);this._instances.h[b.__id__].style.setProperty("-moz-transform","scale("+a+")")},_updateTop:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("top"),s.display.invalidateLayout())},_updateLeft:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("left"),
s.display.invalidateLayout())},_updatePaddingLeft:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("paddingLeft"),s.display.invalidateLayout())},_updatePaddingRight:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("paddingRight"),s.display.invalidateLayout())},_updatePaddingTop:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("paddingTop"),
s.display.invalidateLayout())},_updatePaddingBottom:function(a,b){!0==this.gameEntity.getState("layoutable")&&(this.groupInstances.h[b.__id__].updateState("paddingBottom"),s.display.invalidateLayout())},_updateOverflow:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.overflow=a)},_updateWhiteSpace:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.whiteSpace=a)},_updateFontSize:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.fontSize=a)},_updateFontWeight:function(a,
b){"Undefined"!=a&&(this._instances.h[b.__id__].style.fontWeight=a)},_updateFontColor:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.color=a)},_updateVisibility:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.visibility=a)},_updateOpacity:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.opacity=a)},_updateBackgroundColor:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.backgroundColor=a)},_updateBorder:function(a,b){"Undefined"!=a&&
(this._instances.h[b.__id__].style.border=a)},_updateBorderColor:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.borderColor=a)},_updateBorderLeft:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.borderLeft=a)},_updateBorderRight:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.borderRight=a)},_updateBorderTop:function(a,b){"Undefined"!=a&&(this._instances.h[b.__id__].style.borderTop=a)},_updateBorderBottom:function(a,b){"Undefined"!=a&&(t._engineLogger.warn("YOYYO FUUUUUCKED",
null),this._instances.h[b.__id__].style.borderBottom=a)},_updateDisplay:function(a,b){this._instances.h[b.__id__].style.display=a},_updateText:function(a,b){switch(this.gameEntity.getState("NCmeshType")){case "Div":"Undefined"!=a&&(this._instances.h[b.__id__].innerHTML=a);break;case "Input":this._instances.h[b.__id__].value=a;break;case "Button":"Undefined"!=a&&(this._instances.h[b.__id__].innerHTML=a)}},_updateNCmeshType:function(a,b){switch(a){case "Div":break;case "Button":this._updateButtonProperties(b);
break;case "Input":this._updateInputProperties(b);break;case "Image":this._updateImageSrc(this.gameEntity.getState("src"),b);break;case "Ace":this._updateAceProperties(b);break;case "Tree":this._updateTreeProperties(b);break;case "Scroller":this._updateScrollerProperties(b);break;case "Video":this._updateVideoProperties(b);break;case "Undefined":t._engineLogger.warn("Undefined NCmeshType value",null);break;default:t._engineLogger.warn("Unhandled NCmeshType value: "+a,null)}},_updateInputProperties:function(a){a=
this._instances.h[a.__id__];null!=this.gameEntity.getState("text")&&"Undefined"!=this.gameEntity.getState("text")&&(a.value=this.gameEntity.getState("text"));null!=this.gameEntity.getState("placeholder")&&"Undefined"!=this.gameEntity.getState("placeholder")&&(a.placeholder=this.gameEntity.getState("placeholder"));null!=this.gameEntity.getState("type")&&"Undefined"!=this.gameEntity.getState("type")&&(a.type=this.gameEntity.getState("type"));"file"==this.gameEntity.getState("type")&&(null!=this.gameEntity.getState("accept")&&
"Undefined"!=this.gameEntity.getState("accept")&&(a.accept=this.gameEntity.getState("accept")),a.multiple=this.gameEntity.getState("multiple"))},_updateButtonProperties:function(a){a=this._instances.h[a.__id__];null!=this.gameEntity.getState("text")&&"Undefined"!=this.gameEntity.getState("text")&&(a.innerHTML=this.gameEntity.getState("text"))},_updateAceProperties:function(a){null==this.gameEntity.getState("aceObject")&&(a=this._instances.h[a.__id__],a.id="editor"+r.string(r.random(999999999)),a=
ace.edit(a.id),a.setTheme("ace/theme/merbivore_soft"),a.getSession().setMode("ace/mode/xml"),this.gameEntity.setState("aceObject",a))},_updateTreeProperties:function(a){a=this._instances.h[a.__id__];a.id="tree";var b=$("#tree");a.style.overflowX="hidden";a.style.overflowY="scroll";this.gameEntity.setState("treeObject",b)},_updateScrollerProperties:function(a){var b=this._instances.h[a.__id__];b.style.overflowY="auto";a=r.string(r.random(999999));b.id=a;var c=$("#"+a);c.mCustomScrollbar({theme:"light-thick",
scrollButtons:{enable:!0},autoHideScrollbar:!0,autoExpandScrollbar:!0});b=b.firstElementChild.firstElementChild;b.style.marginRight="0";this.gameEntity.setState("scrollerId",a);this.gameEntity.setState("scrollerObject",c);this.gameEntity.setState("scrollerContainerObject",b)},_updateVideoProperties:function(a){this.gameEntity.setState("videoObject",this._instances.h[a.__id__]);t._engineLogger.error("HIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",null)},_updateTouchable:function(a,b){var c=this._instances.h[b.__id__];
null!=c&&(a?(c.onclick=u(this,this._onPointerClick),c.oncontextmenu=u(this,this._onMouseRightClick),c.onmousedown=u(this,this._onMouseDown),c.onmouseup=u(this,this._onMouseUp),c.onmouseenter=u(this,this._onMouseEnter),c.onmouseleave=u(this,this._onMouseLeave),c.onmousemove=u(this,this._onMouseMove),c.onwheel=u(this,this._onScroll)):this.gameEntity.getState("preventDefaultEvents")&&(c.oncontextmenu=u(this,this._preventDefault)))},_preventDefault:function(){return!1},_updateAcceptsKeyboardInput:function(a,
b){var c=this._instances.h[b.__id__];null!=c&&a&&(c.onkeypress=u(this,this._onKeyPress),c.onkeyup=u(this,this._onKeyRelease),c.onkeydown=u(this,this._onKeyDown),c.tabIndex=1)},_updateDraggable:function(a,b){var c=this._instances.h[b.__id__];null!=c&&a&&(c.ondragstart=u(this,this._onDragStart),c.ondrag=u(this,this._onDrag),c.ondragend=u(this,this._onDragEnd),c.draggable=!0)},_updatePointerEvents:function(a,b){var c=this._instances.h[b.__id__];null!=c&&c.style.setProperty("pointer-events",a)},_updateZindex:function(a,
b){0!=a&&(this._instances.h[b.__id__].style.zIndex=null==a?"null":""+a)},_updateZOrder:function(a,b){var c=this._instances.h[b.__id__];t._engineLogger.error("DEBUG->Updating z order of DOM element to: "+a,null);t._engineLogger.error("DEBUG->Current zIndex: "+c.style.zIndex,null);c.style.zIndex=null==a?"null":""+a},_queryGlobalPosition:function(a,b){var c=this._instances.h[b.__id__],d=0,e=0;do d+=c.offsetTop,e+=c.offsetLeft,c=c.offsetParent;while(null!=c);return new jd(e,d)},_queryAbsoluteRect:function(a,
b){return this._instances.h[b.__id__].getBoundingClientRect()},_queryGroupObject:function(a,b){return this.groupInstances.h[b.__id__]},_onDragStart:function(a){var b;b=window.document.createElement("img");a.dataTransfer.setDragImage(b,0,0);this.gameEntity.setState("eventObject",a);s.event.raiseEvent(m.ON_DRAG_START,this.gameEntity)},_onDrag:function(a){this.gameEntity.setState("eventObjectOnDrag",a);s.event.raiseEvent(m.ON_DRAG,this.gameEntity)},_onDragEnd:function(a){this.gameEntity.setState("eventObject",
a);s.event.raiseEvent(m.ON_DRAG_END,this.gameEntity)},_updateDropTarget:function(a,b){var c=this._instances.h[b.__id__];null!=c&&a&&(c.ondragenter=u(this,this._onDragEnter),c.ondragover=u(this,this._onDragOver),c.ondragleave=u(this,this._onDragLeave),c.ondrop=u(this,this._onDrop))},_onDragEnter:function(a){this.gameEntity.setState("eventObject",a);s.event.raiseEvent(m.ON_DRAG_ENTER,this.gameEntity)},_onDragOver:function(a){this.gameEntity.setState("eventObject",a);a.preventDefault();s.event.raiseEvent(m.ON_DRAG_OVER,
this.gameEntity)},_onDragLeave:function(a){this.gameEntity.setState("eventObject",a);s.event.raiseEvent(m.ON_DRAG_LEAVE,this.gameEntity)},_onDrop:function(a){this.gameEntity.setState("eventObject",a);a.preventDefault();s.event.raiseEvent(m.ON_DROP,this.gameEntity)},_onKeyPress:function(a){this.gameEntity.setState("eventObjectKeyPress",a);this.gameEntity.getState("preventDefaultEvents")&&a.preventDefault();s.event.raiseEvent(m.KEY_PRESSED_LOCAL,this.gameEntity)},_onKeyRelease:function(a){this.gameEntity.setState("eventObjectKeyRelease",
a);this.gameEntity.getState("preventDefaultEvents")&&a.preventDefault();s.event.raiseEvent(m.KEY_RELEASED_LOCAL,this.gameEntity)},_onKeyDown:function(a){this.gameEntity.setState("eventObjectKeyDown",a);this.gameEntity.getState("preventDefaultEvents")&&a.preventDefault();s.event.raiseEvent(m.KEY_DOWN_LOCAL,this.gameEntity)},_onPointerClick:function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();this.gameEntity.setState("eventObject",a);s.input.pointer.submitPointerEvent(m.MOUSE_LEFT_CLICK,
this.gameEntity)},_onMouseRightClick:function(a){this.gameEntity.getState("preventDefaultEvents")&&a.preventDefault();this.gameEntity.setState("eventObject",a);s.input.pointer.submitPointerEvent(m.MOUSE_RIGHT_CLICK,this.gameEntity)},_onMouseDown:function(a){this.gameEntity.setState("eventObject",a);s.input.pointer.submitPointerEvent(m.MOUSE_DOWN,this.gameEntity)},_onMouseUp:function(a){this.gameEntity.setState("eventObject",a);s.input.pointer.submitPointerEvent(m.MOUSE_UP,this.gameEntity)},_onMouseEnter:function(a){this.gameEntity.setState("eventObject",
a);s.input.pointer.submitPointerEvent(m.MOUSE_ENTERED,this.gameEntity)},_onMouseLeave:function(a){this.gameEntity.setState("eventObject",a);s.input.pointer.submitPointerEvent(m.MOUSE_LEFT,this.gameEntity)},_onMouseMove:function(a){this.gameEntity.setState("eventObjectMouseMove",a);s.input.pointer.submitPointerEvent(m.MOUSE_MOVED,this.gameEntity)},_onScroll:function(a){this.gameEntity.setState("eventObject",a);s.input.pointer.submitPointerEvent(m.MOUSE_SCROLL,this.gameEntity)},_onChange:function(a){"file"==
this.gameEntity.getState("type")?this.gameEntity.setState("files",a.target.files):this.gameEntity.setState("text",a.target.value);s.event.raiseEvent(m.CHANGED,this.gameEntity)},__class__:td});var bh=function(){};h["tools.spark.framework.space2_5D.interfaces.IScene2_5D"]=bh;bh.__name__="tools,spark,framework,space2_5D,interfaces,IScene2_5D".split(",");bh.__interfaces__=[Je];bh.prototype={__class__:bh};var ba=function(a){this._tempY=this._tempX=0;this._scaleY=this._scaleX=1;bc.call(this,a)};h["tools.spark.framework.space2_5D.core.AScene2_5D"]=
ba;ba.__name__="tools,spark,framework,space2_5D,core,AScene2_5D".split(",");ba.__interfaces__=[bh];ba.__super__=bc;ba.prototype=x(bc.prototype,{createInstance:function(a){return bc.prototype.createInstance.call(this,a)},_createChildOfInstance:function(a,b,c){null==c&&(c=-1);!0==a.gameEntity.getState("layoutable")&&(-1==c?b.group.children.push(a.groupInstances.h[b.__id__]):b.group.children.splice(c,0,a.groupInstances.h[b.__id__]));a.parentScene=this},_removeChildOfInstance:function(a,b){!0==a.gameEntity.getState("layoutable")&&
A.remove(b.group.children,a.groupInstances.h[b.__id__])},updateCamera:function(a,b){var c=this._getCaptureRect(a,b),d=a.gameEntity.getState("feedbackWidth")/c.width,e=a.gameEntity.getState("feedbackHeight")/c.height;this._scaleX=this._scaleY=d=Math.min(d,e);this._tempX=-c.x*d;this._tempY=-c.y*d},_getCaptureRect:function(a,b){var c=a.gameEntity,d=b.gameEntity,e=d.getState("x"),f=d.getState("y"),i=d.getState("width")*d.getState("zoom"),g=d.getState("height")*d.getState("zoom"),o=d.getState("minBoundsWidthRatio"),
h=d.getState("minBoundsHeightRatio"),j=d.getState("minBoundsHorizontalAlign"),d=d.getState("minBoundsVerticalAlign"),o=i*o,h=g*h,k=c.getState("feedbackWidth"),c=c.getState("feedbackHeight"),c=k/c;ba._rect.x=0;ba._rect.y=0;ba._rect.width=0;ba._rect.height=0;1.5<c?(ba._rect.height=h,ba._rect.width=Math.round(ba._rect.height*c)):(ba._rect.width=o,ba._rect.height=Math.round(ba._rect.width/c));"Left"==j?ba._rect.x=e:"Center"==j?ba._rect.x=e+(i-ba._rect.width)/2:"Right"==j&&(ba._rect.x=e+(i-ba._rect.width));
"Top"==d?ba._rect.y=f:"Middle"==d?ba._rect.y=f+(g-ba._rect.height)/2:"Bottom"==d&&(ba._rect.y=f+(g-ba._rect.height));return ba._rect},__class__:ba});var Jd=function(a){ba.call(this,a);this._initDomScene2_5D()};h["tools.spark.framework.dom2_5D.DomScene2_5D"]=Jd;Jd.__name__=["tools","spark","framework","dom2_5D","DomScene2_5D"];Jd.__super__=ba;Jd.prototype=x(ba.prototype,{_initDomScene2_5D:function(){},createInstance:function(a){var b;b=window.document.createElement("div");this._instances.set(a,b);
b;this._instances.h[a.__id__].style.position="absolute";this._instances.h[a.__id__].style.setProperty("pointer-events","none");return ba.prototype.createInstance.call(this,a)},update:function(a){for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.update(a)}},_createChildOfInstance:function(a,b,c){null==c&&(c=-1);this._instances.h[b.__id__].appendChild(w.__cast(a.createInstance(b),HTMLElement));ba.prototype._createChildOfInstance.call(this,a,b,c)},_removeChildOfInstance:function(a,b){this._instances.h[b.__id__].removeChild(w.__cast(a.getInstance(b),
HTMLElement));ba.prototype._removeChildOfInstance.call(this,a,b)},__class__:Jd});var ch=function(){};h["tools.spark.framework.space2_5D.interfaces.IView2_5D"]=ch;ch.__name__="tools,spark,framework,space2_5D,interfaces,IView2_5D".split(",");ch.__interfaces__=[Cf];ch.prototype={__class__:ch};var Nc=function(a){this.gameEntity=a;this.group=s.display.projectActiveSpaceReference.activeStageReference.layoutManager.getViewGroupByGameEntity(this.gameEntity);this.group.layoutableInstance=this};h["tools.spark.framework.space2_5D.core.AView2_5D"]=
Nc;Nc.__name__="tools,spark,framework,space2_5D,core,AView2_5D".split(",");Nc.__interfaces__=[ch];Nc.__super__=Vd;Nc.prototype=x(Vd.prototype,{render:function(){},updateCamera:function(){this.scene.updateCamera(this,this.camera)},__class__:Nc});var Kd=function(a){Nc.call(this,a);this._initDomView2_5D()};h["tools.spark.framework.dom2_5D.DomView2_5D"]=Kd;Kd.__name__=["tools","spark","framework","dom2_5D","DomView2_5D"];Kd.__super__=Nc;Kd.prototype=x(Nc.prototype,{updateState:function(a){switch(a){case "visible":this._instanceView.style.display=
!0==this.gameEntity.getState(a)?"inline":"none";break;case "width":this._updateWidth(this.gameEntity.getState(a));break;case "height":this._updateHeight(this.gameEntity.getState(a))}},_updateWidth:function(){!0==this.gameEntity.getState("layoutable")&&(this.group.updateState("width"),s.display.projectActiveSpaceReference.activeStageReference.layoutManager.validated=!1)},_updateHeight:function(){!0==this.gameEntity.getState("layoutable")&&(this.group.updateState("height"),s.display.projectActiveSpaceReference.activeStageReference.layoutManager.validated=
!1)},_initDomView2_5D:function(){var a=window.document.getElementById("content");this._instanceView=window.document.createElement("div");this._instanceView.style.position="absolute";this._instanceView.style.setProperty("pointer-events","none");a.insertBefore(this._instanceView,a.firstElementChild)},destroy:function(){window.document.getElementById("content").removeChild(this._instanceView)},set_camera:function(a){if(this.camera==a)return this.camera;if(null==a)return this.camera=null,this._updateCurrentView(),
null;this.camera=a;this.camera.attachToView(this);this._updateCurrentView();return this.camera},set_scene:function(a){if(this.scene==a)return this.scene;if(null==a)return this.scene=null,this._disposeCurrentScene(),this._updateCurrentView(),null;this.scene=a;this._instanceScene=w.__cast(this.scene.createInstance(this),HTMLDivElement);this._updateCurrentView();return this.scene},_updateCurrentView:function(){null==this.scene||null==this.camera?null!=this._instanceView.firstElementChild&&this._instanceView.removeChild(this._instanceView.firstElementChild):
(null==this._instanceView.firstElementChild&&this._instanceView.appendChild(this._instanceScene),this.scene.update(this))},_disposeCurrentScene:function(){this._instanceScene=null},setPosSize:function(a,b,c,d,e){null!=a&&(this._instanceView.style.left=(null==a?"null":""+a)+"px");null!=b&&(this._instanceView.style.top=(null==b?"null":""+b)+"px");null!=c&&(this._instanceView.style.width=(null==c?"null":""+c)+"px");null!=d&&(this._instanceView.style.height=(null==d?"null":""+d)+"px");Nc.prototype.setPosSize.call(this,
a,b,c,d,e)},__class__:Kd});var Le=function(a){Mc.call(this,a)};h["tools.spark.framework.flambe2_5D.FlambeCamera2_5D"]=Le;Le.__name__=["tools","spark","framework","flambe2_5D","FlambeCamera2_5D"];Le.__super__=Mc;Le.prototype=x(Mc.prototype,{__class__:Le});var Ld=function(a){bc.call(this,a);this._initFlambeEntity2_5D()};h["tools.spark.framework.flambe2_5D.FlambeEntity2_5D"]=Ld;Ld.__name__=["tools","spark","framework","flambe2_5D","FlambeEntity2_5D"];Ld.__super__=Ma;Ld.prototype=x(Ma.prototype,{_initFlambeEntity2_5D:function(){this._instancesMesh=
new Fa;var a=u(this,this._update2DMeshType);this._updateStateFunctions.set("2DmeshType",a);a;a=u(this,this._updatePositionX);this._updateStateFunctions.set("spaceX",a);a;a=u(this,this._updatePositionY);this._updateStateFunctions.set("spaceY",a);a;a=u(this,this._updateSizeX);this._updateStateFunctions.set("scaleX",a);a;a=u(this,this._updateSizeY);this._updateStateFunctions.set("scaleY",a);a;a=u(this,this._updateRotation);this._updateStateFunctions.set("rotation",a);a;a=u(this,this._updateAnimateX);
this._updateStateFunctions.set("animate_x",a);a;a=u(this,this._updateAnimateY);this._updateStateFunctions.set("animate_y",a);a;a=u(this,this._updateAnimateScaleX);this._updateStateFunctions.set("animate_scaleX",a);a;a=u(this,this._updateAnimateScaleY);this._updateStateFunctions.set("animate_scaleY",a);a;a=u(this,this._updateAnimateRotation);this._updateStateFunctions.set("animate_rotation",a);a;a=u(this,this._updateBlendMode);this._updateStateFunctions.set("blendMode",a);a;a=u(this,this._updateTouchable);
this._updateStateFunctions.set("touchable",a);a;a=u(this,this._updateVisible);this._updateStateFunctions.set("visible",a);a;a=u(this,this._updateOpacity);this._updateStateFunctions.set("opacity",a);a;a=u(this,this._updateAnimateOpacity);this._updateStateFunctions.set("animate_opacity",a);a;a=u(this,this._updateVelocityX);this._updateStateFunctions.set("velocityX",a);a;a=u(this,this._updateVelocityY);this._updateStateFunctions.set("velocityY",a);a;a=u(this,this._updateVelocityAng);this._updateStateFunctions.set("velocityAng",
a);a;a=u(this,this._updateApplyImpulseX);this._updateStateFunctions.set("applyImpulseX",a);a;a=u(this,this._updateApplyImpulseY);this._updateStateFunctions.set("applyImpulseY",a);a;a=u(this,this._updateApplyImpulseAngle);this._updateStateFunctions.set("applyImpulseAngle",a);a;a=u(this,this._centerAnchor);this._updateStateFunctions.set("centerAnchor",a);a;a=u(this,this._updatePhysics);this._updateStateFunctions.set("physicsEntity",a);a;a=u(this,this._updateSpaceWidth);this._updateStateFunctions.set("spaceWidth",
a);a;a=u(this,this._updateSpaceHeight);this._updateStateFunctions.set("spaceHeight",a);a;a=u(this,this._update2DMeshImageForm);this._updateStateFunctions.set("2DMeshImageForm",a);a;a=u(this,this._update2DMeshTextForm);this._updateStateFunctions.set("2DMeshTextForm",a);a;a=u(this,this._update2DMeshSpriterForm);this._updateStateFunctions.set("2DMeshSpriterForm",a);a;a=u(this,this._update2DMeshSpritesheetForm);this._updateStateFunctions.set("2DMeshSpritesheetForm",a);a;a=u(this,this._update2DMeshAdobeAnimationForm);
this._updateStateFunctions.set("2DMeshAdobeAnimationForm",a);a;a=u(this,this._update2DMeshParticleEmitterForm);this._updateStateFunctions.set("2DMeshParticleEmitterForm",a);a;a=u(this,this._update2DMeshFillRectForm);this._updateStateFunctions.set("2DMeshFillRectForm",a);a;a=u(this,this._update2DMeshSpriteForm);this._updateStateFunctions.set("2DMeshSpriteForm",a);a;a=u(this,this._update2DMeshSpriterAnimForm);this._updateStateFunctions.set("2DMeshSpriterAnimForm",a);a;a=u(this,this._updateAnimation);
this._updateStateFunctions.set("Animation",a);a;a=u(this,this._updateAnimationSpeed);this._updateStateFunctions.set("Animation Speed",a);a;a=u(this,this._updateFireParticle);this._updateStateFunctions.set("action_fire",a);a;a=u(this,this._updateEmitX);this._updateStateFunctions.set("emitX",a);a;a=u(this,this._updateEmitY);this._updateStateFunctions.set("emitY",a);a;a=u(this,this._updateParticleEnabled);this._updateStateFunctions.set("particleEnabled",a);a;a=u(this,this._updateParticleDuration);this._updateStateFunctions.set("particleDuration",
a);a;a=u(this,this._updateText);this._updateStateFunctions.set("text",a);a;a=u(this,this._updateFont);this._updateStateFunctions.set("font",a);a;a=u(this,this._updateAlign);this._updateStateFunctions.set("align",a);a;a=u(this,this._updateWrapWidth);this._updateStateFunctions.set("wrapWidth",a);a;a=u(this,this._updateLetterSpacing);this._updateStateFunctions.set("letterSpacing",a);a;a=u(this,this._updateLineSpacing);this._updateStateFunctions.set("lineSpacing",a);a;a=u(this,this._updateScissorRect);
this._updateStateFunctions.set("scissorRect",a);a;a=u(this,this._updateZOrder);this._updateStateFunctions.set("command_zOrder",a);a;a=u(this,this._queryRealWidth);this._queryFunctions.set("realWidth",a);a;a=u(this,this._queryRealHeight);this._queryFunctions.set("realHeight",a);a;a=u(this,this._queryBoundsX);this._queryFunctions.set("boundsX",a);a;a=u(this,this._queryBoundsY);this._queryFunctions.set("boundsY",a);a;a=u(this,this._queryBoundsWidth);this._queryFunctions.set("boundsWidth",a);a;a=u(this,
this._queryBoundsHeight);this._queryFunctions.set("boundsHeight",a);a;a=u(this,this._queryRealX);this._queryFunctions.set("x",a);a;a=u(this,this._queryRealY);this._queryFunctions.set("y",a);a;a=u(this,this._queryRealRotation);this._queryFunctions.set("angle",a);a},createInstance:function(a){t.error("Creating: "+r.string(this.gameEntity.getState("name")),null);if(null!=this._instances.h[a.__id__])return this._instances.h[a.__id__];var b=new Ua;this._instances.set(a,b);b;return Ma.prototype.createInstance.call(this,
a)},_createChildOfInstance:function(a,b,c){null==c&&(c=-1);-1==c?this._instances.h[b.__id__].addChild(w.__cast(a.createInstance(b),Ua)):this._instances.h[b.__id__].addChild(w.__cast(a.createInstance(b),Ua),!0,c);Ma.prototype._createChildOfInstance.call(this,a,b,c)},_removeChildOfInstance:function(a,b){var c;c=w.__cast(a.getInstance(b),Ua);var d=c._compMap.BodyComponent_7;null!=d&&c.remove(d);null!=c.parent&&this._instances.h[b.__id__].removeChild(c);Ma.prototype._removeChildOfInstance.call(this,a,
b)},update:function(a){this._updateState("2DmeshType",a);this._updateState("centerAnchor",a);this._updateState("physicsEntity",a);if(null==this.gameEntity.getState("layoutable")||!1==this.gameEntity.getState("layoutable"))this._updateState("spaceX",a),this._updateState("spaceY",a),this._updateState("animate_x",a),this._updateState("animate_y",a);this._updateState("scaleX",a);this._updateState("scaleY",a);this._updateState("rotation",a);this._updateState("blendMode",a);this._updateState("animate_scaleX",
a);this._updateState("animate_scaleY",a);this._updateState("animate_rotation",a);this._updateState("touchable",a);this._updateState("visible",a);this._updateState("opacity",a);this._updateState("animate_opacity",a);!0==this.gameEntity.getState("layoutable")&&this._updateLayoutGroup(a);for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.update(a)}},_update2DMeshType:function(a,b){switch(a){case "Image":null!=this._updateStateFunctions.get("2DMeshImageForm")?this._updateStateFunctions.get("2DMeshImageForm")(this.gameEntity.getState("2DMeshImageForm"),
b):t._engineLogger.warn("State 2DMeshImageForm does not have a function handler! Ignoring :(",null);break;case "Spriter":null!=this._updateStateFunctions.get("2DMeshSpriterForm")?this._updateStateFunctions.get("2DMeshSpriterForm")(this.gameEntity.getState("2DMeshSpriterForm"),b):t._engineLogger.warn("State 2DMeshSpriterForm does not have a function handler! Ignoring :(",null);break;case "Spritesheet":null!=this._updateStateFunctions.get("2DMeshSpritesheetForm")?this._updateStateFunctions.get("2DMeshSpritesheetForm")(this.gameEntity.getState("2DMeshSpritesheetForm"),
b):t._engineLogger.warn("State 2DMeshSpritesheetForm does not have a function handler! Ignoring :(",null);break;case "AdobeAnimation":null!=this._updateStateFunctions.get("2DMeshAdobeAnimationForm")?this._updateStateFunctions.get("2DMeshAdobeAnimationForm")(this.gameEntity.getState("2DMeshAdobeAnimationForm"),b):t._engineLogger.warn("State 2DMeshAdobeAnimationForm does not have a function handler! Ignoring :(",null);break;case "Particle Emitter":null!=this._updateStateFunctions.get("2DMeshParticleEmitterForm")?
this._updateStateFunctions.get("2DMeshParticleEmitterForm")(this.gameEntity.getState("2DMeshParticleEmitterForm"),b):t._engineLogger.warn("State 2DMeshParticleEmitterForm does not have a function handler! Ignoring :(",null);break;case "FillRect":null!=this._updateStateFunctions.get("2DMeshFillRectForm")?this._updateStateFunctions.get("2DMeshFillRectForm")(this.gameEntity.getState("2DMeshFillRectForm"),b):t._engineLogger.warn("State 2DMeshFillRectForm does not have a function handler! Ignoring :(",
null);break;case "Sprite":null!=this._updateStateFunctions.get("2DMeshSpriteForm")?this._updateStateFunctions.get("2DMeshSpriteForm")(this.gameEntity.getState("2DMeshSpriteForm"),b):t._engineLogger.warn("State 2DMeshSpriteForm does not have a function handler! Ignoring :(",null);break;case "Text":null!=this._updateStateFunctions.get("2DMeshTextForm")?this._updateStateFunctions.get("2DMeshTextForm")(this.gameEntity.getState("2DMeshTextForm"),b):t._engineLogger.warn("State 2DMeshTextForm does not have a function handler! Ignoring :(",
null);this._updateState("font",b);this._updateState("align",b);this._updateState("wrapWidth",b);this._updateState("letterSpacing",b);this._updateState("lineSpacing",b);break;case "Undefined":t._engineLogger.warn("Undefined 2DmeshType value",null);break;default:t._engineLogger.warn("Unhandled 2DmeshType value: "+a,null)}this._updateBounds(b)},_update2DMeshImageForm:function(a,b){if(!("Image"!=this.gameEntity.getState("2DmeshType")||"Undefined"==a)){var c=this._instances.h[b.__id__],d;d=null!=this._instancesMesh.h[b.__id__]?
w.__cast(this._instancesMesh.h[b.__id__],fe):null;var e;e="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,a.length-1)):a;null==d?(d=new fe(C.getTexture(e)),c.add(d),this._instancesMesh.set(b,d),d):(d.texture=C.getTexture(e),d.centerAnchor())}},_update2DMeshTextForm:function(a,b){if(!("Text"!=this.gameEntity.getState("2DmeshType")||"Undefined"==a)){var c=this._instances.h[b.__id__],d;d=null!=this._instancesMesh.h[b.__id__]?w.__cast(this._instancesMesh.h[b.__id__],mc):null;null==d&&
(d="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,a.length-1)):a,d=new re(C.getAssetPackOf(d+".fnt"),d),d=new mc(d,this.gameEntity.getState("text")),c.add(d),this._instancesMesh.set(b,d),d)}},_update2DMeshParticleEmitterForm:function(a,b){if(!("Particle Emitter"!=this.gameEntity.getState("2DmeshType")||"Undefined"==a)){var c=this._instances.h[b.__id__],d;d=null!=this._instancesMesh.h[b.__id__]?w.__cast(this._instancesMesh.h[b.__id__],ua):null;null==d&&(d="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,
a.length-1)):a,d=new L(C.getAssetPackOf(d+".pex"),d),this.gameEntity.setState("feedback_mold",d),d=d.createEmitter(),d.enabled=this.gameEntity.getState("particleEnabled"),d.duration=this.gameEntity.getState("particleDuration"),d.emitX.set__(this.gameEntity.getState("emitX")),d.emitY.set__(this.gameEntity.getState("emitY")),c.add(d),this._instancesMesh.set(b,d),d)}},_update2DMeshSpriterForm:function(a,b){if(!("Spriter"!=this.gameEntity.getState("2DmeshType")||"Undefined"==a)){var c=this._instances.h[b.__id__],
d=this._instancesMesh.h[b.__id__];if(null==d){var d=new E,e;e="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,a.length-1)):a;e=new Tg(C.getAssetPackOf(e),e,this.gameEntity.getState("Atlas Folder"),null,this.gameEntity.getState("Animation Speed"));c.add(d);c.add(e);this._instancesMesh.set(b,d);d;this.gameEntity.setState("obj_player",e);"Undefined"!=this.gameEntity.getState("Animation")&&e.playAnim(this.gameEntity.getState("Animation"))}}},_updateAnimation:function(a,b){if("Spriter"==
this.gameEntity.getState("2DmeshType")){var c=this._instances.h[b.__id__];null!=c._compMap.SpriterMovie_1&&c._compMap.SpriterMovie_1.playAnim(this.gameEntity.getState("Animation"))}},_updateAnimationSpeed:function(a,b){if("Spriter"==this.gameEntity.getState("2DmeshType")){var c=this._instances.h[b.__id__];null!=c._compMap.SpriterMovie_1&&(c._compMap.SpriterMovie_1.spriter.playbackSpeed=a)}},_update2DMeshSpritesheetForm:function(a,b){if(!("Spritesheet"!=this.gameEntity.getState("2DmeshType")||"Undefined"==
a)){var c=this._instances.h[b.__id__],d=this._instancesMesh.h[b.__id__];if(null==d){var d=new E,e;e="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,a.length-1)):a;e=new dh(C.getAssetPackOf(e),e,this.gameEntity.getState("Atlas File"));this.gameEntity.setState("obj_player",e);c.add(d);c.add(e);this._instancesMesh.set(b,d);d}c=c._compMap.SpriteSheetPlayer_2;!0==this.gameEntity.getState("AnimationLoop")?c.loop():c.play();c.setSpeed(this.gameEntity.getState("AnimationSpeed"))}},_update2DMeshAdobeAnimationForm:function(a,
b){if(!("AdobeAnimation"!=this.gameEntity.getState("2DmeshType")||"Undefined"==a)){var c=this._instances.h[b.__id__],d=this._instancesMesh.h[b.__id__];if(null==d){var d=new E,e;e="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,a.length-1)):a;e=new Li(C.getAssetPackOf(e),e,this.gameEntity.getState("Atlas Folder"));e=new xg(e);!0==this.gameEntity.getState("Animation Loop")?e.loop(this.gameEntity.getState("Animation")):e.play(this.gameEntity.getState("Animation"));var f=(new Ua).add(e);
this.gameEntity.setState("obj_player",e);c.add(d);c.addChild(f);this._instancesMesh.set(b,d);d}}},_update2DMeshFillRectForm:function(a,b){if(!("FillRect"!=this.gameEntity.getState("2DmeshType")||"Undefined"==a)){var c=this._instances.h[b.__id__],d;d=null!=this._instancesMesh.h[b.__id__]?w.__cast(this._instancesMesh.h[b.__id__],yb):null;var e;e="["==a.charAt(0)?this.gameEntity.gameForm.getState(a.substring(1,a.length-1)):r.parseInt(a);null==d?(d=new yb(e,this.gameEntity.getState("spaceWidth"),this.gameEntity.getState("spaceHeight")),
d.scissor=new Jb(0,0,this.gameEntity.getState("spaceWidth"),this.gameEntity.getState("spaceHeight")),c.add(d),this._instancesMesh.set(b,d),d):d.color=e}},_updateScissorRect:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=c&&(null==c.scissor?c.scissor=new Jb(a.x,a.y,a.width,a.height):(c.scissor.x=a.x,c.scissor.y=a.y,c.scissor.width=a.width,c.scissor.height=a.height))},_update2DMeshSpriteForm:function(a,b){if("Sprite"==this.gameEntity.getState("2DmeshType")){var c=this._instances.h[b.__id__],
d;d=null!=this._instancesMesh.h[b.__id__]?w.__cast(this._instancesMesh.h[b.__id__],E):null;null==d&&(d=new E,c.add(d),this._instancesMesh.set(b,d),d)}},_update2DMeshSpriterAnimForm:function(a,b){if(!("Spriter"!=this.gameEntity.getState("2DmeshType")||"Undefined"==this.gameEntity.getState("2DMeshSpriterForm"))&&"Undefined"!=a){var c=this._instances.h[b.__id__]._compMap.SpriterMovie_1;null!=c&&c.playAnim(this.gameEntity.gameForm.getState(a))}},_updateAnimateX:function(a,b){var c=this._instancesMesh.h[b.__id__];
if(null!=a&&(null==this.gameEntity.getState("physicsEntity")||!1==this.gameEntity.getState("physicsEntity")))null==a.type||"normal"==a.type?c.x.animate(a.from,a.to,a.seconds,a.easing):"to"==a.type?c.x.animateTo(a.to,a.seconds,a.easing):"by"==a.type?c.x.animateBy(a.by,a.seconds,a.easing):t._engineLogger.warn("Unknown animate method",null)},_updateAnimateY:function(a,b){var c=this._instancesMesh.h[b.__id__];if(null!=a&&(null==this.gameEntity.getState("physicsEntity")||!1==this.gameEntity.getState("physicsEntity")))null==
a.type||"normal"==a.type?c.y.animate(a.from,a.to,a.seconds,a.easing):"to"==a.type?c.y.animateTo(a.to,a.seconds,a.easing):"by"==a.type?c.y.animateBy(a.by,a.seconds,a.easing):t._engineLogger.warn("Unknown animate method",null)},_updateAnimateScaleX:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=a&&(null==a.type||"normal"==a.type?c.scaleX.animate(a.from,a.to,a.seconds,a.easing):"to"==a.type?c.scaleX.animateTo(a.to,a.seconds,a.easing):"by"==a.type?c.scaleX.animateBy(a.by,a.seconds,a.easing):
t._engineLogger.warn("Unknown animate method",null))},_updateAnimateScaleY:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=a&&(null==a.type||"normal"==a.type?c.scaleY.animate(a.from,a.to,a.seconds,a.easing):"to"==a.type?c.scaleY.animateTo(a.to,a.seconds,a.easing):"by"==a.type?c.scaleY.animateBy(a.by,a.seconds,a.easing):t._engineLogger.warn("Unknown animate method",null))},_updateAnimateRotation:function(a,b){var c=this._instancesMesh.h[b.__id__];if(null!=a&&(null==this.gameEntity.getState("physicsEntity")||
!1==this.gameEntity.getState("physicsEntity")))null==a.type||"normal"==a.type?c.rotation.animate(a.from,a.to,a.seconds,a.easing):"to"==a.type?c.rotation.animateTo(a.to,a.seconds,a.easing):"by"==a.type?c.rotation.animateBy(a.by,a.seconds,a.easing):t._engineLogger.warn("Unknown animate method",null)},_updatePositionX:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=this._instances.h[b.__id__]._compMap.BodyComponent_7?"Static"!=this.gameEntity.getState("physicsType")&&w.__cast(this.gameEntity.getState("physicsBody"),
Hc).get_position().set_x(a):c.x.set__(a)},_updatePositionY:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=this._instances.h[b.__id__]._compMap.BodyComponent_7?"Static"!=this.gameEntity.getState("physicsType")&&w.__cast(this.gameEntity.getState("physicsBody"),Hc).get_position().set_y(a):c.y.set__(a)},_updateSizeX:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=c&&c.scaleX.set__(a)},_updateSizeY:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=c&&c.scaleY.set__(a)},_updateRotation:function(a,
b){var c=this._instancesMesh.h[b.__id__];null!=this._instances.h[b.__id__]._compMap.BodyComponent_7?"Static"!=this.gameEntity.getState("physicsType")&&w.__cast(this.gameEntity.getState("physicsBody"),Hc).set_rotation(3.141592653589793*a/180):c.rotation.set__(a)},_updateVisible:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=c&&c.set_visible(a)},_updateOpacity:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=c&&c.setAlpha(a)},_updateBlendMode:function(a,b){var c=this._instancesMesh.h[b.__id__];
null!=c&&"Undefined"!=a&&("Mask"==a?c.blendMode=ia.Mask:"Normal"==a?c.blendMode=ia.Normal:"Add"==a?c.blendMode=ia.Add:"Copy"==a?c.blendMode=ia.Copy:"Multiply"==a?c.blendMode=ia.Multiply:"Screen"==a&&(c.blendMode=ia.Screen))},_updateAnimateOpacity:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=a&&(null==a.type||"normal"==a.type?c.alpha.animate(a.from,a.to,a.seconds,a.easing):"to"==a.type?c.alpha.animateTo(a.to,a.seconds,a.easing):"by"==a.type?c.alpha.animateBy(a.by,a.seconds,a.easing):t._engineLogger.warn("Unknown animate method",
null))},_updateFireParticle:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],ua);null!=c&&!0==a&&(c.restart(),this.gameEntity.setStateSilent("action_fire",!1))},_updateEmitX:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],ua);null!=c&&c.emitX.set__(a)},_updateEmitY:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],ua);null!=c&&c.emitY.set__(a)},_updateParticleEnabled:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],ua);null!=c&&(c.enabled=a)},
_updateParticleDuration:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],ua);null!=c&&(c.duration=a)},_updateText:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],mc);null!=c&&c.set_text(a)},_updateFont:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],mc);null!=c&&c.set_font(new re(C.getAssetPackOf(a+".fnt"),a))},_updateAlign:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],mc);if(null!=c)switch(a){case "Left":c.setAlign(Ya.Left);break;case "Center":c.setAlign(Ya.Center);
break;case "Right":c.setAlign(Ya.Right)}},_updateWrapWidth:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],mc);null!=c&&c.setWrapWidth(a)},_updateLetterSpacing:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],mc);null!=c&&c.setLetterSpacing(a)},_updateLineSpacing:function(a,b){var c;c=w.__cast(this._instancesMesh.h[b.__id__],mc);null!=c&&c.setLineSpacing(a)},_updateZOrder:function(a,b){this._instances.h[b.__id__].setZOrder(a)},_centerAnchor:function(a,b){var c=this._instancesMesh.h[b.__id__];
null!=c&&(c.centerAnchor(),null!=this.gameEntity.getState("anchorX")&&"Undefined"!=this.gameEntity.getState("anchorX")&&c.anchorX.set__(this.gameEntity.getState("anchorX")),null!=this.gameEntity.getState("anchorY")&&"Undefined"!=this.gameEntity.getState("anchorY")&&c.anchorY.set__(this.gameEntity.getState("anchorY")))},_updatePhysics:function(a,b){var c=this._instances.h[b.__id__];if(null!=this._instancesMesh.h[b.__id__])if(a)if(null!=this.parentScene)if(this.parentScene.gameEntity.getState("physicsScene"))if(0<
this._queryBoundsWidth("boundsWidth",b)){var d=this.parentScene.getInstance(b),e;"Static"==this.gameEntity.getState("physicsType")?(null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1),e=g.BodyType_STATIC):"Kinematic"==this.gameEntity.getState("physicsType")?(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1),e=g.BodyType_KINEMATIC):"Dynamic"==this.gameEntity.getState("physicsType")?(null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=
new Ga,g.internal=!1),e=g.BodyType_DYNAMIC):(null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1),e=g.BodyType_STATIC);e=new Hc(e);var f;switch(this.gameEntity.getState("physicsMaterial")){case "Glass":f=ra.glass();break;case "Ice":f=ra.ice();break;case "Rubber":f=ra.rubber();break;case "Sand":f=ra.sand();break;case "Steel":f=ra.steel();break;case "Wood":f=ra.wood();break;case "Ellastic":f=new ra(1,0,0,1,0);break;case "Biped":f=new ra(0,1,2,10,0.001);break;default:f=ra.wood()}var i=
this._queryBoundsWidth("boundsWidth",b)*this.gameEntity.getState("scaleX"),h=this._queryBoundsHeight("boundsHeight",b)*this.gameEntity.getState("scaleY"),o=null;switch(this.gameEntity.getState("physicsShape")){case "Circle":o=new Jg((i+h)/4,null,f);break;case "Polygon":t.warn("("+r.string(this.gameEntity.getState("name"))+") l_meshWidth: "+i,null);t.warn("("+r.string(this.gameEntity.getState("name"))+") l_meshHeight: "+h,null);"Spriter"==this.gameEntity.getState("2DmeshType")?(t.warn("("+r.string(this.gameEntity.getState("name"))+
") boundsX: "+r.string(this._queryBoundsX("boundsX",b)),null),t.warn("("+r.string(this.gameEntity.getState("name"))+") boundsY: "+r.string(this._queryBoundsY("boundsY",b)),null),o=new Nb(Nb.rect(this._queryBoundsX("boundsX",b),this._queryBoundsY("boundsY",b),i,h),f)):o=new Nb(Nb.box(i,h),f);break;case "Triangle":f=Nb.regular(0.5*i,h,4,0.5*-Math.PI);f.splice(2,1);for(i=0;i<f.length;){o=f[i];++i;var j=o;j.set_y(function(){j.zpp_inner.validate();return j.zpp_inner.y}(this)+h/2)}o=new Nb(f);break;case "Biped":t._engineLogger.warn("NOT YET IMPLEMENTED. Look below",
null);break;default:o=new Nb(Nb.box(i,h),f)}null!=o&&(o.set_sensorEnabled(this.gameEntity.getState("physicsSensorFlag")),e.zpp_inner.wrap_shapes.add(o));e.set_allowRotation(this.gameEntity.getState("allowRotation"));12345!=this.gameEntity.getState("inertia")&&e.set_inertia(this.gameEntity.getState("inertia"));this.gameEntity.setState("physicsBody",e);e.set_position(new Va(this.gameEntity.getState("spaceX"),this.gameEntity.getState("spaceY")));e.set_rotation(Ra.toRadians(this.gameEntity.getState("rotation")));
if("Dynamic"==this.gameEntity.getState("physicsType")||"Kinematic"==this.gameEntity.getState("physicsType"))e.set_velocity(new Va(this.gameEntity.getState("velocityX"),this.gameEntity.getState("velocityY"))),e.set_angularVel(Ra.toRadians(this.gameEntity.getState("velocityAng")));e.set_space(d._compMap.SpaceComponent_6.space);null==e.zpp_inner_i.userData&&(e.zpp_inner_i.userData={});e.zpp_inner_i.userData.gameEntity=this.gameEntity;c.add(new eh(e));null!=c._compMap.PreBodyComponent_4&&c.remove(c._compMap.PreBodyComponent_4)}else c.add(new fh(this.gameEntity)),
t.warn("Entity "+r.string(this.gameEntity.getState("name"))+" failed to become a physics object. But will try again next frame",null);else this.gameEntity.setState("physicsEntity",!1),t.warn("Entity "+r.string(this.gameEntity.getState("name"))+" failed to become a physics object. ParentScene not physics",null);else this.gameEntity.setState("physicsEntity",!1),t.warn("Entity "+r.string(this.gameEntity.getState("name"))+" failed to become a physics object. ParentScene null",null);else null!=this.gameEntity.getState("physicsBody")&&
(t._engineLogger.error("DEBUG->Removing physics body thing",null),this.gameEntity.setState("physicsBody",null),c.remove(c._compMap.BodyComponent_7))},_updateVelocityX:function(a,b){var c=this._instances.h[b.__id__];null!=c._compMap.BodyComponent_7&&(c=c._compMap.BodyComponent_7.body,null==c.zpp_inner.wrap_vel&&c.zpp_inner.setupVelocity(),c.zpp_inner.wrap_vel.set_x(a))},_updateVelocityY:function(a,b){var c=this._instances.h[b.__id__];null!=c._compMap.BodyComponent_7&&(c=c._compMap.BodyComponent_7.body,
null==c.zpp_inner.wrap_vel&&c.zpp_inner.setupVelocity(),c.zpp_inner.wrap_vel.set_y(a))},_updateVelocityAng:function(a,b){var c=this._instances.h[b.__id__];null!=c._compMap.BodyComponent_7&&c._compMap.BodyComponent_7.body.set_angularVel(3.141592653589793*a/180)},_updateApplyImpulseX:function(a,b){var c=this._instances.h[b.__id__];null!=c._compMap.BodyComponent_7&&c._compMap.BodyComponent_7.body.applyImpulse(Va.get(a,0,!0))},_updateApplyImpulseY:function(a,b){var c=this._instances.h[b.__id__];null!=
c._compMap.BodyComponent_7&&c._compMap.BodyComponent_7.body.applyImpulse(Va.get(0,a,!0))},_updateApplyImpulseAngle:function(a,b){var c=this._instances.h[b.__id__];null!=c._compMap.BodyComponent_7&&c._compMap.BodyComponent_7.body.applyAngularImpulse(a)},_updateTouchable:function(a,b){var c=this._instancesMesh.h[b.__id__];null!=c&&(a?(c.set_pointerEnabled(!0),c.get_pointerIn().hasListeners()||c.get_pointerIn().connect(u(this,this._onPointerIn)),c.get_pointerMove().hasListeners()||c.get_pointerMove().connect(u(this,
this._onPointerMove)),c.get_pointerOut().hasListeners()||c.get_pointerOut().connect(u(this,this._onPointerOut)),c.get_pointerDown().hasListeners()||c.get_pointerDown().connect(u(this,this._onPointerDown)),c.get_pointerUp().hasListeners()||c.get_pointerUp().connect(u(this,this._onPointerUp))):c.set_pointerEnabled(!1))},_onPointerIn:function(){s.input.pointer.submitPointerEvent(m.MOUSE_ENTERED,this.gameEntity)},_onPointerMove:function(){s.input.pointer.submitPointerEvent(m.MOUSE_MOVED,this.gameEntity)},
_onPointerOut:function(){s.input.pointer.submitPointerEvent(m.MOUSE_LEFT,this.gameEntity)},_onPointerDown:function(a){s.input.pointer.submitPointerEvent(m.MOUSE_DOWN,this.gameEntity);this.gameEntity.setState("feedback_touchEvent",a.clone());"Mouse"==a.source[0]?s.input.mouse.isDown(Da.Left)&&s.input.pointer.submitPointerEvent(m.MOUSE_LEFT_CLICK,this.gameEntity):s.input.pointer.submitPointerEvent(m.MOUSE_LEFT_CLICK,this.gameEntity)},_onPointerUp:function(a){s.input.pointer.submitPointerEvent(m.MOUSE_UP,
this.gameEntity);"Mouse"==a.source[0]&&s.input.mouse.lastMouseButton==Da.Right&&s.input.pointer.submitPointerEvent(m.MOUSE_RIGHT_CLICK,this.gameEntity);!1==s.sound.iOSPlayedBlankSound&&s.sound.iOSPlayBlankSound()},setPosSize:function(a,b,c,d,e){var f=this._instancesMesh.h[e.__id__];t.de("RESIZING: "+r.string(this.gameEntity.getState("name"))+". x: "+a+", y: "+b,null);t.de("RESIZING: "+r.string(this.gameEntity.getState("name"))+". width: "+c+", height: "+d,null);null!=f&&(null!=a&&(f.x.set__(a),t._engineLogger.error("DEBUG->wtfXX",
null)),null!=b&&(f.y.set__(b),t._engineLogger.error("DEBUG->wtfYY",null)));f=r.instance(this._instances.h[e.__id__]._compMap.Sprite_3,yb);null!=f&&(f.setSize(c,d),t._engineLogger.error("DEBUG->wtfsetSize",null));Ma.prototype.setPosSize.call(this,a,b,c,d,e)},_updateSpaceWidth:function(a,b){var c=r.instance(this._instances.h[b.__id__]._compMap.Sprite_3,yb);null!=c&&(c.width.set__(a),c.centerAnchor(),c.scissor.width=a)},_updateSpaceHeight:function(a,b){var c=r.instance(this._instances.h[b.__id__]._compMap.Sprite_3,
yb);null!=c&&(c.height.set__(a),c.centerAnchor(),c.scissor.height=a)},_updateBounds:function(a){a=this._instances.h[a.__id__];null!=a?"Spriter"==this.gameEntity.getState("2DmeshType")?this.gameEntity.setState("boundsRect",new Jb(-55,-112,140,190)):this.gameEntity.setState("boundsRect",E.getBounds(a)):t._engineLogger.error("Update Bounds: Instance is null",null)},_queryRealWidth:function(a,b){return this._instancesMesh.h[b.__id__].getNaturalWidth()},_queryRealHeight:function(a,b){return this._instancesMesh.h[b.__id__].getNaturalHeight()},
_queryBoundsWidth:function(a,b){var c=this._instances.h[b.__id__];return null!=c._compMap.SpriterMovie_1?E.getBounds(c._compMap.SpriterMovie_1.container).width*c._compMap.Sprite_3.scaleX._value:E.getBounds(c).width},_queryBoundsHeight:function(a,b){var c=this._instances.h[b.__id__];return null!=c._compMap.SpriterMovie_1?E.getBounds(c._compMap.SpriterMovie_1.container).height*c._compMap.Sprite_3.scaleY._value:E.getBounds(c).height},_queryBoundsX:function(a,b){var c=this._instances.h[b.__id__];return null!=
c._compMap.SpriterMovie_1?E.getBounds(c._compMap.SpriterMovie_1.container).x*c._compMap.Sprite_3.scaleX._value:E.getBounds(c).x},_queryBoundsY:function(a,b){var c=this._instances.h[b.__id__];return null!=c._compMap.SpriterMovie_1?E.getBounds(c._compMap.SpriterMovie_1.container).y*c._compMap.Sprite_3.scaleY._value:E.getBounds(c).y},_queryRealX:function(a,b){return this._instancesMesh.h[b.__id__].x._value},_queryRealY:function(a,b){return this._instancesMesh.h[b.__id__].y._value},_queryRealRotation:function(a,
b){return this._instancesMesh.h[b.__id__].rotation},__class__:Ld});var La=function(){this.cbsets=this.listeners=this.bodylisteners=this.conlisteners=null;this.id=0;this.outer=null;this.id=Aa.CbType();this.listeners=new Me;this.bodylisteners=new gh;this.conlisteners=new hh;this.constraints=new dd;this.interactors=new Xd;this.cbsets=new Ne};h["zpp_nape.callbacks.ZPP_CbType"]=La;La.__name__=["zpp_nape","callbacks","ZPP_CbType"];La.prototype={addint:function(a){for(var b=null,c=this.listeners.head;null!=
c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.listeners.inlined_insert(b,a);this.invalidateint()},invalidateint:function(){for(var a=this.cbsets.head;null!=a;){var b=a.elt;b.zip_listeners=!0;b.invalidate_pairs();a=a.next}},addbody:function(a){for(var b=null,c=this.bodylisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.bodylisteners.inlined_insert(b,a);this.invalidatebody()},
invalidatebody:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_bodylisteners=!0,a=a.next},addconstraint:function(a){for(var b=null,c=this.conlisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.conlisteners.inlined_insert(b,a);this.invalidateconstraint()},invalidateconstraint:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_conlisteners=!0,a=a.next},__class__:La};var Aa=function(){};h["zpp_nape.ZPP_ID"]=Aa;
Aa.__name__=["zpp_nape","ZPP_ID"];Aa.Interactor=function(){return Aa._Interactor++};Aa.CbType=function(){return Aa._CbType++};Aa.CbSet=function(){return Aa._CbSet++};Aa.Listener=function(){return Aa._Listener++};var Me=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_InteractionListener"]=Me;Me.__name__=["zpp_nape","util","ZNPList_ZPP_InteractionListener"];Me.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==
Db.zpp_pool?b=new Db:(b=Db.zpp_pool,Db.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_insert:function(a,b){var c;null==Db.zpp_pool?c=new Db:(c=Db.zpp_pool,Db.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Db.zpp_pool;Db.zpp_pool=a;null==this.head&&
(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Db.zpp_pool;Db.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},
clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:Me};var gh=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_BodyListener"]=gh;gh.__name__=["zpp_nape","util","ZNPList_ZPP_BodyListener"];gh.prototype={inlined_insert:function(a,b){var c;null==Oc.zpp_pool?c=new Oc:(c=Oc.zpp_pool,Oc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=
this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Oc.zpp_pool;Oc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=
this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Oc.zpp_pool;Oc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:gh};var hh=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_ConstraintListener"]=hh;hh.__name__=["zpp_nape","util","ZNPList_ZPP_ConstraintListener"];
hh.prototype={inlined_insert:function(a,b){var c;null==Pc.zpp_pool?c=new Pc:(c=Pc.zpp_pool,Pc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Pc.zpp_pool;Pc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Pc.zpp_pool;Pc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:hh};var dd=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Constraint"]=dd;dd.__name__=["zpp_nape","util","ZNPList_ZPP_Constraint"];dd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==wc.zpp_pool?b=new wc:(b=wc.zpp_pool,wc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=wc.zpp_pool;wc.zpp_pool=
a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,
a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=wc.zpp_pool;wc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:dd};var Xd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Interactor"]=Xd;Xd.__name__=["zpp_nape","util","ZNPList_ZPP_Interactor"];Xd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;
null==Qc.zpp_pool?b=new Qc:(b=Qc.zpp_pool,Qc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Qc.zpp_pool;Qc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Qc.zpp_pool;Qc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=
this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Xd};var Ne=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CbSet"]=Ne;Ne.__name__=["zpp_nape","util","ZNPList_ZPP_CbSet"];Ne.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ud.zpp_pool?b=new ud:(b=ud.zpp_pool,ud.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ud.zpp_pool;ud.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ud.zpp_pool;ud.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Ne};var qa=function(a){ba.call(this,a);this._initFlambeScene2_5D()};h["tools.spark.framework.flambe2_5D.FlambeScene2_5D"]=qa;qa.__name__=["tools","spark","framework","flambe2_5D","FlambeScene2_5D"];qa.__super__=ba;qa.prototype=x(ba.prototype,{_initFlambeScene2_5D:function(){var a=
u(this,this._updatePhysics);this._updateStateFunctions.set("physicsScene",a);a;a=u(this,this._updateBackgroundColor);this._updateStateFunctions.set("backgroundColor",a);a;a=u(this,this._updateBoundsWidth);this._updateStateFunctions.set("boundsWidth",a);a;a=u(this,this._updateBoundsHeight);this._updateStateFunctions.set("boundsHeight",a);a;a=u(this,this._queryZoomX);this._queryFunctions.set("zoomX",a);a;a=u(this,this._queryZoomY);this._queryFunctions.set("zoomY",a);a;a=u(this,this._queryZoomScale);
this._queryFunctions.set("zoomScale",a);a},createInstance:function(a){t.error("Creating Scene: "+r.string(this.gameEntity.getState("name")),null);if(null!=this._instances.h[a.__id__])return this._instances.h[a.__id__];var b=new Ua;this._instances.set(a,b);b;this._initScene(a);return ba.prototype.createInstance.call(this,a)},update:function(a){this._updateState("physicsScene",a);this._updateState("backgroundColor",a);for(var b=0,c=this.children;b<c.length;){var d=c[b];++b;d.update(a)}},_createChildOfInstance:function(a,
b,c){null==c&&(c=-1);-1==c?this._instances.h[b.__id__].addChild(w.__cast(a.createInstance(b),Ua)):this._instances.h[b.__id__].addChild(w.__cast(a.createInstance(b),Ua),!0,c);ba.prototype._createChildOfInstance.call(this,a,b,c)},_removeChildOfInstance:function(a,b){var c;c=w.__cast(a.getInstance(b),Ua);var d=c._compMap.BodyComponent_7;null!=d&&c.remove(d);null!=c.parent&&this._instances.h[b.__id__].removeChild(c);ba.prototype._removeChildOfInstance.call(this,a,b)},updateCamera:function(a,b){ba.prototype.updateCamera.call(this,
a,b);var c=this._instances.h[a.__id__]._compMap.Sprite_3;c.setXY(this._tempX,this._tempY);c.setScaleXY(this._scaleX,this._scaleY);s.event.raiseEvent(m.CHANGED,this.gameEntity)},_initScene:function(a){var a=this._instances.h[a.__id__],b=new E;b.centerAnchor();a.add(b)},_updatePhysics:function(a,b){var c=this._instances.h[b.__id__];if(a){var d=new ih(this.gameEntity.getState("gravityX"),this.gameEntity.getState("gravityY"),this.gameEntity);c.add(d);this._scenePhysicsInit(d.space)}},_updateBackgroundColor:function(a,
b){var c=this._instances.h[b.__id__];t.error("UPDATING Background Color of: "+r.string(this.gameEntity.getState("name")),null);var d=c._compMap.Sprite_3;if("Transparent"!=a){var e=r.parseInt(a);null!=r.instance(c._compMap.Sprite_3,yb)?r.instance(c._compMap.Sprite_3,yb).color=e:(c.remove(d),e=new yb(e,this.gameEntity.getState("boundsWidth"),this.gameEntity.getState("boundsHeight")),e.setXY(d.x._value,d.y._value),e.setScaleXY(d.scaleX._value,d.scaleY._value),c.add(e))}else null!=r.instance(c._compMap.Sprite_3,
yb)&&(c.remove(d),e=new E,e.setXY(d.x._value,d.y._value),e.setScaleXY(d.scaleX._value,d.scaleY._value),c.add(e));c._compMap.Sprite_3.scissor=new Jb(180,80,1920,1280)},_updateBoundsWidth:function(a,b){var c=this._instances.h[b.__id__];null!=r.instance(c._compMap.Sprite_3,yb)&&r.instance(c._compMap.Sprite_3,yb).width.set__(a)},_updateBoundsHeight:function(a,b){var c=this._instances.h[b.__id__];null!=r.instance(c._compMap.Sprite_3,yb)&&r.instance(c._compMap.Sprite_3,yb).height.set__(a)},_scenePhysicsInit:function(a){a.zpp_inner.wrap_listeners.add(new he(function(){null==
g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new sb,g.internal=!1);return g.CbEvent_BEGIN}(this),function(){null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new Za,g.internal=!1);return g.InteractionType_ANY}(this),La.ANY_BODY,La.ANY_BODY,u(this,this._beginHandlerSensor)));a.zpp_inner.wrap_listeners.add(new he(function(){null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new sb,g.internal=!1);return g.CbEvent_END}(this),function(){null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=
new Za,g.internal=!1);return g.InteractionType_ANY}(this),La.ANY_BODY,La.ANY_BODY,u(this,this._endHandlerSensor)));a.zpp_inner.wrap_listeners.add(new he(function(){null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new sb,g.internal=!1);return g.CbEvent_BEGIN}(this),function(){null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new Za,g.internal=!1);return g.InteractionType_SENSOR}(this),qa.BIPED_FEET,La.ANY_BODY,u(this,this._beginHandlerSensorFeet)));a.zpp_inner.wrap_listeners.add(new he(function(){null==
g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new sb,g.internal=!1);return g.CbEvent_END}(this),function(){null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new Za,g.internal=!1);return g.InteractionType_SENSOR}(this),qa.BIPED_FEET,La.ANY_BODY,u(this,this._endHandlerSensorFeet)))},_beginHandlerSensor:function(a){null!=a.zpp_inner.int1.outer_i.get_userData().gameEntity&&null!=a.zpp_inner.int2.outer_i.get_userData().gameEntity&&(s.event.raiseEvent(m.PHYSICS_SENSOR_START,a.zpp_inner.int1.outer_i.get_userData().gameEntity),
s.event.raiseEvent(m.PHYSICS_SENSOR_START,a.zpp_inner.int2.outer_i.get_userData().gameEntity),a.zpp_inner.int1.outer_i.get_userData().gameEntity.setState("collidedWith",a.zpp_inner.int2.outer_i.get_userData().gameEntity),a.zpp_inner.int2.outer_i.get_userData().gameEntity.setState("collidedWith",a.zpp_inner.int1.outer_i.get_userData().gameEntity))},_endHandlerSensor:function(a){null!=a.zpp_inner.int1.outer_i.get_userData().gameEntity&&null!=a.zpp_inner.int2.outer_i.get_userData().gameEntity&&(s.event.raiseEvent(m.PHYSICS_SENSOR_END,
a.zpp_inner.int1.outer_i.get_userData().gameEntity),s.event.raiseEvent(m.PHYSICS_SENSOR_END,a.zpp_inner.int2.outer_i.get_userData().gameEntity))},_beginHandlerSensorFeet:function(a){var b=a.zpp_inner.int1.outer_i.get_castShape().get_body();null==b.zpp_inner_i.userData&&(b.zpp_inner_i.userData={});null!=b.zpp_inner_i.userData.gameEntity&&s.event.raiseEvent(m.PHYSICS_SENSOR_START_BIPED_FEET,function(){null==b.zpp_inner_i.userData&&(b.zpp_inner_i.userData={});return b.zpp_inner_i.userData}(this).gameEntity);
null!=a.zpp_inner.int2.outer_i.get_userData().gameEntity&&s.event.raiseEvent(m.PHYSICS_SENSOR_START_BIPED_FEET,a.zpp_inner.int2.outer_i.get_userData().gameEntity)},_endHandlerSensorFeet:function(a){var b=a.zpp_inner.int1.outer_i.get_castShape().get_body();null==b.zpp_inner_i.userData&&(b.zpp_inner_i.userData={});null!=b.zpp_inner_i.userData.gameEntity&&s.event.raiseEvent(m.PHYSICS_SENSOR_END_BIPED_FEET,function(){null==b.zpp_inner_i.userData&&(b.zpp_inner_i.userData={});return b.zpp_inner_i.userData}(this).gameEntity);
null!=a.zpp_inner.int2.outer_i.get_userData().gameEntity&&s.event.raiseEvent(m.PHYSICS_SENSOR_END_BIPED_FEET,a.zpp_inner.int2.outer_i.get_userData().gameEntity)},_queryZoomX:function(){return this._tempX},_queryZoomY:function(){return this._tempY},_queryZoomScale:function(){return this._scaleX},__class__:qa});var me=function(a,b){Nc.call(this,a);this._flambeGraphics=b;this._initFlambeView2_5D()};h["tools.spark.framework.flambe2_5D.FlambeView2_5D"]=me;me.__name__=["tools","spark","framework","flambe2_5D",
"FlambeView2_5D"];me.__super__=Nc;me.prototype=x(Nc.prototype,{_initFlambeView2_5D:function(){t.error("Creating View: "+r.string(this.gameEntity.getState("name")),null);this._instanceView=new Ua;this._instanceView.add(new E);this.gameEntity.getState("visible")&&G.root.addChild(this._instanceView)},destroy:function(){G.root.removeChild(this._instanceView)},render:function(){this.gameEntity.getState("visible")&&E.render(this._instanceView,this._flambeGraphics)},setVisible:function(a){a?G.root.addChild(this._instanceView):
G.root.removeChild(this._instanceView)},set_camera:function(a){if(this.camera==a)return this.camera;if(null==a)return this.camera=null,this._updateCurrentView(),null;this.camera=a;this.camera.attachToView(this);this._updateCurrentView();return this.camera},set_scene:function(a){if(this.scene==a)return this.scene;if(null==a)return this.scene=null,this._disposeCurrentScene(),this._updateCurrentView(),null;null!=this.scene&&(this.scene=null,this._disposeCurrentScene());this.scene=a;this._instanceScene=
w.__cast(this.scene.createInstance(this),Ua);this._updateCurrentView();return this.scene},_updateCurrentView:function(){null==this.scene||null==this.camera?null!=this._instanceView.firstChild&&this._instanceView.removeChild(this._instanceView.firstChild):(null==this._instanceView.firstChild&&this._instanceView.addChild(this._instanceScene),this.scene.update(this))},_disposeCurrentScene:function(){this._instanceScene=null;this._instanceView.disposeChildren()},setPosSize:function(a,b,c,d,e){var f=this._instanceView._compMap.Sprite_3;
null!=a&&f.x.set__(a);null!=b&&f.y.set__(b);null!=c&&null!=d&&(f.scissor=new Jb(0,0,c,d));Nc.prototype.setPosSize.call(this,a,b,c,d,e)},__class__:me});var eh=function(a){T.call(this);this.body=a};h["tools.spark.framework.flambe2_5D.components.BodyComponent"]=eh;eh.__name__="tools,spark,framework,flambe2_5D,components,BodyComponent".split(",");eh.__super__=T;eh.prototype=x(T.prototype,{get_name:function(){return"BodyComponent_7"},onUpdate:function(){var a=this.body.get_position(),b=this.owner._compMap.Sprite_3;
b.x.set__(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this));b.y.set__(function(){a.zpp_inner.validate();return a.zpp_inner.y}(this));b.rotation.set__(180*this.body.zpp_inner.rot/3.141592653589793)},onRemoved:function(){this.body.set_space(null)},__class__:eh});var fh=function(a){T.call(this);this._gameEntity=a};h["tools.spark.framework.flambe2_5D.components.PreBodyComponent"]=fh;fh.__name__="tools,spark,framework,flambe2_5D,components,PreBodyComponent".split(",");fh.__super__=T;fh.prototype=
x(T.prototype,{get_name:function(){return"PreBodyComponent_4"},onUpdate:function(){t._engineLogger.info("yoyoyo",null);this._gameEntity.setState("physicsEntity",!0)},onRemoved:function(){t._engineLogger.info("yo REMOVED HEY",null)},__class__:fh});var ih=function(a,b,c){T.call(this);this._gameEntity=c;this.space=new lj(new Va(a,b))};h["tools.spark.framework.flambe2_5D.components.SpaceComponent"]=ih;ih.__name__="tools,spark,framework,flambe2_5D,components,SpaceComponent".split(",");ih.__super__=T;ih.prototype=
x(T.prototype,{get_name:function(){return"SpaceComponent_6"},onUpdate:function(a){this._gameEntity.get("physicsPaused")||this.space.step(Math.min(a,0.06))},__class__:ih});var jh=function(a){null!=a&&(this.name=a.name,this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this.sourceColorX=a.sourceColorX,this.sourceColorY=a.sourceColorY,this.rotated=a.rotated)};h["tools.spark.framework.flambe2_5D.spritesheet.PlistEntry"]=jh;jh.__name__="tools,spark,framework,flambe2_5D,spritesheet,PlistEntry".split(",");
jh.prototype={__class__:jh};var Ef=function(){};h["tools.spark.framework.flambe2_5D.spritesheet.PlistParser"]=Ef;Ef.__name__="tools,spark,framework,flambe2_5D,spritesheet,PlistParser".split(",");Ef.parse=function(a){for(var b=[],c=null,d=0,a=a.firstElement().firstElement().elements();a.hasNext();){var e=a.next();if(e.nodeType!=q.Document&&e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+e.nodeType));if("frames"==e.children[0].get_nodeValue())d=1;else{if(e.nodeType!=
q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));if("dict"==e.nodeName&&1==d)c=e;else{if(e.nodeType!=q.Document&&e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+e.nodeType));if("metadata"==e.children[0].get_nodeValue())d=2;else if(e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));}}}d=1;a=new jh;e="";for(c=c.elements();c.hasNext();){var f=c.next();if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+
f.nodeType));if("key"==f.nodeName&&1==d){d=a;if(f.nodeType!=q.Document&&f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+f.nodeType));d.name=f.children[0].get_nodeValue();d=2}else{if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+f.nodeType));if("dict"==f.nodeName&&2==d){d=1;for(f=f.elements();f.hasNext();){var i=f.next();if(i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+i.nodeType));
if("key"==i.nodeName){if(i.nodeType!=q.Document&&i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+i.nodeType));e=i.children[0].get_nodeValue()}else switch(e){case "frame":var g=Ef.parseString(function(){if(i.nodeType!=q.Document&&i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+i.nodeType));return i.children[0]}(this).get_nodeValue());a.x=g[0];a.y=g[1];a.width=g[2];a.height=g[3];break;case "sourceColorRect":g=
Ef.parseString(function(){if(i.nodeType!=q.Document&&i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+i.nodeType));return i.children[0]}(this).get_nodeValue());a.sourceColorX=g[0];a.sourceColorY=g[1];break;case "rotated":g=a;if(i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+i.nodeType));g.rotated="true"==i.nodeName?!0:!1}}b.push(new jh(a))}}}return b};Ef.parseString=function(a){for(var b=[],c=new Xb,d=0,e=a.length;d<
e;){var f=d++;"{"!=a.charAt(f)&&"}"!=a.charAt(f)&&c.addSub(a.charAt(f),0,null)}a=0;for(c=c.b.split(",");a<c.length;)d=c[a],++a,b.push(parseFloat(d));return b};var Ff=function(a,b){null==b&&(b=0);null==a&&(a=0);this.width=a;this.height=b};h["tools.spark.framework.flambe2_5D.spritesheet.Size"]=Ff;Ff.__name__="tools,spark,framework,flambe2_5D,spritesheet,Size".split(",");Ff.prototype={__class__:Ff};var Gf=function(){this._offset=new jd(0,0);this._offsetInPixels=new jd(0,0);this._originalSize=new Ff(0,
0);this._rectInPixels=new Jb(0,0,0,0);this._rect=new Jb(0,0,0,0);this._originalSizeInPixels=new Ff(0,0);this._textureFilname=""};h["tools.spark.framework.flambe2_5D.spritesheet.SpriteFrame"]=Gf;Gf.__name__="tools,spark,framework,flambe2_5D,spritesheet,SpriteFrame".split(",");Gf.createWithTexture=function(a,b,c,d,e){var f=new Gf;f.initWithTexture(a,b,c,d,e);return f};Gf.prototype={isRotated:function(){return this._rotated},getRect:function(){return this._rect},getTexture:function(){return null!=this._texture?
this._texture:null},getOffset:function(){return new jd(this._offset.x,this._offset.y)},initWithTexture:function(a,b,c,d,e){this._texture=a;this._rect=this._rectInPixels=b;this._offset=this._offsetInPixels=d;this._originalSize=this._originalSizeInPixels=e;this._rotated=c;return!0},__class__:Gf};var Hf=function(a){E.call(this);this.frame=a};h["tools.spark.framework.flambe2_5D.spritesheet.SpriteSheet"]=Hf;Hf.__name__="tools,spark,framework,flambe2_5D,spritesheet,SpriteSheet".split(",");Hf.__super__=
E;Hf.prototype=x(E.prototype,{draw:function(a){this.g=a;this.frame.isRotated()?(a.translate(this.frame.getOffset().x,this.frame.getOffset().y+this.frame.getRect().height),a.rotate(-90),a.drawSubTexture(this.frame.getTexture(),0,0,this.frame.getRect().x,this.frame.getRect().y,this.frame.getRect().height,this.frame.getRect().width)):(a.translate(this.frame.getOffset().x,this.frame.getOffset().y),a.drawSubTexture(this.frame.getTexture(),0,0,this.frame.getRect().x,this.frame.getRect().y,this.frame.getRect().width,
this.frame.getRect().height))},getNaturalHeight:function(){return null==this.frame?0:this.frame.getRect().height},getNaturalWidth:function(){return null==this.frame?0:this.frame.getRect().width},__class__:Hf});var dh=function(a,b,c){this.paused=this.isLooping=!1;this.currentIndex=0;T.call(this);b=q.parse(a.getFile(b).toString());this.plist=Ef.parse(b);this._spriteFramesInfo=[];this.sprites=[];null==this.texture&&(this.texture=a.getTexture(c));this._addSpriteFramesWithDictionary();this._initSprites();
this._root=new Ua;this.speed=-1};h["tools.spark.framework.flambe2_5D.spritesheet.SpriteSheetPlayer"]=dh;dh.__name__="tools,spark,framework,flambe2_5D,spritesheet,SpriteSheetPlayer".split(",");dh.__super__=T;dh.prototype=x(T.prototype,{get_name:function(){return"SpriteSheetPlayer_2"},_addSpriteFramesWithDictionary:function(){for(var a=0,b=this.plist;a<b.length;){var c=b[a];++a;var d=new Jb(c.x,c.y,c.width,c.height),e=c.rotated,c=new jd(c.sourceColorX,c.sourceColorY),f=new Ff(0,0);this._spriteFramesInfo.push(Gf.createWithTexture(this.texture,
d,e,c,f))}},_initSprites:function(){this.currentFrame=new Hf(this._spriteFramesInfo[0]);this.currentIndex++},play:function(){null==r.instance(this._root._compMap.Sprite_3,Hf)&&(this._root.add(this.currentFrame),this.currentFrame.centerAnchor());this.currentIndex=0;this.paused=!1},loop:function(){this.play();this.isLooping=!0},onAdded:function(){this.owner.addChild(this._root);this.oldTime=(new Date).getTime();this.curTime=(new Date).getTime()},onRemoved:function(){this._root.parent.removeChild(this._root);
this.currentFrame.frame=this._spriteFramesInfo[0];this.currentIndex=0;this.isLooping=this.paused=!1},onUpdate:function(){if(-1!=this.speed){this.curTime=(new Date).getTime();if(this.curTime-this.oldTime<this.speed)return;this.oldTime=this.curTime}!this.paused&&null!=this.currentFrame&&(this.currentIndex==this._spriteFramesInfo.length&&(this.isLooping?this.currentIndex=0:this.paused=!0),this.paused||(this.currentFrame.frame=this._spriteFramesInfo[this.currentIndex++]))},setCurrentFrame:function(a){this.currentIndex=
a;this.currentFrame=this.sprites[a]},setSpeed:function(a){this.speed=a},__class__:dh});var $a=h["tools.spark.framework.haxe.Filter"]={__ename__:["tools","spark","framework","haxe","Filter"],__constructs__:["FInt","FBool","FEnum","FReg"]};$a.FInt=["FInt",0];$a.FInt.toString=l;$a.FInt.__enum__=$a;$a.FBool=["FBool",1];$a.FBool.toString=l;$a.FBool.__enum__=$a;$a.FEnum=function(a){a=["FEnum",2,a];a.__enum__=$a;a.toString=l;return a};$a.FReg=function(a){a=["FReg",3,a];a.__enum__=$a;a.toString=l;return a};
$a.__empty_constructs__=[$a.FInt,$a.FBool];var kh=h["tools.spark.framework.haxe.Attrib"]={__ename__:["tools","spark","framework","haxe","Attrib"],__constructs__:["Att"]};kh.Att=function(a,b,c){a=["Att",0,a,b,c];a.__enum__=kh;a.toString=l;return a};kh.__empty_constructs__=[];var z=h["tools.spark.framework.haxe.Rule"]={__ename__:["tools","spark","framework","haxe","Rule"],__constructs__:"RNode,RData,RMulti,RList,RChoice,ROptional".split(",")};z.RNode=function(a,b,c){a=["RNode",0,a,b,c];a.__enum__=z;
a.toString=l;return a};z.RData=function(a){a=["RData",1,a];a.__enum__=z;a.toString=l;return a};z.RMulti=function(a,b){var c=["RMulti",2,a,b];c.__enum__=z;c.toString=l;return c};z.RList=function(a,b){var c=["RList",3,a,b];c.__enum__=z;c.toString=l;return c};z.RChoice=function(a){a=["RChoice",4,a];a.__enum__=z;a.toString=l;return a};z.ROptional=function(a){a=["ROptional",5,a];a.__enum__=z;a.toString=l;return a};z.__empty_constructs__=[];var I=h["tools.spark.framework.haxe._LooseCheck.CheckResult"]=
{__ename__:"tools,spark,framework,haxe,_LooseCheck,CheckResult".split(","),__constructs__:"CMatch,CMissing,CExtra,CElementExpected,CDataExpected,CExtraAttrib,CMissingAttrib,CInvalidAttrib,CInvalidData,CInElement".split(",")};I.CMatch=["CMatch",0];I.CMatch.toString=l;I.CMatch.__enum__=I;I.CMissing=function(a){a=["CMissing",1,a];a.__enum__=I;a.toString=l;return a};I.CExtra=function(a){a=["CExtra",2,a];a.__enum__=I;a.toString=l;return a};I.CElementExpected=function(a,b){var c=["CElementExpected",3,a,
b];c.__enum__=I;c.toString=l;return c};I.CDataExpected=function(a){a=["CDataExpected",4,a];a.__enum__=I;a.toString=l;return a};I.CExtraAttrib=function(a,b){var c=["CExtraAttrib",5,a,b];c.__enum__=I;c.toString=l;return c};I.CMissingAttrib=function(a,b){var c=["CMissingAttrib",6,a,b];c.__enum__=I;c.toString=l;return c};I.CInvalidAttrib=function(a,b,c){a=["CInvalidAttrib",7,a,b,c];a.__enum__=I;a.toString=l;return a};I.CInvalidData=function(a,b){var c=["CInvalidData",8,a,b];c.__enum__=I;c.toString=l;
return c};I.CInElement=function(a,b){var c=["CInElement",9,a,b];c.__enum__=I;c.toString=l;return c};I.__empty_constructs__=[I.CMatch];var N=function(){};h["tools.spark.framework.haxe.LooseCheck"]=N;N.__name__=["tools","spark","framework","haxe","LooseCheck"];N.isBlank=function(a){return a.nodeType==q.PCData&&N.blanks.match(function(){if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);return a.nodeValue}(this))||a.nodeType==q.Comment};N.filterMatch=
function(a,b){switch(b[1]){case 0:return N.filterMatch(a,$a.FReg(new xb("[0-9]+","")));case 1:return N.filterMatch(a,$a.FEnum(["true","false","0","1"]));case 2:for(var c=b[2],d=0;d<c.length;){var e=c[d];++d;if(a==e)return!0}return!1;case 3:return b[2].match(a)}};N.isNullable=function(a){switch(a[1]){case 2:var b=a[2];return!0!=a[3]||N.isNullable(b);case 3:a=a[2];for(b=0;b<a.length;){var c=a[b];++b;if(!N.isNullable(c))return!1}return!0;case 4:a=a[2];for(b=0;b<a.length;)if(c=a[b],++b,N.isNullable(c))return!0;
return!1;case 1:return!1;case 0:return!1;case 5:return!0}};N.check=function(a,b){switch(b[1]){case 0:var c=b[4],d=b[3],e=b[2],f;if(!(f=a.nodeType!=q.Element)){if(a.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+a.nodeType);f=a.nodeName!=e}if(f)return I.CElementExpected(e,a);if(null!=d){e=d.slice();for(f=a.attributes();f.hasNext();){for(var i=f.next(),g=!1,o=0;o<e.length;){var h=e[o];++o;var j=h[3],k=h[2];if(i==k){if(null!=j&&!N.filterMatch(a.get(i),j))return I.CInvalidAttrib(k,
a,j);A.remove(e,h);g=!0}}if(!g)return I.CExtraAttrib(i,a)}for(f=0;f<e.length;)if(i=e[f],++f,g=i[2],null==i[4])return I.CMissingAttrib(g,a)}if(null!=c&&(c=N.checkList(function(){if(a.nodeType!=q.Document&&a.nodeType!=q.Element)throw new p("Bad node type, expected Element or Document but found "+a.nodeType);return A.iter(a.children)}(this),c),c!=I.CMatch))return I.CInElement(a,c);if(null!=d)for(c=0;c<d.length;)e=d[c],++c,a.set(e[2],e[4]);return I.CMatch;case 1:return d=b[2],a.nodeType!=q.PCData&&a.nodeType!=
q.CData?I.CDataExpected(a):null!=d&&!N.filterMatch(function(){if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);return a.nodeValue}(this),d)?I.CInvalidData(a,d):I.CMatch;case 4:d=b[2];if(0==d.length)throw new p("No choice possible");for(c=0;c<d.length;)if(e=d[c],++c,N.check(a,e)==I.CMatch)return I.CMatch;return N.check(a,d[0]);case 5:return N.check(a,b[2]);default:throw new p("Unexpected "+r.string(b));}};N.checkList=function(a,b){switch(b[1]){case 3:for(var c=
b[3],d=b[2].slice();a.hasNext();){var e=a.next();if(!N.isBlank(e)){for(var f=!1,i=0;i<d.length;){var g=d[i];++i;var o=N.checkList(A.iter([e]),g);if(o==I.CMatch){f=!0;switch(g[1]){case 2:i=g[2];if(g[3])for(var o=0,h=d.length;o<h;){var j=o++;d[j]==g&&(d[j]=z.RMulti(i))}break;default:A.remove(d,g)}break}else if(c&&!N.isNullable(g))return o}if(!f)return I.CExtra(e)}}for(c=0;c<d.length;)if(e=d[c],++c,!N.isNullable(e))return I.CMissing(e);return I.CMatch;case 2:d=b[3];c=b[2];for(e=!1;a.hasNext();)if(f=
a.next(),!N.isBlank(f)){e=N.checkList(A.iter([f]),c);if(e!=I.CMatch)return e;e=!0}return d&&!e?I.CMissing(c):I.CMatch;default:for(d=!1;a.hasNext();)if(c=a.next(),!N.isBlank(c)){d=N.check(c,b);if(d!=I.CMatch)return d;d=!0;break}if(!d)switch(b[1]){case 5:break;default:return I.CMissing(b)}for(;a.hasNext();)if(d=a.next(),!N.isBlank(d))return I.CExtra(d);return I.CMatch}};N.makeWhere=function(a){if(0==a.length)return"";for(var b="In ",c=!0,d=0;d<a.length;){var e=a[d];++d;c?c=!1:b+=".";if(e.nodeType!=
q.Element)throw new p("Bad node type, expected Element but found "+e.nodeType);b+=e.nodeName}return b+": "};N.makeString=function(a){if(a.nodeType==q.Element){if(a.nodeType!=q.Element)throw new p("Bad node type, expected Element but found "+a.nodeType);return"element "+a.nodeName}if(a.nodeType==q.Document||a.nodeType==q.Element)throw new p("Bad node type, unexpected "+a.nodeType);a=a.nodeValue.split("\r").join("\\r").split("\n").join("\\n").split("\t").join("\\t");return 20<a.length?A.substr(a,0,
17)+"...":a};N.makeRule=function(a){switch(a[1]){case 0:return"element "+a[2];case 1:return"data";case 2:return N.makeRule(a[2]);case 3:return N.makeRule(a[2][0]);case 4:return N.makeRule(a[2][0]);case 5:return N.makeRule(a[2])}};N.makeError=function(a,b){null==b&&(b=[]);switch(a[1]){case 0:throw new p("assert");case 1:var c=a[2];return N.makeWhere(b)+"Missing "+N.makeRule(c);case 2:return c=a[2],N.makeWhere(b)+"Unexpected "+N.makeString(c);case 3:var c=a[3],d=a[2];return N.makeWhere(b)+N.makeString(c)+
" while expected element "+d;case 4:return c=a[2],N.makeWhere(b)+N.makeString(c)+" while data expected";case 5:return c=a[2],b.push(a[3]),N.makeWhere(b)+"unexpected attribute "+c;case 6:return c=a[2],b.push(a[3]),N.makeWhere(b)+"missing required attribute "+c;case 7:return c=a[2],b.push(a[3]),N.makeWhere(b)+"invalid attribute value for "+c;case 8:return c=a[2],N.makeWhere(b)+"invalid data format for "+N.makeString(c);case 9:return c=a[3],b.push(a[2]),N.makeError(c,b)}};N.checkNode=function(a,b){var c=
N.checkList(A.iter([a]),b);if(c!=I.CMatch)throw new p(N.makeError(c));};var Ke=function(a,b,c){this.layoutableEntity=a;this.layoutableInstanceType=b;this.layoutableInstance=c;this.children=[];this.visibleStartX=this.visibleStartY=this.x=this.y=this.width=this.height=0;this.visibleStartIndex=this.visibleEndIndex=this.numElementsCached=-1;this.tileWidthCached=this.tileHeightCached=null;this.rowCount=this.columnCount=-1};h["tools.spark.framework.layout.containers.Group"]=Ke;Ke.__name__="tools,spark,framework,layout,containers,Group".split(",");
Ke.prototype={update:function(){this.updateState("layout");this.updateState("includeInLayout");this.updateState("x");this.updateState("y");this.updateState("width");this.updateState("height");this.updateState("left");this.updateState("top");this.updateState("right");this.updateState("bottom");this.updateState("horizontalCenter");this.updateState("verticalCenter");if(null!=this.layout&&"Basic"!=this.layout.layoutType){this.updateState("paddingLeft");this.updateState("paddingRight");this.updateState("paddingTop");
this.updateState("paddingBottom");this.updateState("horizontalAlign");this.updateState("verticalAlign");("Horizontal"==this.layout.layoutType||"Vertical"==this.layout.layoutType)&&this.updateState("gap");if("Horizontal"==this.layout.layoutType||"Tile"==this.layout.layoutType)this.updateState("columnWidth"),this.updateState("requestedColumnCount");"Horizontal"==this.layout.layoutType&&(this.updateState("requestedMaxColumnCount"),this.updateState("requestedMinColumnCount"),this.updateState("variableColumnWidth"));
if("Vertical"==this.layout.layoutType||"Tile"==this.layout.layoutType)this.updateState("rowHeight"),this.updateState("requestedRowCount");"Vertical"==this.layout.layoutType&&(this.updateState("requestedMaxRowCount"),this.updateState("requestedMinRowCount"),this.updateState("variableRowHeight"));"Tile"==this.layout.layoutType&&(this.updateState("horizontalGap"),this.updateState("verticalGap"),this.updateState("rowAlign"),this.updateState("columnAlign"),this.updateState("orientation"))}},updateState:function(a){switch(a){case "layout":this._updateLayout(this.layoutableEntity.getState(a));
break;case "includeInLayout":this.includeInLayout=this.layoutableEntity.getState(a);break;case "x":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.x=this.layoutableEntity.getState(a));break;case "y":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.y=this.layoutableEntity.getState(a));break;case "width":this._updateExplicitSize(this.layoutableEntity.getState(a),"width");break;case "height":this._updateExplicitSize(this.layoutableEntity.getState(a),
"height");break;case "left":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.left=this.layoutableEntity.getState(a));break;case "top":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.top=this.layoutableEntity.getState(a));break;case "right":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.right=this.layoutableEntity.getState(a));break;case "bottom":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||
(this.bottom=this.layoutableEntity.getState(a));break;case "horizontalCenter":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.horizontalCenter=this.layoutableEntity.getState(a));break;case "verticalCenter":(function(b){b=b.layoutableEntity.getState(a);return isNaN(b)})(this)||(this.verticalCenter=this.layoutableEntity.getState(a));break;case "paddingLeft":this.paddingLeft=this.layoutableEntity.getState(a);break;case "paddingRight":this.paddingRight=this.layoutableEntity.getState(a);
break;case "paddingTop":this.paddingTop=this.layoutableEntity.getState(a);break;case "paddingBottom":this.paddingBottom=this.layoutableEntity.getState(a);break;case "gap":this.gap=this.layoutableEntity.getState(a);break;case "horizontalAlign":var b=this.layoutableEntity.getState(a);"left"==b?this.horizontalAlign=ga.LEFT:"center"==b?this.horizontalAlign=ga.CENTER:"right"==b?this.horizontalAlign=ga.RIGHT:"justify"==b?this.horizontalAlign=ga.JUSTIFY:"contentJustify"==b&&(this.horizontalAlign=ga.CONTENT_JUSTIFY);
break;case "verticalAlign":b=this.layoutableEntity.getState(a);"top"==b?this.verticalAlign=ka.TOP:"middle"==b?this.verticalAlign=ka.MIDDLE:"bottom"==b?this.verticalAlign=ka.BOTTOM:"justify"==b?this.verticalAlign=ka.JUSTIFY:"contentJustify"==b&&(this.verticalAlign=ka.CONTENT_JUSTIFY);break;case "columnWidth":b=this.layoutableEntity.getState(a);this.columnWidth="calculated"==b?this.explicitColumnWidth=null:this.explicitColumnWidth=parseFloat(b);break;case "requestedColumnCount":this.requestedColumnCount=
this.layoutableEntity.getState(a);break;case "requestedMaxColumnCount":this.requestedMaxColumnCount=this.layoutableEntity.getState(a);break;case "requestedMinColumnCount":this.requestedMinColumnCount=this.layoutableEntity.getState(a);break;case "variableColumnWidth":this.variableColumnWidth=this.layoutableEntity.getState(a);break;case "rowHeight":b=this.layoutableEntity.getState(a);this.rowHeight="calculated"==b?this.explicitRowHeight=null:this.explicitRowHeight=parseFloat(b);break;case "requestedRowCount":this.requestedRowCount=
this.layoutableEntity.getState(a);break;case "requestedMaxRowCount":this.requestedMaxRowCount=this.layoutableEntity.getState(a);break;case "requestedMinRowCount":this.requestedMinRowCount=this.layoutableEntity.getState(a);break;case "variableRowHeight":this.variableRowHeight=this.layoutableEntity.getState(a);break;case "horizontalGap":this.horizontalGap=this.explicitHorizontalGap=this.layoutableEntity.getState(a);break;case "verticalGap":this.verticalGap=this.explicitVerticalGap=this.layoutableEntity.getState(a);
break;case "rowAlign":b=this.layoutableEntity.getState(a);"top"==b?this.rowAlign=Sa.TOP:"justifyUsingHeight"==b?this.rowAlign=Sa.JUSTIFY_USING_HEIGHT:"justifyUsingGap"==b&&(this.rowAlign=Sa.JUSTIFY_USING_GAP);break;case "columnAlign":b=this.layoutableEntity.getState(a);"left"==b?this.columnAlign=cb.LEFT:"justifyUsingWidth"==b?this.columnAlign=cb.JUSTIFY_USING_WIDTH:"justifyUsingGap"==b&&(this.columnAlign=cb.JUSTIFY_USING_GAP);break;case "orientation":b=this.layoutableEntity.getState(a),"rows"==b?
this.orientation=Wa.ROWS:"columns"==b&&(this.orientation=Wa.COLUMNS)}},_updateLayout:function(a){"Basic"==a?null==this.layout?this.set_layout(new cc):this.layout.layoutType!=a&&this.set_layout(new cc):"Horizontal"==a?null==this.layout?this.set_layout(new Ob):this.layout.layoutType!=a&&this.set_layout(new Ob):"Vertical"==a?null==this.layout?this.set_layout(new Pb):this.layout.layoutType!=a&&this.set_layout(new Pb):"Tile"==a&&(null==this.layout?this.set_layout(new If):this.layout.layoutType!=a&&this.set_layout(new If));
this.layout.set_target(this)},_updateExplicitSize:function(a,b){var c=null,d=null;"Implicit"!=a&&(-1!=a.indexOf("%")?d=parseFloat(a):c=parseFloat(a));"width"==b?(this.explicitWidth=c,this.percentWidth=d):(this.explicitHeight=c,this.percentHeight=d)},set_layout:function(a){return this.layout==a?this.layout:this.layout=a},measure:function(){this.layout.measure()},updateDisplayList:function(a,b){this.layout.updateDisplayList(a,b)},setActualSize:function(a,b){null!=this.explicitWidth?this.width=this.explicitWidth:
null!=a&&0!=a?this.measuredWidth=this.width=a:0!=this.get_preferredWidth()&&(this.width=this.get_preferredWidth());null!=this.explicitHeight?this.height=this.explicitHeight:null!=b&&0!=b?this.measuredHeight=this.height=b:0!=this.get_preferredHeight()&&(this.height=this.get_preferredHeight())},get_preferredWidth:function(){return null==this.explicitWidth?this.measuredWidth:this.explicitWidth},get_preferredHeight:function(){return null==this.explicitHeight?this.measuredHeight:this.explicitHeight},get_preferredMinWidth:function(){return null==
this.explicitMinWidth?this.measuredMinWidth:this.explicitMinWidth},get_preferredMinHeight:function(){return null==this.explicitMinHeight?this.measuredMinHeight:this.explicitMinHeight},get_preferredMaxWidth:function(){return null==this.explicitMaxWidth?this.measuredMaxWidth:this.explicitMaxWidth},get_preferredMaxHeight:function(){return null==this.explicitMaxHeight?this.measuredMaxHeight:this.explicitMaxHeight},__class__:Ke,__properties__:{get_preferredMaxHeight:"get_preferredMaxHeight",get_preferredMaxWidth:"get_preferredMaxWidth",
get_preferredMinHeight:"get_preferredMinHeight",get_preferredMinWidth:"get_preferredMinWidth",get_preferredHeight:"get_preferredHeight",get_preferredWidth:"get_preferredWidth",set_layout:"set_layout"}};var lh=function(){this.size=0};h["tools.spark.framework.layout.helpers.ChildInfo"]=lh;lh.__name__="tools,spark,framework,layout,helpers,ChildInfo".split(",");lh.prototype={__class__:lh};var Fj=function(){};h["tools.spark.framework.layout.helpers.LayoutHelper"]=Fj;Fj.__name__="tools,spark,framework,layout,helpers,LayoutHelper".split(",");
Fj.flexChildrenProportionally=function(a,b,c,d){var e=d.length,f,i,g;do{f=0;i=!0;g=b-a*c/100;0<g?b-=g:g=0;for(var o=b/c,h=0;h<e;){var j=d[h],k=j.percent*o;if(k<j.min){i=j.min;j.size=i;d[h]=d[--e];d[e]=j;c-=j.percent;g>=i?g-=i:(b-=i-g,g=0);i=!1;break}else if(k>j.max){i=j.max;j.size=i;d[h]=d[--e];d[e]=j;c-=j.percent;g>=i?g-=i:(b-=i-g,g=0);i=!1;break}else j.size=k,f+=k;h++}}while(!i);return Math.max(0,Math.floor(b+g-f))};var mh=function(){};h["tools.spark.framework.layout.helpers.SizesAndLimit"]=mh;
mh.__name__="tools,spark,framework,layout,helpers,SizesAndLimit".split(",");mh.prototype={__class__:mh};var cb=h["tools.spark.framework.layout.interfaces.EColumnAlign"]={__ename__:"tools,spark,framework,layout,interfaces,EColumnAlign".split(","),__constructs__:["JUSTIFY_USING_GAP","JUSTIFY_USING_WIDTH","LEFT"]};cb.JUSTIFY_USING_GAP=["JUSTIFY_USING_GAP",0];cb.JUSTIFY_USING_GAP.toString=l;cb.JUSTIFY_USING_GAP.__enum__=cb;cb.JUSTIFY_USING_WIDTH=["JUSTIFY_USING_WIDTH",1];cb.JUSTIFY_USING_WIDTH.toString=
l;cb.JUSTIFY_USING_WIDTH.__enum__=cb;cb.LEFT=["LEFT",2];cb.LEFT.toString=l;cb.LEFT.__enum__=cb;cb.__empty_constructs__=[cb.JUSTIFY_USING_GAP,cb.JUSTIFY_USING_WIDTH,cb.LEFT];var ga=h["tools.spark.framework.layout.interfaces.EHorizontalAlign"]={__ename__:"tools,spark,framework,layout,interfaces,EHorizontalAlign".split(","),__constructs__:["LEFT","CENTER","RIGHT","JUSTIFY","CONTENT_JUSTIFY"]};ga.LEFT=["LEFT",0];ga.LEFT.toString=l;ga.LEFT.__enum__=ga;ga.CENTER=["CENTER",1];ga.CENTER.toString=l;ga.CENTER.__enum__=
ga;ga.RIGHT=["RIGHT",2];ga.RIGHT.toString=l;ga.RIGHT.__enum__=ga;ga.JUSTIFY=["JUSTIFY",3];ga.JUSTIFY.toString=l;ga.JUSTIFY.__enum__=ga;ga.CONTENT_JUSTIFY=["CONTENT_JUSTIFY",4];ga.CONTENT_JUSTIFY.toString=l;ga.CONTENT_JUSTIFY.__enum__=ga;ga.__empty_constructs__=[ga.LEFT,ga.CENTER,ga.RIGHT,ga.JUSTIFY,ga.CONTENT_JUSTIFY];var Sa=h["tools.spark.framework.layout.interfaces.ERowAlign"]={__ename__:"tools,spark,framework,layout,interfaces,ERowAlign".split(","),__constructs__:["JUSTIFY_USING_GAP","JUSTIFY_USING_HEIGHT",
"TOP"]};Sa.JUSTIFY_USING_GAP=["JUSTIFY_USING_GAP",0];Sa.JUSTIFY_USING_GAP.toString=l;Sa.JUSTIFY_USING_GAP.__enum__=Sa;Sa.JUSTIFY_USING_HEIGHT=["JUSTIFY_USING_HEIGHT",1];Sa.JUSTIFY_USING_HEIGHT.toString=l;Sa.JUSTIFY_USING_HEIGHT.__enum__=Sa;Sa.TOP=["TOP",2];Sa.TOP.toString=l;Sa.TOP.__enum__=Sa;Sa.__empty_constructs__=[Sa.JUSTIFY_USING_GAP,Sa.JUSTIFY_USING_HEIGHT,Sa.TOP];var Wa=h["tools.spark.framework.layout.interfaces.ETileOrientation"]={__ename__:"tools,spark,framework,layout,interfaces,ETileOrientation".split(","),
__constructs__:["COLUMNS","ROWS"]};Wa.COLUMNS=["COLUMNS",0];Wa.COLUMNS.toString=l;Wa.COLUMNS.__enum__=Wa;Wa.ROWS=["ROWS",1];Wa.ROWS.toString=l;Wa.ROWS.__enum__=Wa;Wa.__empty_constructs__=[Wa.COLUMNS,Wa.ROWS];var ka=h["tools.spark.framework.layout.interfaces.EVerticalAlign"]={__ename__:"tools,spark,framework,layout,interfaces,EVerticalAlign".split(","),__constructs__:["TOP","MIDDLE","BOTTOM","JUSTIFY","CONTENT_JUSTIFY"]};ka.TOP=["TOP",0];ka.TOP.toString=l;ka.TOP.__enum__=ka;ka.MIDDLE=["MIDDLE",1];
ka.MIDDLE.toString=l;ka.MIDDLE.__enum__=ka;ka.BOTTOM=["BOTTOM",2];ka.BOTTOM.toString=l;ka.BOTTOM.__enum__=ka;ka.JUSTIFY=["JUSTIFY",3];ka.JUSTIFY.toString=l;ka.JUSTIFY.__enum__=ka;ka.CONTENT_JUSTIFY=["CONTENT_JUSTIFY",4];ka.CONTENT_JUSTIFY.toString=l;ka.CONTENT_JUSTIFY.__enum__=ka;ka.__empty_constructs__=[ka.TOP,ka.MIDDLE,ka.BOTTOM,ka.JUSTIFY,ka.CONTENT_JUSTIFY];var vd=function(){};h["tools.spark.framework.layout.layouts.ALayoutBase"]=vd;vd.__name__="tools,spark,framework,layout,layouts,ALayoutBase".split(",");
vd.prototype={get_typicalLayoutElement:function(){null==this._typicalLayoutElement&&null!=this.target&&0<this.target.children.length&&(this._typicalLayoutElement=this.target.children[0]);return this._typicalLayoutElement},set_target:function(a){return this.target==a?this.target:this.target=a},measure:function(){},updateDisplayList:function(){},__class__:vd,__properties__:{get_typicalLayoutElement:"get_typicalLayoutElement",set_target:"set_target"}};var cc=function(){this.layoutType="Basic"};h["tools.spark.framework.layout.layouts.BasicLayout"]=
cc;cc.__name__="tools,spark,framework,layout,layouts,BasicLayout".split(",");cc._constraintsDetermineWidth=function(a){return null!=a.percentWidth||null!=a.left&&null!=a.right};cc._constraintsDetermineHeight=function(a){return null!=a.percentHeight||null!=a.top&&null!=a.bottom};cc._maxSizeToFitIn=function(a,b,c,d,e){return null!=b?a-2*Math.abs(b):null!=c?a-c:null!=d?a-d:a-e};cc.__super__=vd;cc.prototype=x(vd.prototype,{measure:function(){for(var a=0,b=0,c=0,d=0,e=0,f=this.target.children;e<f.length;){var i=
f[e];++e;if(!(null==i||!1==i.includeInLayout)){var g,o;null!=i.left&&null!=i.right?g=i.left+i.right:null!=i.horizontalCenter?g=2*Math.abs(i.horizontalCenter):null!=i.left||null!=i.right?(g=null==i.left?0:i.left,g=null==i.right?g+0:g+i.right):g=i.x;null!=i.top&&null!=i.bottom?o=i.top+i.bottom:null!=i.verticalCenter?o=2*Math.abs(i.verticalCenter):null!=i.top||null!=i.bottom?(o=null==i.top?0:i.top,o=null==i.bottom?o+0:o+i.bottom):o=i.y;var a=Math.max(a,g+i.get_preferredWidth()),b=Math.max(b,o+i.get_preferredHeight()),
h;h=cc._constraintsDetermineWidth(i)?i.get_preferredMinWidth():i.get_preferredWidth();i=cc._constraintsDetermineHeight(i)?i.get_preferredMinHeight():i.get_preferredHeight();c=Math.max(c,g+h);d=Math.max(d,o+i)}}this.target.measuredWidth=Math.ceil(Math.max(a,c));this.target.measuredHeight=Math.ceil(Math.max(b,d));this.target.measuredMinWidth=Math.ceil(c);this.target.measuredMinHeight=Math.ceil(d);this.target.measuredMaxWidth=999999;this.target.measuredMaxHeight=999999},updateDisplayList:function(a,
b){for(var c=0,d=0,e=0,f=this.target.children;e<f.length;){var i=f[e];++e;if(!(null==i||!1==i.includeInLayout)){var g=null,o=null,h=null,j=null;null!=i.percentWidth?(g=a,null!=i.left&&(g-=i.left),null!=i.right&&(g-=i.right),h=Math.round(g*Math.min(0.01*i.percentWidth,1)),g=Math.min(i.get_preferredMaxWidth(),cc._maxSizeToFitIn(a,i.horizontalCenter,i.left,i.right,i.x))):null!=i.left&&null!=i.right&&(h=a-i.right-i.left);null!=i.percentHeight?(o=b,null!=i.top&&(o-=i.top),null!=i.bottom&&(o-=i.bottom),
j=Math.round(o*Math.min(0.01*i.percentHeight,1)),o=Math.min(i.get_preferredMaxHeight(),cc._maxSizeToFitIn(b,i.verticalCenter,i.top,i.bottom,i.y))):null!=i.top&&null!=i.bottom&&(j=b-i.bottom-i.top);null!=h&&(null==g&&(g=i.get_preferredMaxWidth()),h=Math.max(i.get_preferredMinWidth(),Math.min(g,h)));null!=j&&(null==o&&(o=i.get_preferredMaxHeight()),j=Math.max(i.get_preferredMinHeight(),Math.min(o,j)));i.setActualSize(h,j);g=i.width;o=i.height;j=h=null;h=null!=i.horizontalCenter?Math.round((a-g)/2+i.horizontalCenter):
null!=i.left?i.left:null!=i.right?a-g-i.right:i.x;j=null!=i.verticalCenter?Math.round((b-o)/2+i.verticalCenter):null!=i.top?i.top:null!=i.bottom?b-o-i.bottom:i.y;i.x=h;i.y=j;c=Math.max(c,h+g);d=Math.max(d,j+o)}}this.target.width=Math.ceil(a);this.target.height=Math.ceil(b)},__class__:cc});var Ob=function(){this.layoutType="Horizontal"};h["tools.spark.framework.layout.layouts.HorizontalLayout"]=Ob;Ob.__name__="tools,spark,framework,layout,layouts,HorizontalLayout".split(",");Ob._pinBetween=function(a,
b,c){return Math.min(c,Math.max(b,a))};Ob._calculatePercentHeight=function(a,b){return Ob._pinBetween(Math.min(Math.round(0.01*a.percentHeight*b),b),a.get_preferredMinHeight(),a.get_preferredMaxHeight())};Ob._sizeLayoutElement=function(a,b,c,d,e,f,i){var g=null;c==ka.JUSTIFY||c==ka.CONTENT_JUSTIFY?g=d:null!=a.percentHeight&&(g=Ob._calculatePercentHeight(a,b));f?a.setActualSize(e,g):a.setActualSize(i,g)};Ob.__super__=vd;Ob.prototype=x(vd.prototype,{_getColumsToMeasure:function(a){-1!=this.target.requestedColumnCount?
a=this.target.requestedColumnCount:(-1!=this.target.requestedMaxColumnCount&&(a=r["int"](Math.min(this.target.requestedMaxColumnCount,a))),-1!=this.target.requestedMinColumnCount&&(a=r["int"](Math.max(this.target.requestedMinColumnCount,a))));return a},_getElementWidth:function(a,b,c){b=null==b?Math.ceil(a.get_preferredWidth()):b;a=null!=a.percentWidth?Math.ceil(a.get_preferredMinWidth()):b;c.preferredSize=b;c.minSize=a},_getElementHeight:function(a,b,c){var d=Math.ceil(a.get_preferredHeight()),a=
null!=a.percentHeight||b?Math.ceil(a.get_preferredMinHeight()):d;c.preferredSize=d;c.minSize=a},_distributeWidth:function(a,b,c){var d=a,e=0,f=[],i,g;g=this.target.variableColumnWidth?0:Math.ceil(this.target.columnWidth);for(var o=this.target.children.length,h=0,j=this.target.children;h<j.length;){var k=j[h];++h;null==k||!1==k.includeInLayout?o--:null!=k.percentWidth&&this.target.variableColumnWidth?(e+=k.percentWidth,i=new lh,i.layoutElement=k,i.percent=k.percentWidth,i.min=k.get_preferredMinWidth(),
i.max=k.get_preferredMaxWidth(),f.push(i)):(Ob._sizeLayoutElement(k,b,this.target.verticalAlign,c,null,this.target.variableColumnWidth,g),d-=Math.ceil(k.width))}1<o&&(d-=(o-1)*this.target.gap);if(0!=e){Fj.flexChildrenProportionally(a,d,e,f);for(e=a=0;e<f.length;)i=f[e],++e,o=Math.round(i.size+a),a+=i.size-o,Ob._sizeLayoutElement(i.layoutElement,b,this.target.verticalAlign,c,o,this.target.variableColumnWidth,g),d-=o}return d},measure:function(){var a=new mh,b=this.target.verticalAlign==ka.JUSTIFY,
c=this.target.children.length,d=0,e=0,f=0,i=0,g=0,o=null;this.target.variableColumnWidth||(o=null==this.target.columnWidth?this.get_typicalLayoutElement().get_preferredWidth():this.target.columnWidth);for(var h=this._getColumsToMeasure(c),j=0,k=this.target.children;j<k.length;){var l=k[j];++j;null==l||!1==l.includeInLayout?c--:(this._getElementHeight(l,b,a),e=Math.max(e,a.preferredSize),i=Math.max(i,a.minSize),d<h&&(this._getElementWidth(l,o,a),f+=a.preferredSize,g+=a.minSize,d++))}h=this._getColumsToMeasure(c);
d<h&&(c=this.get_typicalLayoutElement(),null!=c&&(this._getElementHeight(c,b,a),e=Math.max(e,a.preferredSize),i=Math.max(i,a.minSize),this._getElementWidth(c,o,a),f+=a.preferredSize*(h-d),g+=a.minSize*(h-d),d=h));1<d&&(a=this.target.gap*(d-1),f+=a,g+=a);a=this.target.paddingLeft+this.target.paddingRight;b=this.target.paddingTop+this.target.paddingBottom;this.target.measuredHeight=Math.ceil(e+b);this.target.measuredWidth=Math.ceil(f+a);this.target.measuredMinHeight=Math.ceil(i+b);this.target.measuredMinWidth=
Math.ceil(g+a);this.target.measuredMaxWidth=999999;this.target.measuredMaxHeight=999999},updateDisplayList:function(a,b){if(0==this.target.children.length||0==a||0==b)0==this.target.children.length&&(this.target.width=Math.ceil(this.target.paddingLeft+this.target.paddingRight),this.target.height=Math.ceil(this.target.paddingTop+this.target.paddingBottom));else{var c=Math.max(0,this.target.width-this.target.paddingLeft-this.target.paddingRight),d=Math.max(0,this.target.height-this.target.paddingTop-
this.target.paddingBottom),e=d;if(this.target.verticalAlign==ka.CONTENT_JUSTIFY)for(var f=0,i=this.target.children;f<i.length;){var g=i[f];++f;null==g||!1==g.includeInLayout||(g=null!=g.percentHeight?Ob._calculatePercentHeight(g,d):g.get_preferredHeight(),e=Math.max(e,Math.ceil(g)))}var o=this._distributeWidth(c,d,e),c=0;this.target.verticalAlign==ka.MIDDLE?c=0.5:this.target.verticalAlign==ka.BOTTOM&&(c=1);var d=this.target.paddingLeft,f=this.target.paddingTop,i=this.target.paddingLeft,g=this.target.paddingTop,
h=this.target.horizontalAlign;h==ga.CENTER?d=this.target.paddingLeft+Math.round(o/2):h==ga.RIGHT&&(d=this.target.paddingLeft+o);o=0;for(h=this.target.children;o<h.length;){var j=h[o];++o;if(!(null==j||!1==j.includeInLayout)){var k=Math.ceil(j.width),l=Math.ceil(j.height),m;m=f+(e-l)*c;0.5==c&&(m=Math.round(m));j.x=d;j.y=m;i=Math.max(i,d+k);g=Math.max(g,m+l);d+=k+this.target.gap}}this.target.width=Math.ceil(a);this.target.height=Math.ceil(b)}},__class__:Ob});var If=function(){this.layoutType="Tile"};
h["tools.spark.framework.layout.layouts.TileLayout"]=If;If.__name__="tools,spark,framework,layout,layouts,TileLayout".split(",");If.__super__=vd;If.prototype=x(vd.prototype,{_closerToSquare:function(a,b,c,d){a=Math.abs(a*(this.target.columnWidth+this.target.horizontalGap)-this.target.horizontalGap-b*(this.target.rowHeight+this.target.verticalGap)+this.target.verticalGap);c=Math.abs(c*(this.target.columnWidth+this.target.horizontalGap)-this.target.horizontalGap-d*(this.target.rowHeight+this.target.verticalGap)+
this.target.verticalGap);return a<c||a==c&&b<=d},_calculateColumnAndRowCount:function(a,b,c){this.target.columnCount=this.target.rowCount=-1;0>=a&&(a=null);0>=b&&(b=null);if(-1!=this.target.requestedColumnCount||-1!=this.target.requestedRowCount)-1!=this.target.requestedRowCount&&(this.target.rowCount=r["int"](Math.max(1,this.target.requestedRowCount))),-1!=this.target.requestedColumnCount&&(this.target.columnCount=r["int"](Math.max(1,this.target.requestedColumnCount)));else if(null!=a&&(this.target.orientation==
Wa.ROWS||null==b))this.target.columnCount=0<this.target.columnWidth+this.target.explicitHorizontalGap?r["int"](Math.max(1,Math.floor((a+this.target.explicitHorizontalGap)/(this.target.columnWidth+this.target.explicitHorizontalGap)))):1;else if(null!=b&&(this.target.orientation==Wa.COLUMNS||null==a))this.target.rowCount=0<this.target.rowHeight+this.target.explicitVerticalGap?r["int"](Math.max(1,Math.floor((b+this.target.explicitVerticalGap)/(this.target.rowHeight+this.target.explicitVerticalGap)))):
1;else{var b=this.target.explicitHorizontalGap,d=this.target.explicitVerticalGap,a=Math.max(0,this.target.rowHeight+d),d=b-d,b=d*d-4*a*-c*(this.target.columnWidth+b),b=Math.sqrt(b),e;e=0!=a?(d+b)/(2*a):c;var a=r["int"](Math.max(1,Math.floor(e))),b=r["int"](Math.max(1,Math.ceil(c/a))),a=r["int"](Math.max(1,Math.ceil(c/b))),d=r["int"](Math.max(1,Math.ceil(e))),f=r["int"](Math.max(1,Math.ceil(c/d))),d=r["int"](Math.max(1,Math.ceil(c/f))),i=r["int"](Math.max(1,Math.floor(c/e))),g=r["int"](Math.max(1,
Math.ceil(c/i))),i=r["int"](Math.max(1,Math.ceil(c/g)));e=r["int"](Math.max(1,Math.ceil(c/e)));var o=r["int"](Math.max(1,Math.ceil(c/e)));e=r["int"](Math.max(1,Math.ceil(c/o)));this._closerToSquare(i,g,b,a)&&(b=i,a=g);this._closerToSquare(e,o,f,d)&&(f=e,d=o);this._closerToSquare(b,a,f,d)?(this.target.columnCount=b,this.target.rowCount=a):(this.target.columnCount=f,this.target.rowCount=d)}-1==this.target.rowCount&&(this.target.rowCount=r["int"](Math.max(1,Math.ceil(c/this.target.columnCount))));-1==
this.target.columnCount&&(this.target.columnCount=r["int"](Math.max(1,Math.ceil(c/this.target.rowCount))))},_justifyByGapSize:function(a,b,c,d){if(0>=b+c)return c;var e=r["int"](Math.min(d,Math.floor((a+c)/(b+c))));return 1>e?c:1==e?1<d?Math.max(c,a-b):c:(a-e*b)/(e-1)},_justifyByElementSize:function(a,b,c,d){var e=b+c,f=0,f=0==e?d:r["int"](Math.min(d,Math.floor((a+c)/e)));return 1>f?b:(a-(f-1)*c)/f},_calculateElementCount:function(){if(-1!=this.target.numElementsCached)return this.target.numElementsCached;
this.target.numElementsCached=this.target.children.length;for(var a=0,b=this.target.children;a<b.length;){var c=b[a];++a;(null==c||!1==c.includeInLayout)&&this.target.numElementsCached--}return this.target.numElementsCached},_calculateTileSize:function(){this.target.columnWidth=this.target.tileWidthCached;this.target.rowHeight=this.target.tileHeightCached;if(!(null!=this.target.columnWidth&&null!=this.target.rowHeight)&&(this.target.columnWidth=this.target.tileWidthCached=this.target.explicitColumnWidth,
this.target.rowHeight=this.target.tileHeightCached=this.target.explicitRowHeight,!(null!=this.target.columnWidth&&null!=this.target.rowHeight))){var a=0,b=0;this.target.numElementsCached=this.target.children.length;for(var c=0,d=this.target.children;c<d.length;){var e=d[c];++c;null==e||!1==e.includeInLayout?this.target.numElementsCached--:(null==this.target.columnWidth&&(a=Math.max(a,e.get_preferredWidth())),null==this.target.rowHeight&&(b=Math.max(b,e.get_preferredHeight())))}null==this.target.columnWidth&&
(this.target.columnWidth=this.target.tileWidthCached=a);null==this.target.rowHeight&&(this.target.rowHeight=this.target.tileHeightCached=b)}},_updateActualValues:function(a,b){var c=a-this.target.paddingLeft-this.target.paddingRight,d=b-this.target.paddingTop-this.target.paddingBottom;this._calculateTileSize();var e=this._calculateElementCount();this._calculateColumnAndRowCount(c,d,e);this.target.horizontalGap=this.target.explicitHorizontalGap;this.target.verticalGap=this.target.explicitVerticalGap;
if(null!=this.target.width)switch(this.target.columnAlign[1]){case 0:this.target.horizontalGap=this._justifyByGapSize(c,this.target.columnWidth,this.target.horizontalGap,this.target.columnCount);break;case 1:this.target.columnWidth=this._justifyByElementSize(c,this.target.columnWidth,this.target.horizontalGap,this.target.columnCount)}if(null!=this.target.height)switch(this.target.rowAlign[1]){case 0:this.target.verticalGap=this._justifyByGapSize(d,this.target.rowHeight,this.target.verticalGap,this.target.rowCount);
break;case 1:this.target.rowHeight=this._justifyByElementSize(d,this.target.rowHeight,this.target.verticalGap,this.target.rowCount)}-1!=this.target.requestedColumnCount&&-1!=this.target.requestedRowCount&&(this.target.orientation==Wa.ROWS?this.target.rowCount=r["int"](Math.max(1,Math.ceil(e/Math.max(1,this.target.requestedColumnCount)))):this.target.columnCount=r["int"](Math.max(1,Math.ceil(e/Math.max(1,this.target.requestedRowCount)))))},_calculateDisplayParameters:function(a,b){this._updateActualValues(a,
b);var c=this.target.children.length;this.target.visibleStartX=this.target.paddingLeft;this.target.visibleStartY=this.target.paddingTop;this.target.visibleStartIndex=0;this.target.visibleEndIndex=c-1},_sizeAndPositionElement:function(a,b,c,d,e){var f=null,i=null,f=this.target.horizontalAlign==ga.JUSTIFY?d:null!=a.percentWidth?Math.round(0.01*d*a.percentWidth):a.get_preferredWidth(),i=this.target.verticalAlign==ka.JUSTIFY?e:null!=a.percentHeight?Math.round(0.01*e*a.percentHeight):a.get_preferredHeight(),
g=Math.min(a.get_preferredMaxWidth(),d),o=Math.min(a.get_preferredMaxHeight(),e),f=Math.max(a.get_preferredMinWidth(),Math.min(g,f)),i=Math.max(a.get_preferredMinHeight(),Math.min(o,i));a.setActualSize(f,i);f=b;switch(this.target.horizontalAlign[1]){case 2:f+=d-a.width;break;case 1:f=b+Math.floor((d-a.width)/2)}b=c;switch(this.target.verticalAlign[1]){case 2:b+=e-a.height;break;case 1:b+=Math.floor((e-a.height)/2)}a.x=f;a.y=b},measure:function(){var a=this.target.columnCount,b=this.target.rowCount,
c=this.target.horizontalGap,d=this.target.verticalGap,e=this.target.columnWidth,f=this.target.rowHeight;this._updateActualValues(this.target.explicitWidth,this.target.explicitHeight);var i;i=-1!=this.target.requestedColumnCount?r["int"](Math.max(1,this.target.requestedColumnCount)):this.target.columnCount;var g;g=-1!=this.target.requestedRowCount?r["int"](Math.max(1,this.target.requestedRowCount)):this.target.rowCount;var o=0,h=0,j=0,k=0;0<i&&(o=Math.ceil(i*(this.target.columnWidth+this.target.horizontalGap)-
this.target.horizontalGap),h=Math.ceil(this.target.columnCount*(this.target.columnWidth+this.target.horizontalGap)-this.target.horizontalGap));0<g&&(j=Math.ceil(g*(this.target.rowHeight+this.target.verticalGap)-this.target.verticalGap),k=Math.ceil(this.target.rowCount*(this.target.rowHeight+this.target.verticalGap)-this.target.verticalGap));this.target.numElementsCached=-1;i=this.target.paddingLeft+this.target.paddingRight;g=this.target.paddingTop+this.target.paddingBottom;this.target.measuredWidth=
o+i;this.target.measuredMinWidth=h+i;this.target.measuredHeight=j+g;this.target.measuredMinHeight=k+g;this.target.measuredMaxWidth=999999;this.target.measuredMaxHeight=999999;this.target.measuredWidth=0;this.target.measuredMinWidth=0;this.target.requestedColumnCount=r["int"](Math.max(1,Math.floor((this.target.width+this.target.explicitHorizontalGap)/(this.target.columnWidth+this.target.explicitHorizontalGap))));this.target.columnCount=a;this.target.rowCount=b;this.target.horizontalGap=c;this.target.verticalGap=
d;this.target.columnWidth=e;this.target.rowHeight=f},updateDisplayList:function(a,b){this._calculateDisplayParameters(a|0,b|0);var c=this.target.visibleStartX,d=this.target.visibleStartY,e,f,i,g,o=0,h;this.target.orientation==Wa.ROWS?(h=this.target.columnCount,e=this.target.columnWidth+this.target.horizontalGap,f=i=0,g=this.target.rowHeight+this.target.verticalGap):(h=this.target.rowCount,e=0,i=this.target.columnWidth+this.target.horizontalGap,f=this.target.rowHeight+this.target.verticalGap,g=0);
for(var j=0,k=this.target.children;j<k.length;){var l=k[j];++j;if(!(null==l||!1==l.includeInLayout)){var m=Math.round(c),n=Math.round(d),p=Math.round(c+this.target.columnWidth)-m,q=Math.round(d+this.target.rowHeight)-n;this._sizeAndPositionElement(l,m,n,p,q);c+=e;d+=f;++o>=h&&(o=0,this.target.orientation==Wa.ROWS?(c=this.target.paddingLeft,d+=g):(c+=i,d=this.target.paddingTop))}}this.target.width=Math.ceil(a);this.target.height=Math.ceil(b);this.target.tileWidthCached=this.target.tileHeightCached=
null;this.target.numElementsCached=-1},__class__:If});var Pb=function(){this.layoutType="Vertical"};h["tools.spark.framework.layout.layouts.VerticalLayout"]=Pb;Pb.__name__="tools,spark,framework,layout,layouts,VerticalLayout".split(",");Pb._pinBetween=function(a,b,c){return Math.min(c,Math.max(b,a))};Pb._calculatePercentWidth=function(a,b){return Pb._pinBetween(Math.min(Math.round(0.01*a.percentWidth*b),b),a.get_preferredMinWidth(),a.get_preferredMaxWidth())};Pb._sizeLayoutElement=function(a,b,c,
d,e,f,i){var g=null;c==ga.JUSTIFY||c==ga.CONTENT_JUSTIFY?g=d:null!=a.percentWidth&&(g=Pb._calculatePercentWidth(a,b));f?a.setActualSize(g,e):a.setActualSize(g,i)};Pb.__super__=vd;Pb.prototype=x(vd.prototype,{_getRowsToMeasure:function(a){-1!=this.target.requestedRowCount?a=this.target.requestedRowCount:(-1!=this.target.requestedMaxRowCount&&(a=r["int"](Math.min(this.target.requestedMaxRowCount,a))),-1!=this.target.requestedMinRowCount&&(a=r["int"](Math.max(this.target.requestedMinRowCount,a))));return a},
_getElementWidth:function(a,b,c){var d=Math.ceil(a.get_preferredWidth()),a=null!=a.percentWidth||b?Math.ceil(a.get_preferredMinWidth()):d;c.preferredSize=d;c.minSize=a},_getElementHeight:function(a,b,c){b=null==b?Math.ceil(a.get_preferredHeight()):b;a=null!=a.percentHeight?Math.ceil(a.get_preferredMinHeight()):b;c.preferredSize=b;c.minSize=a},_distributeHeight:function(a,b,c){var d=b,e=0,f=[],i,g;g=this.target.variableRowHeight?0:Math.ceil(this.target.rowHeight);for(var o=this.target.children.length,
h=0,j=this.target.children;h<j.length;){var k=j[h];++h;null==k||!1==k.includeInLayout?o--:null!=k.percentHeight&&this.target.variableRowHeight?(e+=k.percentHeight,i=new lh,i.layoutElement=k,i.percent=k.percentHeight,i.min=k.get_preferredMinHeight(),i.max=k.get_preferredMaxHeight(),f.push(i)):(Pb._sizeLayoutElement(k,a,this.target.horizontalAlign,c,null,this.target.variableRowHeight,g),d-=Math.ceil(k.height))}1<o&&(d-=(o-1)*this.target.gap);if(0!=e){Fj.flexChildrenProportionally(b,d,e,f);for(e=b=0;e<
f.length;)i=f[e],++e,o=Math.round(i.size+b),b+=i.size-o,Pb._sizeLayoutElement(i.layoutElement,a,this.target.horizontalAlign,c,o,this.target.variableRowHeight,g),d-=o}return d},measure:function(){var a=new mh,b=this.target.horizontalAlign==ga.JUSTIFY,c=this.target.children.length,d=0,e=0,f=0,i=0,g=0,o=null;this.target.variableRowHeight||(o=null==this.target.rowHeight?this.get_typicalLayoutElement().get_preferredHeight():this.target.rowHeight);for(var h=this._getRowsToMeasure(c),j=0,k=this.target.children;j<
k.length;){var l=k[j];++j;null==l||!1==l.includeInLayout?c--:(d<h&&(this._getElementHeight(l,o,a),e+=a.preferredSize,i+=a.minSize,d++),this._getElementWidth(l,b,a),f=Math.max(f,a.preferredSize),g=Math.max(g,a.minSize))}h=this._getRowsToMeasure(c);d<h&&(c=this.get_typicalLayoutElement(),null!=c&&(this._getElementHeight(c,o,a),e+=a.preferredSize*(h-d),i+=a.minSize*(h-d),this._getElementWidth(c,b,a),f=Math.max(f,a.preferredSize),g=Math.max(g,a.minSize),d=h));1<d&&(a=this.target.gap*(d-1),e+=a,i+=a);
a=this.target.paddingLeft+this.target.paddingRight;b=this.target.paddingTop+this.target.paddingBottom;this.target.measuredHeight=Math.ceil(e+b);this.target.measuredWidth=Math.ceil(f+a);this.target.measuredMinHeight=Math.ceil(i+b);this.target.measuredMinWidth=Math.ceil(g+a);this.target.measuredMaxWidth=999999;this.target.measuredMaxHeight=999999},updateDisplayList:function(a,b){if(0==this.target.children.length||0==a||0==b)0==this.target.children.length&&(this.target.width=Math.ceil(this.target.paddingLeft+
this.target.paddingRight),this.target.height=Math.ceil(this.target.paddingTop+this.target.paddingBottom));else{var c=Math.max(0,this.target.width-this.target.paddingLeft-this.target.paddingRight),d=Math.max(0,this.target.height-this.target.paddingTop-this.target.paddingBottom),e=c;if(this.target.horizontalAlign==ga.CONTENT_JUSTIFY)for(var f=0,i=this.target.children;f<i.length;){var g=i[f];++f;null==g||!1==g.includeInLayout||(g=null!=g.percentWidth?Pb._calculatePercentWidth(g,c):g.get_preferredWidth(),
e=Math.max(e,Math.ceil(g)))}var o=this._distributeHeight(c,d,e),c=0;this.target.horizontalAlign==ga.CENTER?c=0.5:this.target.horizontalAlign==ga.RIGHT&&(c=1);var d=this.target.paddingLeft,f=this.target.paddingTop,i=this.target.paddingLeft,g=this.target.paddingTop,h=this.target.verticalAlign;h==ka.MIDDLE?f=this.target.paddingTop+Math.round(o/2):h==ka.BOTTOM&&(f=this.target.paddingTop+o);o=0;for(h=this.target.children;o<h.length;){var j=h[o];++o;if(!(null==j||!1==j.includeInLayout)){var k=Math.ceil(j.width),
l=Math.ceil(j.height),m=d+(e-k)*c;0.5==c&&(m=Math.round(m));j.x=m;j.y=f;i=Math.max(i,m+k);g=Math.max(g,f+l);f+=l+this.target.gap}}this.target.width=Math.ceil(a);this.target.height=Math.ceil(b)}},__class__:Pb});var Gj=function(a){this.rootLayoutElement=a;this.validated=!1};h["tools.spark.framework.layout.managers.LayoutManager"]=Gj;Gj.__name__="tools,spark,framework,layout,managers,LayoutManager".split(",");Gj.prototype={validate:function(){this.validated||(t._engineLogger.info("Validating Layout...",
null),this.measure(this.rootLayoutElement),this.updateDisplayList(this.rootLayoutElement),this.updateRealObjects(this.rootLayoutElement),this.validated=!0)},getViewGroupByGameEntity:function(a,b){null==b&&(b=this.rootLayoutElement);if(b.layoutableEntity==a)return b;for(var c=0,d=b.children;c<d.length;){var e=d[c];++c;if("Entity"!=e.layoutableInstanceType&&(e=this.getViewGroupByGameEntity(a,e),null!=e))return e}return null},updateRealObjects:function(a,b,c,d){null==c&&(c=0);null==b&&(b=0);if("View"==
a.layoutableInstanceType)if("3D"==a.layoutableEntity.getState("renderer")){var e=a.layoutableInstance;e.x=a.x+b;e.y=a.y+c;e.width=a.width;e.height=a.height}else d=a.layoutableInstance,d.setPosSize(a.x+b,a.y+c,a.width,a.height);else"Entity"==a.layoutableInstanceType&&a.layoutableInstance.setPosSize(a.x,a.y,a.width,a.height,d);for(var e=0,f=a.children;e<f.length;){var i=f[e];++e;this.updateRealObjects(i,a.x+b,a.y+c,d)}},measure:function(a){for(var b=0,c=a.children;b<c.length;){var d=c[b];++b;this.measure(d)}a.measure()},
updateDisplayList:function(a){a.updateDisplayList(a.get_preferredWidth(),a.get_preferredHeight());for(var b=0,a=a.children;b<a.length;){var c=a[b];++b;this.updateDisplayList(c)}},__class__:Gj};var Xg=function(){};h["tools.spark.framework.platform.html.Graphics"]=Xg;Xg.__name__="tools,spark,framework,platform,html,Graphics".split(",");Xg.init=function(){Wc.init()};Xg.createDisplayRenderers=function(){Wc.createDisplayRenderers();var a=new Jf;s.display.platformRendererSet.set("NativeControls",a);a};
var Wc=function(){};h["tools.spark.framework.platform.html.flambe2_5.Subgraphics"]=Wc;Wc.__name__="tools,spark,framework,platform,html,flambe2_5,Subgraphics".split(",");Wc.createDisplayRenderers=function(){var a=new Kf;s.display.platformRendererSet.set("2D",a);a};Wc.init=function(){Wc._flambeDisplaySystem=Vc.instance.getRenderer()};Wc.onRender=function(){Wc._flambeDisplaySystem.willRender();if(null!=s.display&&null!=s.display.projectActiveSpaceReference&&null!=s.display.projectActiveSpaceReference.activeStageReference)for(var a=
0,b=s.display.projectActiveSpaceReference.activeStageReference.activeViewReferences;a<b.length;){var c=b[a];++a;c.renderer.renderView(c.viewEntity)}Wc._flambeDisplaySystem.didRender()};var Md=function(){};h["tools.spark.sliced.interfaces.IService"]=Md;Md.__name__=["tools","spark","sliced","interfaces","IService"];var Eb=function(){};h["tools.spark.sliced.core.AService"]=Eb;Eb.__name__=["tools","spark","sliced","core","AService"];Eb.__interfaces__=[Md];Eb.prototype={__class__:Eb};var Yk=function(){};
h["tools.spark.sliced.interfaces.IServiceFactory"]=Yk;Yk.__name__=["tools","spark","sliced","interfaces","IServiceFactory"];var nh=function(){this._init()};h["tools.spark.sliced.core.ServiceFactory"]=nh;nh.__name__=["tools","spark","sliced","core","ServiceFactory"];nh.__interfaces__=[Yk];nh.prototype={_init:function(){this._createServices()},_createServices:function(){var a=this._reflectService(n.SOUND_SERVICE),b=this._reflectService(n.LOGIC_SERVICE),c=this._reflectService(n.INPUT_SERVICE),d=this._reflectService(n.COMMUNICATIONS_SERVICE),
e=this._reflectService(n.EVENT_SERVICE),f=this._reflectService(n.DISPLAY_SERVICE);s.assignServices(a,b,c,d,e,f);s.logic.createInterpreters()},_reflectService:function(a){a=F.main.sliced.get(a);return Y.createInstance(Y.resolveClass(a),[])},__class__:nh};var s=gl.Sliced=function(){};h["tools.spark.sliced.core.Sliced"]=s;s.__name__=["tools","spark","sliced","core","Sliced"];s.init=function(){new nh};s.assignServices=function(a,b,c,d,e,f){t._engineLogger.info("Init Core (S.L.I.C.E.D.)...",null);s.sound=
a;s.logic=b;s.input=c;s.comms=d;s.event=e;s.display=f};var oh=function(){};h["tools.spark.sliced.interfaces.IComms"]=oh;oh.__name__=["tools","spark","sliced","interfaces","IComms"];oh.__interfaces__=[Md];oh.prototype={__class__:oh};var ph=function(){};h["tools.spark.sliced.interfaces.IDisplay"]=ph;ph.__name__=["tools","spark","sliced","interfaces","IDisplay"];ph.__interfaces__=[Md];ph.prototype={__class__:ph};var qh=function(){};h["tools.spark.sliced.interfaces.IEvent"]=qh;qh.__name__=["tools","spark",
"sliced","interfaces","IEvent"];qh.__interfaces__=[Md];qh.prototype={__class__:qh};var rh=function(){};h["tools.spark.sliced.interfaces.IInput"]=rh;rh.__name__=["tools","spark","sliced","interfaces","IInput"];rh.__interfaces__=[Md];rh.prototype={__class__:rh};var sh=function(){};h["tools.spark.sliced.interfaces.ILogic"]=sh;sh.__name__=["tools","spark","sliced","interfaces","ILogic"];sh.__interfaces__=[Md];sh.prototype={__class__:sh};var th=function(){};h["tools.spark.sliced.interfaces.ISound"]=th;
th.__name__=["tools","spark","sliced","interfaces","ISound"];th.__interfaces__=[Md];th.prototype={__class__:th};var uh=function(){this._init()};h["tools.spark.sliced.services.std.comms.core.Comms"]=uh;uh.__name__="tools,spark,sliced,services,std,comms,core,Comms".split(",");uh.__interfaces__=[oh];uh.__super__=Eb;uh.prototype=x(Eb.prototype,{_init:function(){t._engineLogger.info("Init Comms std Service...",null);this._socket=new vh;this._requestsData=new M;this._serverEventsData=new M;this.isConnected=
!1;this._file_requestsData=new M;this.file_isConnected=!1},update:function(){this._requestsData=new M;this._serverEventsData=new M;this._file_requestsData=new M},getRequestData:function(a){return this._requestsData.get(a)},getServerEventData:function(a){return this._serverEventsData.get(a)},connectTo:function(a,b,c,d){var e=this;null==c&&(c=a+":"+b);this._socket.init(a,b,null,function(){e.isConnected=!0;e.connectedServerName=c;s.event.raiseEvent(m.NETWORK_CONNECTED,d,c)})},request:function(a,b,c,
d){var e=this;null==c&&(c=a);this._socket.request(a,b,function(a){e._requestsData.set(c,a);a;s.event.raiseEvent(m.NETWORK_REQUEST,d,c)})},disconnect:function(){this._socket.disconnect();this.isConnected=!1;this.connectedServerName=null},notify:function(a,b){this._socket.notify(a,b)},addServerEvent:function(a,b,c){var d=this;null==b&&(b=a);this._socket.on(a,function(a){if(!d._serverEventsData.exists(b)){var f=[];d._serverEventsData.set(b,f);f}d._serverEventsData.get(b).push(a);s.event.raiseEvent(m.NETWORK_SERVER_EVENT,
c,b)})},file_connectTo:function(a,b,c,d){var e=this;this.file_isConnected?t._engineLogger.warn("Attempting to connect to file server: File Transfer already connected. Disconnect first.",null):(null==c&&(c=a+":"+b),this._fileTransfer=new wh("ws://"+a+":"+b),this._fileTransfer.onConnected(function(){e.file_isConnected=!0;e.file_connectedServerName=c;s.event.raiseEvent(m.FILETRANSFER_CONNECTED,d,c)}))},file_getSendFileRequestData:function(a){return this._file_requestsData.get(a)},file_disconnect:function(){this._fileTransfer.disconnect();
this.file_isConnected=!1;this.file_connectedServerName=this._fileTransfer=null},file_sendFileRequest:function(a,b,c,d){var e=this;if(this.file_isConnected){null==c&&(c=b.name);var f=0;this._fileTransfer.sendFile(a,b,function(a){f+=a.length;a.progress=f/b.size;a.progressPercent=Math.round(100*(f/b.size));if(!e._file_requestsData.exists(c)){var g=[];e._file_requestsData.set(c,g);g}e._file_requestsData.get(c).push(a);s.event.raiseEvent(m.FILETRANSFER_SENDREQUEST,d,c)})}else t._engineLogger.warn("Attempting to send a file: File Transfer is not connected.",
null)},__class__:uh});var Hj=function(){};h["tools.spark.sliced.services.std.comms.filetransfer.interfaces.IFileTransfer"]=Hj;Hj.__name__="tools,spark,sliced,services,std,comms,filetransfer,interfaces,IFileTransfer".split(",");Hj.prototype={__class__:Hj};var wh=function(a){this._binaryJs=new BinaryClient(a)};h["tools.spark.sliced.services.std.comms.filetransfer.core.platform.html5.websocket.binaryjs.FileTransfer"]=wh;wh.__name__="tools,spark,sliced,services,std,comms,filetransfer,core,platform,html5,websocket,binaryjs,FileTransfer".split(",");
wh.__interfaces__=[Hj];wh.prototype={onConnected:function(a){this._binaryJs.on("open",a)},disconnect:function(){this._binaryJs.close();this._binaryJs=null},sendFile:function(a,b,c){this._binaryJs.send(a,b).on("data",c)},__class__:wh};var Ij=function(){};h["tools.spark.sliced.services.std.comms.sockets.interfaces.ISocket"]=Ij;Ij.__name__="tools,spark,sliced,services,std,comms,sockets,interfaces,ISocket".split(",");Ij.prototype={__class__:Ij};var vh=function(){};h["tools.spark.sliced.services.std.comms.sockets.core.pomelo.platform.html5.websocket.Socket"]=
vh;vh.__name__="tools,spark,sliced,services,std,comms,sockets,core,pomelo,platform,html5,websocket,Socket".split(",");vh.__interfaces__=[Ij];vh.prototype={init:function(a,b,c,d){null==c&&(c=!1);window.pomelo.init({host:a,port:b,log:c},d)},request:function(a,b,c){window.pomelo.request(a,b,c)},notify:function(a,b){window.pomelo.notify(a,b)},on:function(a,b){window.pomelo.on(a,b)},disconnect:function(){window.pomelo.disconnect()},__class__:vh};var Jj=function(){};h["tools.spark.sliced.services.std.display.active_displayentity_references.interfaces.IActiveSpaceReference"]=
Jj;Jj.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,interfaces,IActiveSpaceReference".split(",");Jj.prototype={__class__:Jj};var Oe=function(a){this.spaceEntity=a};h["tools.spark.sliced.services.std.display.active_displayentity_references.core.ActiveSpaceReference"]=Oe;Oe.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,core,ActiveSpaceReference".split(",");Oe.__interfaces__=[Jj];Oe.prototype={__class__:Oe};var Lf=function(){};h["tools.spark.sliced.services.std.display.active_displayentity_references.interfaces.IActiveStageAreaReference"]=
Lf;Lf.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,interfaces,IActiveStageAreaReference".split(",");Lf.prototype={__class__:Lf};var Mf=function(a){this.stageAreaEntity=a;this.layoutElement=new Ke(this.stageAreaEntity,"StageArea",this)};h["tools.spark.sliced.services.std.display.active_displayentity_references.core.ActiveStageAreaReference"]=Mf;Mf.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,core,ActiveStageAreaReference".split(",");
Mf.__interfaces__=[Lf];Mf.prototype={__class__:Mf};var Nf=function(){};h["tools.spark.sliced.services.std.display.active_displayentity_references.interfaces.IActiveStageReference"]=Nf;Nf.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,interfaces,IActiveStageReference".split(",");Nf.prototype={__class__:Nf};var Yd=function(a){this.stageEntity=a;this.activeViewReferences=[];this.activeStageAreaReferences=[];this.layoutRoot=new Ke(this.stageEntity,"Stage",this);this.layoutManager=
new Gj(this.layoutRoot);G._platform.getStage().resize.connect(u(this,this._onResize))};h["tools.spark.sliced.services.std.display.active_displayentity_references.core.ActiveStageReference"]=Yd;Yd.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,core,ActiveStageReference".split(",");Yd.__interfaces__=[Nf];Yd.prototype={_onResize:function(){this.layoutRoot.explicitWidth=window.innerWidth;this.layoutRoot.explicitHeight=window.innerHeight;s.display.invalidateLayout();
s.event.raiseEvent(m.STAGE_RESIZED)},addView:function(a){this.activeViewReferences.push(a);this.activeViewReferences.sort(u(this,this._orderViews));this._addLayoutElement(a.layoutElement)},addStageArea:function(a){this.activeStageAreaReferences.push(a);this._addLayoutElement(a.layoutElement)},removeView:function(a){A.remove(this.activeViewReferences,a);this._removeLayoutElement(a.layoutElement)},removeStageArea:function(a){A.remove(this.activeStageAreaReferences,a);this._removeLayoutElement(a.layoutElement)},
_addLayoutElement:function(a){if("Implicit"==a.layoutableEntity.getState("parent"))this.layoutRoot.children.push(a);else for(var b=0,c=this.activeStageAreaReferences;b<c.length;){var d=c[b];++b;if(d.stageAreaEntity.getState("name")==a.layoutableEntity.getState("parent")){d.layoutElement.children.push(a);break}}},_removeLayoutElement:function(a){if("Implicit"==a.layoutableEntity.getState("parent"))A.remove(this.layoutRoot.children,a);else for(var b=0,c=this.activeStageAreaReferences;b<c.length;){var d=
c[b];++b;if(d.stageAreaEntity.getState("name")==a.layoutableEntity.getState("parent")){A.remove(d.layoutElement.children,a);break}}},_orderViews:function(a,b){return a.viewEntity.getState("zIndex")>b.viewEntity.getState("zIndex")?1:a.viewEntity.getState("zIndex")<b.viewEntity.getState("zIndex")?-1:0},__class__:Yd};var Of=function(){};h["tools.spark.sliced.services.std.display.active_displayentity_references.interfaces.IActiveViewReference"]=Of;Of.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,interfaces,IActiveViewReference".split(",");
Of.prototype={__class__:Of};var Zd=function(a){this.viewEntity=a;this.layoutElement=new Ke(this.viewEntity,"View",this)};h["tools.spark.sliced.services.std.display.active_displayentity_references.core.ActiveViewReference"]=Zd;Zd.__name__="tools,spark,sliced,services,std,display,active_displayentity_references,core,ActiveViewReference".split(",");Zd.__interfaces__=[Of];Zd.prototype={__class__:Zd};var xh=function(){this._init()};h["tools.spark.sliced.services.std.display.core.Display"]=xh;xh.__name__=
"tools,spark,sliced,services,std,display,core,Display".split(",");xh.__interfaces__=[ph];xh.__super__=Eb;xh.prototype=x(Eb.prototype,{_initRenderStateNames:function(){this._renderStateNames.set("2DmeshType",!0);!0;this._renderStateNames.set("3DmeshType",!0);!0;this._renderStateNames.set("touchable",!0);!0;this._renderStateNames.set("2DMeshImageForm",!0);!0;this._renderStateNames.set("2DMeshTextForm",!0);!0;this._renderStateNames.set("2DMeshSpriterForm",!0);!0;this._renderStateNames.set("2DMeshFillRectForm",
!0);!0;this._renderStateNames.set("2DMeshSpriteForm",!0);!0;this._renderStateNames.set("2DMeshSpriterAnimForm",!0);!0;this._renderStateNames.set("visibility",!0);!0;this._renderStateNames.set("visible",!0);!0;this._renderStateNames.set("width",!0);!0;this._renderStateNames.set("height",!0);!0;this._renderStateNames.set("top",!0);!0;this._renderStateNames.set("left",!0);!0;this._renderStateNames.set("paddingLeft",!0);!0;this._renderStateNames.set("paddingRight",!0);!0;this._renderStateNames.set("paddingTop",
!0);!0;this._renderStateNames.set("paddingBottom",!0);!0;this._renderStateNames.set("opacity",!0);!0;this._renderStateNames.set("display",!0);!0;this._renderStateNames.set("text",!0);!0;this._renderStateNames.set("fontSize",!0);!0;this._renderStateNames.set("fontWeight",!0);!0;this._renderStateNames.set("fontColor",!0);!0;this._renderStateNames.set("src",!0);!0;this._renderStateNames.set("overflow",!0);!0;this._renderStateNames.set("whiteSpace",!0);!0;this._renderStateNames.set("backgroundColor",
!0);!0;this._renderStateNames.set("boundsWidth",!0);!0;this._renderStateNames.set("boundsHeight",!0);!0;this._renderStateNames.set("border",!0);!0;this._renderStateNames.set("borderColor",!0);!0;this._renderStateNames.set("borderLeft",!0);!0;this._renderStateNames.set("borderRight",!0);!0;this._renderStateNames.set("borderTop",!0);!0;this._renderStateNames.set("borderBottom",!0);!0;this._renderStateNames.set("zIndex",!0);!0;this._renderStateNames.set("command_zOrder",!0);!0;this._renderStateNames.set("physicsEntity",
!0);!0;this._renderStateNames.set("Animation",!0);!0;this._renderStateNames.set("Animation Speed",!0);!0;this._renderStateNames.set("transform",!0);!0;this._renderStateNames.set("transformScale",!0);!0;this._renderStateNames.set("font",!0);!0;this._renderStateNames.set("align",!0);!0;this._renderStateNames.set("wrapWidth",!0);!0;this._renderStateNames.set("letterSpacing",!0);!0;this._renderStateNames.set("lineSpacing",!0);!0;this._renderStateNames.set("scissorRect",!0);!0;this._renderStateNames.set("pointerEvents",
!0);!0;this._renderStateNames.set("spaceX",!0);!0;this._renderStateNames.set("spaceY",!0);!0;this._renderStateNames.set("spaceZ",!0);!0;this._renderStateNames.set("scaleX",!0);!0;this._renderStateNames.set("scaleY",!0);!0;this._renderStateNames.set("scaleZ",!0);!0;this._renderStateNames.set("rotation",!0);!0;this._renderStateNames.set("blendMode",!0);!0;this._renderStateNames.set("animate_x",!0);!0;this._renderStateNames.set("animate_y",!0);!0;this._renderStateNames.set("animate_scaleX",!0);!0;this._renderStateNames.set("animate_scaleY",
!0);!0;this._renderStateNames.set("animate_rotation",!0);!0;this._renderStateNames.set("animate_opacity",!0);!0;this._renderStateNames.set("velocityX",!0);!0;this._renderStateNames.set("velocityY",!0);!0;this._renderStateNames.set("velocityAng",!0);!0;this._renderStateNames.set("applyImpulseX",!0);!0;this._renderStateNames.set("applyImpulseY",!0);!0;this._renderStateNames.set("applyImpulseAngle",!0);!0;this._renderStateNames.set("captureAreaX",!0);!0;this._renderStateNames.set("captureAreaY",!0);
!0;this._renderStateNames.set("captureAreaWidth",!0);!0;this._renderStateNames.set("captureAreaHeight",!0);!0;this._renderStateNames.set("command_updateCamera",!0);!0;this._renderStateNames.set("spaceWidth",!0);!0;this._renderStateNames.set("spaceHeight",!0);!0;this._renderStateNames.set("action_fire",!0);!0;this._renderStateNames.set("emitX",!0);!0;this._renderStateNames.set("emitY",!0);!0;this._renderStateNames.set("particleEnabled",!0);!0;this._renderStateNames.set("particleDuration",!0);!0;this._renderStateNames.set("stage",
!0);!0;this._renderStateNames.set("view",!0);!0;this._renderStateNames.set("camera",!0);!0;this._renderStateNames.set("scene",!0);!0;this._renderStateNames.set("space",!0);!0;this._renderStateNames.set("active",!0);!0},_init:function(){t._engineLogger.info("Init Display std Service...",null);this._renderStateNames=new M;this._initRenderStateNames();this._renderFormStateNames=new M;this._activeReferenceMediator=new yh(this);this.platformRendererSet=new M;this._dataBuffer=new zh;this._scriptLogger=
new bf(G._platform.createLogHandler("script"))},setActiveSpace:function(a){return"Space"==a.getState("displayType")?(this._dataBuffer.addEntry(Z.SET_SPACE,a),!0):!1},_setActiveSpace:function(a){null!=this._activeReferenceMediator.getActiveSpaceReference(a)?t._engineLogger.warn("This space object is already bound to the Project. Ignoring...",null):(null!=this.projectActiveSpaceReference&&t._engineLogger.warn("Another space object was already set to this Project! Resetting...",null),this.projectActiveSpaceReference=
this._activeReferenceMediator.createSpaceReference(a),this._activeReferenceMediator.spaceReferenceManager.update(this.projectActiveSpaceReference,a))},invalidateLayout:function(){this.projectActiveSpaceReference.activeStageReference.layoutManager.validated=!1;s.event.raiseEvent(m.LAYOUT_INVALIDATED)},getSpace2_5Object:function(a,b){null==b&&(b=!1);if(b)return null;for(var c,d=this.platformRendererSet.iterator();d.hasNext()&&!(c=d.next().getRealObject(a),null!=c););return c},update:function(){for(var a=
0,b=this._dataBuffer.dataBuffer;a<b.length;){var c=b[a];++a;switch(c.type[1]){case 0:this._setActiveSpace(c.source);break;case 1:case 2:switch(c.source.getState("displayType")){case "Space":break;case "Stage":this._activeReferenceMediator.stageReferenceManager.addTo(c.target,this.projectActiveSpaceReference.activeStageReference);break;case "StageArea":break;case "View":break;default:for(var d=this.platformRendererSet.iterator();d.hasNext();){var e=d.next();c.type==Z.ADDED?e.addChild(c.source,c.target):
c.type==Z.INSERTED&&e.insertChild(c.source,c.target,r.parseInt(c.field))}}break;case 3:switch(c.source.getState("displayType")){case "Space":break;case "Stage":this._activeReferenceMediator.stageReferenceManager.removeFrom(c.target,this.projectActiveSpaceReference.activeStageReference);break;case "StageArea":break;case "View":break;default:for(d=this.platformRendererSet.iterator();d.hasNext();)d.next().removeChild(c.source,c.target)}break;case 4:switch(c.source.getState("displayType")){case "Space":this._activeReferenceMediator.spaceReferenceManager.updateState(this._activeReferenceMediator.getActiveSpaceReference(c.source),
c.source,c.field);break;case "Stage":this._activeReferenceMediator.stageReferenceManager.updateState(this._activeReferenceMediator.getActiveStageReference(c.source),c.source,c.field);break;case "StageArea":this._activeReferenceMediator.stageAreaReferenceManager.updateState(this._activeReferenceMediator.getActiveStageAreaReference(c.source),c.source,c.field);break;case "View":this._activeReferenceMediator.viewReferenceManager.updateState(this._activeReferenceMediator.getActiveViewReference(c.source),
c.source,c.field);for(d=this.platformRendererSet.iterator();d.hasNext();)d.next().updateState(c.source,c.field);break;default:for(d=this.platformRendererSet.iterator();d.hasNext();)d.next().updateState(c.source,c.field)}break;default:t._engineLogger.warn("DISPLAY: Unhandled request: "+r.string(c.type),null)}}this._dataBuffer.clearBuffer();null!=this.projectActiveSpaceReference&&this.projectActiveSpaceReference.activeStageReference.layoutManager.validate()},addDisplayObjectChild:function(a,b){null!=
a.getState("displayType")&&null!=b.getState("displayType")&&this._dataBuffer.addEntry(Z.ADDED,a,b)},insertDisplayObjectChild:function(a,b,c){null!=a.getState("displayType")&&null!=b.getState("displayType")&&this._dataBuffer.addEntry(Z.INSERTED,a,b,null==c?"null":""+c)},removeDisplayObjectChild:function(a,b){null!=a.getState("displayType")&&null!=b.getState("displayType")&&this._dataBuffer.addEntry(Z.REMOVED,a,b)},updateDisplayObjectState:function(a,b){null!=a.getState("displayType")&&!0==this._renderStateNames.get(b)&&
this._dataBuffer.addEntry(Z.UPDATED_STATE,a,null,b)},updateDisplayObjectFormState:function(a,b){null!=a.getState("displayType")&&!0==this._renderFormStateNames.get(b)&&this._dataBuffer.addEntry(Z.UPDATED_FORM_STATE,a,null,b)},_addChild:function(a,b){this._dataBuffer.addEntry(Z.ADDED,a,b)},_insertChild:function(a,b,c){this._dataBuffer.addEntry(Z.INSERTED,a,b,null==c?"null":""+c)},_removeChild:function(a,b){this._dataBuffer.addEntry(Z.REMOVED,a,b)},_updateState:function(a,b){this._dataBuffer.addEntry(Z.UPDATED_STATE,
a,null,b)},_updateFormState:function(a,b){this._dataBuffer.addEntry(Z.UPDATED_FORM_STATE,a,null,b)},log:function(a,b){this._scriptLogger.info(a,b)},warn:function(a,b){this._scriptLogger.warn(a,b)},error:function(a,b){this._scriptLogger.error(a,b)},dl:function(a,b){this._scriptLogger.info("DEBUG->"+a,b)},dw:function(a,b){this._scriptLogger.warn("DEBUG->"+a,b)},de:function(a,b){this._scriptLogger.error("DEBUG->"+a,b)},__class__:xh});var Kj=function(){};h["tools.spark.sliced.services.std.display.databuffer.interfaces.IBufferEntry"]=
Kj;Kj.__name__="tools,spark,sliced,services,std,display,databuffer,interfaces,IBufferEntry".split(",");Kj.prototype={__class__:Kj};var Ah=function(a,b,c,d){this.type=a;this.source=b;this.target=c;this.field=d};h["tools.spark.sliced.services.std.display.databuffer.core.BufferEntry"]=Ah;Ah.__name__="tools,spark,sliced,services,std,display,databuffer,core,BufferEntry".split(",");Ah.__interfaces__=[Kj];Ah.prototype={__class__:Ah};var Lj=function(){};h["tools.spark.sliced.services.std.display.databuffer.interfaces.IDataBuffer"]=
Lj;Lj.__name__="tools,spark,sliced,services,std,display,databuffer,interfaces,IDataBuffer".split(",");Lj.prototype={__class__:Lj};var zh=function(){this.dataBuffer=[]};h["tools.spark.sliced.services.std.display.databuffer.core.DataBuffer"]=zh;zh.__name__="tools,spark,sliced,services,std,display,databuffer,core,DataBuffer".split(",");zh.__interfaces__=[Lj];zh.prototype={addEntry:function(a,b,c,d){this.dataBuffer.push(new Ah(a,b,c,d))},clearBuffer:function(){this.dataBuffer=[]},__class__:zh};var Z=
h["tools.spark.sliced.services.std.display.databuffer.interfaces.EBufferEntryType"]={__ename__:"tools,spark,sliced,services,std,display,databuffer,interfaces,EBufferEntryType".split(","),__constructs__:"SET_SPACE,ADDED,INSERTED,REMOVED,UPDATED_STATE,UPDATED_FORM_STATE".split(",")};Z.SET_SPACE=["SET_SPACE",0];Z.SET_SPACE.toString=l;Z.SET_SPACE.__enum__=Z;Z.ADDED=["ADDED",1];Z.ADDED.toString=l;Z.ADDED.__enum__=Z;Z.INSERTED=["INSERTED",2];Z.INSERTED.toString=l;Z.INSERTED.__enum__=Z;Z.REMOVED=["REMOVED",
3];Z.REMOVED.toString=l;Z.REMOVED.__enum__=Z;Z.UPDATED_STATE=["UPDATED_STATE",4];Z.UPDATED_STATE.toString=l;Z.UPDATED_STATE.__enum__=Z;Z.UPDATED_FORM_STATE=["UPDATED_FORM_STATE",5];Z.UPDATED_FORM_STATE.toString=l;Z.UPDATED_FORM_STATE.__enum__=Z;Z.__empty_constructs__=[Z.SET_SPACE,Z.ADDED,Z.INSERTED,Z.REMOVED,Z.UPDATED_STATE,Z.UPDATED_FORM_STATE];var Mj=function(){};h["tools.spark.sliced.services.std.display.managers.interfaces.IActiveReferenceMediator"]=Mj;Mj.__name__="tools,spark,sliced,services,std,display,managers,interfaces,IActiveReferenceMediator".split(",");
Mj.prototype={__class__:Mj};var yh=function(a){this.display=a;this.spaceReferenceManager=new Bh(this);this.stageReferenceManager=new Ch(this);this.viewReferenceManager=new Dh(this);this.stageAreaReferenceManager=new Eh(this)};h["tools.spark.sliced.services.std.display.managers.core.ActiveReferenceMediator"]=yh;yh.__name__="tools,spark,sliced,services,std,display,managers,core,ActiveReferenceMediator".split(",");yh.__interfaces__=[Mj];yh.prototype={createSpaceReference:function(a){return w.__cast(this.spaceReferenceManager.create(a),
Oe)},createStageReference:function(a){return w.__cast(this.stageReferenceManager.create(a),Yd)},createViewReference:function(a){return w.__cast(this.viewReferenceManager.create(a),Zd)},createStageAreaReference:function(a){return w.__cast(this.stageAreaReferenceManager.create(a),Mf)},getActiveSpaceReference:function(a){return null==this.display.projectActiveSpaceReference?null:a==this.display.projectActiveSpaceReference.spaceEntity?this.display.projectActiveSpaceReference:null},getActiveStageReference:function(a){return null==
this.display.projectActiveSpaceReference||null==this.display.projectActiveSpaceReference.activeStageReference?null:a==this.display.projectActiveSpaceReference.activeStageReference.stageEntity?this.display.projectActiveSpaceReference.activeStageReference:null},getActiveViewReference:function(a){if(null==this.display.projectActiveSpaceReference||null==this.display.projectActiveSpaceReference.activeStageReference)return null;for(var b=0,c=this.display.projectActiveSpaceReference.activeStageReference.activeViewReferences;b<
c.length;){var d=c[b];++b;if(d.viewEntity==a)return d}return null},getActiveStageAreaReference:function(a){if(null==this.display.projectActiveSpaceReference||null==this.display.projectActiveSpaceReference.activeStageReference)return null;for(var b=0,c=this.display.projectActiveSpaceReference.activeStageReference.activeStageAreaReferences;b<c.length;){var d=c[b];++b;if(d.stageAreaEntity==a)return d}return null},__class__:yh};var Qb=function(){};h["tools.spark.sliced.services.std.display.managers.interfaces.IDisplayObjectManager"]=
Qb;Qb.__name__="tools,spark,sliced,services,std,display,managers,interfaces,IDisplayObjectManager".split(",");Qb.prototype={__class__:Qb};var Fh=function(a){this._renderer=a};h["tools.spark.sliced.services.std.display.managers.core.DomCameraManager"]=Fh;Fh.__name__="tools,spark,sliced,services,std,display,managers,core,DomCameraManager".split(",");Fh.__interfaces__=[Qb];Fh.prototype={create:function(a){return new Df(a)},destroy:function(){},update:function(){},updateState:function(){},addTo:function(){},
removeFrom:function(){},__class__:Fh};var Gh=function(a){this._renderer=a};h["tools.spark.sliced.services.std.display.managers.core.DomObjectManager"]=Gh;Gh.__name__="tools,spark,sliced,services,std,display,managers,core,DomObjectManager".split(",");Gh.__interfaces__=[Qb];Gh.prototype={create:function(a){var b=new td(a);this.update(b,a);return b},destroy:function(){},update:function(a,b){var c;c=w.__cast(a,td);for(var d=0,e=b.get_children();d<e.length;){var f=e[d];++d;this.addTo(this._renderer.createObject(f),
c)}},updateState:function(a,b,c){a=w.__cast(a,td);for(b=a._instances.keys();b.hasNext();){var d=b.next();null!=a._updateStateFunctions.get(c)?a._updateStateFunctions.get(c)(a.gameEntity.getState(c),d):t._engineLogger.warn("State "+c+" does not have a function handler! Ignoring :(",null)}},addTo:function(a,b){var c;c=w.__cast(b,td);null!=a&&c.addChild(a)},insertTo:function(a,b,c){b=w.__cast(b,td);null!=a&&b.insertChild(a,c)},removeFrom:function(a,b){var c;c=w.__cast(b,td);null!=a&&c.removeChild(a)},
__class__:Gh};var Hh=function(a){this._renderer=a};h["tools.spark.sliced.services.std.display.managers.core.DomSceneManager"]=Hh;Hh.__name__="tools,spark,sliced,services,std,display,managers,core,DomSceneManager".split(",");Hh.__interfaces__=[Qb];Hh.prototype={create:function(a){var b=new Jd(a);this.update(b,a);return b},destroy:function(){},update:function(a,b){var c;c=w.__cast(a,Jd);for(var d=0,e=b.get_children();d<e.length;){var f=e[d];++d;this.addTo(this._renderer.createObject(f),c)}},updateState:function(){},
addTo:function(a,b){var c;c=w.__cast(b,Jd);null!=a&&c.addChild(a)},insertTo:function(a,b,c){b=w.__cast(b,Jd);null!=a&&b.insertChild(a,c)},removeFrom:function(a,b){var c;c=w.__cast(b,Jd);null!=a&&c.removeChild(a)},__class__:Hh};var Ih=function(a){this._renderer=a};h["tools.spark.sliced.services.std.display.managers.core.DomViewManager"]=Ih;Ih.__name__="tools,spark,sliced,services,std,display,managers,core,DomViewManager".split(",");Ih.__interfaces__=[Qb];Ih.prototype={create:function(a){var b=new Kd(a);
this.update(b,a);return b},destroy:function(a){w.__cast(a,Kd).destroy()},update:function(a,b){this.updateState(a,b,"scene");this.updateState(a,b,"camera");this.updateState(a,b,"visible")},updateState:function(a,b,c){a=w.__cast(a,Kd);switch(c){case "scene":b=b.getState(c);a.set_scene(this._renderer.createScene(b));break;case "camera":b=b.getState(c);a.set_camera(this._renderer.createCamera(b));break;default:a.updateState(c)}},addTo:function(){},removeFrom:function(){},__class__:Ih};var Jh=function(a){this._renderer=
a};h["tools.spark.sliced.services.std.display.managers.core.Flambe2_5DCameraManager"]=Jh;Jh.__name__="tools,spark,sliced,services,std,display,managers,core,Flambe2_5DCameraManager".split(",");Jh.__interfaces__=[Qb];Jh.prototype={create:function(a){return new Le(a)},destroy:function(){},update:function(){},updateState:function(a,b,c){for(a=w.__cast(a,Le)._attachedToViews.keys();a.hasNext();)switch(b=a.next(),c){case "command_updateCamera":b.updateCamera();break;default:t._engineLogger.warn("Unhandled Camera State value: "+
c,null)}},addTo:function(){},removeFrom:function(){},__class__:Jh};var Kh=function(a){this._renderer=a};h["tools.spark.sliced.services.std.display.managers.core.Flambe2_5DObjectManager"]=Kh;Kh.__name__="tools,spark,sliced,services,std,display,managers,core,Flambe2_5DObjectManager".split(",");Kh.__interfaces__=[Qb];Kh.prototype={create:function(a){var b=new Ld(a);this.update(b,a);return b},destroy:function(){},update:function(a,b){var c;c=w.__cast(a,Ld);for(var d=0,e=b.get_children();d<e.length;){var f=
e[d];++d;this.addTo(this._renderer.createObject(f),c)}},updateState:function(a,b,c){a=w.__cast(a,Ld);for(b=a._instances.keys();b.hasNext();){var d=b.next();null!=a._updateStateFunctions.get(c)?a._updateStateFunctions.get(c)(a.gameEntity.getState(c),d):t._engineLogger.warn("State "+c+" does not have a function handler! Ignoring :(",null)}},addTo:function(a,b){var c;c=w.__cast(b,Ld);null!=a&&c.addChild(a)},insertTo:function(a,b,c){b=w.__cast(b,Ld);null!=a&&b.insertChild(a,c)},removeFrom:function(a,
b){var c;c=w.__cast(b,Ld);null!=a&&c.removeChild(a)},__class__:Kh};var Lh=function(a){this._renderer=a};h["tools.spark.sliced.services.std.display.managers.core.Flambe2_5DSceneManager"]=Lh;Lh.__name__="tools,spark,sliced,services,std,display,managers,core,Flambe2_5DSceneManager".split(",");Lh.__interfaces__=[Qb];Lh.prototype={create:function(a){var b=new qa(a);this.update(b,a);return b},destroy:function(){},update:function(a,b){var c;c=w.__cast(a,qa);for(var d=0,e=b.get_children();d<e.length;){var f=
e[d];++d;this.addTo(this._renderer.createObject(f),c)}},updateState:function(a,b,c){a=w.__cast(a,qa);for(b=a._instances.keys();b.hasNext();){var d=b.next();null!=a._updateStateFunctions.get(c)?a._updateStateFunctions.get(c)(a.gameEntity.getState(c),d):t._engineLogger.warn("State "+c+" does not have a function handler! Ignoring :(",null)}},addTo:function(a,b){var c;c=w.__cast(b,qa);null!=a&&c.addChild(a)},insertTo:function(a,b,c){b=w.__cast(b,qa);null!=a&&b.insertChild(a,c)},removeFrom:function(a,
b){var c;c=w.__cast(b,qa);null!=a&&c.removeChild(a)},__class__:Lh};var Mh=function(a,b){this._renderer=a;this._flambeGraphics=b};h["tools.spark.sliced.services.std.display.managers.core.Flambe2_5DViewManager"]=Mh;Mh.__name__="tools,spark,sliced,services,std,display,managers,core,Flambe2_5DViewManager".split(",");Mh.__interfaces__=[Qb];Mh.prototype={create:function(a){var b=new me(a,this._flambeGraphics);this.update(b,a);return b},destroy:function(a){w.__cast(a,me).destroy()},update:function(a,b){this.updateState(a,
b,"scene");this.updateState(a,b,"camera")},updateState:function(a,b,c){a=w.__cast(a,me);switch(c){case "scene":b=b.getState(c);a.set_scene(this._renderer.createScene(b));break;case "camera":b=b.getState(c);a.set_camera(this._renderer.createCamera(b));break;case "visible":a.setVisible(b.getState(c))}},addTo:function(){},removeFrom:function(){},__class__:Mh};var Bh=function(a){this._activeReferenceMediator=a};h["tools.spark.sliced.services.std.display.managers.core.SpaceReferenceManager"]=Bh;Bh.__name__=
"tools,spark,sliced,services,std,display,managers,core,SpaceReferenceManager".split(",");Bh.__interfaces__=[Qb];Bh.prototype={create:function(a){return new Oe(a)},destroy:function(){},update:function(a,b){null!=a&&this.updateState(a,b,"stage")},updateState:function(a,b,c){if(null!=a)switch(a=w.__cast(a,Oe),c){case "stage":null!=b.getState(c)&&this._setStage(a,this._activeReferenceMediator.createStageReference(b.getState(c)),b.getState(c))}},_setStage:function(a,b,c){null!=this._activeReferenceMediator.getActiveStageReference(c)?
t.warn("This stage object ["+r.string(c.getState("name"))+"] is already bound to the Active Space. Ignoring...",null):(null!=this._activeReferenceMediator.display.projectActiveSpaceReference.activeStageReference&&t._engineLogger.warn("Another stage object was already set to this Project! Resetting...",null),a.activeStageReference=b,this._activeReferenceMediator.stageReferenceManager.update(b,c))},addTo:function(){},removeFrom:function(){},__class__:Bh};var Eh=function(a){this._activeReferenceMediator=
a};h["tools.spark.sliced.services.std.display.managers.core.StageAreaReferenceManager"]=Eh;Eh.__name__="tools,spark,sliced,services,std,display,managers,core,StageAreaReferenceManager".split(",");Eh.__interfaces__=[Qb];Eh.prototype={create:function(a){return new Mf(a)},destroy:function(){},update:function(a){null!=a&&w.__cast(a,Lf).layoutElement.update()},updateState:function(a,b,c){null!=a&&w.__cast(a,Lf).layoutElement.updateState(c)},addTo:function(){},removeFrom:function(){},__class__:Eh};var Ch=
function(a){this._activeReferenceMediator=a};h["tools.spark.sliced.services.std.display.managers.core.StageReferenceManager"]=Ch;Ch.__name__="tools,spark,sliced,services,std,display,managers,core,StageReferenceManager".split(",");Ch.__interfaces__=[Qb];Ch.prototype={create:function(a){return new Yd(a)},destroy:function(){},update:function(a,b){if(null!=a){var c;c=w.__cast(a,Nf);this.updateState(c,b,"test");this.updateState(c,b,"width");this.updateState(c,b,"height");c.layoutRoot.update();c.layoutRoot.explicitWidth=
G._platform.getStage().get_width();c.layoutRoot.explicitHeight=G._platform.getStage().get_height();for(var d=0,e=b.getChildren();d<e.length;){var f=e[d];++d;this.addTo(f,c)}}},updateState:function(a){null!=a&&w.__cast(a,Nf)},addTo:function(a,b){if(null!=b){var c;c=w.__cast(b,Yd);var d;d=w.__cast(a,$d);"View"==d.getState("displayType")?this._addView(c,this._activeReferenceMediator.createViewReference(d),d):"StageArea"==d.getState("displayType")?this._addStageArea(c,this._activeReferenceMediator.createStageAreaReference(d),
d):t._engineLogger.warn("A child of a Stage gameEntity is NOT a View or a StageArea! Ignoring...",null)}},removeFrom:function(a,b){if(null!=b){var c;c=w.__cast(b,Yd);var d;d=w.__cast(a,$d);"View"==d.getState("displayType")?this._removeView(c,d):"StageArea"==d.getState("displayType")?this._removeStageArea(c,d):t._engineLogger.warn("A child of a Stage gameEntity is NOT a View or a StageArea! Ignoring...",null)}},_addView:function(a,b,c){null!=this._activeReferenceMediator.getActiveViewReference(c)?
t.warn("This view object ["+r.string(c.getState("name"))+"] is already bound to the Active Stage. Ignoring...",null):null==c.getState("scene")||null==c.getState("camera")?t.warn("This view object ["+r.string(c.getState("name"))+"] is not ready yet (missing camera or scene). Ignoring...",null):(a.addView(b),this._activeReferenceMediator.viewReferenceManager.update(b,c))},_addStageArea:function(a,b,c){null!=this._activeReferenceMediator.getActiveStageAreaReference(c)?t.warn("This stageArea object ["+
r.string(c.getState("name"))+"] is already bound to the Active Stage. Ignoring...",null):(a.addStageArea(b),this._activeReferenceMediator.stageAreaReferenceManager.update(b,c))},_removeView:function(a,b){var c=this._activeReferenceMediator.getActiveViewReference(b);null==c?t.warn("This view object ["+r.string(b.getState("name"))+"] is not bound to the Active Stage. Ignoring Remove View...",null):(a.removeView(c),this._activeReferenceMediator.viewReferenceManager.destroy(c))},_removeStageArea:function(a,
b){var c=this._activeReferenceMediator.getActiveStageAreaReference(b);null==c?t.warn("This stageArea object ["+r.string(b.getState("name"))+"] is not bound to the Active Stage. Ignoring Remove StageArea...",null):a.removeStageArea(c)},__class__:Ch};var Dh=function(a){this._activeReferenceMediator=a};h["tools.spark.sliced.services.std.display.managers.core.ViewReferenceManager"]=Dh;Dh.__name__="tools,spark,sliced,services,std,display,managers,core,ViewReferenceManager".split(",");Dh.__interfaces__=
[Qb];Dh.prototype={create:function(a){return new Zd(a)},destroy:function(a){null!=a&&(a=w.__cast(a,Of),null!=a.renderer?a.renderer.destroyView(a.viewEntity):t._engineLogger.error("Tried to remove View from renderer, but view wasn't assigned to one. Ignoring...",null))},update:function(a,b){if(null!=a){var c;c=w.__cast(a,Of);this.updateState(c,b,"scene");this.updateState(c,b,"camera");c.layoutElement.update();this._updateRenderer(c)}},updateState:function(a,b,c){if(null!=a)switch(c){case "scene":this._updateRenderer(w.__cast(a,
Zd));break;case "camera":this._updateRenderer(w.__cast(a,Zd))}},_updateRenderer:function(a){if(null==a.renderer){if("Implicit"!=a.viewEntity.getState("renderer")){var b=a.viewEntity.getState("renderer");a.renderer=this._activeReferenceMediator.display.platformRendererSet.get(b)}else t.error("Implicit Renderer selection has not been implemented yet. View "+r.string(a.viewEntity.getState("name"))+" cannot be rendered!",null);null!=a.renderer?a.renderer.createView(a.viewEntity):t.error("Could not create renderer: "+
r.string(a.viewEntity.getState("renderer"))+".",null)}},addTo:function(){},removeFrom:function(){},__class__:Dh};var Nh=function(){};h["tools.spark.sliced.services.std.display.renderers.interfaces.IRenderer"]=Nh;Nh.__name__="tools,spark,sliced,services,std,display,renderers,interfaces,IRenderer".split(",");Nh.prototype={__class__:Nh};var Pe=function(){null};h["tools.spark.sliced.services.std.display.renderers.core.ARenderer"]=Pe;Pe.__name__="tools,spark,sliced,services,std,display,renderers,core,ARenderer".split(",");
Pe.__interfaces__=[Nh];Pe.prototype={getRealObject:function(){return null},__class__:Pe};var Nj=function(){};h["tools.spark.sliced.services.std.display.renderers.interfaces.IDimensionSpecificRenderer"]=Nj;Nj.__name__="tools,spark,sliced,services,std,display,renderers,interfaces,IDimensionSpecificRenderer".split(",");Nj.__interfaces__=[Nh];var ed=function(){Pe.call(this);null};h["tools.spark.sliced.services.std.display.renderers.core.dimension.A2_5DRenderer"]=ed;ed.__name__="tools,spark,sliced,services,std,display,renderers,core,dimension,A2_5DRenderer".split(",");
ed.__interfaces__=[Nj];ed.__super__=Pe;ed.prototype=x(Pe.prototype,{__class__:ed});var Qe=function(){};h["tools.spark.sliced.services.std.display.renderers.interfaces.ILibrarySpecificRenderer"]=Qe;Qe.__name__="tools,spark,sliced,services,std,display,renderers,interfaces,ILibrarySpecificRenderer".split(",");Qe.__interfaces__=[Nj];Qe.prototype={__class__:Qe};var ne=function(){ed.call(this);this._internalGraphics=this._platform.getRenderer().graphics;null==this._internalGraphics&&t._engineLogger.error("Flambe renderer does NOT have internal graphics!",
null);this._views=new Fa;this._scenes=new Fa;this._cameras=new Fa;this._objects=new Fa;this._viewManager=new Mh(this,this._internalGraphics);this._sceneManager=new Lh(this);this._cameraManager=new Jh(this);this._objectManager=new Kh(this)};h["tools.spark.sliced.services.std.display.renderers.core.library.AFlambe2_5DRenderer"]=ne;ne.__name__="tools,spark,sliced,services,std,display,renderers,core,library,AFlambe2_5DRenderer".split(",");ne.__interfaces__=[Qe];ne.__super__=ed;ne.prototype=x(ed.prototype,
{renderView:function(a){this._views.h[a.__id__].render()},createView:function(a){if(null!=this._views.h[a.__id__])t.warn("View "+r.string(a.getState("name"))+" has already been added to this Flambe2_5DRenderer. Ignoring...",null);else{var b;b=w.__cast(this._viewManager.create(a),me);this._views.set(a,b);b}return this._views.h[a.__id__]},destroyView:function(a){null==this._views.h[a.__id__]?t.warn("View "+r.string(a.getState("name"))+" has not been added to this Flambe2_5DRenderer. Ignoring destroyView...",
null):(this._viewManager.destroy(this._views.h[a.__id__]),this._views.set(a,null),null)},createScene:function(a){if(null!=this._scenes.h[a.__id__])t.warn("Scene "+r.string(a.getState("name"))+" has already been added to this Flambe2_5DRenderer. Ignoring...",null);else{var b;b=w.__cast(this._sceneManager.create(a),qa);this._scenes.set(a,b);b}return this._scenes.h[a.__id__]},createCamera:function(a){if(null!=this._cameras.h[a.__id__])t.warn("Camera "+r.string(a.getState("name"))+" has already been added to this Flambe2_5DRenderer. Ignoring...",
null);else{var b;b=w.__cast(this._cameraManager.create(a),Le);this._cameras.set(a,b);b}return this._cameras.h[a.__id__]},createObject:function(a){if("Entity"==a.getState("displayType")){if(null==this._objects.h[a.__id__]){var b;b=w.__cast(this._objectManager.create(a),vc);this._objects.set(a,b);b}return this._objects.h[a.__id__]}return null},addChild:function(a,b){switch(a.getState("displayType")){case "Scene":null!=this._scenes.h[a.__id__]&&this._sceneManager.addTo(this.createObject(b),this._scenes.h[a.__id__]);
break;case "Entity":null!=this._objects.h[a.__id__]&&this._objectManager.addTo(this.createObject(b),this._objects.h[a.__id__]);break;default:t.warn("AFlambe2_5DRenderer: Unhandled add child request: "+r.string(a.getState("displayType")),null)}},insertChild:function(a,b,c){switch(a.getState("displayType")){case "Scene":null!=this._scenes.h[a.__id__]&&this._sceneManager.insertTo(this.createObject(b),this._scenes.h[a.__id__],c);break;case "Entity":null!=this._objects.h[a.__id__]&&this._objectManager.insertTo(this.createObject(b),
this._objects.h[a.__id__],c);break;default:t.warn("AFlambe2_5DRenderer: Unhandled insert child request: "+r.string(a.getState("displayType")),null)}},removeChild:function(a,b){switch(a.getState("displayType")){case "Scene":null!=this._scenes.h[a.__id__]&&this._sceneManager.removeFrom(this._objects.h[b.__id__],this._scenes.h[a.__id__]);break;case "Entity":null!=this._objects.h[a.__id__]&&this._objectManager.removeFrom(this._objects.h[b.__id__],this._objects.h[a.__id__]);break;default:t.warn("AFlambe2_5DRenderer: Unhandled remove child request: "+
r.string(a.getState("displayType")),null)}},updateState:function(a,b){null!=this._objects.h[a.__id__]?this._objectManager.updateState(this._objects.h[a.__id__],a,b):null!=this._views.h[a.__id__]?this._viewManager.updateState(this._views.h[a.__id__],a,b):null!=this._cameras.h[a.__id__]?this._cameraManager.updateState(this._cameras.h[a.__id__],a,b):null!=this._scenes.h[a.__id__]&&this._sceneManager.updateState(this._scenes.h[a.__id__],a,b)},getRealObject:function(a){return null!=this._objects.h[a.__id__]?
this._objects.h[a.__id__]:null!=this._views.h[a.__id__]?this._views.h[a.__id__]:null!=this._cameras.h[a.__id__]?this._cameras.h[a.__id__]:null!=this._scenes.h[a.__id__]?this._scenes.h[a.__id__]:null},__class__:ne});var Re=function(){ed.call(this)};h["tools.spark.sliced.services.std.display.renderers.core.library.ANativeControls2_5DRenderer"]=Re;Re.__name__="tools,spark,sliced,services,std,display,renderers,core,library,ANativeControls2_5DRenderer".split(",");Re.__interfaces__=[Qe];Re.__super__=ed;
Re.prototype=x(ed.prototype,{renderView:function(){},createView:function(){return null},destroyView:function(){},createScene:function(){return null},createCamera:function(){return null},createObject:function(){return null},addChild:function(){},insertChild:function(){},removeChild:function(){},updateState:function(){},__class__:Re});var Oj=function(){};h["tools.spark.sliced.services.std.display.renderers.interfaces.IPlatformSpecificRenderer"]=Oj;Oj.__name__="tools,spark,sliced,services,std,display,renderers,interfaces,IPlatformSpecificRenderer".split(",");
Oj.__interfaces__=[Qe];var Kf=function(){this._platform=Vc.instance;ne.call(this);t._engineLogger.info("Creating Flambe 2_5D Html Renderer...",null)};h["tools.spark.sliced.services.std.display.renderers.core.platform.html.Flambe2_5DHtmlRenderer"]=Kf;Kf.__name__="tools,spark,sliced,services,std,display,renderers,core,platform,html,Flambe2_5DHtmlRenderer".split(",");Kf.__interfaces__=[Oj];Kf.__super__=ne;Kf.prototype=x(ne.prototype,{__class__:Kf});var Jf=function(){ed.call(this);t._engineLogger.info("Creating Native Controls Html (DOM) Renderer...",
null);this._views=new Fa;this._scenes=new Fa;this._cameras=new Fa;this._objects=new Fa;this._viewManager=new Ih(this);this._sceneManager=new Hh(this);this._cameraManager=new Fh(this);this._objectManager=new Gh(this)};h["tools.spark.sliced.services.std.display.renderers.core.platform.html.NativeControlsHtmlRenderer"]=Jf;Jf.__name__="tools,spark,sliced,services,std,display,renderers,core,platform,html,NativeControlsHtmlRenderer".split(",");Jf.__interfaces__=[Oj];Jf.__super__=Re;Jf.prototype=x(Re.prototype,
{renderView:function(a){this._views.h[a.__id__].render()},createView:function(a){if(null!=this._views.h[a.__id__])t.warn("View "+r.string(a.getState("name"))+" has already been added to this NativeControlsHtmlRenderer. Ignoring createView...",null);else{var b;b=w.__cast(this._viewManager.create(a),Kd);this._views.set(a,b);b}return this._views.h[a.__id__]},destroyView:function(a){null==this._views.h[a.__id__]?t.warn("View "+r.string(a.getState("name"))+" has not been added to this NativeControlsHtmlRenderer. Ignoring destroyView...",
null):(this._viewManager.destroy(this._views.h[a.__id__]),this._views.set(a,null),null)},createScene:function(a){if(null!=this._scenes.h[a.__id__])t.warn("Scene "+r.string(a.getState("name"))+" has already been added to this NativeControlsHtmlRenderer. Ignoring...",null);else{var b;b=w.__cast(this._sceneManager.create(a),Jd);this._scenes.set(a,b);b}return this._scenes.h[a.__id__]},createCamera:function(a){if(null!=this._cameras.h[a.__id__])t.warn("Camera "+r.string(a.getState("name"))+" has already been added to this NativeControlsHtmlRenderer. Ignoring...",
null);else{var b;b=w.__cast(this._cameraManager.create(a),Df);this._cameras.set(a,b);b}return this._cameras.h[a.__id__]},createObject:function(a){if("Entity"==a.getState("displayType")){if(null!=this._objects.h[a.__id__])t.warn("Object "+r.string(a.getState("name"))+" has already been added to this NativeControlsHtmlRenderer. Ignoring...",null);else{var b;b=w.__cast(this._objectManager.create(a),vc);this._objects.set(a,b);b}return this._objects.h[a.__id__]}return null},addChild:function(a,b){switch(a.getState("displayType")){case "Scene":null!=
this._scenes.h[a.__id__]&&this._sceneManager.addTo(this.createObject(b),this._scenes.h[a.__id__]);break;case "Entity":null!=this._objects.h[a.__id__]&&this._objectManager.addTo(this.createObject(b),this._objects.h[a.__id__]);break;default:t.warn("NativeControlsHtmlRenderer: Unhandled add child request: "+r.string(a.getState("displayType")),null)}},insertChild:function(a,b,c){switch(a.getState("displayType")){case "Scene":null!=this._scenes.h[a.__id__]&&this._sceneManager.insertTo(this.createObject(b),
this._scenes.h[a.__id__],c);break;case "Entity":null!=this._objects.h[a.__id__]&&this._objectManager.insertTo(this.createObject(b),this._objects.h[a.__id__],c);break;default:t.warn("NativeControlsHtmlRenderer: Unhandled insert child request: "+r.string(a.getState("displayType")),null)}},removeChild:function(a,b){switch(a.getState("displayType")){case "Scene":null!=this._scenes.h[a.__id__]&&this._sceneManager.removeFrom(this._objects.h[b.__id__],this._scenes.h[a.__id__]);break;case "Entity":null!=
this._objects.h[a.__id__]&&this._objectManager.removeFrom(this._objects.h[b.__id__],this._objects.h[a.__id__]);break;default:t.warn("NativeControlsHtmlRenderer: Unhandled remove child request: "+r.string(a.getState("displayType")),null)}},updateState:function(a,b){null!=this._objects.h[a.__id__]?this._objectManager.updateState(this._objects.h[a.__id__],a,b):null!=this._views.h[a.__id__]&&this._viewManager.updateState(this._views.h[a.__id__],a,b)},getRealObject:function(a){return null!=this._objects.h[a.__id__]?
this._objects.h[a.__id__]:null!=this._views.h[a.__id__]?this._views.h[a.__id__]:null!=this._cameras.h[a.__id__]?this._cameras.h[a.__id__]:null!=this._scenes.h[a.__id__]?this._scenes.h[a.__id__]:null},__class__:Jf});var Oh=function(){this._init()};h["tools.spark.sliced.services.std.event.core.Event"]=Oh;Oh.__name__="tools,spark,sliced,services,std,event,core,Event".split(",");Oh.__interfaces__=[qh];Oh.__super__=Eb;Oh.prototype=x(Eb.prototype,{_init:function(){var a=this;t._engineLogger.info("Init Event std Service...",
null);this._eventTypeRegisteredTriggers=new ea;this._eventEntries=[];G.hidden.get_changed().connect(function(b){b?(a._timeBeforePause=G._platform.getTime(),a.raiseEvent(m.PROJECT_PAUSED)):(s.logic.pauseDt=G._platform.getTime()-a._timeBeforePause,a.raiseEvent(m.PROJECT_RESUMED))})},addTrigger:function(a){var b=a.eventType,c=a.target;"TargetMe"==c&&(c=r.string(a.parentEntity.uid));var d;if(d=null!=a.parameter)d=K.keyboardStringToKey.exists(a.parameter);d&&(a.parameter=K.keyboardStringToKey.get(a.parameter));
!1==this._eventTypeRegisteredTriggers.exists(b)&&(d=new M,this._eventTypeRegisteredTriggers.set(b,d));!1==this._eventTypeRegisteredTriggers.get(b).exists(c)&&this._eventTypeRegisteredTriggers.get(b).set(c,[]);this._eventTypeRegisteredTriggers.get(b).get(c).push(a)},raiseEvent:function(a,b,c){if(this._eventTypeRegisteredTriggers.exists(a)){var d=[];null==b?d.push("TargetNone"):(d.push(null==b.uid?"null":""+b.uid),d.push(r.string(b.getState("name"))));for(var e=0;e<d.length;){var f=d[e];++e;this._eventTypeRegisteredTriggers.get(a).exists(f)&&
this._eventEntries.push({eventType:a,eventTarget:f,parameter:c,pickedObjects:b})}}},_doTriggers:function(a){for(var b=0,c=this._eventTypeRegisteredTriggers.get(a.eventType).get(a.eventTarget);b<c.length;){var d=c[b];++b;d.pickedObject=a.pickedObjects;(null==d.parameter||d.parameter==a.parameter)&&d.doPass()}},update:function(){for(;0<this._eventEntries.length;)this._doTriggers(this._eventEntries.pop())},__class__:Oh});var Ph=function(){this._init()};h["tools.spark.sliced.services.std.input.core.Input"]=
Ph;Ph.__name__="tools,spark,sliced,services,std,input,core,Input".split(",");Ph.__interfaces__=[rh];Ph.__super__=Eb;Ph.prototype=x(Eb.prototype,{_init:function(){t._engineLogger.info("Init Input std Service...",null);this.keyboard=new Qh;this.pointer=new Rh;this.mouse=new Sh},update:function(){this.keyboard.update();this.pointer.update();this.mouse.update()},__class__:Ph});var Pj=function(){};h["tools.spark.sliced.services.std.input.devices.interfaces.IInputDevice"]=Pj;Pj.__name__="tools,spark,sliced,services,std,input,devices,interfaces,IInputDevice".split(",");
var Qh=function(){this._init()};h["tools.spark.sliced.services.std.input.devices.core.KeyboardDevice"]=Qh;Qh.__name__="tools,spark,sliced,services,std,input,devices,core,KeyboardDevice".split(",");Qh.__interfaces__=[Pj];Qh.prototype={_init:function(){this._keysPressed=[];this._keysReleased=[];this._keysDown=new ea;this._keysJustPressed=new ea;this._keysJustReleased=new ea;G._platform.getKeyboard().down.connect(u(this,this._onKeyDown));G._platform.getKeyboard().up.connect(u(this,this._onKeyUp))},_onKeyDown:function(a){this._keysPressed.push(a.key);
this._keysDown.set(a.key,!0)},_onKeyUp:function(a){this._keysReleased.push(a.key);this._keysDown.remove(a.key)},update:function(){this._keysJustPressed=new ea;for(this._keysJustReleased=new ea;0<this._keysPressed.length;){var a=this._keysPressed.pop();this._keysJustPressed.set(a,!0);!0;s.event.raiseEvent(m.KEY_PRESSED,null,a)}for(;0<this._keysReleased.length;)a=this._keysReleased.pop(),this._keysJustReleased.set(a,!0),!0,s.event.raiseEvent(m.KEY_RELEASED,null,a);for(a=this._keysDown.keys();a.hasNext();){var b=
a.next();s.event.raiseEvent(m.KEY_DOWN,null,b)}},registerTrigger:function(){},isKeyDown:function(a){return G._platform.getKeyboard().isDown(a)},isKeyPressed:function(a){return this._keysJustPressed.exists(a)},isKeyReleased:function(a){return this._keysJustReleased.exists(a)},__class__:Qh};var Sh=function(){this._init()};h["tools.spark.sliced.services.std.input.devices.core.MouseDevice"]=Sh;Sh.__name__="tools,spark,sliced,services,std,input,devices,core,MouseDevice".split(",");Sh.__interfaces__=[Pj];
Sh.prototype={getScroll:function(){return this.get_scroll()},_init:function(){G._platform.getMouse().scroll.connect(u(this,this._onScroll));G._platform.getMouse().down.connect(u(this,this._onMouseButtonDown));this._oldScroll=0;this._mouseRightDown=this._mouseLeftDown=this._scrollTriggered=!1},update:function(){this._scrollTriggered?(s.event.raiseEvent(m.MOUSE_SCROLL),this._scrollTriggered=!1):this._oldScroll=0;this._mouseLeftDown&&(s.event.raiseEvent(m.MOUSE_LEFT_DOWN),this._mouseLeftDown=!1);this._mouseRightDown&&
(s.event.raiseEvent(m.MOUSE_RIGHT_DOWN),this._mouseRightDown=!1)},get_scroll:function(){return this._oldScroll},_onScroll:function(a){this._scrollTriggered=!0;this._oldScroll=a},_onMouseButtonDown:function(a){a.button==Da.Left?this._mouseLeftDown=!0:a.button==Da.Right&&(this._mouseRightDown=!0);this.lastMouseButton=a.button},registerTrigger:function(){},isDown:function(a){return G._platform.getMouse().isDown(a)},__class__:Sh,__properties__:{get_scroll:"get_scroll"}};var Rh=function(){this._init()};
h["tools.spark.sliced.services.std.input.devices.core.PointerDevice"]=Rh;Rh.__name__="tools,spark,sliced,services,std,input,devices,core,PointerDevice".split(",");Rh.__interfaces__=[Pj];Rh.prototype={_init:function(){this._registeredTriggers=new ea},update:function(){this._oldX=this.currentX;this._oldY=this.currentY;this.currentX=G._platform.getPointer().get_x();this.currentY=G._platform.getPointer().get_y()},distX:function(){return this.currentX-this._oldX},distY:function(){return this.currentY-
this._oldY},isDown:function(){return G._platform.getPointer().isDown()},_setTrigger:function(a,b){if(null==this._registeredTriggers.get(a)){var c=new Fa;this._registeredTriggers.set(a,c);c}this._registeredTriggers.get(a).set(b,b);b},_getTrigger:function(a,b){return null==this._registeredTriggers.get(a)?null:this._registeredTriggers.get(a).get(b)},registerTrigger:function(a,b){this._setTrigger(a,b)},submitPointerEvent:function(a,b){s.event.raiseEvent(a,b)},_onMove:function(a){t._engineLogger.error("PointerMove: "+
a.viewX+", "+a.viewY,null)},__class__:Rh};var Th=function(){this._init()};h["tools.spark.sliced.services.std.logic.core.Logic"]=Th;Th.__name__="tools,spark,sliced,services,std,logic,core,Logic".split(",");Th.__interfaces__=[sh];Th.__super__=Eb;Th.prototype=x(Eb.prototype,{_init:function(){t._engineLogger.info("Init Logic std Service...",null);K.init();this.gameFactory=new Uh;this.levelManager=new Qj;this.rootGameEntitiesRunning=new M;this.rootGameEntitiesPaused=new M;this.gameEntitiesByName=new M;
this.registerToBackupActive=!1},createInterpreters:function(){this.scriptInterpreter=new Vh;this.gmlInterpreter=new Wh},update:function(){for(var a=this.rootGameEntitiesRunning.iterator();a.hasNext();)a.next().doActions()},startAction:function(a,b){return a.startAction(b)},createAndRun:function(a){var b=this.gameFactory.createGameEntity(a);this.rootGameEntitiesRunning.set(a,b);b;t._engineLogger.info("Logic Service: Create and Running entity: "+a,null)},createAndPause:function(a){var b=this.gameFactory.createGameEntity(a);
this.rootGameEntitiesPaused.set(a,b);b},create:function(a,b){null==b&&(b=!1);return this.gameFactory.createGameEntity(a,null,b)},createFromXml:function(a,b){null==b&&(b=!0);return b?this.gameFactory.createGameEntity(null,this.xml_clone(a)):this.gameFactory.createGameEntity(null,a)},interpet:function(a,b,c){var d=null;null!=b&&(d=b.parentEntity);return this.scriptInterpreter.runExpr(this.scriptInterpreter.hashExpr(a),b,d,c)},getAllEntitiesByName:function(a){return this.gameEntitiesByName.get(a)},getEntityByName:function(a){return this.gameEntitiesByName.exists(a)?
this.gameEntitiesByName.get(a)[this.gameEntitiesByName.get(a).length-1]:null},queryGameEntity:function(a,b,c,d,e){null==e&&(e=!1);null==d&&(d=!1);return!1==d&&!1==e?(a=s.display.getSpace2_5Object(a),null!=a?a.query(b,c):null):null},registerEntityByName:function(a){if(null!=a.getState("name")){var b=a.getState("name"),c;c=this.registerToBackupActive?this.gameEntitiesByNameBackup:this.gameEntitiesByName;if(!1==(null!=Oa[b]?c.existsReserved(b):c.h.hasOwnProperty(b))){var d=[];null!=Oa[b]?c.setReserved(b,
d):c.h[b]=d}(null!=Oa[b]?c.getReserved(b):c.h[b]).push(a)}},deregisterEntityNameClass:function(a){if(null!=a.getState("name")){var a=a.getState("name"),b;b=this.registerToBackupActive?this.gameEntitiesByNameBackup:this.gameEntitiesByName;(null!=Oa[a]?b.existsReserved(a):b.h.hasOwnProperty(a))&&b.remove(a)}},get_storage:function(){return G._platform.getStorage()},getStorage:function(){return G._platform.getStorage()},getExternal:function(){return G._platform.getExternal()},getTime:function(){return G._platform.getTime()},
random:function(a,b){return a+r.random(b-a+1)},replace:function(a,b,c,d){return(new xb(b,c)).replace(a,d)},getDt:function(){return s.dt},reflectField:function(a,b){return da.getProperty(a,b)},reflectFieldOfField:function(a,b,c){return da.getProperty(da.getProperty(a,b),c)},copyObject:function(a){return da.copy(a)},insertStr:function(a,b,c){return A.substr(a,0,c)+b+A.substr(a,c,null)},lerp:function(a,b,c){return a==b?a:(b-a)*c+a},formatStr:function(a){a=r.string(a);9<a.length?(a=this.insertStr(a,",",
a.length-9),a=this.insertStr(a,",",a.length-6),a=this.insertStr(a,",",a.length-3)):6<a.length?(a=this.insertStr(a,",",a.length-6),a=this.insertStr(a,",",a.length-3)):3<a.length&&(a=this.insertStr(a,",",a.length-3));return a},getDbaFlambeId:function(a){return r.string(a.type)+":"+r.string(a.name)},xmlToString:function(a){return ld.print(a)},xml_createDocument:function(){return q.createDocument()},xml_clone:function(a){return q.parse(this.xmlToString(a)).firstElement()},xml_from_file:function(a){return q.parse(a.toString()).firstElement()},
xml_getElements:function(a,b){for(var c=a,d=0;d<b.length;){var e=b[d];++d;c=this.xml_getElement(c,e);if(null==c)return null}return c},xml_getAllStates:function(a,b){var c=new M,d=this.xml_getElement(a,b?"_States":"States");if(null!=d)for(d=d.elementsNamed("State");d.hasNext();){var e=d.next(),f=this.xml_getElement(e,"Id").firstChild().get_nodeValue(),i=this.xml_getElement(e,"Type").firstChild().get_nodeValue(),g=this.xml_getElement(e,"Value").firstChild().get_nodeValue(),e={id:f,type:i,value:g,kind:"Normal",
objectSpecific:e.get("objectSpecific"),visibleOnEditor:e.get("visibleOnEditor"),live:e.get("live")};c.set(f,e)}return c},xml_getState:function(a,b,c){return this.xml_getAllStates(a,c).get(b)},xml_getAllMStates:function(a,b){var c=new M,d=this.xml_getElement(a,b?"_States":"States");if(null!=d)for(d=d.elementsNamed("_State");d.hasNext();){var e=d.next(),f=e.get("id"),i=this.xml_getElement(e,"Value").firstChild().get_nodeValue(),e={id:f,value:i,kind:"Merge",objectSpecific:e.get("objectSpecific"),visibleOnEditor:e.get("visibleOnEditor"),
live:e.get("live")};c.set(f,e)}return c},xml_getMState:function(a,b,c){return this.xml_getAllMStates(a,c).get(b)},xml_getEveryState:function(a,b){for(var c=this.xml_getAllStates(a,b),d=this.xml_getAllMStates(a,b),d=new cf(d,d.arrayKeys());d.hasNext();){var e=d.next();c.exists(e.id)?c.get(e.id).value=e.value:c.set(e.id,e)}return c},xml_getEveryState_Array:function(a,b){var c=[],d=this.xml_getElement(a,b?"_States":"States");if(null!=d){for(var e=d.elementsNamed("State");e.hasNext();){var f=e.next(),
i=this.xml_getElement(f,"Id").firstChild().get_nodeValue(),g=this.xml_getElement(f,"Type").firstChild().get_nodeValue(),f=this.xml_getElement(f,"Value").firstChild().get_nodeValue();c.push({id:i,type:g,value:f,kind:"Normal"})}for(d=d.elementsNamed("_State");d.hasNext();)i=d.next(),e=i.get("id"),i=this.xml_getElement(i,"Value").firstChild().get_nodeValue(),c.push({id:e,value:i,kind:"Merge"})}return c},xml_parseAsset:function(a){return q.parse(C.getFile(r.string(a.dir)+"/"+r.string(a.fileName)+"."+
r.string(a.fileExtension)).toString()).firstElement()},xml_parseScript:function(a){return q.parse(a.toString()).firstElement()},xml_parseScriptName:function(a){return this.xml_parseScript(C.getScript(a))},xml_getElement:function(a,b){var c=a.elementsNamed(b);return c.hasNext()?c.next():null},xml_createElements:function(a){for(var b={first:null,last:null},c=0;c<a.length;){var d=a[c];++c;d=q.createElement(d);null==b.first?b.first=d:b.last.addChild(d);b.last=d}return b},xml_createElement:function(a,
b){if(null==b)return q.createElement(a);var c=q.createElement(a);c.addChild(q.createPCData(b));return c},xml_createElementAttr:function(a,b,c){a=q.createElement(a);a.set(b,c);return a},xml_entity_removeNode:function(a,b){var c=a.elementsNamed(b);c.hasNext()&&a.removeChild(c.next());return a},xml_entity_removeAllNodes:function(a,b){for(var c=a.elementsNamed(b);c.hasNext();)a.removeChild(c.next());return a},xml_entity_addExtend:function(a,b){var c;c=a.elementsNamed("Extends");c.hasNext()?c=c.next():
(c=q.createElement("Extends"),a.addChild(c));var d=q.createElement("Entity");c.addChild(d);null!=b.ext&&d.set("extends",b.ext);return d},xml_entity_getExtendsEntityNames:function(a){var b=[],c=null,a=a.elementsNamed("Extends");a.hasNext()&&(c=a.next());if(null!=c)for(c=c.elementsNamed("Entity");c.hasNext();)a=c.next(),b.push(a.get("extends"));return b},xml_entity_getExtendsEntities:function(a){var b=[],c=null,a=a.elementsNamed("Extends");a.hasNext()&&(c=a.next());if(null!=c)for(c=c.elementsNamed("Entity");c.hasNext();)a=
c.next(),b.push({ext:a.get("extends"),meta_editor:a.get("meta_editor"),xml:a});return b},xml_entity_addFormState:function(a,b,c,d){var c=c?"_Form":"Form",e=a.elementsNamed(c);e.hasNext()?c=e.next():(c=q.createElement(c),a.addChild(c));return this.xml_entity_addState(c,b,d)},xml_entity_updateFormState:function(a,b,c,d){a=a.elementsNamed(c?"_Form":"Form");if(a.hasNext())a=a.next();else return!1;return this.xml_entity_updateState(a,b,d)},xml_entity_addState:function(a,b,c){var c=c?"_States":"States",
d=a.elementsNamed(c);d.hasNext()?c=d.next():(c=q.createElement(c),a.addChild(c));a=q.createElement("State");c.addChild(a);null!=b.id&&(c=q.createElement("Id"),a.addChild(c),c.addChild(q.createPCData(b.id)));null!=b.type&&(c=q.createElement("Type"),a.addChild(c),c.addChild(q.createPCData(b.type)));null!=b.value&&(c=q.createElement("Value"),a.addChild(c),c.addChild(q.createCData(b.value)));null!=b.visibleOnEditor&&a.set("visibleOnEditor",b.visibleOnEditor);null!=b.objectSpecific&&a.set("objectSpecific",
b.objectSpecific);null!=b.live&&a.set("live",b.live);return a},xml_entity_updateState:function(a,b,c,d){null==d&&(d=!1);var e;e=a.elementsNamed(c?"_States":"States");if(e.hasNext())e=e.next();else return d?(this.xml_entity_addState(a,b,c),!0):!1;for(e=e.elements();e.hasNext();){var f=e.next();if(this.xml_getElement(f,"Id").firstChild().get_nodeValue()==b.id){var i=this.xml_getElement(f,"Value");i.removeChild(function(){if(i.nodeType!=q.Document&&i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+
i.nodeType));return i.children[0]}(this));i.addChild(q.createCData(b.value));return!0}}return d?(this.xml_entity_addState(a,b,c),!0):!1},xml_entity_addMState:function(a,b,c){var c=c?"_States":"States",d=a.elementsNamed(c);d.hasNext()?c=d.next():(c=q.createElement(c),a.addChild(c));a=q.createElement("_State");c.addChild(a);null!=b.id&&a.set("id",b.id);null!=b.value&&(c=q.createElement("Value"),a.addChild(c),c.addChild(q.createCData(b.value)));null!=b.visibleOnEditor&&a.set("visibleOnEditor",b.visibleOnEditor);
null!=b.objectSpecific&&a.set("objectSpecific",b.objectSpecific);null!=b.live&&a.set("live",b.live);return a},xml_entity_updateMState:function(a,b,c,d){null==d&&(d=!1);var e;e=a.elementsNamed(c?"_States":"States");if(e.hasNext())e=e.next();else return d?(this.xml_entity_addMState(a,b,c),!0):!1;for(e=e.elements();e.hasNext();){var f=e.next();if(f.get("id")==b.id){var i=this.xml_getElement(f,"Value");i.removeChild(function(){if(i.nodeType!=q.Document&&i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+
i.nodeType));return i.children[0]}(this));i.addChild(q.createCData(b.value));return!0}}return d?(this.xml_entity_addMState(a,b,c),!0):!1},xml_entity_addTrigger:function(a,b,c){var c=c?"_Triggers":"Triggers",d=a.elementsNamed(c);d.hasNext()?c=d.next():(c=q.createElement(c),a.addChild(c));a=q.createElement("Trigger");c.addChild(a);null!=b.ext&&a.set("extends",b.ext);null!=b.event&&(c=q.createElement("Event"),a.addChild(c),c.addChild(q.createPCData(b.event)));null!=b.target&&(c=q.createElement("Target"),
a.addChild(c),c.addChild(q.createPCData(b.target)));null!=b.parameter&&(c=q.createElement("Parameter"),a.addChild(c),c.addChild(q.createPCData(b.parameter)));return a},__class__:Th,__properties__:{get_storage:"get_storage"}});var Nd=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameBase"]=Nd;Nd.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameBase".split(",");Nd.prototype={__class__:Nd};var Ta=function(){};h["tools.spark.sliced.services.std.logic.gde.core.AGameBase"]=
Ta;Ta.__name__="tools,spark,sliced,services,std,logic,gde,core,AGameBase".split(",");Ta.__interfaces__=[Nd];Ta.prototype={get_parent:function(){return this.parentEntity},__class__:Ta,__properties__:{get_parent:"get_parent"}};var Xh=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameAction"]=Xh;Xh.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameAction".split(",");Xh.__interfaces__=[Nd];Xh.prototype={__class__:Xh};var Se=function(){this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameAction"]=
Se;Se.__name__="tools,spark,sliced,services,std,logic,gde,core,GameAction".split(",");Se.__interfaces__=[Xh];Se.__super__=Ta;Se.prototype=x(Ta.prototype,{_init:function(){this.scriptSet=[];this.gameStateSet=new M},clone:function(a){var b=new Se;b.parentEntity=a;b.id=this.id;b.concurrency=this.concurrency;for(var c=0,d=this.scriptSet;c<d.length;){var e=d[c];++c;b.scriptSet.push(e)}for(c=this.gameStateSet.iterator();c.hasNext();)d=c.next(),b.addState(d.clone(a));return b},addState:function(a){null!=
this.gameStateSet.get(a.id)&&t._engineLogger.warn("A State with id "+a.id+" already exists in this Action.",null);this.gameStateSet.set(a.id,a);a},doPass:function(){for(var a=0,b=this.scriptSet;a<b.length;){var c=b[a];++a;-1==c?s.logic.gmlInterpreter.run(c,function(a){var b=new M;null!=Oa.it?b.setReserved("it",a):b.h.it=a;b.set("me",a.parentEntity);b.set("parent",a.parentEntity.parentEntity);return b}(this)):!1==s.logic.scriptInterpreter.run(c,function(a){var b=new M;null!=Oa.it?b.setReserved("it",
a):b.h.it=a;b.set("me",a.parentEntity);b.set("parent",a.parentEntity.parentEntity);return b}(this))&&(t._engineLogger.error("Error: Failed to run Action ["+this.id+"].",null),this.parentEntity.stopAction(this.id))}},getState:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},s:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},get:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},
setState:function(a,b){this.gameStateSet.get(a).set_value(b);return this.gameStateSet.get(a).get_value()},set:function(a,b){this.gameStateSet.get(a).set_value(b);return this.gameStateSet.get(a).get_value()},addToState:function(a,b){var c=this.gameStateSet.get(a);c.set_value(c.get_value()+b);return this.gameStateSet.get(a).get_value()},subtractFromState:function(a,b){var c=this.gameStateSet.get(a);c.set_value(c.get_value()-b);return this.gameStateSet.get(a).get_value()},stop:function(){this.parentEntity.stopAction(this.id)},
__class__:Se});var Rj=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameClassInstantiator"]=Rj;Rj.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameClassInstantiator".split(",");Rj.prototype={__class__:Rj};var Yh=function(a,b,c){t._engineLogger.info("Creating Game Class Instantiator",null);this._xmlNodeTypeToNodeName=a;this._xmlConcurrencyNameToType=b;this._xmlStateNameToType=c};h["tools.spark.sliced.services.std.logic.gde.core.GameClassInstantiator"]=Yh;
Yh.__name__="tools,spark,sliced,services,std,logic,gde,core,GameClassInstantiator".split(",");Yh.__interfaces__=[Rj];Yh.prototype={instantiateEntity:function(a,b){var c=new $d;c.parentEntity=b;if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.STATES)).hasNext())for(var d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.STATES)).next().elements();d.hasNext();){var e=d.next();c.addState(this.instantiateState(e,c))}if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.ACTIONS)).hasNext())for(d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.ACTIONS)).next().elements();d.hasNext();)e=
this.instantiateAction(d.next(),c),c.addAction(e);if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TRIGGERS)).hasNext())for(d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TRIGGERS)).next().elements();d.hasNext();)e=this.instantiateTrigger(d.next(),c),c.addTrigger(e);s.logic.registerEntityByName(c);c.gameForm=this.instantiateForm(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.FORM)).next(),c);s.event.raiseEvent(m.CREATED,c);return c},instantiateForm:function(a,b){var c=new Te;c.parentEntity=
b;if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.STATES)).hasNext())for(var d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.STATES)).next().elements();d.hasNext();){var e=d.next();c.addState(this.instantiateState(e,b))}c.gameSpace=this.instantiateSpace(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.SPACE)).next(),b);return c},instantiateSpace:function(a,b){var c=new Ue;c.parentEntity=b;if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.ENTITIES)).hasNext())for(var d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.ENTITIES)).next().elements();d.hasNext();){var e=
d.next();c.gameEntitySet.push(this.instantiateEntity(e,b))}return c},instantiateState:function(a,b){var c;c=this._xmlStateNameToType.get(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TYPE)).next().firstChild().get_nodeValue());var d;d=c==S.EXPRESSION?new Ve:new We;d.parentEntity=b;d.id=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.ID)).next().firstChild().get_nodeValue();d.type=c;c=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.VALUE)).next().firstChild().get_nodeValue();if(";"==c.charAt(0))d.set_value(s.logic.scriptInterpreter.runExpr(s.logic.scriptInterpreter.hashExpr(A.substr(c,
1,null)),b,b.parentEntity,d));else switch(d.type[1]){case 4:d.set_value("true"==c||"True"==c||"t"==c||"T"==c);break;case 3:d.set_value(parseFloat(c));break;case 2:d.set_value(r.parseInt(c));break;case 5:d.set_value(c);break;case 1:"null"!=c?d.set_value(s.logic.scriptInterpreter.runExpr(s.logic.scriptInterpreter.hashExpr(c),b,b.parentEntity,d)):d.set_value(null);break;case 0:d.set_value(c)}return d},instantiateAction:function(a,b){var c=new Se;c.parentEntity=b;c.id=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.ID)).next().firstChild().get_nodeValue();
var d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.CONCURRENCY)).next().firstChild().get_nodeValue();c.concurrency=this._xmlConcurrencyNameToType.get(d);for(d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.SCRIPTS)).next().elements();d.hasNext();){var e=d.next();if(e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));e.nodeName==this._xmlNodeTypeToNodeName.get(k.SCRIPT)?c.scriptSet.push(s.logic.scriptInterpreter.hash(function(){if(e.nodeType!=q.Document&&
e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+e.nodeType));return e.children[0]}(this).get_nodeValue())):c.scriptSet.push(s.logic.gmlInterpreter.hash(function(){if(e.nodeType!=q.Document&&e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+e.nodeType));return e.children[0]}(this).get_nodeValue()))}if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.STATES)).hasNext())for(d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.STATES)).next().elements();d.hasNext();){var f=
d.next();c.addState(this.instantiateState(f,b))}return c},instantiateTrigger:function(a,b){var c=new Xe;c.parentEntity=b;var d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.EVENT)).next().firstChild().get_nodeValue();c.eventType=K.eventTypesMapReverse.get(d);if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.PARAMETER)).hasNext()){d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.PARAMETER)).next();if(d.nodeType!=q.Document&&d.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+
d.nodeType));c.parameter=d.children[0].get_nodeValue()}if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TARGET)).hasNext()){d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TARGET)).next();if(d.nodeType!=q.Document&&d.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+d.nodeType));c.target=d.children[0].get_nodeValue()}else c.target="TargetMe";if(a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TARGET_TYPE)).hasNext()){d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.TARGET_TYPE)).next();
if(d.nodeType!=q.Document&&d.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+d.nodeType));c.targetType=d.children[0].get_nodeValue()}for(d=a.elementsNamed(this._xmlNodeTypeToNodeName.get(k.SCRIPTS)).next().elements();d.hasNext();){var e=d.next();if(e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));e.nodeName==this._xmlNodeTypeToNodeName.get(k.SCRIPT)?c.scriptSet.push(s.logic.scriptInterpreter.hash(function(){if(e.nodeType!=
q.Document&&e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+e.nodeType));return e.children[0]}(this).get_nodeValue())):c.scriptSet.push(s.logic.gmlInterpreter.hash(function(){if(e.nodeType!=q.Document&&e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+e.nodeType));return e.children[0]}(this).get_nodeValue()))}return c},__class__:Yh};var Sj=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameClassParser"]=
Sj;Sj.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameClassParser".split(",");Sj.prototype={__class__:Sj};var Zh=function(){t._engineLogger.info("Creating Game Class Parser",null);this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameClassParser"]=Zh;Zh.__name__="tools,spark,sliced,services,std,logic,gde,core,GameClassParser".split(",");Zh.__interfaces__=[Sj];Zh.prototype={_init:function(){this._initNodeNamesMap();this._initNodeTypesMap();this._initGameTypesMap();
this._initNodeToGameMap();this._initExtendableNodesMap();this._initMergableNodesMap();this._initTargetMergableNodesMap();this._initArrayNodesMap();this._initConcurrencyTypeToNameMap();this._initConcurrencyNameToTypeMap();this._initStateTypeToNameMap();this._initStateNameToTypeMap();this._gameClassValidator=new $h(this._xmlNodeTypeToNodeName,this._xmlConcurrencyTypeToName,this._xmlStateTypeToName);this._gameClassInstantiator=new Yh(this._xmlNodeTypeToNodeName,this._xmlConcurrencyNameToType,this._xmlStateNameToType)},
_initNodeNamesMap:function(){this._xmlNodeTypeToNodeName=new ea;this._xmlNodeTypeToNodeName.set(k.ACTION,"Action");"Action";this._xmlNodeTypeToNodeName.set(k.ACTIONS,"Actions");"Actions";this._xmlNodeTypeToNodeName.set(k.ENTITIES,"Entities");"Entities";this._xmlNodeTypeToNodeName.set(k.ENTITY,"Entity");"Entity";this._xmlNodeTypeToNodeName.set(k.FORM,"Form");"Form";this._xmlNodeTypeToNodeName.set(k.SCRIPTS,"Scripts");"Scripts";this._xmlNodeTypeToNodeName.set(k.SCRIPT,"Script");"Script";this._xmlNodeTypeToNodeName.set(k.GML,
"Gml");"Gml";this._xmlNodeTypeToNodeName.set(k.TRIGGERS,"Triggers");"Triggers";this._xmlNodeTypeToNodeName.set(k.TRIGGER,"Trigger");"Trigger";this._xmlNodeTypeToNodeName.set(k.EVENT,"Event");"Event";this._xmlNodeTypeToNodeName.set(k.PARAMETER,"Parameter");"Parameter";this._xmlNodeTypeToNodeName.set(k.TARGET,"Target");"Target";this._xmlNodeTypeToNodeName.set(k.TARGET_TYPE,"TargetType");"TargetType";this._xmlNodeTypeToNodeName.set(k.CONCURRENCY,"Concurrency");"Concurrency";this._xmlNodeTypeToNodeName.set(k.ID,
"Id");"Id";this._xmlNodeTypeToNodeName.set(k.SPACE,"Space");"Space";this._xmlNodeTypeToNodeName.set(k.STATE,"State");"State";this._xmlNodeTypeToNodeName.set(k.STATES,"States");"States";this._xmlNodeTypeToNodeName.set(k.TYPE,"Type");"Type";this._xmlNodeTypeToNodeName.set(k.VALUE,"Value");"Value";this._xmlNodeTypeToNodeName.set(k.EXTENDS,"Extends");"Extends"},_initNodeTypesMap:function(){this._xmlNodeNameToNodeType=new M;var a=this._xmlNodeTypeToNodeName.get(k.ACTION),b=k.ACTION;this._xmlNodeNameToNodeType.set(a,
b);b;a=this._xmlNodeTypeToNodeName.get(k.ACTIONS);b=k.ACTIONS;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.ENTITIES);b=k.ENTITIES;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.ENTITY);b=k.ENTITY;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.FORM);b=k.FORM;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.SCRIPTS);b=k.SCRIPTS;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.SCRIPT);
b=k.SCRIPT;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.GML);b=k.GML;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.TRIGGERS);b=k.TRIGGERS;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.TRIGGER);b=k.TRIGGER;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.EVENT);b=k.EVENT;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.PARAMETER);b=k.PARAMETER;this._xmlNodeNameToNodeType.set(a,
b);b;a=this._xmlNodeTypeToNodeName.get(k.TARGET);b=k.TARGET;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.TARGET_TYPE);b=k.TARGET_TYPE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.CONCURRENCY);b=k.CONCURRENCY;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.ID);b=k.ID;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.SPACE);b=k.SPACE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.STATE);
b=k.STATE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.STATES);b=k.STATES;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.TYPE);b=k.TYPE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.VALUE);b=k.VALUE;this._xmlNodeNameToNodeType.set(a,b);b;a=this._xmlNodeTypeToNodeName.get(k.EXTENDS);b=k.EXTENDS;this._xmlNodeNameToNodeType.set(a,b);b},_initGameTypesMap:function(){this._xmlGameTypeToNodeName=new ea;var a=this._xmlNodeTypeToNodeName.get(k.ENTITY);
this._xmlGameTypeToNodeName.set(X.ENTITY,a);a;a=this._xmlNodeTypeToNodeName.get(k.STATE);this._xmlGameTypeToNodeName.set(X.STATE,a);a;a=this._xmlNodeTypeToNodeName.get(k.SPACE);this._xmlGameTypeToNodeName.set(X.SPACE,a);a;a=this._xmlNodeTypeToNodeName.get(k.FORM);this._xmlGameTypeToNodeName.set(X.FORM,a);a;a=this._xmlNodeTypeToNodeName.get(k.ACTION);this._xmlGameTypeToNodeName.set(X.ACTION,a);a;a=this._xmlNodeTypeToNodeName.get(k.TRIGGER);this._xmlGameTypeToNodeName.set(X.TRIGGER,a);a},_initNodeToGameMap:function(){this._xmlNodeTypeToGameType=
new ea;var a=X.ENTITY;this._xmlNodeTypeToGameType.set(k.ENTITY,a);a;a=X.STATE;this._xmlNodeTypeToGameType.set(k.STATE,a);a;a=X.SPACE;this._xmlNodeTypeToGameType.set(k.SPACE,a);a;a=X.FORM;this._xmlNodeTypeToGameType.set(k.FORM,a);a;a=X.ACTION;this._xmlNodeTypeToGameType.set(k.ACTION,a);a;a=X.TRIGGER;this._xmlNodeTypeToGameType.set(k.TRIGGER,a);a},_initExtendableNodesMap:function(){this._isNodeExtendable=new ea;this._isNodeExtendable.set(k.ACTION,!0);!0;this._isNodeExtendable.set(k.ACTIONS,!1);!1;this._isNodeExtendable.set(k.ENTITIES,
!1);!1;this._isNodeExtendable.set(k.ENTITY,!0);!0;this._isNodeExtendable.set(k.FORM,!0);!0;this._isNodeExtendable.set(k.SCRIPTS,!1);!1;this._isNodeExtendable.set(k.SCRIPT,!1);!1;this._isNodeExtendable.set(k.GML,!1);!1;this._isNodeExtendable.set(k.TRIGGERS,!1);!1;this._isNodeExtendable.set(k.TRIGGER,!0);!0;this._isNodeExtendable.set(k.EVENT,!1);!1;this._isNodeExtendable.set(k.PARAMETER,!1);!1;this._isNodeExtendable.set(k.TARGET,!1);!1;this._isNodeExtendable.set(k.TARGET_TYPE,!1);!1;this._isNodeExtendable.set(k.CONCURRENCY,
!1);!1;this._isNodeExtendable.set(k.ID,!1);!1;this._isNodeExtendable.set(k.SPACE,!0);!0;this._isNodeExtendable.set(k.STATE,!0);!0;this._isNodeExtendable.set(k.STATES,!1);!1;this._isNodeExtendable.set(k.TYPE,!1);!1;this._isNodeExtendable.set(k.VALUE,!1);!1;this._isNodeExtendable.set(k.EXTENDS,!1);!1},_initMergableNodesMap:function(){this._isNodeMergable=new ea;this._isNodeMergable.set(k.ACTION,!1);!1;this._isNodeMergable.set(k.ACTIONS,!0);!0;this._isNodeMergable.set(k.ENTITIES,!0);!0;this._isNodeMergable.set(k.ENTITY,
!1);!1;this._isNodeMergable.set(k.FORM,!0);!0;this._isNodeMergable.set(k.SCRIPTS,!0);!0;this._isNodeMergable.set(k.SCRIPT,!1);!1;this._isNodeMergable.set(k.GML,!1);!1;this._isNodeMergable.set(k.TRIGGERS,!0);!0;this._isNodeMergable.set(k.TRIGGER,!1);!1;this._isNodeMergable.set(k.EVENT,!1);!1;this._isNodeMergable.set(k.PARAMETER,!1);!1;this._isNodeMergable.set(k.TARGET,!1);!1;this._isNodeMergable.set(k.TARGET_TYPE,!1);!1;this._isNodeMergable.set(k.CONCURRENCY,!1);!1;this._isNodeMergable.set(k.ID,!1);
!1;this._isNodeMergable.set(k.SPACE,!0);!0;this._isNodeMergable.set(k.STATE,!1);!1;this._isNodeMergable.set(k.STATES,!0);!0;this._isNodeMergable.set(k.TYPE,!1);!1;this._isNodeMergable.set(k.VALUE,!1);!1;this._isNodeMergable.set(k.EXTENDS,!1);!1},_initTargetMergableNodesMap:function(){this._isNodeTargetMergable=new ea;this._isNodeTargetMergable.set(k.ACTION,!0);!0;this._isNodeTargetMergable.set(k.ACTIONS,!1);!1;this._isNodeTargetMergable.set(k.ENTITIES,!1);!1;this._isNodeTargetMergable.set(k.ENTITY,
!1);!1;this._isNodeTargetMergable.set(k.FORM,!1);!1;this._isNodeTargetMergable.set(k.SCRIPTS,!1);!1;this._isNodeTargetMergable.set(k.SCRIPT,!1);!1;this._isNodeTargetMergable.set(k.GML,!1);!1;this._isNodeTargetMergable.set(k.TRIGGERS,!1);!1;this._isNodeTargetMergable.set(k.TRIGGER,!1);!1;this._isNodeTargetMergable.set(k.EVENT,!1);!1;this._isNodeTargetMergable.set(k.PARAMETER,!1);!1;this._isNodeTargetMergable.set(k.TARGET,!1);!1;this._isNodeTargetMergable.set(k.TARGET_TYPE,!1);!1;this._isNodeTargetMergable.set(k.CONCURRENCY,
!1);!1;this._isNodeTargetMergable.set(k.ID,!1);!1;this._isNodeTargetMergable.set(k.SPACE,!1);!1;this._isNodeTargetMergable.set(k.STATE,!0);!0;this._isNodeTargetMergable.set(k.STATES,!1);!1;this._isNodeTargetMergable.set(k.TYPE,!1);!1;this._isNodeTargetMergable.set(k.VALUE,!1);!1;this._isNodeTargetMergable.set(k.EXTENDS,!1);!1},_initArrayNodesMap:function(){this._isNodeArray=new ea;this._isNodeArray.set(k.ACTION,!1);!1;this._isNodeArray.set(k.ACTIONS,!0);!0;this._isNodeArray.set(k.ENTITIES,!0);!0;
this._isNodeArray.set(k.ENTITY,!1);!1;this._isNodeArray.set(k.FORM,!1);!1;this._isNodeArray.set(k.SCRIPTS,!0);!0;this._isNodeArray.set(k.SCRIPT,!1);!1;this._isNodeArray.set(k.GML,!1);!1;this._isNodeArray.set(k.TRIGGERS,!0);!0;this._isNodeArray.set(k.TRIGGER,!1);!1;this._isNodeArray.set(k.EVENT,!1);!1;this._isNodeArray.set(k.PARAMETER,!1);!1;this._isNodeArray.set(k.TARGET,!1);!1;this._isNodeArray.set(k.TARGET_TYPE,!1);!1;this._isNodeArray.set(k.CONCURRENCY,!1);!1;this._isNodeArray.set(k.ID,!1);!1;
this._isNodeArray.set(k.SPACE,!1);!1;this._isNodeArray.set(k.STATE,!1);!1;this._isNodeArray.set(k.STATES,!0);!0;this._isNodeArray.set(k.TYPE,!1);!1;this._isNodeArray.set(k.VALUE,!1);!1;this._isNodeArray.set(k.EXTENDS,!0);!0},_initConcurrencyTypeToNameMap:function(){this._xmlConcurrencyTypeToName=new ea;this._xmlConcurrencyTypeToName.set(xa.PARALLEL,"Parallel");"Parallel";this._xmlConcurrencyTypeToName.set(xa.PERSISTENT,"Persistent");"Persistent";this._xmlConcurrencyTypeToName.set(xa.TRANSIENT,"Transient");
"Transient"},_initConcurrencyNameToTypeMap:function(){this._xmlConcurrencyNameToType=new M;var a=this._xmlConcurrencyTypeToName.get(xa.PARALLEL),b=xa.PARALLEL;this._xmlConcurrencyNameToType.set(a,b);b;a=this._xmlConcurrencyTypeToName.get(xa.PERSISTENT);b=xa.PERSISTENT;this._xmlConcurrencyNameToType.set(a,b);b;a=this._xmlConcurrencyTypeToName.get(xa.TRANSIENT);b=xa.TRANSIENT;this._xmlConcurrencyNameToType.set(a,b);b},_initStateTypeToNameMap:function(){this._xmlStateTypeToName=new ea;this._xmlStateTypeToName.set(S.EXPRESSION,
"Expression");"Expression";this._xmlStateTypeToName.set(S.DYNAMIC,"Dynamic");"Dynamic";this._xmlStateTypeToName.set(S.BOOLEAN,"Boolean");"Boolean";this._xmlStateTypeToName.set(S.DECIMAL,"Decimal");"Decimal";this._xmlStateTypeToName.set(S.INTEGER,"Integer");"Integer";this._xmlStateTypeToName.set(S.TEXT,"Text");"Text"},_initStateNameToTypeMap:function(){this._xmlStateNameToType=new M;var a=this._xmlStateTypeToName.get(S.EXPRESSION),b=S.EXPRESSION;this._xmlStateNameToType.set(a,b);b;a=this._xmlStateTypeToName.get(S.DYNAMIC);
b=S.DYNAMIC;this._xmlStateNameToType.set(a,b);b;a=this._xmlStateTypeToName.get(S.BOOLEAN);b=S.BOOLEAN;this._xmlStateNameToType.set(a,b);b;a=this._xmlStateTypeToName.get(S.DECIMAL);b=S.DECIMAL;this._xmlStateNameToType.set(a,b);b;a=this._xmlStateTypeToName.get(S.INTEGER);b=S.INTEGER;this._xmlStateNameToType.set(a,b);b;a=this._xmlStateTypeToName.get(S.TEXT);b=S.TEXT;this._xmlStateNameToType.set(a,b);b},parseGameNode:function(a){if(this._extendGameNode(a)){this._mergeGameNode(a);if(this._validateGameNode(a))return!0;
t._engineLogger.error("Game Entity could not be validated",null);return!1}t._engineLogger.error("Game Entity Class is not valid!",null);return!1},instantiateEntity:function(a){return this._gameClassInstantiator.instantiateEntity(a)},_extendGameNode:function(a){var b;if(a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+a.nodeType));if("_"==A.substr(a.nodeName,0,1)){if(a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+a.nodeType));
b=this._xmlNodeNameToNodeType.get(A.substr(a.nodeName,1,null))}else{if(a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+a.nodeType));b=this._xmlNodeNameToNodeType.get(a.nodeName)}if(null==b)return t.error("Unexpected Element: <"+function(){if(a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+a.nodeType));return a.nodeName}(this)+">",null),!1;for(var c=a.elements();c.hasNext();){var d=c.next();if(!1==this._extendGameNode(d))return t.error("Failed to parse node "+
function(){if(d.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+d.nodeType));return d.nodeName}(this),null),!1}if(this._handleExtendsElement(a,b)){if(this._handleExtendsAttribute(a,b))return!0;t._engineLogger.error("Failed to extend "+r.string(b)+' node from the "extends" parameter.',null);return!1}t._engineLogger.error("Failed to extend "+r.string(b)+' node from the "Extends" tag.',null);return!1},_handleExtendsElement:function(a,b){var c=a.elementsNamed("Extends").hasNext();
if(this._isNodeExtendable.get(b)&&c){for(var c=a.elementsNamed("Extends").next(),d=[],e=c.elements();e.hasNext();){var f=e.next();d.splice(0,0,f)}for(e=0;e<d.length;){var i=d[e];++e;f=this._xmlNodeTypeToNodeName.get(b);if(i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+i.nodeType));if(f==i.nodeName)this._moveChildren(a,i);else return t.error("Expected Node <"+this._xmlNodeTypeToNodeName.get(b)+">. Got <"+function(){if(i.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+
i.nodeType));return i.nodeName}(this)+">.",null),!1}a.removeChild(c);return!0}return c?(t._engineLogger.warn("Element "+r.string(b)+" cannot be extended!",null),!1):!0},_handleExtendsAttribute:function(a,b){if(this._isNodeExtendable.get(b)&&a.exists("extends")){var c=this.getGameNode(this._xmlNodeTypeToGameType.get(b),a.get("extends"),null);a.remove("extends");if(null!=c){if(this._extendGameNode(c))return this._moveChildren(a,c),!0;t._engineLogger.error(""+r.string(b)+" Class is not valid!",null);
return!1}t._engineLogger.error(""+r.string(b)+" Class is not well-formed or not found!",null);return!1}return a.exists("extends")?(t._engineLogger.error("Element "+r.string(b)+" cannot be extended!",null),!1):!0},_moveChildren:function(a,b){for(var c=[],d=b.elements();d.hasNext();){var e=d.next();c.push(e)}for(d=0;d<c.length;){var f=c[d];++d;if(!1==a.elementsNamed(function(){if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+f.nodeType));return f.nodeName}(this)).hasNext())a.addChild(f);
else{if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+f.nodeType));"_"==A.substr(f.nodeName,0,1)&&a.insertChild(f,0)}}},_validateGameNode:function(a){var b;if(a.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+a.nodeType));b=this._xmlNodeNameToNodeType.get(a.nodeName);if(this._gameClassValidator.validateGameNode(a,b)){for(a=a.elements();a.hasNext();){var c=a.next();if(!1==this._validateGameNode(c))return t.error("Failed to validate node "+
function(){if(c.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+c.nodeType));return c.nodeName}(this),null),!1}return!0}t._engineLogger.error("Failed to validate "+r.string(b)+" node",null);return!1},_mergeGameNode:function(a){this._mergeSingleGameNode(a);for(a=a.elements();a.hasNext();)this._mergeGameNode(a.next())},_mergeSingleGameNode:function(a){for(var b=[],c=a.elements();c.hasNext();){var d=c.next();b.push(d)}for(c=0;c<b.length;){var e=b[c];++c;if(e.nodeType!=
q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));if("_"==A.substr(e.nodeName,0,1)){var f;if(e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));f=A.substr(e.nodeName,1,null);if(function(a){var b=a._xmlNodeNameToNodeType.get(f);return a._isNodeMergable.get(b)}(this))a.elementsNamed(f).hasNext()?(d=a.elementsNamed(f).next(),this._mergeChildren(e,d),a.removeChild(e)):e.set_nodeName(function(){if(e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+
e.nodeType));return A.substr(e.nodeName,1,null)}(this));else if(function(a){var b=a._xmlNodeNameToNodeType.get(f);return a._isNodeTargetMergable.get(b)}(this))if(e.exists("id")){for(var d=null,i=!1,g=a.elementsNamed(f);g.hasNext();){var o=g.next();if(o.elementsNamed("Id").hasNext()){var h=o.elementsNamed("Id").next();if(h.nodeType!=q.Document&&h.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element or Document but found "+h.nodeType));if(h.children[0].get_nodeValue()==e.get("id")){d=
o;i=!0;break}}}i?(this._mergeChildren(e,d),a.removeChild(e)):(e.set_nodeName(function(){if(e.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+e.nodeType));return A.substr(e.nodeName,1,null)}(this)),e.remove("id"))}else t._engineLogger.warn("Target-Mergable Element "+f+" does not have a targetMerge attribute",null);else t._engineLogger.warn("Non-mergable element "+f+" has a merge identifier",null)}}},_mergeChildren:function(a,b){for(var c=[],d=a.elements();d.hasNext();){var e=
d.next();c.push(e)}if(function(a){var c;if(b.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+b.nodeType));c=a._xmlNodeNameToNodeType.get(b.nodeName);return a._isNodeArray.get(c)}(this))for(d=0;d<c.length;)e=c[d],++d,b.addChild(e);else for(d=0;d<c.length;){var f=c[d];++d;if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+f.nodeType));"_"!=A.substr(f.nodeName,0,1)&&b.elementsNamed(function(){if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+
f.nodeType));return f.nodeName}(this)).hasNext()&&b.removeChild(b.elementsNamed(function(){if(f.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+f.nodeType));return f.nodeName}(this)).next());b.addChild(f)}},getGameNode:function(a,b,c){var d;null!=b&&null!=c?(t._engineLogger.warn("Both a game class name and a game class node have been specified to create a game class. Using game class node...",null),d=c):null!=b?(d=function(){var a;try{a=q.parse(C.getScript(b).toString())}catch(c){c instanceof
p&&(c=c.val),t._engineLogger.error(r.string(c),null),t._engineLogger.error("Spark Parser Error: Entity ["+b+"] has not been loaded!",null),a=null}return a}(this),null!=d&&(d=d.firstElement())):d=null!=c?c:q.createElement(this._xmlGameTypeToNodeName.get(a));if(null!=d){if(d.nodeType!=q.Element)throw new p(new p("Bad node type, expected Element but found "+d.nodeType));return d.nodeName!=this._xmlGameTypeToNodeName.get(a)?(t.error("Expected "+this._xmlGameTypeToNodeName.get(a)+", got "+function(){if(d.nodeType!=
q.Element)throw new p(new p("Bad node type, expected Element but found "+d.nodeType));return d.nodeName}(this),null),null):d}t._engineLogger.error("Class "+r.string(a)+" ["+b+"] is not well-formed or not found!",null);return null},__class__:Zh};var Tj=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameClassValidator"]=Tj;Tj.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameClassValidator".split(",");Tj.prototype={__class__:Tj};var $h=function(a,b,c){t._engineLogger.info("Creating Game Class Validator",
null);this._xmlNodeTypeToNodeName=a;this._xmlConcurrencyTypeToName=b;this._xmlStateTypeToName=c;this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameClassValidator"]=$h;$h.__name__="tools,spark,sliced,services,std,logic,gde,core,GameClassValidator".split(",");$h.__interfaces__=[Tj];$h.prototype={_init:function(){this._initNodeRulesMap()},_initNodeRulesMap:function(){this._xmlNodeTypeToNodeRule=new ea;var a=this._createActionNodeRule();this._xmlNodeTypeToNodeRule.set(k.ACTION,a);a;a=
this._createActionsNodeRule();this._xmlNodeTypeToNodeRule.set(k.ACTIONS,a);a;a=this._createEntitiesNodeRule();this._xmlNodeTypeToNodeRule.set(k.ENTITIES,a);a;a=this._createEntityNodeRule();this._xmlNodeTypeToNodeRule.set(k.ENTITY,a);a;a=this._createFormNodeRule();this._xmlNodeTypeToNodeRule.set(k.FORM,a);a;a=this._createScriptsNodeRule();this._xmlNodeTypeToNodeRule.set(k.SCRIPTS,a);a;a=this._createScriptNodeRule();this._xmlNodeTypeToNodeRule.set(k.SCRIPT,a);a;a=this._createGmlNodeRule();this._xmlNodeTypeToNodeRule.set(k.GML,
a);a;a=this._createTriggersNodeRule();this._xmlNodeTypeToNodeRule.set(k.TRIGGERS,a);a;a=this._createTriggerNodeRule();this._xmlNodeTypeToNodeRule.set(k.TRIGGER,a);a;a=this._createEventNodeRule();this._xmlNodeTypeToNodeRule.set(k.EVENT,a);a;a=this._createParameterNodeRule();this._xmlNodeTypeToNodeRule.set(k.PARAMETER,a);a;a=this._createTargetNodeRule();this._xmlNodeTypeToNodeRule.set(k.TARGET,a);a;a=this._createTargetTypeNodeRule();this._xmlNodeTypeToNodeRule.set(k.TARGET_TYPE,a);a;a=this._createConcurrencyNodeRule();
this._xmlNodeTypeToNodeRule.set(k.CONCURRENCY,a);a;a=this._createIdNodeRule();this._xmlNodeTypeToNodeRule.set(k.ID,a);a;a=this._createSpaceNodeRule();this._xmlNodeTypeToNodeRule.set(k.SPACE,a);a;a=this._createStateNodeRule();this._xmlNodeTypeToNodeRule.set(k.STATE,a);a;a=this._createStatesNodeRule();this._xmlNodeTypeToNodeRule.set(k.STATES,a);a;a=this._createTypeNodeRule();this._xmlNodeTypeToNodeRule.set(k.TYPE,a);a;a=this._createValueNodeRule();this._xmlNodeTypeToNodeRule.set(k.VALUE,a);a},validateGameNode:function(a,
b){if(null==this._xmlNodeTypeToNodeRule.get(b))return t._engineLogger.error("This rule has not been created Yet!",null),!1;try{return N.checkNode(a,this._xmlNodeTypeToNodeRule.get(b)),!0}catch(c){c instanceof p&&(c=c.val);if(w.__instanceof(c,String))return t._engineLogger.error(c,null),t.error(ld.print(a),null),!1;throw c;}},_createEntityNodeRule:function(){var a=z.RList([z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.ACTIONS))),z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.STATES))),
z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.TRIGGERS))),z.RNode(this._xmlNodeTypeToNodeName.get(k.FORM))],!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.ENTITY),[],a)},_createFormNodeRule:function(){var a=z.RList([z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.STATES))),z.RNode(this._xmlNodeTypeToNodeName.get(k.SPACE))],!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.FORM),[],a)},_createStateNodeRule:function(){var a=z.RList([z.RNode(this._xmlNodeTypeToNodeName.get(k.ID)),
z.RNode(this._xmlNodeTypeToNodeName.get(k.TYPE)),z.RNode(this._xmlNodeTypeToNodeName.get(k.VALUE))],!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.STATE),[kh.Att("objectSpecific",null,"false"),kh.Att("visibleOnEditor",null,"true"),kh.Att("live",null,"false")],a)},_createActionNodeRule:function(){var a=z.RList([z.RNode(this._xmlNodeTypeToNodeName.get(k.ID)),z.RNode(this._xmlNodeTypeToNodeName.get(k.CONCURRENCY)),z.RNode(this._xmlNodeTypeToNodeName.get(k.SCRIPTS)),z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.STATES)))],
!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.ACTION),[],a)},_createSpaceNodeRule:function(){var a=z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.ENTITIES)));return z.RNode(this._xmlNodeTypeToNodeName.get(k.SPACE),[],a)},_createEntitiesNodeRule:function(){var a=z.RMulti(z.RNode(this._xmlNodeTypeToNodeName.get(k.ENTITY)),!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.ENTITIES),[],a)},_createStatesNodeRule:function(){var a=z.RMulti(z.RNode(this._xmlNodeTypeToNodeName.get(k.STATE)),
!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.STATES),[],a)},_createActionsNodeRule:function(){var a=z.RMulti(z.RNode(this._xmlNodeTypeToNodeName.get(k.ACTION)),!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.ACTIONS),[],a)},_createIdNodeRule:function(){var a=z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.ID),[],a)},_createScriptsNodeRule:function(){var a=z.RMulti(z.RChoice([z.RNode(this._xmlNodeTypeToNodeName.get(k.SCRIPT)),z.RNode(this._xmlNodeTypeToNodeName.get(k.GML))]),
!0);return z.RNode(this._xmlNodeTypeToNodeName.get(k.SCRIPTS),[],a)},_createScriptNodeRule:function(){var a=z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.SCRIPT),[],a)},_createGmlNodeRule:function(){var a=z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.GML),[],a)},_createTriggersNodeRule:function(){var a=z.RMulti(z.RNode(this._xmlNodeTypeToNodeName.get(k.TRIGGER)),!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.TRIGGERS),[],a)},_createTriggerNodeRule:function(){var a=
z.RList([z.RNode(this._xmlNodeTypeToNodeName.get(k.EVENT)),z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.PARAMETER))),z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.TARGET))),z.ROptional(z.RNode(this._xmlNodeTypeToNodeName.get(k.TARGET_TYPE))),z.RNode(this._xmlNodeTypeToNodeName.get(k.SCRIPTS))],!1);return z.RNode(this._xmlNodeTypeToNodeName.get(k.TRIGGER),[],a)},_createParameterNodeRule:function(){var a=z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.PARAMETER),[],a)},_createTargetNodeRule:function(){var a=
z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.TARGET),[],a)},_createTargetTypeNodeRule:function(){var a=z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.TARGET_TYPE),[],a)},_createConcurrencyNodeRule:function(){var a=z.RData($a.FEnum([this._xmlConcurrencyTypeToName.get(xa.PARALLEL),this._xmlConcurrencyTypeToName.get(xa.PERSISTENT),this._xmlConcurrencyTypeToName.get(xa.TRANSIENT)]));return z.RNode(this._xmlNodeTypeToNodeName.get(k.CONCURRENCY),[],a)},_createTypeNodeRule:function(){var a=
z.RData($a.FEnum([this._xmlStateTypeToName.get(S.EXPRESSION),this._xmlStateTypeToName.get(S.DYNAMIC),this._xmlStateTypeToName.get(S.INTEGER),this._xmlStateTypeToName.get(S.DECIMAL),this._xmlStateTypeToName.get(S.BOOLEAN),this._xmlStateTypeToName.get(S.TEXT)]));return z.RNode(this._xmlNodeTypeToNodeName.get(k.TYPE),[],a)},_createValueNodeRule:function(){var a=z.RData();return z.RNode(this._xmlNodeTypeToNodeName.get(k.VALUE),[],a)},_createEventNodeRule:function(){var a=z.RData($a.FEnum(K.eventTypesStringArray));
return z.RNode(this._xmlNodeTypeToNodeName.get(k.EVENT),[],a)},__class__:$h};var ai=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameEntity"]=ai;ai.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameEntity".split(",");ai.__interfaces__=[Nd];ai.prototype={__class__:ai,__properties__:{get_children:"get_children"}};var $d=function(){this.uid=s.logic.gameFactory.issueUID();this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameEntity"]=$d;$d.__name__=
"tools,spark,sliced,services,std,logic,gde,core,GameEntity".split(",");$d.__interfaces__=[ai];$d.__super__=Ta;$d.prototype=x(Ta.prototype,{_init:function(){this.gameStateSet=new M;this.triggerSet=[];this.possibleActionSet=new M;this.currentActionSet=new M},clone:function(a){var b=new $d;b.parentEntity=a;b.gameForm=this.gameForm.clone(b);for(a=this.gameStateSet.iterator();a.hasNext();){var c=a.next();b.addState(c.clone(b))}for(a=this.possibleActionSet.iterator();a.hasNext();)c=a.next(),b.addAction(c.clone(b));
a=0;for(c=this.triggerSet;a<c.length;){var d=c[a];++a;b.addTrigger(d.clone(b))}s.logic.registerEntityByName(b);s.event.raiseEvent(m.CREATED,b);return b},doActions:function(){for(var a=this.currentActionSet.iterator();a.hasNext();)for(var b=a.next(),c=0;c<b.length;){var d=b[c];++c;d.doPass()}a=0;for(b=this.gameForm.gameSpace.gameEntitySet;a<b.length;)c=b[a],++a,c.doActions()},addState:function(a){null!=this.gameStateSet.get(a.id)&&t._engineLogger.warn("A State with id "+a.id+" already exists in this Entity.",
null);this.gameStateSet.set(a.id,a);a},addAction:function(a){if(null!=this.possibleActionSet.get(a.id))t._engineLogger.warn("An Action with id "+a.id+" already exists in this Entity.",null);else{var b=[];this.currentActionSet.set(a.id,b);b}this.possibleActionSet.set(a.id,a);a},addTrigger:function(a){this.triggerSet.push(a);s.event.addTrigger(a)},getAction:function(a){return this.possibleActionSet.get(a)},a:function(a){return this.possibleActionSet.get(a)},forceAction:function(a,b){var c=this.possibleActionSet.get(a);
if(null!=c){if(null!=b)for(var d=0,e=da.fields(b);d<e.length;){var f=e[d];++d;c.setState(f,da.field(b,f))}c.doPass()}else t._engineLogger.warn("Action with id '"+a+"' could not be forced. (not found)",null)},fa:function(a,b){this.forceAction(a,b)},startAction:function(a,b){var c=this.possibleActionSet.get(a);if(null!=c){if(null!=b)for(var d=0,e=da.fields(b);d<e.length;){var f=e[d];++d;c.setState(f,da.field(b,f))}switch(c.concurrency[1]){case 0:this.currentActionSet.get(c.id).push(c);break;case 1:0==
this.currentActionSet.get(c.id).length&&this.currentActionSet.get(c.id).push(c);break;case 2:for(;0<this.currentActionSet.get(c.id).length;)this.currentActionSet.get(c.id).pop();this.currentActionSet.get(c.id).push(c)}return!0}t._engineLogger.warn("Action with id '"+a+"' could not be started.",null);return!1},sa:function(a,b){return this.startAction(a,b)},stopAction:function(a){if(this.currentActionSet.exists(a)){for(;0<this.currentActionSet.get(a).length;)this.currentActionSet.get(a).pop();return!0}t._engineLogger.warn("Action with id '"+
a+"' could not be stopped.",null);return!1},ta:function(a){return this.stopAction(a)},getState:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},s:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},get:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},getStateType:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).type[0]},setState:function(a,
b){try{return this.gameStateSet.get(a).set_value(b),s.display.updateDisplayObjectState(this,a),this.gameStateSet.get(a).get_value()}catch(c){return c instanceof p&&(c=c.val),t.error("Could not Set State "+a+" to: "+r.string(b)+", for entity: "+r.string(this.getState("name")),null),null}},set:function(a,b){try{return this.gameStateSet.get(a).set_value(b),s.display.updateDisplayObjectState(this,a),this.gameStateSet.get(a).get_value()}catch(c){return c instanceof p&&(c=c.val),t.error("Could not Set State "+
a+" to: "+r.string(b)+", for entity: "+r.string(this.getState("name")),null),null}},setStateSilent:function(a,b){try{return this.gameStateSet.get(a).set_value(b),this.gameStateSet.get(a).get_value()}catch(c){return c instanceof p&&(c=c.val),t.error("Could not Silently Set State "+a+" to: "+r.string(b)+", for entity: "+r.string(this.getState("name")),null),null}},addToState:function(a,b){var c=this.gameStateSet.get(a);c.set_value(c.get_value()+b);s.display.updateDisplayObjectState(this,a);return this.gameStateSet.get(a).get_value()},
subtractFromState:function(a,b){var c=this.gameStateSet.get(a);c.set_value(c.get_value()-b);s.display.updateDisplayObjectState(this,a);return this.gameStateSet.get(a).get_value()},addChild:function(a){this.get_children().push(a);a.parentEntity=this;s.display.addDisplayObjectChild(this,a)},setZorder:function(a){var b=this.parentEntity.get_children().indexOf(this),c=this.parentEntity.get_children();A.remove(c,this);t._engineLogger.error("MY INDEX IS: "+b,null);switch(a){case "top":this.parentEntity.get_children().push(this);
break;case "oneUp":this.parentEntity.get_children().splice(b+1,0,this);break;case "oneDown":a=this.parentEntity.get_children();b=r["int"](Math.max(0,b-1));a.splice(b,0,this);break;case "bottom":this.parentEntity.get_children().splice(0,0,this)}b=0;for(a=this.parentEntity.get_children();b<a.length;)c=a[b],++b,c.setState("command_zOrder",this.parentEntity.get_children().indexOf(c))},get_zIndex:function(){return this.parentEntity.get_children().indexOf(this)},insertChild:function(a,b){this.get_children().splice(b,
0,a);a.parentEntity=this;s.display.insertDisplayObjectChild(this,a,b)},removeChild:function(a){var b=this.get_children();A.remove(b,a);a.parentEntity=null;s.display.removeDisplayObjectChild(this,a)},remove:function(){this.get_parent().removeChild(this)},removeChildren:function(a){null==a&&(a=!1);for(var b=[],c=0,d=this.get_children();c<d.length;){var e=d[c];++c;b.push(e)}a&&b.shift();for(a=0;a<b.length;)c=b[a],++a,this.removeChild(c)},getChildren:function(){return this.get_children()},get_children:function(){return this.gameForm.gameSpace.gameEntitySet},
__class__:$d,__properties__:x(Ta.prototype.__properties__,{get_children:"get_children"})});var Uj=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameFactory"]=Uj;Uj.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameFactory".split(",");Uj.prototype={__class__:Uj};var Uh=function(){this.instancesCreated=0;t._engineLogger.info("Creating Game Factory",null);this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameFactory"]=Uh;Uh.__name__="tools,spark,sliced,services,std,logic,gde,core,GameFactory".split(",");
Uh.__interfaces__=[Uj];Uh.prototype={issueUID:function(){return this._numObjects++},_init:function(){this._gameClassParser=new Zh;this._cache=new M;this._numObjects=0},createGameEntityExtended:function(a,b){var c=this._gameClassParser.getGameNode(X.ENTITY,b);c.set("extends",a);return this.createGameEntity(null,c)},createGameEntityByXml:function(a){return this.createGameEntity(null,a)},createGameEntity:function(a,b,c){null==c&&(c=!1);this.instancesCreated+=1;if(null!=a&&this._cache.exists(a)&&null!=
this._cache.get(a))return this._cache.get(a).clone();b=this._gameClassParser.getGameNode(X.ENTITY,a,b);if(null!=b){if(this._gameClassParser.parseGameNode(b)){b=this._gameClassParser.instantiateEntity(b);if(null!=b)return null!=a&&(this._cache.exists(a)?null==this._cache.get(a)?(c=b.clone(),this._cache.set(a,c)):t._engineLogger.warn("Game Entity ["+a+"] exists and is not null. WE SHOULDN'T BE HERE! SOMETHING IS WRONG!!!!!!!!!!!!!!!!!!!",null):c||this._cache.set(a,null)),b;t._engineLogger.error("Game Entity could not be instantiated",
null);return null}t._engineLogger.error("Game Entity could not be parsed",null);t.warn(ld.print(b),null);return null}t._engineLogger.error("Game Entity Class ["+a+"] is not well-formed or not found!",null);return null},__class__:Uh};var bi=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameForm"]=bi;bi.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameForm".split(",");bi.__interfaces__=[Nd];bi.prototype={__class__:bi};var Te=function(){this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameForm"]=
Te;Te.__name__="tools,spark,sliced,services,std,logic,gde,core,GameForm".split(",");Te.__interfaces__=[bi];Te.__super__=Ta;Te.prototype=x(Ta.prototype,{_init:function(){this.gameStateSet=new M},clone:function(a){var b=new Te;b.parentEntity=a;for(var c=this.gameStateSet.iterator();c.hasNext();){var d=c.next();b.addState(d.clone(a))}b.gameSpace=this.gameSpace.clone(a);return b},addState:function(a){null!=this.gameStateSet.get(a.id)&&t._engineLogger.warn("A State with id "+a.id+" already exists in this Form.",
null);this.gameStateSet.set(a.id,a);a},getState:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},s:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},get:function(a){return null==this.gameStateSet.get(a)?null:this.gameStateSet.get(a).get_value()},setState:function(a,b){this.gameStateSet.get(a).set_value(b);return this.gameStateSet.get(a).get_value()},set:function(a,b){this.gameStateSet.get(a).set_value(b);return this.gameStateSet.get(a).get_value()},
__class__:Te});var ci=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameSpace"]=ci;ci.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameSpace".split(",");ci.__interfaces__=[Nd];ci.prototype={__class__:ci};var Ue=function(){this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameSpace"]=Ue;Ue.__name__="tools,spark,sliced,services,std,logic,gde,core,GameSpace".split(",");Ue.__interfaces__=[ci];Ue.__super__=Ta;Ue.prototype=x(Ta.prototype,{_init:function(){this.gameEntitySet=
[]},clone:function(a){var b=new Ue;b.parentEntity=a;for(var c=0,d=this.gameEntitySet;c<d.length;){var e=d[c];++c;b.gameEntitySet.push(e.clone(a))}return b},__class__:Ue});var Pf=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameState"]=Pf;Pf.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameState".split(",");Pf.__interfaces__=[Nd];Pf.prototype={__class__:Pf,__properties__:{set_value:"set_value",get_value:"get_value"}};var We=function(){};h["tools.spark.sliced.services.std.logic.gde.core.GameState"]=
We;We.__name__="tools,spark,sliced,services,std,logic,gde,core,GameState".split(",");We.__interfaces__=[Pf];We.__super__=Ta;We.prototype=x(Ta.prototype,{get_value:function(){return this._value},set_value:function(a){return this._value=a},_init:function(){},clone:function(a){var b=new We;b.parentEntity=a;b.id=this.id;b.type=this.type;b.set_value(this.get_value());return b},__class__:We,__properties__:x(Ta.prototype.__properties__,{set_value:"set_value",get_value:"get_value"})});var Ve=function(){};
h["tools.spark.sliced.services.std.logic.gde.core.GameStateExpr"]=Ve;Ve.__name__="tools,spark,sliced,services,std,logic,gde,core,GameStateExpr".split(",");Ve.__interfaces__=[Pf];Ve.__super__=Ta;Ve.prototype=x(Ta.prototype,{get_value:function(){return s.logic.scriptInterpreter.runExpr(this._value,this.parentEntity,this.parentEntity.parentEntity,this)},set_value:function(a){return this._value=s.logic.scriptInterpreter.hashExpr(a)},get_actualValue:function(){return this._value},set_actualValue:function(a){return this._value=
a},_init:function(){},clone:function(a){var b=new Ve;b.parentEntity=a;b.id=this.id;b.type=this.type;b.set_actualValue(this.get_actualValue());return b},__class__:Ve,__properties__:x(Ta.prototype.__properties__,{set_actualValue:"set_actualValue",get_actualValue:"get_actualValue",set_value:"set_value",get_value:"get_value"})});var di=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.IGameTrigger"]=di;di.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,IGameTrigger".split(",");
di.__interfaces__=[Nd];di.prototype={__class__:di};var Xe=function(){this._init()};h["tools.spark.sliced.services.std.logic.gde.core.GameTrigger"]=Xe;Xe.__name__="tools,spark,sliced,services,std,logic,gde,core,GameTrigger".split(",");Xe.__interfaces__=[di];Xe.__super__=Ta;Xe.prototype=x(Ta.prototype,{_init:function(){this.scriptSet=[]},clone:function(a){var b=new Xe;b.parentEntity=a;b.eventType=this.eventType;b.parameter=this.parameter;b.target=this.target;b.targetType=this.targetType;for(var a=0,
c=this.scriptSet;a<c.length;){var d=c[a];++a;b.scriptSet.push(d)}return b},doPass:function(){for(var a=0,b=this.scriptSet;a<b.length;){var c=b[a];++a;-1==c?s.logic.gmlInterpreter.run(c,function(a){var b=new M;null!=Oa.it?b.setReserved("it",a):b.h.it=a;b.set("me",a.parentEntity);b.set("parent",a.parentEntity.parentEntity);return b}(this)):!1==s.logic.scriptInterpreter.run(c,function(a){var b=new M;null!=Oa.it?b.setReserved("it",a):b.h.it=a;b.set("me",a.parentEntity);b.set("parent",a.parentEntity.parentEntity);
return b}(this))&&t._engineLogger.error("Error: Failed to run Trigger ["+r.string(this.eventType)+"].",null)}},__class__:Xe});var xa=h["tools.spark.sliced.services.std.logic.gde.interfaces.EConcurrencyType"]={__ename__:"tools,spark,sliced,services,std,logic,gde,interfaces,EConcurrencyType".split(","),__constructs__:["PARALLEL","PERSISTENT","TRANSIENT"]};xa.PARALLEL=["PARALLEL",0];xa.PARALLEL.toString=l;xa.PARALLEL.__enum__=xa;xa.PERSISTENT=["PERSISTENT",1];xa.PERSISTENT.toString=l;xa.PERSISTENT.__enum__=
xa;xa.TRANSIENT=["TRANSIENT",2];xa.TRANSIENT.toString=l;xa.TRANSIENT.__enum__=xa;xa.__empty_constructs__=[xa.PARALLEL,xa.PERSISTENT,xa.TRANSIENT];var m=h["tools.spark.sliced.services.std.logic.gde.interfaces.EEventType"]={__ename__:"tools,spark,sliced,services,std,logic,gde,interfaces,EEventType".split(","),__constructs__:"CREATED,UPDATE,CHANGED,NETWORK_CONNECTED,NETWORK_REQUEST,NETWORK_SERVER_EVENT,FILETRANSFER_CONNECTED,FILETRANSFER_SENDREQUEST,MOUSE_LEFT_CLICK,MOUSE_RIGHT_CLICK,MOUSE_LEFT_DOWN,MOUSE_RIGHT_DOWN,MOUSE_SCROLL,MOUSE_ENTERED,MOUSE_MOVED,MOUSE_LEFT,MOUSE_DOWN,MOUSE_UP,PHYSICS_COLLISION_START,PHYSICS_COLLISION_END,PHYSICS_SENSOR_START,PHYSICS_SENSOR_START_BIPED_FEET,PHYSICS_SENSOR_END,PHYSICS_SENSOR_END_BIPED_FEET,ON_DRAG_START,ON_DRAG,ON_DRAG_END,ON_DRAG_ENTER,ON_DRAG_OVER,ON_DRAG_LEAVE,ON_DROP,KEY_PRESSED_LOCAL,KEY_DOWN_LOCAL,KEY_RELEASED_LOCAL,KEY_PRESSED,KEY_DOWN,KEY_RELEASED,STATE_CHANGED,CUSTOM_TRIGGER,SCENE_CREATED,PROJECT_PAUSED,PROJECT_RESUMED,SOUND_COMPLETED,LAYOUT_INVALIDATED,STAGE_RESIZED".split(",")};
m.CREATED=["CREATED",0];m.CREATED.toString=l;m.CREATED.__enum__=m;m.UPDATE=["UPDATE",1];m.UPDATE.toString=l;m.UPDATE.__enum__=m;m.CHANGED=["CHANGED",2];m.CHANGED.toString=l;m.CHANGED.__enum__=m;m.NETWORK_CONNECTED=["NETWORK_CONNECTED",3];m.NETWORK_CONNECTED.toString=l;m.NETWORK_CONNECTED.__enum__=m;m.NETWORK_REQUEST=["NETWORK_REQUEST",4];m.NETWORK_REQUEST.toString=l;m.NETWORK_REQUEST.__enum__=m;m.NETWORK_SERVER_EVENT=["NETWORK_SERVER_EVENT",5];m.NETWORK_SERVER_EVENT.toString=l;m.NETWORK_SERVER_EVENT.__enum__=
m;m.FILETRANSFER_CONNECTED=["FILETRANSFER_CONNECTED",6];m.FILETRANSFER_CONNECTED.toString=l;m.FILETRANSFER_CONNECTED.__enum__=m;m.FILETRANSFER_SENDREQUEST=["FILETRANSFER_SENDREQUEST",7];m.FILETRANSFER_SENDREQUEST.toString=l;m.FILETRANSFER_SENDREQUEST.__enum__=m;m.MOUSE_LEFT_CLICK=["MOUSE_LEFT_CLICK",8];m.MOUSE_LEFT_CLICK.toString=l;m.MOUSE_LEFT_CLICK.__enum__=m;m.MOUSE_RIGHT_CLICK=["MOUSE_RIGHT_CLICK",9];m.MOUSE_RIGHT_CLICK.toString=l;m.MOUSE_RIGHT_CLICK.__enum__=m;m.MOUSE_LEFT_DOWN=["MOUSE_LEFT_DOWN",
10];m.MOUSE_LEFT_DOWN.toString=l;m.MOUSE_LEFT_DOWN.__enum__=m;m.MOUSE_RIGHT_DOWN=["MOUSE_RIGHT_DOWN",11];m.MOUSE_RIGHT_DOWN.toString=l;m.MOUSE_RIGHT_DOWN.__enum__=m;m.MOUSE_SCROLL=["MOUSE_SCROLL",12];m.MOUSE_SCROLL.toString=l;m.MOUSE_SCROLL.__enum__=m;m.MOUSE_ENTERED=["MOUSE_ENTERED",13];m.MOUSE_ENTERED.toString=l;m.MOUSE_ENTERED.__enum__=m;m.MOUSE_MOVED=["MOUSE_MOVED",14];m.MOUSE_MOVED.toString=l;m.MOUSE_MOVED.__enum__=m;m.MOUSE_LEFT=["MOUSE_LEFT",15];m.MOUSE_LEFT.toString=l;m.MOUSE_LEFT.__enum__=
m;m.MOUSE_DOWN=["MOUSE_DOWN",16];m.MOUSE_DOWN.toString=l;m.MOUSE_DOWN.__enum__=m;m.MOUSE_UP=["MOUSE_UP",17];m.MOUSE_UP.toString=l;m.MOUSE_UP.__enum__=m;m.PHYSICS_COLLISION_START=["PHYSICS_COLLISION_START",18];m.PHYSICS_COLLISION_START.toString=l;m.PHYSICS_COLLISION_START.__enum__=m;m.PHYSICS_COLLISION_END=["PHYSICS_COLLISION_END",19];m.PHYSICS_COLLISION_END.toString=l;m.PHYSICS_COLLISION_END.__enum__=m;m.PHYSICS_SENSOR_START=["PHYSICS_SENSOR_START",20];m.PHYSICS_SENSOR_START.toString=l;m.PHYSICS_SENSOR_START.__enum__=
m;m.PHYSICS_SENSOR_START_BIPED_FEET=["PHYSICS_SENSOR_START_BIPED_FEET",21];m.PHYSICS_SENSOR_START_BIPED_FEET.toString=l;m.PHYSICS_SENSOR_START_BIPED_FEET.__enum__=m;m.PHYSICS_SENSOR_END=["PHYSICS_SENSOR_END",22];m.PHYSICS_SENSOR_END.toString=l;m.PHYSICS_SENSOR_END.__enum__=m;m.PHYSICS_SENSOR_END_BIPED_FEET=["PHYSICS_SENSOR_END_BIPED_FEET",23];m.PHYSICS_SENSOR_END_BIPED_FEET.toString=l;m.PHYSICS_SENSOR_END_BIPED_FEET.__enum__=m;m.ON_DRAG_START=["ON_DRAG_START",24];m.ON_DRAG_START.toString=l;m.ON_DRAG_START.__enum__=
m;m.ON_DRAG=["ON_DRAG",25];m.ON_DRAG.toString=l;m.ON_DRAG.__enum__=m;m.ON_DRAG_END=["ON_DRAG_END",26];m.ON_DRAG_END.toString=l;m.ON_DRAG_END.__enum__=m;m.ON_DRAG_ENTER=["ON_DRAG_ENTER",27];m.ON_DRAG_ENTER.toString=l;m.ON_DRAG_ENTER.__enum__=m;m.ON_DRAG_OVER=["ON_DRAG_OVER",28];m.ON_DRAG_OVER.toString=l;m.ON_DRAG_OVER.__enum__=m;m.ON_DRAG_LEAVE=["ON_DRAG_LEAVE",29];m.ON_DRAG_LEAVE.toString=l;m.ON_DRAG_LEAVE.__enum__=m;m.ON_DROP=["ON_DROP",30];m.ON_DROP.toString=l;m.ON_DROP.__enum__=m;m.KEY_PRESSED_LOCAL=
["KEY_PRESSED_LOCAL",31];m.KEY_PRESSED_LOCAL.toString=l;m.KEY_PRESSED_LOCAL.__enum__=m;m.KEY_DOWN_LOCAL=["KEY_DOWN_LOCAL",32];m.KEY_DOWN_LOCAL.toString=l;m.KEY_DOWN_LOCAL.__enum__=m;m.KEY_RELEASED_LOCAL=["KEY_RELEASED_LOCAL",33];m.KEY_RELEASED_LOCAL.toString=l;m.KEY_RELEASED_LOCAL.__enum__=m;m.KEY_PRESSED=["KEY_PRESSED",34];m.KEY_PRESSED.toString=l;m.KEY_PRESSED.__enum__=m;m.KEY_DOWN=["KEY_DOWN",35];m.KEY_DOWN.toString=l;m.KEY_DOWN.__enum__=m;m.KEY_RELEASED=["KEY_RELEASED",36];m.KEY_RELEASED.toString=
l;m.KEY_RELEASED.__enum__=m;m.STATE_CHANGED=["STATE_CHANGED",37];m.STATE_CHANGED.toString=l;m.STATE_CHANGED.__enum__=m;m.CUSTOM_TRIGGER=["CUSTOM_TRIGGER",38];m.CUSTOM_TRIGGER.toString=l;m.CUSTOM_TRIGGER.__enum__=m;m.SCENE_CREATED=["SCENE_CREATED",39];m.SCENE_CREATED.toString=l;m.SCENE_CREATED.__enum__=m;m.PROJECT_PAUSED=["PROJECT_PAUSED",40];m.PROJECT_PAUSED.toString=l;m.PROJECT_PAUSED.__enum__=m;m.PROJECT_RESUMED=["PROJECT_RESUMED",41];m.PROJECT_RESUMED.toString=l;m.PROJECT_RESUMED.__enum__=m;m.SOUND_COMPLETED=
["SOUND_COMPLETED",42];m.SOUND_COMPLETED.toString=l;m.SOUND_COMPLETED.__enum__=m;m.LAYOUT_INVALIDATED=["LAYOUT_INVALIDATED",43];m.LAYOUT_INVALIDATED.toString=l;m.LAYOUT_INVALIDATED.__enum__=m;m.STAGE_RESIZED=["STAGE_RESIZED",44];m.STAGE_RESIZED.toString=l;m.STAGE_RESIZED.__enum__=m;m.__empty_constructs__=[m.CREATED,m.UPDATE,m.CHANGED,m.NETWORK_CONNECTED,m.NETWORK_REQUEST,m.NETWORK_SERVER_EVENT,m.FILETRANSFER_CONNECTED,m.FILETRANSFER_SENDREQUEST,m.MOUSE_LEFT_CLICK,m.MOUSE_RIGHT_CLICK,m.MOUSE_LEFT_DOWN,
m.MOUSE_RIGHT_DOWN,m.MOUSE_SCROLL,m.MOUSE_ENTERED,m.MOUSE_MOVED,m.MOUSE_LEFT,m.MOUSE_DOWN,m.MOUSE_UP,m.PHYSICS_COLLISION_START,m.PHYSICS_COLLISION_END,m.PHYSICS_SENSOR_START,m.PHYSICS_SENSOR_START_BIPED_FEET,m.PHYSICS_SENSOR_END,m.PHYSICS_SENSOR_END_BIPED_FEET,m.ON_DRAG_START,m.ON_DRAG,m.ON_DRAG_END,m.ON_DRAG_ENTER,m.ON_DRAG_OVER,m.ON_DRAG_LEAVE,m.ON_DROP,m.KEY_PRESSED_LOCAL,m.KEY_DOWN_LOCAL,m.KEY_RELEASED_LOCAL,m.KEY_PRESSED,m.KEY_DOWN,m.KEY_RELEASED,m.STATE_CHANGED,m.CUSTOM_TRIGGER,m.SCENE_CREATED,
m.PROJECT_PAUSED,m.PROJECT_RESUMED,m.SOUND_COMPLETED,m.LAYOUT_INVALIDATED,m.STAGE_RESIZED];var X=h["tools.spark.sliced.services.std.logic.gde.interfaces.EGameType"]={__ename__:"tools,spark,sliced,services,std,logic,gde,interfaces,EGameType".split(","),__constructs__:"ENTITY,FORM,STATE,SPACE,ACTION,TRIGGER".split(",")};X.ENTITY=["ENTITY",0];X.ENTITY.toString=l;X.ENTITY.__enum__=X;X.FORM=["FORM",1];X.FORM.toString=l;X.FORM.__enum__=X;X.STATE=["STATE",2];X.STATE.toString=l;X.STATE.__enum__=X;X.SPACE=
["SPACE",3];X.SPACE.toString=l;X.SPACE.__enum__=X;X.ACTION=["ACTION",4];X.ACTION.toString=l;X.ACTION.__enum__=X;X.TRIGGER=["TRIGGER",5];X.TRIGGER.toString=l;X.TRIGGER.__enum__=X;X.__empty_constructs__=[X.ENTITY,X.FORM,X.STATE,X.SPACE,X.ACTION,X.TRIGGER];var k=h["tools.spark.sliced.services.std.logic.gde.interfaces.ENodeType"]={__ename__:"tools,spark,sliced,services,std,logic,gde,interfaces,ENodeType".split(","),__constructs__:"ENTITIES,ENTITY,FORM,STATES,STATE,SPACE,ACTIONS,ACTION,SCRIPTS,SCRIPT,GML,TRIGGERS,TRIGGER,EVENT,PARAMETER,TARGET,TARGET_TYPE,CONCURRENCY,ID,TYPE,VALUE,EXTENDS".split(",")};
k.ENTITIES=["ENTITIES",0];k.ENTITIES.toString=l;k.ENTITIES.__enum__=k;k.ENTITY=["ENTITY",1];k.ENTITY.toString=l;k.ENTITY.__enum__=k;k.FORM=["FORM",2];k.FORM.toString=l;k.FORM.__enum__=k;k.STATES=["STATES",3];k.STATES.toString=l;k.STATES.__enum__=k;k.STATE=["STATE",4];k.STATE.toString=l;k.STATE.__enum__=k;k.SPACE=["SPACE",5];k.SPACE.toString=l;k.SPACE.__enum__=k;k.ACTIONS=["ACTIONS",6];k.ACTIONS.toString=l;k.ACTIONS.__enum__=k;k.ACTION=["ACTION",7];k.ACTION.toString=l;k.ACTION.__enum__=k;k.SCRIPTS=
["SCRIPTS",8];k.SCRIPTS.toString=l;k.SCRIPTS.__enum__=k;k.SCRIPT=["SCRIPT",9];k.SCRIPT.toString=l;k.SCRIPT.__enum__=k;k.GML=["GML",10];k.GML.toString=l;k.GML.__enum__=k;k.TRIGGERS=["TRIGGERS",11];k.TRIGGERS.toString=l;k.TRIGGERS.__enum__=k;k.TRIGGER=["TRIGGER",12];k.TRIGGER.toString=l;k.TRIGGER.__enum__=k;k.EVENT=["EVENT",13];k.EVENT.toString=l;k.EVENT.__enum__=k;k.PARAMETER=["PARAMETER",14];k.PARAMETER.toString=l;k.PARAMETER.__enum__=k;k.TARGET=["TARGET",15];k.TARGET.toString=l;k.TARGET.__enum__=
k;k.TARGET_TYPE=["TARGET_TYPE",16];k.TARGET_TYPE.toString=l;k.TARGET_TYPE.__enum__=k;k.CONCURRENCY=["CONCURRENCY",17];k.CONCURRENCY.toString=l;k.CONCURRENCY.__enum__=k;k.ID=["ID",18];k.ID.toString=l;k.ID.__enum__=k;k.TYPE=["TYPE",19];k.TYPE.toString=l;k.TYPE.__enum__=k;k.VALUE=["VALUE",20];k.VALUE.toString=l;k.VALUE.__enum__=k;k.EXTENDS=["EXTENDS",21];k.EXTENDS.toString=l;k.EXTENDS.__enum__=k;k.__empty_constructs__=[k.ENTITIES,k.ENTITY,k.FORM,k.STATES,k.STATE,k.SPACE,k.ACTIONS,k.ACTION,k.SCRIPTS,
k.SCRIPT,k.GML,k.TRIGGERS,k.TRIGGER,k.EVENT,k.PARAMETER,k.TARGET,k.TARGET_TYPE,k.CONCURRENCY,k.ID,k.TYPE,k.VALUE,k.EXTENDS];var S=h["tools.spark.sliced.services.std.logic.gde.interfaces.EStateType"]={__ename__:"tools,spark,sliced,services,std,logic,gde,interfaces,EStateType".split(","),__constructs__:"EXPRESSION,DYNAMIC,INTEGER,DECIMAL,BOOLEAN,TEXT".split(",")};S.EXPRESSION=["EXPRESSION",0];S.EXPRESSION.toString=l;S.EXPRESSION.__enum__=S;S.DYNAMIC=["DYNAMIC",1];S.DYNAMIC.toString=l;S.DYNAMIC.__enum__=
S;S.INTEGER=["INTEGER",2];S.INTEGER.toString=l;S.INTEGER.__enum__=S;S.DECIMAL=["DECIMAL",3];S.DECIMAL.toString=l;S.DECIMAL.__enum__=S;S.BOOLEAN=["BOOLEAN",4];S.BOOLEAN.toString=l;S.BOOLEAN.__enum__=S;S.TEXT=["TEXT",5];S.TEXT.toString=l;S.TEXT.__enum__=S;S.__empty_constructs__=[S.EXPRESSION,S.DYNAMIC,S.INTEGER,S.DECIMAL,S.BOOLEAN,S.TEXT];var K=function(){};h["tools.spark.sliced.services.std.logic.gde.interfaces.EventType"]=K;K.__name__="tools,spark,sliced,services,std,logic,gde,interfaces,EventType".split(",");
K.init=function(){K.eventTypesMap=new ea;K.eventTypesMapReverse=new M;K.eventTypesStringArray=[];K.keyboardStringToKey=new M;K.eventTypesMap.set(m.CREATED,"Created");"Created";K.eventTypesMap.set(m.UPDATE,"Update");"Update";K.eventTypesMap.set(m.CHANGED,"Changed");"Changed";K.eventTypesMap.set(m.NETWORK_CONNECTED,"NetworkConnected");"NetworkConnected";K.eventTypesMap.set(m.NETWORK_REQUEST,"NetworkRequest");"NetworkRequest";K.eventTypesMap.set(m.NETWORK_SERVER_EVENT,"NetworkServerEvent");"NetworkServerEvent";
K.eventTypesMap.set(m.FILETRANSFER_CONNECTED,"FileTransferConnected");"FileTransferConnected";K.eventTypesMap.set(m.FILETRANSFER_SENDREQUEST,"FileTransferRequest");"FileTransferRequest";K.eventTypesMap.set(m.MOUSE_LEFT_CLICK,"MouseLeftClick");"MouseLeftClick";K.eventTypesMap.set(m.MOUSE_RIGHT_CLICK,"MouseRightClick");"MouseRightClick";K.eventTypesMap.set(m.MOUSE_LEFT_DOWN,"MouseLeftDown");"MouseLeftDown";K.eventTypesMap.set(m.MOUSE_RIGHT_DOWN,"MouseRightDown");"MouseRightDown";K.eventTypesMap.set(m.MOUSE_SCROLL,
"MouseScroll");"MouseScroll";K.eventTypesMap.set(m.MOUSE_ENTERED,"MouseEntered");"MouseEntered";K.eventTypesMap.set(m.MOUSE_MOVED,"MouseMoved");"MouseMoved";K.eventTypesMap.set(m.MOUSE_LEFT,"MouseLeft");"MouseLeft";K.eventTypesMap.set(m.MOUSE_DOWN,"MouseDown");"MouseDown";K.eventTypesMap.set(m.MOUSE_UP,"MouseUp");"MouseUp";K.eventTypesMap.set(m.PHYSICS_COLLISION_START,"PhysicsCollisionStart");"PhysicsCollisionStart";K.eventTypesMap.set(m.PHYSICS_COLLISION_END,"PhysicsCollisionEnd");"PhysicsCollisionEnd";
K.eventTypesMap.set(m.PHYSICS_SENSOR_START,"PhysicsSensorStart");"PhysicsSensorStart";K.eventTypesMap.set(m.PHYSICS_SENSOR_START_BIPED_FEET,"PhysicsSensorStartBipedFeet");"PhysicsSensorStartBipedFeet";K.eventTypesMap.set(m.PHYSICS_SENSOR_END,"PhysicsSensorEnd");"PhysicsSensorEnd";K.eventTypesMap.set(m.PHYSICS_SENSOR_END_BIPED_FEET,"PhysicsSensorEndBipedFeet");"PhysicsSensorEndBipedFeet";K.eventTypesMap.set(m.ON_DRAG_START,"OnDragStart");"OnDragStart";K.eventTypesMap.set(m.ON_DRAG,"OnDrag");"OnDrag";
K.eventTypesMap.set(m.ON_DRAG_END,"OnDragEnd");"OnDragEnd";K.eventTypesMap.set(m.ON_DRAG_ENTER,"OnDragEnter");"OnDragEnter";K.eventTypesMap.set(m.ON_DRAG_OVER,"OnDragOver");"OnDragOver";K.eventTypesMap.set(m.ON_DRAG_LEAVE,"OnDragLeave");"OnDragLeave";K.eventTypesMap.set(m.ON_DROP,"OnDrop");"OnDrop";K.eventTypesMap.set(m.KEY_PRESSED_LOCAL,"KeyPressedLocal");"KeyPressedLocal";K.eventTypesMap.set(m.KEY_DOWN_LOCAL,"KeyDownLocal");"KeyDownLocal";K.eventTypesMap.set(m.KEY_RELEASED_LOCAL,"KeyReleasedLocal");
"KeyReleasedLocal";K.eventTypesMap.set(m.KEY_PRESSED,"KeyPressed");"KeyPressed";K.eventTypesMap.set(m.KEY_DOWN,"KeyDown");"KeyDown";K.eventTypesMap.set(m.KEY_RELEASED,"KeyReleased");"KeyReleased";K.eventTypesMap.set(m.STATE_CHANGED,"StateChanged");"StateChanged";K.eventTypesMap.set(m.CUSTOM_TRIGGER,"CustomTrigger");"CustomTrigger";K.eventTypesMap.set(m.SCENE_CREATED,"SceneCreated");"SceneCreated";K.eventTypesMap.set(m.PROJECT_PAUSED,"ProjectPaused");"ProjectPaused";K.eventTypesMap.set(m.PROJECT_RESUMED,
"ProjectResumed");"ProjectResumed";K.eventTypesMap.set(m.SOUND_COMPLETED,"SoundCompleted");"SoundCompleted";K.eventTypesMap.set(m.LAYOUT_INVALIDATED,"LayoutInvalidated");"LayoutInvalidated";K.eventTypesMap.set(m.STAGE_RESIZED,"StageResized");"StageResized";for(var a=K.eventTypesMap.keys();a.hasNext();){var b=a.next(),c=K.eventTypesMap.get(b);K.eventTypesMapReverse.set(c,b);b}for(a=K.eventTypesMap.iterator();a.hasNext();)b=a.next(),K.eventTypesStringArray.push(b);a=0;for(b=Y.allEnums(j);a<b.length;)c=
b[a],++a,K.keyboardStringToKey.set(c[0],c),c};var ei=function(){};h["tools.spark.sliced.services.std.logic.interpreter.interfaces.IInterpreter"]=ei;ei.__name__="tools,spark,sliced,services,std,logic,interpreter,interfaces,IInterpreter".split(",");ei.prototype={__class__:ei};var Wh=function(){t._engineLogger.info("Init Gml Interpreter...",null);this._init()};h["tools.spark.sliced.services.std.logic.interpreter.core.GmlInterpreter"]=Wh;Wh.__name__="tools,spark,sliced,services,std,logic,interpreter,core,GmlInterpreter".split(",");
Wh.__interfaces__=[ei];Wh.prototype={_init:function(){this._hashTable=new zb},runExpr:function(){return null},hashExpr:function(){return null},run:function(a,b){this._deleteMeCircleAround(null!=Oa.me?b.getReserved("me"):b.h.me);return!0},_deleteMeCircleAround:function(a){null!=a.getState("std_object")&&(a.setState("std_x",a.getState("initX")+50*Math.cos(a.getState("rotationDegree"))),a.getState("std_object").x=a.getState("std_x"),a.setState("std_y",a.getState("initY")+50*Math.sin(a.getState("rotationDegree"))),
a.getState("std_object").y=a.getState("std_y"),a.setState("rotationDegree",a.getState("rotationDegree")+0.1))},hash:function(){return-1},__class__:Wh};var Vh=function(){this._lalala=0;t._engineLogger.info("Init HaxeJs Interpreter...",null);this._init()};h["tools.spark.sliced.services.std.logic.interpreter.core.platform.html.HaxeJsInterpreter"]=Vh;Vh.__name__="tools,spark,sliced,services,std,logic,interpreter,core,platform,html,HaxeJsInterpreter".split(",");Vh.__interfaces__=[ei];Vh.prototype={_init:function(){r.random(1);
G._platform.getStorage();G._platform.getStorage().get_supported();Fb=G._platform.getStorage();u(Fb,Fb.clear);Fb=G._platform.getStorage();u(Fb,Fb.get);Fb=G._platform.getStorage();u(Fb,Fb.remove);Fb=G._platform.getStorage();u(Fb,Fb.set);this._hashTable=new zb;window.Sound=s.sound;window.Logic=s.logic;window.Input=s.input;window.Comms=s.comms;window.Event=s.event;window.Display=s.display;window.Project=F;window.Module=Af;window.Asset=Bf;window.Std=r;window.StringMap=M;window.IntMap=zb;window.ObjectMap=
Fa;window.Assets=C;window.AssetFormat=D;window.StringTools=fa;window.Xml=q;window.MouseButton=Da;window.EEventType=m;window.EModuleState=R;window.Key=j;window.Ease=ca;window.System=G;window.ModuleManager=B;window.Tween=Ed;window.expr=u(this,this.runExpr);window.e=(Fb=s.logic,u(Fb,Fb.getEntityByName));window.query=(Fb=s.logic,u(Fb,Fb.queryGameEntity));window.string=r.string},run:function(a,b){var c=this._get(a);try{return c(null!=Oa.me?b.getReserved("me"):b.h.me,null!=Oa.parent?b.getReserved("parent"):
b.h.parent,null!=Oa.it?b.getReserved("it"):b.h.it),!0}catch(d){return d instanceof p&&(d=d.val),t._engineLogger.error("<<<<<SPARK SCRIPT RUN-TIME JS ERROR>>>>>: "+r.string(d),null),G._platform.getExternal().call("console.log",[d]),G._platform.getExternal().call("console.log",[c]),!1}},runExpr:function(a,b,c,d){a=this._get(a);try{return a(b,c,d)}catch(e){return e instanceof p&&(e=e.val),t._engineLogger.error("<<<<<SPARK EXPRESSION RUN-TIME JS ERROR>>>>>: "+r.string(e),null),G._platform.getExternal().call("console.log",
[e]),G._platform.getExternal().call("console.log",[a]),null}},hashExpr:function(a){a="(function(me,parent,it){return("+a+");})";return this._store(a,Ri.make(zc.ofString(a)))},hash:function(a){a="(function(me,parent,it){"+a+"})";return this._store(a,Ri.make(zc.ofString(a)))},_get:function(a){var b=this._hashTable.h[a];null==b&&t._engineLogger.error("Script not found on address ["+a+"]",null);return b},_store:function(a,b){if(null!=this._hashTable.h[b])return b;try{var c=G._platform.getExternal().call("eval",
[a]);this._hashTable.set(b,c);c;this._lalala+=1;return b}catch(d){return d instanceof p&&(d=d.val),t._engineLogger.error("<<<<<SPARK SCRIPT PARSING ERROR: "+r.string(d),null),G._platform.getExternal().call("console.log",[d]),G._platform.getExternal().call("console.log",[a]),-1}},__class__:Vh};var Qj=function(){t._engineLogger.info("Creating Level Manager",null);this._init()};h["tools.spark.sliced.services.std.logic.level_manager.core.LevelManager"]=Qj;Qj.__name__="tools,spark,sliced,services,std,logic,level_manager,core,LevelManager".split(",");
Qj.prototype={_init:function(){this.currentLevel=new M;this._preLoaderActive=!0;this.levelLoaded=new ma;this.levelCreated=new yc;this.levelRan=new yc},addLevel:function(){t._engineLogger.error("addLevel...",null)},loadLevel:function(a){this._actionAfterLoad=db.DO_NOTHING;this._loadLevel(a)},runLevel:function(a,b,c){null==c&&(c="Implicit");null==b&&(b="Main");this._actionAfterLoad=db.RUN;this._levelRunSlot=b;this._levelParentStage=c;this._loadLevel(a)},_loadLevel:function(a){if(null!=a){if(!Object.prototype.hasOwnProperty.call(a,
"getState"))if(-1==a.indexOf("."))a=s.logic.getEntityByName(a);else if(C.scriptLoaded(a))a=s.logic.create(a);else{t._engineLogger.error("Level Manager->Level "+r.string(a)+" has not been loaded, and dynamic loaded has been deprecated! Quitting...",null);return}a.forceAction("Find References");var b=a.getState("moduleReferences");null!=b?(this._levelLoading=a,B.successSignal.connect(u(this,this._onLevelLoaded)).once(),B.execute(b[0].getState("url"))):t._engineLogger.error("No Modules Found for level",
null)}else t._engineLogger.error("No parameters found for LevelManager.runLevel!",null)},_onLevelLoaded:function(){t._engineLogger.info("LEVEL LOADED!",null);this.levelLoaded.emit(this._levelLoading);this._actionAfterLoad==db.CREATE?this._createLevel(this._levelLoading):this._actionAfterLoad==db.RUN&&this._runLevel(this._levelLoading,this._levelRunSlot)},_createLevel:function(a){if(!1==a.getState("created")){for(var b=a.getState("cameraReferences"),c=null,d=0;d<b.length;)c=b[d],++d,c=s.logic.create(c.getState("url")),
a.addChild(c);b=[];d=[];null!=c&&d.push(c);for(var e=a.getState("stageAreaReferences"),f=0;f<e.length;){var i=e[f];++f;i=s.logic.create(i.getState("url"));b.push(i)}e=a.getState("viewReferences");for(f=0;f<e.length;){i=e[f];++f;i=s.logic.create(i.getState("url"));b.push(i);var g=s.logic.create(i.getState("initSceneUrl"),!0);g.setState("parentLevel",a);var o=null;"Level Camera"!=i.getState("initCameraUrl")&&(o=s.logic.create(i.getState("initCameraUrl")),d.push(o));i.setState("scene",g);null!=o?i.setState("camera",
o):i.setState("camera",c);a.addChild(g);null!=o&&a.addChild(o)}a.setState("created",!0);a.setState("views",b);a.setState("cameras",d);this.levelCreated.emit()}else t._engineLogger.warn("Level already created. Ignoring...",null)},_runLevel:function(a,b){!1==a.getState("created")&&this._createLevel(a);if(a!=this.currentLevel.get(b)){null!=this.currentLevel.get(b)&&(this._removeLevel(this.currentLevel.get(b)),this.currentLevel.remove(b));this._preLoaderActive&&(G._platform.getExternal().call("hidePreloader"),
this._preLoaderActive=!1);var c=a.getState("views");s.display.projectActiveSpaceReference.spaceEntity.addChild(a);for(var d=0;d<c.length;){var e=c[d];++d;e.setState("parent",this._levelParentStage);s.display.projectActiveSpaceReference.activeStageReference.stageEntity.addChild(e)}this.currentLevel.set(b,a);a;this.levelRan.emit()}else t._engineLogger.warn("Level already running. Ignoring...",null)},clearRunSlot:function(a){null==a&&(a="Main");null!=this.currentLevel.get(a)&&this.currentLevel.remove(a)},
addRunSlotToStage:function(a){null==a&&(a="Main");null!=this.currentLevel.get(a)&&this._addLevel(this.currentLevel.get(a))},removeRunSlotFromStage:function(a){null==a&&(a="Main");null!=this.currentLevel.get(a)&&this._removeLevel(this.currentLevel.get(a))},_addLevel:function(a){var b=a.getState("views");s.display.projectActiveSpaceReference.spaceEntity.addChild(a);for(a=0;a<b.length;){var c=b[a];++a;s.display.projectActiveSpaceReference.activeStageReference.stageEntity.addChild(c)}},_removeLevel:function(a){var b=
a.getState("views");a.remove();for(a=0;a<b.length;){var c=b[a];++a;c.remove()}},__class__:Qj};var db=h["tools.spark.sliced.services.std.logic.level_manager.interfaces.EActionAfterLoad"]={__ename__:"tools,spark,sliced,services,std,logic,level_manager,interfaces,EActionAfterLoad".split(","),__constructs__:["DO_NOTHING","CREATE","RUN"]};db.DO_NOTHING=["DO_NOTHING",0];db.DO_NOTHING.toString=l;db.DO_NOTHING.__enum__=db;db.CREATE=["CREATE",1];db.CREATE.toString=l;db.CREATE.__enum__=db;db.RUN=["RUN",2];
db.RUN.toString=l;db.RUN.__enum__=db;db.__empty_constructs__=[db.DO_NOTHING,db.CREATE,db.RUN];var fi=function(){this._init()};h["tools.spark.sliced.services.std.sound.core.Sound"]=fi;fi.__name__="tools,spark,sliced,services,std,sound,core,Sound".split(",");fi.__interfaces__=[th];fi.__super__=Eb;fi.prototype=x(Eb.prototype,{_init:function(){t._engineLogger.info("Init Sound std Service...",null);this._playBacks=new M;this.iOSPlayedBlankSound=!1},playSound:function(a,b){if(null!=C.getSound(a)){var c=
C.getSound(a).play(b);this._playBacks.set(a,c);c;c.get_complete().get_changed().connect(function(){s.event.raiseEvent(m.SOUND_COMPLETED,null,a)});return c}t._engineLogger.warn("Could not play sound: "+a,null);return null},loopSound:function(a,b){if(null!=C.getSound(a)){var c=C.getSound(a).loop(b);this._playBacks.set(a,c);c;return c}t._engineLogger.warn("Could not loop sound: "+a,null);return null},stopSound:function(a,b){var c=this._playBacks.get(a);null!=c&&!1==c.get_complete().get__()&&(null==b?
c.dispose():(c.volume.animateTo(0,b),this._playBacks.set(a,null),null))},setVolume:function(a,b){var c=this._playBacks.get(a);null!=c&&c.volume.set__(b)},isPlaying:function(a){a=this._playBacks.get(a);return null==a?!1:!a.get_complete().get__()},iOSPlayBlankSound:function(){this.playSound("_blankSound",0);this.iOSPlayedBlankSound=!0},stopAllSounds:function(a){for(var b=this._playBacks.iterator();b.hasNext();){var c=b.next();!1==c.get_complete().get__()&&(null==a?c.dispose():c.volume.animateTo(0,a))}},
__class__:fi});var fd=function(){this.body=this.constraint=null;this.pre_swapped=!1;this.int1=this.int2=this.set=this.wrap_arbiters=this.pre_arbiter=null;this.length=0;this.listener=this.next=this.prev=null;this.event=0;this.outer_body=this.outer_con=this.outer_int=null;this.length=0};h["zpp_nape.callbacks.ZPP_Callback"]=fd;fd.__name__=["zpp_nape","callbacks","ZPP_Callback"];fd.prototype={wrapper_body:function(){null==this.outer_body&&(this.outer_body=new zg,this.outer_body.zpp_inner=this);return this.outer_body},
wrapper_con:function(){null==this.outer_con&&(this.outer_con=new Bg,this.outer_con.zpp_inner=this);return this.outer_con},wrapper_int:function(){null==this.outer_int&&(this.outer_int=new Cg,this.outer_int.zpp_inner=this);null==this.wrap_arbiters?this.wrap_arbiters=rc.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters;this.wrap_arbiters.zpp_inner.zip_length=!0;this.wrap_arbiters.zpp_inner.at_ite=null;return this.outer_int},push:function(a){null!=this.prev?this.prev.next=
a:this.next=a;a.prev=this.prev;a.next=null;this.prev=a;this.length++},pop:function(){var a=this.next;this.next=a.next;null==this.next?this.prev=null:this.next.prev=null;this.length--;return a},empty:function(){return null==this.next},__class__:fd};var ta=function(){this.interactors=this.constraints=null;this.zip_conlisteners=!1;this.conlisteners=null;this.zip_bodylisteners=!1;this.bodylisteners=null;this.zip_listeners=!1;this.manager=this.cbpairs=this.listeners=null;this.id=0;this.next=null;this.count=
0;this.cbTypes=null;this.cbTypes=new gd;this.listeners=new Me;this.zip_listeners=!0;this.bodylisteners=new gh;this.zip_bodylisteners=!0;this.conlisteners=new hh;this.zip_conlisteners=!0;this.constraints=new dd;this.interactors=new Xd;this.id=Aa.CbSet();this.cbpairs=new Vj};h["zpp_nape.callbacks.ZPP_CbSet"]=ta;ta.__name__=["zpp_nape","callbacks","ZPP_CbSet"];ta.setlt=function(a,b){for(var c=a.cbTypes.head,d=b.cbTypes.head;null!=c&&null!=d;){var e=c.elt,f=d.elt;if(e.id<f.id)return!0;if(f.id<e.id)return!1;
c=c.next;d=d.next}return null!=d&&null==c};ta.get=function(a){var b;null==ta.zpp_pool?b=new ta:(b=ta.zpp_pool,ta.zpp_pool=b.next,b.next=null);null;for(var c=null,a=a.head;null!=a;){var d=a.elt,c=b.cbTypes.insert(c,d);d.cbsets.add(b);a=a.next}return b};ta.single_intersection=function(a,b,c){return a.manager.pair(a,b).single_intersection(c)};ta.find_all=function(a,b,c,d){a.manager.pair(a,b).forall(c,d)};ta.prototype={invalidate_pairs:function(){for(var a=this.cbpairs.head;null!=a;)a.elt.zip_listeners=
!0,a=a.next},realvalidate_listeners:function(){this.listeners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.listeners.head,d=a.elt.listeners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||Rb.setlt(e,c.elt)?(e.space==this.manager.space&&(b=this.listeners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.bodylisteners.head,
d=a.elt.bodylisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||Rb.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.bodylisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.conlisteners.head,d=a.elt.conlisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||
Rb.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.conlisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners());this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners());this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},free:function(){this.listeners.clear();this.zip_listeners=!0;this.bodylisteners.clear();
this.zip_bodylisteners=!0;this.conlisteners.clear();for(this.zip_conlisteners=!0;null!=this.cbTypes.head;)this.cbTypes.pop_unsafe().cbsets.remove(this)},__class__:ta};var Sb=function(){this.listeners=null;this.zip_listeners=!1;this.a=this.b=this.next=null;this.listeners=new Me};h["zpp_nape.callbacks.ZPP_CbSetPair"]=Sb;Sb.__name__=["zpp_nape","callbacks","ZPP_CbSetPair"];Sb.get=function(a,b){var c;null==Sb.zpp_pool?c=new Sb:(c=Sb.zpp_pool,Sb.zpp_pool=c.next,c.next=null);c.zip_listeners=!0;ta.setlt(a,
b)?(c.a=a,c.b=b):(c.a=b,c.b=a);return c};Sb.setlt=function(a,b){return ta.setlt(a.a,b.a)||a.a==b.a&&ta.setlt(a.b,b.b)};Sb.prototype={__validate:function(){this.listeners.clear();for(var a=this.a.listeners.head,b=this.b.listeners.head;null!=a&&null!=b;){var c=a.elt,d=b.elt;c==d?((c.options1.compatible(this.a.cbTypes)&&c.options2.compatible(this.b.cbTypes)||c.options2.compatible(this.a.cbTypes)&&c.options1.compatible(this.b.cbTypes))&&this.listeners.add(c),a=a.next,b=b.next):c.precedence>d.precedence||
c.precedence==d.precedence&&c.id>d.id?a=a.next:b=b.next}},empty_intersection:function(){return null==this.listeners.head},single_intersection:function(a){var b=this.listeners.head;return null!=b&&b.elt==a&&null==b.next},forall:function(a,b){for(var c=this.listeners.head;null!=c;){var d=c.elt;d.event==a&&b(d);c=c.next}},__class__:Sb};var g=function(){};h["zpp_nape.util.ZPP_Flags"]=g;g.__name__=["zpp_nape","util","ZPP_Flags"];var Rb=function(){this.body=this.constraint=this.interaction=this.space=null;
this.id=this.type=this.event=this.precedence=0;this.outer=null;this.id=Aa.Listener()};h["zpp_nape.callbacks.ZPP_Listener"]=Rb;Rb.__name__=["zpp_nape","callbacks","ZPP_Listener"];Rb.setlt=function(a,b){return a.precedence>b.precedence||a.precedence==b.precedence&&a.id>b.id};Rb.prototype={addedToSpace:function(){},removedFromSpace:function(){},__class__:Rb};var Wj=function(){this.outer_zn=this.options=this.handler=null};h["zpp_nape.callbacks.ZPP_BodyListener"]=Wj;Wj.__name__=["zpp_nape","callbacks",
"ZPP_BodyListener"];Wj.__super__=Rb;Wj.prototype=x(Rb.prototype,{addedToSpace:function(){this.options.handler=u(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addbody(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.bodylisteners.remove(this);b.invalidatebody();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Wj});
var Xj=function(){this.outer_zn=this.options=this.handler=null};h["zpp_nape.callbacks.ZPP_ConstraintListener"]=Xj;Xj.__name__=["zpp_nape","callbacks","ZPP_ConstraintListener"];Xj.__super__=Rb;Xj.prototype=x(Rb.prototype,{addedToSpace:function(){this.options.handler=u(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addconstraint(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.conlisteners.remove(this);b.invalidateconstraint();
a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Xj});var gd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CbType"]=gd;gd.__name__=["zpp_nape","util","ZNPList_ZPP_CbType"];gd.prototype={inlined_add:function(a){var b;null==dc.zpp_pool?b=new dc:(b=dc.zpp_pool,dc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==dc.zpp_pool?c=new dc:(c=dc.zpp_pool,dc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=dc.zpp_pool;dc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=
!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=
b;a.elt=null;a.next=dc.zpp_pool;dc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:gd};var Ab=function(a,b,c,d){this.handlerp=null;this.allowSleepingCallbacks=this.pure=
!1;this.options1=this.options2=this.handleri=null;this.itype=0;this.outer_zni=this.outer_znp=null;Rb.call(this);this.type=d;this.interaction=this;this.event=c;this.options1=a.zpp_inner;this.options2=b.zpp_inner;this.allowSleepingCallbacks=!1};h["zpp_nape.callbacks.ZPP_InteractionListener"]=Ab;Ab.__name__=["zpp_nape","callbacks","ZPP_InteractionListener"];Ab.__super__=Rb;Ab.prototype=x(Rb.prototype,{CbSetset:function(a,b,c){for(var d=Ab.UCbSet,e=Ab.VCbSet,f=Ab.WCbSet,a=a.head,i=b.head;null!=a&&null!=
i;){var g=a.elt,o=i.elt;g==o?(f.inlined_add(g),a=a.next,i=i.next):ta.setlt(g,o)?(d.inlined_add(g),a=a.next):(e.inlined_add(o),i=i.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=i;)e.inlined_add(i.elt),i=i.next;for(;null!=d.head;){a=d.pop_unsafe();for(i=b.head;null!=i;)c(a,i.elt),i=i.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=f.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=f.head;){e=f.pop_unsafe();c(e,e);for(b=f.head;null!=b;)c(e,b.elt),b=b.next}},CbTypeset:function(a,b,c){for(var d=
Ab.UCbType,e=Ab.VCbType,f=Ab.WCbType,a=a.head,i=b.head;null!=a&&null!=i;){var g=a.elt,o=i.elt;g==o?(f.inlined_add(g),a=a.next,i=i.next):g.id<o.id?(d.inlined_add(g),a=a.next):(e.inlined_add(o),i=i.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=i;)e.inlined_add(i.elt),i=i.next;for(;null!=d.head;){a=d.pop_unsafe();for(i=b.head;null!=i;)c(a,i.elt),i=i.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=f.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=f.head;){e=f.pop_unsafe();c(e,e);for(b=f.head;null!=
b;)c(e,b.elt),b=b.next}},with_uniquesets:function(a){var b=this,c;null==ab.zpp_pool?c=new ab:(c=ab.zpp_pool,ab.zpp_pool=c.next,c.next=null);null;c.lt=Sb.setlt;this.CbTypeset(this.options1.includes,this.options2.includes,function(a,d){b.CbSetset(a.cbsets,d.cbsets,function(a,d){a.validate();d.validate();ta.single_intersection(a,d,b)&&c.try_insert(Sb.get(a,d))})});c.clear_with(function(c){a?b.space.freshListenerType(c.a,c.b):b.space.nullListenerType(c.a,c.b);c.a=c.b=null;c.listeners.clear();c.next=Sb.zpp_pool;
Sb.zpp_pool=c});var d=c;d.data=null;d.lt=null;d.swapped=null;d.next=ab.zpp_pool;ab.zpp_pool=d},with_union:function(a){for(var b=this.options1.includes.head,c=this.options2.includes.head;null!=b&&null!=c;){var d=b.elt,e=c.elt;d==e?(a(d),b=b.next,c=c.next):d.id<e.id?(a(d),b=b.next):(a(e),c=c.next)}for(;null!=b;)a(b.elt),b=b.next;for(;null!=c;)a(c.elt),c=c.next},addedToSpace:function(){var a=this,b=this.type==g.id_ListenerType_PRE;this.with_union(function(c){c.addint(a);if(b)for(c=c.interactors.head;null!=
c;)c.elt.wake(),c=c.next});this.options1.handler=u(this,this.cbtype_change1);this.options2.handler=u(this,this.cbtype_change2);this.with_uniquesets(!0)},removedFromSpace:function(){var a=this;this.with_uniquesets(!1);var b=this.type==g.id_ListenerType_PRE;this.with_union(function(c){c.listeners.remove(a);c.invalidateint();if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=null;this.options2.handler=null},cbtype_change1:function(a,b,c){this.cbtype_change(this.options1,
a,b,c)},cbtype_change2:function(a,b,c){this.cbtype_change(this.options2,a,b,c)},cbtype_change:function(a,b,c,d){this.removedFromSpace();a.effect_change(b,c,d);this.addedToSpace();null},__class__:Ab});var Ce=function(){this.outer=this.handler=this.includes=this.excludes=this.wrap_includes=this.wrap_excludes=null;this.includes=new gd;this.excludes=new gd};h["zpp_nape.callbacks.ZPP_OptionType"]=Ce;Ce.__name__=["zpp_nape","callbacks","ZPP_OptionType"];Ce.argument=function(a){return null==a?new of:w.__instanceof(a,
of)?a:(new of).including(a)};Ce.prototype={setup_includes:function(){this.wrap_includes=$c.get(this.includes,!0)},setup_excludes:function(){this.wrap_excludes=$c.get(this.excludes,!0)},excluded:function(a){return this.nonemptyintersection(a,this.excludes)},compatible:function(a){return this.nonemptyintersection(a,this.includes)&&!this.nonemptyintersection(a,this.excludes)},nonemptyintersection:function(a,b){for(var c=!1,d=a.head,e=b.head;null!=e&&null!=d;){var f=e.elt,i=d.elt;if(f==i){c=!0;break}else f.id<
i.id?e=e.next:d=d.next}return c},effect_change:function(a,b,c){if(b)if(c){b=null;for(c=this.includes.head;null!=c&&!(a.id<c.elt.id);){b=c;c=c.next}this.includes.inlined_insert(b,a)}else this.includes.remove(a);else if(c){b=null;for(c=this.excludes.head;null!=c&&!(a.id<c.elt.id);){b=c;c=c.next}this.excludes.inlined_insert(b,a)}else this.excludes.remove(a)},append_type:function(a,b){a==this.includes?this.includes.has(b)||(this.excludes.has(b)?null!=this.handler?this.handler(b,!1,!1):this.effect_change(b,
!1,!1):null!=this.handler?this.handler(b,!0,!0):this.effect_change(b,!0,!0)):this.excludes.has(b)||(this.includes.has(b)?null!=this.handler?this.handler(b,!0,!1):this.effect_change(b,!0,!1):null!=this.handler?this.handler(b,!1,!0):this.effect_change(b,!1,!0))},append:function(a,b){if(w.__instanceof(b,Gd))this.append_type(a,b.zpp_inner);else if(w.__instanceof(b,Ag)){var c;b.zpp_inner.valmod();for(c=Zb.get(b);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);this.append_type(a,d.zpp_inner)}}else if(b instanceof
Array&&null==b.__enum__)for(c=0;c<b.length;)d=b[c],++c,this.append_type(a,d.zpp_inner)},__class__:Ce};var Gk=function(){this.cbTypes=this.cbSet=null;this.ignore=this.__velocity=!1;this.component=null;this.active=this.stiff=this.removeOnBreak=!1;this.outer=this.compound=this.space=null};h["zpp_nape.constraint.ZPP_Constraint"]=Gk;Gk.__name__=["zpp_nape","constraint","ZPP_Constraint"];Gk.prototype={alloc_cbSet:function(){if(null!=(this.cbSet=this.space.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.constraints.add(this)},
dealloc_cbSet:function(){if(null!=this.cbSet){this.cbSet.constraints.remove(this);if(0==--this.cbSet.count){this.space.cbsets.remove(this.cbSet);var a=this.cbSet;a.free();a.next=ta.zpp_pool;ta.zpp_pool=a}this.cbSet=null}},addedToSpace:function(){this.active&&this.activeInSpace();this.activeBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.add(this),a=a.next},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace();this.inactiveBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.remove(this),
a=a.next},activeInSpace:function(){this.alloc_cbSet();null==wa.zpp_pool?this.component=new wa:(this.component=wa.zpp_pool,wa.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!1;this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var a=this.component;a.body=null;a.constraint=null;null;a.next=wa.zpp_pool;wa.zpp_pool=a;this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},wake_connected:function(){},
forest:function(){},pair_exists:function(){return!1},broken:function(){},warmStart:function(){},preStep:function(){return!1},applyImpulseVel:function(){return!1},applyImpulsePos:function(){return!1},__class__:Gk};var pa=function(){this.colarb=this.fluidarb=this.sensorarb=null;this.type=0;this.b1=this.b2=this.ws1=this.ws2=this.pair=null;this.invalidated=!1;this.immState=0;this.intchange=this.presentable=this.continuous=this.fresh=!1;this.present=0;this.active=this.cleared=this.sleeping=!1;this.id=
this.di=this.stamp=this.up_stamp=this.sleep_stamp=this.endGenerated=0;this.outer=null};h["zpp_nape.dynamics.ZPP_Arbiter"]=pa;pa.__name__=["zpp_nape","dynamics","ZPP_Arbiter"];pa.prototype={wrapper:function(){null==this.outer&&(pa.internal=!0,this.type==pa.COL?(this.colarb.outer_zn=new Eg,this.outer=this.colarb.outer_zn):this.type==pa.FLUID?(this.fluidarb.outer_zn=new Fg,this.outer=this.fluidarb.outer_zn):this.outer=new ie,this.outer.zpp_inner=this,pa.internal=!1);return this.outer},__class__:pa};
var ub=function(){this.next=null;pa.call(this);this.type=pa.SENSOR;this.sensorarb=this};h["zpp_nape.dynamics.ZPP_SensorArbiter"]=ub;ub.__name__=["zpp_nape","dynamics","ZPP_SensorArbiter"];ub.__super__=pa;ub.prototype=x(pa.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=ub.zpp_pool;ub.zpp_pool=this},__class__:ub});
var ob=function(){this.wMass=this.adamp=this.agamma=this.vMassa=this.vMassb=this.vMassc=this.dampx=this.dampy=this.lgamma=this.nx=this.ny=this.buoyx=this.buoyy=this.pre_dt=0;this.nodrag=!1;this.centroidx=this.centroidy=this.overlap=this.r1x=this.r1y=this.r2x=this.r2y=0;this.outer_zn=this.next=null;pa.call(this);this.type=pa.FLUID;this.fluidarb=this;this.buoyy=this.buoyx=0;this.pre_dt=-1};h["zpp_nape.dynamics.ZPP_FluidArbiter"]=ob;ob.__name__=["zpp_nape","dynamics","ZPP_FluidArbiter"];ob.__super__=
pa;ob.prototype=x(pa.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=ob.zpp_pool;ob.zpp_pool=this;this.pre_dt=-1},preStep:function(a,b){-1==this.pre_dt&&(this.pre_dt=b);var c=b/this.pre_dt;this.pre_dt=b;this.r1x=this.centroidx-this.b1.posx;this.r1y=this.centroidy-this.b1.posy;this.r2x=this.centroidx-this.b2.posx;
this.r2y=this.centroidy-this.b2.posy;var d=0,e=0;this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(d=this.ws1.fluidProperties.gravityx,e=this.ws1.fluidProperties.gravityy):(d=a.gravityx,e=a.gravityy);var f=0,i=0;this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(f=this.ws2.fluidProperties.gravityx,i=this.ws2.fluidProperties.gravityy):(f=a.gravityx,i=a.gravityy);var h=0,o=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var j=this.overlap*this.ws1.fluidProperties.density,
k=this.overlap*this.ws2.fluidProperties.density;if(j>k)f=j+k,h-=d*f,o-=e*f;else if(j<k)d=j+k,h+=f*d,o+=i*d;else{var l=0,m=0,l=0.5*(d+f),m=0.5*(e+i);this.ws1.worldCOMx*l+this.ws1.worldCOMy*m>this.ws2.worldCOMx*l+this.ws2.worldCOMy*m?(d=j+k,h-=l*d,o-=m*d):(d=j+k,h+=l*d,o+=m*d)}}else this.ws1.fluidEnabled?(f=this.overlap*this.ws1.fluidProperties.density,h-=d*f,o-=e*f):this.ws2.fluidEnabled&&(d=this.overlap*this.ws2.fluidProperties.density,h+=f*d,o+=i*d);h*=b;o*=b;this.buoyx=h;this.buoyy=o;this.b1.type==
g.id_BodyType_DYNAMIC&&(d=this.b1.imass,this.b1.velx-=h*d,this.b1.vely-=o*d,this.b1.angvel-=(o*this.r1x-h*this.r1y)*this.b1.iinertia);this.b2.type==g.id_BodyType_DYNAMIC&&(d=this.b2.imass,this.b2.velx+=h*d,this.b2.vely+=o*d,this.b2.angvel+=(o*this.r2x-h*this.r2y)*this.b2.iinertia);if((!this.ws1.fluidEnabled||0==this.ws1.fluidProperties.viscosity)&&(!this.ws2.fluidEnabled||0==this.ws2.fluidProperties.viscosity))this.nodrag=!0,this.adamp=this.dampy=this.dampx=0;else{this.nodrag=!1;h=0;this.ws1.fluidEnabled&&
(this.ws2.validate_angDrag(),h+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area);this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),h+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area);0!=h?(o=this.b1.sinertia+this.b2.sinertia,this.wMass=0!=o?1/o:0,h=2*Math.PI*4.0E-4*h,this.agamma=1/(b*h*(2+h*b)),h=1/(1+this.agamma),this.agamma*=h,this.wMass*=h):this.agamma=this.wMass=0;h=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-
(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel));o=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));h*h+o*o<v.epsilon*v.epsilon||(d=1/Math.sqrt(h*h+o*o),this.nx=h*d,this.ny=o*d);h=0;if(this.ws1.fluidEnabled)if(o=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area,this.ws2.type==g.id_ShapeType_CIRCLE)h-=o*this.ws2.circle.radius*v.fluidLinearDrag/(2*this.ws2.circle.radius*
Math.PI);else{e=d=0;for(f=this.ws2.polygon.edges.head;null!=f;)i=f.elt,d+=i.length,i=o*i.length*(i.gnormx*this.nx+i.gnormy*this.ny),0<i&&(i=i*=-v.fluidVacuumDrag),e-=0.5*i*v.fluidLinearDrag,f=f.next;h+=e/d}if(this.ws2.fluidEnabled)if(o=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area,this.ws1.type==g.id_ShapeType_CIRCLE)h-=o*this.ws1.circle.radius*v.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{e=d=0;for(f=this.ws1.polygon.edges.head;null!=f;)i=f.elt,d+=i.length,i=o*i.length*
(i.gnormx*this.nx+i.gnormy*this.ny),0<i&&(i=i*=-v.fluidVacuumDrag),e-=0.5*i*v.fluidLinearDrag,f=f.next;h+=e/d}0!=h?(f=this.b1.smass+this.b2.smass,e=d=o=0,o=f,d=0,e=f,0!=this.b1.sinertia&&(f=this.r1x*this.b1.sinertia,i=this.r1y*this.b1.sinertia,o+=i*this.r1y,d+=-i*this.r1x,e+=f*this.r1x),0!=this.b2.sinertia&&(f=this.r2x*this.b2.sinertia,i=this.r2y*this.b2.sinertia,o+=i*this.r2y,d+=-i*this.r2x,e+=f*this.r2x),f=o*e-d*d,f!=f?(o=d=e=0,3):0==f?(f=0,0!=o?o=1/o:(o=0,f|=1),0!=e?e=1/e:(e=0,f|=2),d=0,f):(f=
1/f,i=e*f,e=o*f,o=i,d*=-f,0),this.vMassa=o,this.vMassb=d,this.vMassc=e,h*=2*Math.PI,this.lgamma=1/(b*h*(2+h*b)),h=1/(1+this.lgamma),this.lgamma*=h,this.vMassa*=h,this.vMassb*=h,this.vMassc*=h):this.lgamma=this.vMassc=this.vMassb=this.vMassa=0}this.dampx*=c;this.dampy*=c;this.adamp*=c},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.dampx*a;this.b1.vely-=this.dampy*a;a=this.b2.imass;this.b2.velx+=this.dampx*a;this.b2.vely+=this.dampy*a;this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-
this.dampx*this.r1y);this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y);this.b1.angvel-=this.adamp*this.b1.iinertia;this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var a=this.b1.angvel+this.b1.kinangvel,b=this.b2.angvel+this.b2.kinangvel,c=this.b1.velx+this.b1.kinvelx-this.r1y*a-(this.b2.velx+this.b2.kinvelx-this.r2y*b),d=this.b1.vely+this.b1.kinvely+this.r1x*a-(this.b2.vely+this.b2.kinvely+this.r2x*b),e=this.vMassa*c+this.vMassb*d,
d=this.vMassb*c+this.vMassc*d,f=this.lgamma,c=e-this.dampx*f,d=d-this.dampy*f;this.dampx+=1*c;this.dampy+=1*d;e=this.b1.imass;this.b1.velx-=c*e;this.b1.vely-=d*e;e=this.b2.imass;this.b2.velx+=c*e;this.b2.vely+=d*e;this.b1.angvel-=this.b1.iinertia*(d*this.r1x-c*this.r1y);this.b2.angvel+=this.b2.iinertia*(d*this.r2x-c*this.r2y);a=(a-b)*this.wMass-this.adamp*this.agamma;this.adamp+=a;this.b1.angvel-=a*this.b1.iinertia;this.b2.angvel+=a*this.b2.iinertia}},__class__:ob});var qb=function(){this.pre_dt=
0;this.stat=!1;this.next=null;this.hc2=this.hpc2=!1;this.c1=this.oc1=this.c2=this.oc2=null;this.__ref_vertex=0;this.__ref_edge1=this.__ref_edge2=null;this.biasCoef=0;this.rev=!1;this.nx=this.ny=this.kMassa=this.kMassb=this.kMassc=this.Ka=this.Kb=this.Kc=this.rMass=this.jrAcc=this.rn1a=this.rt1a=this.rn1b=this.rt1b=this.rn2a=this.rt2a=this.rn2b=this.rt2b=this.k1x=this.k1y=this.k2x=this.k2y=this.surfacex=this.surfacey=this.lnormx=this.lnormy=this.lproj=this.radius=0;this.s1=this.s2=this.contacts=this.innards=
null;this.userdef_dyn_fric=this.userdef_stat_fric=this.userdef_restitution=this.userdef_rfric=!1;this.dyn_fric=this.stat_fric=this.restitution=this.rfric=0;this.outer_zn=null;pa.call(this);this.pre_dt=-1;this.contacts=new Gb;this.innards=new gi;this.type=pa.COL;this.colarb=this};h["zpp_nape.dynamics.ZPP_ColArbiter"]=qb;qb.__name__=["zpp_nape","dynamics","ZPP_ColArbiter"];qb.__super__=pa;qb.prototype=x(pa.prototype,{injectContact:function(a,b,c,d,e,f,i){null==i&&(i=!1);for(var g=null,h=this.contacts.next;null!=
h;){var j=h;if(f==j.hash){g=j;break}h=h.next}null==g?(null==Gb.zpp_pool?g=new Gb:(g=Gb.zpp_pool,Gb.zpp_pool=g.next,g.next=null),null,h=g.inner,h.jnAcc=h.jtAcc=0,g.hash=f,g.fresh=!0,g.arbiter=this,this.jrAcc=0,this.contacts.inlined_add(g),this.innards.add(h)):g.fresh=!1;g.px=a;g.py=b;this.nx=c;this.ny=d;g.dist=e;g.stamp=this.stamp;g.posOnly=i;return g},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=
null));this.b1=this.b2=null;for(this.intchange=this.active=!1;null!=this.contacts.next;){var a=this.contacts.inlined_pop_unsafe();a.arbiter=null;a.next=Gb.zpp_pool;Gb.zpp_pool=a;this.innards.inlined_pop()}this.userdef_rfric=this.userdef_restitution=this.userdef_stat_fric=this.userdef_dyn_fric=!1;this.__ref_edge1=this.__ref_edge2=null;this.next=qb.zpp_pool;qb.zpp_pool=this;this.pre_dt=-1},cleanupContacts:function(){var a=!0,b=null,c=null,d=this.innards.next;this.hc2=!1;for(var e=this.contacts.next;null!=
e;){var f=e;f.stamp+v.arbiterExpirationDelay<this.stamp?(e=this.contacts.inlined_erase(b),d=this.innards.inlined_erase(c),f.arbiter=null,f.next=Gb.zpp_pool,Gb.zpp_pool=f):(b=f.inner,c=f.active,f.active=f.stamp==this.stamp,f.active&&(a?(a=!1,this.c1=b,this.oc1=f):(this.hc2=!0,this.c2=b,this.oc2=f)),c!=f.active&&(this.contacts.modified=!0),b=e,c=d,d=d.next,e=e.next)}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(d=this.c1,this.c1=this.c2,this.c2=d,d=this.oc1,this.oc1=this.oc2,this.oc2=d,this.hc2=!1):this.oc2.posOnly&&
(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;return a},preStep:function(a){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=
Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)));-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;var c=this.b1.smass+this.b2.smass;this.hc2=!1;a=!0;this.biasCoef=this.b1.type!=g.id_BodyType_DYNAMIC||this.b2.type!=g.id_BodyType_DYNAMIC?
this.continuous?v.contactContinuousStaticBiasCoef:v.contactStaticBiasCoef:this.continuous?v.contactContinuousBiasCoef:v.contactBiasCoef;this.continuous=!1;for(var d=null,e=null,f=this.innards.next,i=this.contacts.next;null!=i;){var h=i;if(h.stamp+v.arbiterExpirationDelay<this.stamp)i=this.contacts.inlined_erase(d),f=this.innards.inlined_erase(e),h.arbiter=null,h.next=Gb.zpp_pool,Gb.zpp_pool=h;else{d=h.inner;e=h.active;h.active=h.stamp==this.stamp;if(h.active){a?(a=!1,this.c1=d,this.oc1=h):(this.hc2=
!0,this.c2=d,this.oc2=h);d.r2x=h.px-this.b2.posx;d.r2y=h.py-this.b2.posy;d.r1x=h.px-this.b1.posx;d.r1y=h.py-this.b1.posy;var o=c+this.b2.sinertia*Qf.sqr(d.r2x*this.nx+d.r2y*this.ny),o=o+this.b1.sinertia*Qf.sqr(d.r1x*this.nx+d.r1y*this.ny);d.tMass=o<v.epsilon*v.epsilon?0:1/o;o=c+this.b2.sinertia*Qf.sqr(this.ny*d.r2x-this.nx*d.r2y);o+=this.b1.sinertia*Qf.sqr(this.ny*d.r1x-this.nx*d.r1y);d.nMass=o<v.epsilon*v.epsilon?0:1/o;var j=o=0,k=this.b2.angvel+this.b2.kinangvel,o=this.b2.velx+this.b2.kinvelx-d.r2y*
k,j=this.b2.vely+this.b2.kinvely+d.r2x*k,k=this.b1.angvel+this.b1.kinangvel,o=o-(this.b1.velx+this.b1.kinvelx-d.r1y*k),j=j-(this.b1.vely+this.b1.kinvely+d.r1x*k),k=this.nx*o+this.ny*j;h.elasticity=this.restitution;d.bounce=k*h.elasticity;d.bounce>-v.elasticThreshold&&(d.bounce=0);k=j*this.nx-o*this.ny;o=v.staticFrictionThreshold;d.friction=k*k>o*o?this.dyn_fric:this.stat_fric;d.jnAcc*=b;d.jtAcc*=b}e!=h.active&&(this.contacts.modified=!0);d=i;e=f;f=f.next;i=i.next}}this.hc2?(this.hpc2=!0,this.oc1.posOnly?
(f=this.c1,this.c1=this.c2,this.c2=f,f=this.oc1,this.oc1=this.oc2,this.oc2=f,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;this.jrAcc*=b;a||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+
this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel));this.hc2&&(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=
c+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=c+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=c+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<v.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)?(this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc,b=this.kMassa*this.kMassc-this.kMassb*
this.kMassb,b!=b?(this.kMassa=this.kMassb=this.kMassc=0,3):0==b?(b=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,b|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,b|=2),this.kMassb=0,b):(b=1/b,c=this.kMassc*b,this.kMassc=this.kMassa*b,this.kMassa=c,this.kMassb*=-b,0)):(this.hc2=!1,this.oc2.dist<this.oc1.dist&&(b=this.c1,this.c1=this.c2,this.c2=b),this.oc2.active=!1,this.contacts.modified=!0));this.surfacex=this.b2.svelx;this.surfacey=this.b2.svely;this.surfacex+=1*this.b1.svelx;
this.surfacey+=1*this.b1.svely;this.surfacex=-this.surfacex;this.surfacey=-this.surfacey;this.rMass=this.b1.sinertia+this.b2.sinertia;0!=this.rMass&&(this.rMass=1/this.rMass);return a},warmStart:function(){var a=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,b=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,c=this.b1.imass;this.b1.velx-=a*c;this.b1.vely-=b*c;this.b1.angvel-=this.b1.iinertia*(b*this.c1.r1x-a*this.c1.r1y);c=this.b2.imass;this.b2.velx+=a*c;this.b2.vely+=b*c;this.b2.angvel+=this.b2.iinertia*
(b*this.c1.r2x-a*this.c1.r2y);this.hc2&&(a=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,b=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,c=this.b1.imass,this.b1.velx-=a*c,this.b1.vely-=b*c,this.b1.angvel-=this.b1.iinertia*(b*this.c2.r1x-a*this.c2.r1y),c=this.b2.imass,this.b2.velx+=a*c,this.b2.vely+=b*c,this.b2.angvel+=this.b2.iinertia*(b*this.c2.r2x-a*this.c2.r2y));this.b2.angvel+=this.jrAcc*this.b2.iinertia;this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var a,b,c,d,e;d=this.k1x+
this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);var f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);c=(f*this.nx-d*this.ny+this.surfacex)*this.c1.tMass;d=this.c1.friction*this.c1.jnAcc;a=this.c1.jtAcc;e=a-c;e>d?e=d:e<-d&&(e=-d);c=e-a;this.c1.jtAcc=e;a=-this.ny*c;b=this.nx*c;this.b2.velx+=a*this.b2.imass;this.b2.vely+=b*this.b2.imass;this.b1.velx-=a*this.b1.imass;this.b1.vely-=b*this.b1.imass;this.b2.angvel+=this.rt1b*c*
this.b2.iinertia;this.b1.angvel-=this.rt1a*c*this.b1.iinertia;this.hc2?(e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=(b*this.nx-e*this.ny+this.surfacex)*this.c2.tMass,d=this.c2.friction*this.c2.jnAcc,a=this.c2.jtAcc,e=a-c,e>d?e=d:e<-d&&(e=-d),c=e-a,this.c2.jtAcc=e,a=-this.ny*c,b=this.nx*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=
a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rt2b*c*this.b2.iinertia,this.b1.angvel-=this.rt2a*c*this.b1.iinertia,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),
c=this.c1.jnAcc,a=this.c2.jnAcc,d=d*this.nx+f*this.ny+this.surfacey+this.c1.bounce-(this.Ka*c+this.Kb*a),e=e*this.nx+b*this.ny+this.surfacey+this.c2.bounce-(this.Kb*c+this.Kc*a),b=-(this.kMassa*d+this.kMassb*e),f=-(this.kMassb*d+this.kMassc*e),0<=b&&0<=f?(d=b-c,e=f-a,this.c1.jnAcc=b,this.c2.jnAcc=f):(b=-this.c1.nMass*d,0<=b&&0<=this.Kb*b+e?(d=b-c,e=-a,this.c1.jnAcc=b,this.c2.jnAcc=0):(f=-this.c2.nMass*e,0<=f&&0<=this.Kb*f+d?(d=-c,e=f-a,this.c1.jnAcc=0,this.c2.jnAcc=f):0<=d&&0<=e?(d=-c,e=-a,this.c1.jnAcc=
this.c2.jnAcc=0):e=d=0)),c=d+e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=(this.rn1b*d+this.rn2b*e)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*d+this.rn2a*e)*this.b1.iinertia):(0!=this.radius&&(c=(this.b2.angvel-this.b1.angvel)*this.rMass,d=this.rfric*this.c1.jnAcc,a=this.jrAcc,this.jrAcc-=c,this.jrAcc>d?this.jrAcc=d:this.jrAcc<-d&&(this.jrAcc=-d),c=this.jrAcc-a,this.b2.angvel+=c*
this.b2.iinertia,this.b1.angvel-=c*this.b1.iinertia),d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),c=(this.c1.bounce+(this.nx*d+this.ny*f)+this.surfacey)*this.c1.nMass,a=this.c1.jnAcc,e=a-c,0>e&&(e=0),c=e-a,this.c1.jnAcc=e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,
this.b2.angvel+=this.rn1b*c*this.b2.iinertia,this.b1.angvel-=this.rn1a*c*this.b1.iinertia)},applyImpulsePos:function(){if(2==this.ptype){var a=this.c1,b=0,c=0,b=this.b2.axisy*a.lr2x-this.b2.axisx*a.lr2y,c=a.lr2x*this.b2.axisx+a.lr2y*this.b2.axisy,b=b+1*this.b2.posx,c=c+1*this.b2.posy,d=0,e=0,d=this.b1.axisy*a.lr1x-this.b1.axisx*a.lr1y,e=a.lr1x*this.b1.axisx+a.lr1y*this.b1.axisy,d=d+1*this.b1.posx,e=e+1*this.b1.posy,f=a=0,a=b-d,f=c-e,i=Math.sqrt(a*a+f*f),g=this.radius-v.collisionSlop,h=i-g;0>a*this.nx+
f*this.ny&&(a=-a,f=-f,h-=this.radius);0>h&&(i<v.epsilon?0!=this.b1.smass?this.b1.posx+=10*v.epsilon:this.b2.posx+=10*v.epsilon:(h=1/i,a*=h,f*=h,b=0.5*(d+b),c=0.5*(e+c),d=b-this.b1.posx,e=c-this.b1.posy,b-=this.b2.posx,c-=this.b2.posy,d=f*d-a*e,b=f*b-a*c,c=this.b2.smass+b*b*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia,0!=c&&(i=-this.biasCoef*(i-g)/c,c=g=0,g=a*i,c=f*i,a=this.b1.imass,this.b1.posx-=g*a,this.b1.posy-=c*a,this.b1.delta_rot(-d*this.b1.iinertia*i),a=this.b2.imass,this.b2.posx+=g*
a,this.b2.posy+=c*a,this.b2.delta_rot(b*this.b2.iinertia*i))))}else{var j=h=f=a=0,e=b=0;0==this.ptype?(a=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,f=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,g=this.lproj+(a*this.b1.posx+f*this.b1.posy),h=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,j=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,h+=1*this.b2.posx,j+=1*this.b2.posy,this.hpc2&&(b=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b2.axisx+
this.c2.lr1y*this.b2.axisy,b+=1*this.b2.posx,e+=1*this.b2.posy)):(a=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,f=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,g=this.lproj+(a*this.b2.posx+f*this.b2.posy),h=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,j=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,h+=1*this.b1.posx,j+=1*this.b1.posy,this.hpc2&&(b=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,b+=1*this.b1.posx,
e+=1*this.b1.posy));i=h*a+j*f-g-this.radius;i+=v.collisionSlop;c=0;this.hpc2&&(c=b*a+e*f-g-this.radius,c+=v.collisionSlop);if(0>i||0>c){this.rev&&(a=-a,f=-f);var k=0,l=0,k=h-this.b1.posx,l=j-this.b1.posy,d=g=0,g=h-this.b2.posx,d=j-this.b2.posy,m=0,n=0,j=h=0;if(this.hpc2){m=b-this.b1.posx;n=e-this.b1.posy;h=b-this.b2.posx;j=e-this.b2.posy;b=f*k-a*l;g=f*g-a*d;e=f*m-a*n;d=f*h-a*j;h=this.b1.smass+this.b2.smass;this.kMassa=h+this.b1.sinertia*b*b+this.b2.sinertia*g*g;this.kMassb=h+this.b1.sinertia*b*e+
this.b2.sinertia*g*d;this.kMassc=h+this.b1.sinertia*e*e+this.b2.sinertia*d*d;k=j=h=0;h=this.kMassa;j=this.kMassb;k=this.kMassc;l=i*this.biasCoef;m=c*this.biasCoef;c=i=0;i=-l;c=-m;n=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(n!=n)i=c=0;else if(0==n)i=0!=this.kMassa?i/this.kMassa:0,c=0!=this.kMassc?c/this.kMassc:0;else var n=1/n,p=n*(this.kMassc*i-this.kMassb*c),c=n*(this.kMassa*c-this.kMassb*i),i=p;0<=i&&0<=c?(h=(i+c)*this.b1.imass,this.b1.posx-=a*h,this.b1.posy-=f*h,this.b1.delta_rot(-this.b1.iinertia*
(b*i+e*c)),b=(i+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(g*i+d*c))):(i=-l/h,c=0,0<=i&&0<=j*i+m?(h=(i+c)*this.b1.imass,this.b1.posx-=a*h,this.b1.posy-=f*h,this.b1.delta_rot(-this.b1.iinertia*(b*i+e*c)),b=(i+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(g*i+d*c))):(i=0,c=-m/k,0<=c&&0<=j*c+l&&(h=(i+c)*this.b1.imass,this.b1.posx-=a*h,this.b1.posy-=f*h,this.b1.delta_rot(-this.b1.iinertia*(b*i+e*c)),b=(i+c)*this.b2.imass,
this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(g*i+d*c)))))}else b=f*k-a*l,g=f*g-a*d,c=this.b2.smass+g*g*this.b2.sinertia+this.b1.smass+b*b*this.b1.sinertia,0!=c&&(i=-this.biasCoef*i/c,d=c=0,c=a*i,d=f*i,a=this.b1.imass,this.b1.posx-=c*a,this.b1.posy-=d*a,this.b1.delta_rot(-b*this.b1.iinertia*i),a=this.b2.imass,this.b2.posx+=c*a,this.b2.posy+=d*a,this.b2.delta_rot(g*this.b2.iinertia*i))}}},__class__:qb});var Gb=function(){this.length=0;this._inuse=this.modified=this.pushmod=
!1;this.next=null;this.dist=this.elasticity=0;this.fresh=!1;this.stamp=this.hash=0;this.active=this.posOnly=!1;this.arbiter=this.inner=null;this.px=this.py=0;this.outer=null;this.inner=new gi};h["zpp_nape.dynamics.ZPP_Contact"]=Gb;Gb.__name__=["zpp_nape","dynamics","ZPP_Contact"];Gb.prototype={wrapper:function(){null==this.outer&&(Gb.internal=!0,this.outer=new cj,Gb.internal=!1,this.outer.zpp_inner=this);return this.outer},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=
!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Gb};
var gi=function(){this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.r1x=this.r1y=this.r2x=this.r2y=this.nMass=this.tMass=this.bounce=this.friction=this.jnAcc=this.jtAcc=this.lr1x=this.lr1y=this.lr2x=this.lr2y=0};h["zpp_nape.dynamics.ZPP_IContact"]=gi;gi.__name__=["zpp_nape","dynamics","ZPP_IContact"];gi.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_pop:function(){var a=
this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:gi};var tb=function(){this.collisionGroup=this.collisionMask=this.sensorGroup=this.sensorMask=this.fluidGroup=this.fluidMask=0;this.next=this.outer=this.shapes=
null;this.shapes=new Ye;this.collisionGroup=this.sensorGroup=this.fluidGroup=1;this.collisionMask=this.sensorMask=this.fluidMask=-1};h["zpp_nape.dynamics.ZPP_InteractionFilter"]=tb;tb.__name__=["zpp_nape","dynamics","ZPP_InteractionFilter"];tb.prototype={wrapper:function(){if(null==this.outer){this.outer=new dj;var a=this.outer.zpp_inner;a.outer=null;a.next=tb.zpp_pool;tb.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},shouldCollide:function(a){return 0!=(this.collisionMask&a.collisionGroup)&&
0!=(a.collisionMask&this.collisionGroup)},shouldSense:function(a){return 0!=(this.sensorMask&a.sensorGroup)&&0!=(a.sensorMask&this.sensorGroup)},shouldFlow:function(a){return 0!=(this.fluidMask&a.fluidGroup)&&0!=(a.fluidMask&this.fluidGroup)},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_filter(),a=a.next},__class__:tb};var Hk=function(){this.depth=0;this.group=this.interactors=null;this.ignore=!1;this.outer=null};h["zpp_nape.dynamics.ZPP_InteractionGroup"]=Hk;Hk.__name__=
["zpp_nape","dynamics","ZPP_InteractionGroup"];Hk.prototype={__class__:Hk};var la=function(){this.wrap_max=null;this.maxx=this.maxy=0;this.wrap_min=null;this.minx=this.miny=0;this.outer=this.next=null;this._immutable=!1;this._invalidate=this._validate=null};h["zpp_nape.geom.ZPP_AABB"]=la;la.__name__=["zpp_nape","geom","ZPP_AABB"];la.get=function(a,b,c,d){var e;null==la.zpp_pool?e=new la:(e=la.zpp_pool,la.zpp_pool=e.next,e.next=null);null;e.minx=a;e.miny=b;e.maxx=c;e.maxy=d;return e};la.prototype=
{validate:function(){null!=this._validate&&this._validate()},perimeter:function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},intersectY:function(a){return!(a.miny>this.maxy||this.miny>a.maxy)},intersect:function(a){return a.miny<=this.maxy&&this.miny<=a.maxy&&a.minx<=this.maxx&&this.minx<=a.maxx},combine:function(a){a.minx<this.minx&&(this.minx=a.minx);a.maxx>this.maxx&&(this.maxx=a.maxx);a.miny<this.miny&&(this.miny=a.miny);a.maxy>this.maxy&&(this.maxy=a.maxy)},contains:function(a){return a.minx>=
this.minx&&a.miny>=this.miny&&a.maxx<=this.maxx&&a.maxy<=this.maxy},setCombine:function(a,b){this.minx=a.minx<b.minx?a.minx:b.minx;this.miny=a.miny<b.miny?a.miny:b.miny;this.maxx=a.maxx>b.maxx?a.maxx:b.maxx;this.maxy=a.maxy>b.maxy?a.maxy:b.maxy},setExpand:function(a,b){this.minx=a.minx-b;this.miny=a.miny-b;this.maxx=a.maxx+b;this.maxy=a.maxy+b},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},__class__:la};var Rf=function(){this.length=
0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Vec2"]=Rf;Rf.__name__=["zpp_nape","util","ZNPList_ZPP_Vec2"];Rf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Na.zpp_pool?b=new Na:(b=Na.zpp_pool,Na.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Na.zpp_pool?c=new Na:(c=
Na.zpp_pool,Na.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Na.zpp_pool;Na.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},
erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Na.zpp_pool;Na.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Rf};var J=function(){};
h["zpp_nape.geom.ZPP_Collide"]=J;J.__name__=["zpp_nape","geom","ZPP_Collide"];J.contactCollide=function(a,b,c,d){if(b.type==g.id_ShapeType_POLYGON)if(a.type==g.id_ShapeType_POLYGON){for(var e=!0,f=-1.0E100,i=-1,h=null,j=null,k=a.polygon.edges.head;null!=k;){for(var l=k.elt,m=1.0E100,n=b.polygon.gverts.next;null!=n;){var p=n,p=l.gnormx*p.x+l.gnormy*p.y;p<m&&(m=p);if(m-l.gprojection<=f)break;n=n.next}m-=l.gprojection;if(0<=m){e=!1;break}m>f&&(f=m,h=l,i=1);k=k.next}if(e){for(k=b.polygon.edges.head;null!=
k;){l=k.elt;m=1.0E100;for(n=a.polygon.gverts.next;null!=n;){p=n;p=l.gnormx*p.x+l.gnormy*p.y;p<m&&(m=p);if(m-l.gprojection<=f)break;n=n.next}m-=l.gprojection;if(0<=m){e=!1;break}m>f&&(f=m,j=l,i=2);k=k.next}if(e){1==i?(a=b.polygon,b=h,j=1):(a=a.polygon,b=j,j=-1);h=null;e=1.0E100;for(f=a.edges.head;null!=f;)k=f.elt,l=b.gnormx*k.gnormx+b.gnormy*k.gnormy,l<e&&(e=l,h=k),f=f.next;var f=e=0,e=h.gp0.x,f=h.gp0.y,l=k=0,k=h.gp1.x,l=h.gp1.y,n=m=0,m=k-e,n=l-f,q=b.gnormy*e-b.gnormx*f,p=b.gnormy*k-b.gnormx*l,r=1/
(p-q),q=(-b.tp1-q)*r;q>v.epsilon&&(e+=m*q,f+=n*q);p=(-b.tp0-p)*r;p<-v.epsilon&&(k+=m*p,l+=n*p);n=m=0;n=j;m=b.gnormx*n;n*=b.gnormy;c.lnormx=b.lnormx;c.lnormy=b.lnormy;c.lproj=b.lprojection;c.radius=0;c.rev=d!=(-1==j);c.ptype=c.rev?1:0;p=e*b.gnormx+f*b.gnormy-b.gprojection;j=k*b.gnormx+l*b.gnormy-b.gprojection;if(0<p&&0<j)return!1;d&&(m=-m,n=-n);d=c.injectContact(e-0.5*b.gnormx*p,f-0.5*b.gnormy*p,m,n,p,c.rev?1:0,0<p);e-=1*a.body.posx;f-=1*a.body.posy;d.inner.lr1x=e*a.body.axisy+f*a.body.axisx;d.inner.lr1y=
f*a.body.axisy-e*a.body.axisx;d=c.injectContact(k-0.5*b.gnormx*j,l-0.5*b.gnormy*j,m,n,j,c.rev?0:1,0<j);k-=1*a.body.posx;l-=1*a.body.posy;d.inner.lr1x=k*a.body.axisy+l*a.body.axisx;d.inner.lr1y=l*a.body.axisy-k*a.body.axisx;1==i?(c.__ref_edge1=b,c.__ref_edge2=h):(c.__ref_edge2=b,c.__ref_edge1=h);return!0}}}else{j=-1.0E100;h=!0;e=i=null;f=b.polygon.gverts.next;for(k=b.polygon.edges.head;null!=k;){l=k.elt;m=l.gnormx*a.circle.worldCOMx+l.gnormy*a.circle.worldCOMy-l.gprojection-a.circle.radius;if(0<m){h=
!1;break}m>j&&(j=m,i=l,e=f);f=f.next;k=k.next}if(h){h=e;e=null==e.next?b.polygon.gverts.next:e.next;f=a.circle.worldCOMy*i.gnormx-a.circle.worldCOMx*i.gnormy;if(f<=h.y*i.gnormx-h.x*i.gnormy)return j=a.circle.radius,f=e=0,e=h.x-a.circle.worldCOMx,f=h.y-a.circle.worldCOMy,k=e*e+f*f,k>j*j?j=null:k<v.epsilon*v.epsilon?j=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-j,0,null):(k=1/Math.sqrt(k),l=k<v.epsilon?1.0E100:1/k,m=0.5+(a.circle.radius-0.5*j)*k,j=d?c.injectContact(a.circle.worldCOMx+
e*m,a.circle.worldCOMy+f*m,-e*k,-f*k,l-j,0,null):c.injectContact(a.circle.worldCOMx+e*m,a.circle.worldCOMy+f*m,e*k,f*k,l-j,0,null)),null!=j&&(e=j.inner,c.ptype=2,k=f=0,f=h.x-b.polygon.body.posx,k=h.y-b.polygon.body.posy,c.__ref_edge1=i,c.__ref_vertex=-1,d?(e.lr1x=f*b.polygon.body.axisy+k*b.polygon.body.axisx,e.lr1y=k*b.polygon.body.axisy-f*b.polygon.body.axisx,e.lr2x=a.circle.localCOMx,e.lr2y=a.circle.localCOMy):(e.lr2x=f*b.polygon.body.axisy+k*b.polygon.body.axisx,e.lr2y=k*b.polygon.body.axisy-f*
b.polygon.body.axisx,e.lr1x=a.circle.localCOMx,e.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=j;if(f>=e.y*i.gnormx-e.x*i.gnormy)return h=a.circle.radius,f=j=0,j=e.x-a.circle.worldCOMx,f=e.y-a.circle.worldCOMy,k=j*j+f*f,k>h*h?h=null:k<v.epsilon*v.epsilon?h=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-h,0,null):(k=1/Math.sqrt(k),l=k<v.epsilon?1.0E100:1/k,m=0.5+(a.circle.radius-0.5*h)*k,h=d?c.injectContact(a.circle.worldCOMx+j*m,a.circle.worldCOMy+f*m,-j*k,-f*k,l-h,0,null):
c.injectContact(a.circle.worldCOMx+j*m,a.circle.worldCOMy+f*m,j*k,f*k,l-h,0,null)),null!=h&&(j=h.inner,c.ptype=2,k=f=0,f=e.x-b.polygon.body.posx,k=e.y-b.polygon.body.posy,c.__ref_edge1=i,c.__ref_vertex=1,d?(j.lr1x=f*b.polygon.body.axisy+k*b.polygon.body.axisx,j.lr1y=k*b.polygon.body.axisy-f*b.polygon.body.axisx,j.lr2x=a.circle.localCOMx,j.lr2y=a.circle.localCOMy):(j.lr2x=f*b.polygon.body.axisy+k*b.polygon.body.axisx,j.lr2y=k*b.polygon.body.axisy-f*b.polygon.body.axisx,j.lr1x=a.circle.localCOMx,j.lr1y=
a.circle.localCOMy),c.radius=a.circle.radius),null!=h;h=b=0;h=a.circle.radius+0.5*j;b=i.gnormx*h;h*=i.gnormy;f=e=0;e=a.circle.worldCOMx-b;f=a.circle.worldCOMy-h;b=d?c.injectContact(e,f,i.gnormx,i.gnormy,j,0,null):c.injectContact(e,f,-i.gnormx,-i.gnormy,j,0,null);c.ptype=d?0:1;c.lnormx=i.lnormx;c.lnormy=i.lnormy;c.rev=!d;c.lproj=i.lprojection;c.radius=a.circle.radius;b.inner.lr1x=a.circle.localCOMx;b.inner.lr1y=a.circle.localCOMy;c.__ref_edge1=i;c.__ref_vertex=0;return!0}}else if(i=a.circle.radius+
b.circle.radius,j=h=0,h=b.circle.worldCOMx-a.circle.worldCOMx,j=b.circle.worldCOMy-a.circle.worldCOMy,e=h*h+j*j,e>i*i?i=null:e<v.epsilon*v.epsilon?i=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-i,0,null):(e=1/Math.sqrt(e),f=e<v.epsilon?1.0E100:1/e,k=0.5+(a.circle.radius-0.5*i)*e,i=d?c.injectContact(a.circle.worldCOMx+h*k,a.circle.worldCOMy+j*k,-h*e,-j*e,f-i,0,null):c.injectContact(a.circle.worldCOMx+h*k,a.circle.worldCOMy+j*k,h*e,j*e,f-i,0,null)),null!=i)return i=i.inner,d?(i.lr1x=b.circle.localCOMx,
i.lr1y=b.circle.localCOMy,i.lr2x=a.circle.localCOMx,i.lr2y=a.circle.localCOMy):(i.lr1x=a.circle.localCOMx,i.lr1y=a.circle.localCOMy,i.lr2x=b.circle.localCOMx,i.lr2y=b.circle.localCOMy),c.radius=a.circle.radius+b.circle.radius,c.ptype=2,!0;return!1};J.testCollide_safe=function(a,b){if(b.type==g.id_ShapeType_CIRCLE)var c=a,a=b,b=c;return J.testCollide(a,b)};J.testCollide=function(a,b){if(b.type==g.id_ShapeType_POLYGON){if(a.type==g.id_ShapeType_POLYGON){for(var c=!0,d=a.polygon.edges.head;null!=d;){for(var e=
d.elt,f=1.0E100,i=b.polygon.gverts.next;null!=i;){var h=i,h=e.gnormx*h.x+e.gnormy*h.y;h<f&&(f=h);i=i.next}f-=e.gprojection;if(0<f){c=!1;break}d=d.next}if(c){for(d=b.polygon.edges.head;null!=d;){e=d.elt;f=1.0E100;for(i=a.polygon.gverts.next;null!=i;)h=i,h=e.gnormx*h.x+e.gnormy*h.y,h<f&&(f=h),i=i.next;f-=e.gprojection;if(0<f){c=!1;break}d=d.next}return c}}else{d=c=null;e=!0;f=-1.0E100;i=b.polygon.gverts.next;for(h=b.polygon.edges.head;null!=h;){var j=h.elt,k=j.gnormx*a.circle.worldCOMx+j.gnormy*a.circle.worldCOMy-
j.gprojection-a.circle.radius;if(0<k){e=!1;break}k>f&&(f=k,c=j,d=i);i=i.next;h=h.next}if(e){e=d;d=null==d.next?b.polygon.gverts.next:d.next;f=a.circle.worldCOMy*c.gnormx-a.circle.worldCOMx*c.gnormy;if(f<=e.y*c.gnormx-e.x*c.gnormy)return c=a.circle.radius,f=d=0,d=e.x-a.circle.worldCOMx,f=e.y-a.circle.worldCOMy,d*d+f*f<=c*c;return f>=d.y*c.gnormx-d.x*c.gnormy?(c=a.circle.radius,f=e=0,e=d.x-a.circle.worldCOMx,f=d.y-a.circle.worldCOMy,e*e+f*f<=c*c):!0}}return!1}c=a.circle.radius+b.circle.radius;e=d=0;
d=b.circle.worldCOMx-a.circle.worldCOMx;e=b.circle.worldCOMy-a.circle.worldCOMy;return d*d+e*e<=c*c};J.flowCollide=function(a,b,c){if(b.type==g.id_ShapeType_POLYGON){if(a.type==g.id_ShapeType_POLYGON){for(var d=[],e=[],f=!0,i=!0,h=a.polygon.edges.head;null!=h;){for(var j=h.elt,k=1.0E100,l=0,m=b.polygon.gverts.next;null!=m;){var n=m,p=j.gnormx*n.x+j.gnormy*n.y;p<k&&(k=p);p>=j.gprojection+v.epsilon&&(e[l]=!0,i=!1);l++;m=m.next}k-=j.gprojection;if(0<k){f=!1;break}h=h.next}if(i)return b.polygon.validate_worldCOM(),
c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;if(f){for(var i=!0,q=b.polygon.edges.head;null!=q;){for(var r=q.elt,t=1.0E100,u=0,s=a.polygon.gverts.next;null!=s;){var w=s,x=r.gnormx*w.x+r.gnormy*w.y;x<t&&(t=x);x>=r.gprojection+v.epsilon&&(d[u]=!0,i=!1);u++;s=s.next}t-=r.gprojection;if(0<t){f=!1;break}q=q.next}if(i)return a.polygon.validate_worldCOM(),c.overlap=a.polygon.area,c.centroidx=a.polygon.worldCOMx,c.centroidy=a.polygon.worldCOMy,null,!0;if(f){for(;null!=
J.flowpoly.head;){var D=J.flowpoly.pop_unsafe();if(!D._inuse){var B=D;null!=B.outer&&(B.outer.zpp_inner=null,B.outer=null);B._isimmutable=null;B._validate=null;B._invalidate=null;B.next=ja.zpp_pool;ja.zpp_pool=B}}for(var z=null,A=!1,C=a.polygon.gverts.next,F=0,E=b.polygon.gverts.next,G=0,M=0,K=b.polygon.edgeCnt;M<K;){var O=M++;if(e[O])E=E.next;else{G=O;break}}if(null==E){for(var E=b.polygon.gverts.next,A=!0,Q=0,S=a.polygon.edgeCnt;Q<S;){var W=Q++;if(d[W])C=C.next;else{F=W;break}}null==C?C=a.polygon.gverts.next:
(J.flowpoly.add(C),z=J.flowpoly.head.elt)}else J.flowpoly.add(E),z=J.flowpoly.head.elt;var N=1;if(null==J.flowpoly.head){for(var aa=!0,V=a.polygon.gverts.next,I=V,X=V.next;null!=X;){for(var U=X,Z=2,ca=b.polygon.gverts.next,L=ca,ba=ca.next;null!=ba;){var ga=ba,ka=0;(function(){var a=0,b=0,a=I.x-L.x,b=I.y-L.y,c=0,d=0,c=U.x-I.x,d=U.y-I.y,e=0,f=0,e=ga.x-L.x,f=ga.y-L.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(ka=e,a=!0):
a=!1):a=!1):a=!1;return a})(this)&&ka<Z&&(Z=ka,E=ca);ca=ba;L=ga;ba=ba.next}var da=ba=b.polygon.gverts.next,ia=0;(function(){var a=0,b=0,a=I.x-L.x,b=I.y-L.y,c=0,d=0,c=U.x-I.x,d=U.y-I.y,e=0,f=0,e=da.x-L.x,f=da.y-L.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(ia=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&ia<Z&&(Z=ia,E=ca);if(2!=Z){var oa=0,pa=0,na=Z,oa=I.x+(U.x-I.x)*na,pa=I.y+(U.y-I.y)*na,z=ja.get(oa,pa,null);J.flowpoly.add(z);
A=!0;C=V;aa=!1;break}V=X;I=U;X=X.next}if(aa){for(var T=X=a.polygon.gverts.next,y=2,ha=b.polygon.gverts.next,R=ha,ma=ha.next;null!=ma;){var va=ma,Zk=0;(function(){var a=0,b=0,a=I.x-R.x,b=I.y-R.y,c=0,d=0,c=T.x-I.x,d=T.y-I.y,e=0,f=0,e=va.x-R.x,f=va.y-R.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(Zk=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&Zk<y&&(y=Zk,E=ha);ha=ma;R=va;ma=ma.next}var za=ma=b.polygon.gverts.next,fa=0;(function(){var a=
0,b=0,a=I.x-R.x,b=I.y-R.y,c=0,d=0,c=T.x-I.x,d=T.y-I.y,e=0,f=0,e=za.x-R.x,f=za.y-R.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(fa=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&fa<y&&(y=fa,E=ha);if(2!=y){var Y=0,ta=0,Ba=y,Y=I.x+(T.x-I.x)*Ba,ta=I.y+(T.y-I.y)*Ba,z=ja.get(Y,ta,null);J.flowpoly.add(z);A=!0;C=V}}N=2}for(;;)if(A)if(C=C.next,F++,null==C&&(C=a.polygon.gverts.next,F=0),d[F]){var ua=J.flowpoly.head.elt,ea=C,sa=E,
xa=E.next;null==xa&&(xa=b.polygon.gverts.next);var Da=-1,ra=null,Ka=0,Fa=0,Ja=xa,P=xa;do{var ab=P,Oa=0;if(function(){var a=0,b=0,a=sa.x-ua.x,b=sa.y-ua.y,c=0,d=0,c=ab.x-sa.x,d=ab.y-sa.y,e=0,f=0,e=ea.x-ua.x,f=ea.y-ua.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(Oa=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Oa>=Da)if(ra=E,Ka=G,++Fa==N){Da=Oa;P=Ja;break}else Da=Oa;sa=ab;E=P;G++;G>=b.polygon.edgeCnt&&(G=0);P=P.next;null==
P&&(P=b.polygon.gverts.next)}while(0);for(;P!=Ja;){var Va=P,Ua=0;if(function(){var a=0,b=0,a=sa.x-ua.x,b=sa.y-ua.y,c=0,d=0,c=Va.x-sa.x,d=Va.y-sa.y,e=0,f=0,e=ea.x-ua.x,f=ea.y-ua.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(Ua=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Ua>=Da)if(ra=E,Ka=G,++Fa==N){Da=Ua;P=Ja;break}else Da=Ua;sa=Va;E=P;G++;G>=b.polygon.edgeCnt&&(G=0);P=P.next;null==P&&(P=b.polygon.gverts.next)}if(null==
ra)break;var La=ra,Ta=ra.next;null==Ta&&(Ta=b.polygon.gverts.next);var la=Ta,Ra=0,$k=0,Ya=Da,Ra=La.x+(la.x-La.x)*Ya,$k=La.y+(la.y-La.y)*Ya;if(null!=z&&Tb.vec_dsq(Ra,$k,z.x,z.y)<v.epsilon)break;J.flowpoly.add(ja.get(Ra,$k,null));null==z&&(z=J.flowpoly.head.elt);E=ra;G=Ka;A=!A;N=2}else{var ib=C;if(null!=z&&Tb.vec_dsq(ib.x,ib.y,z.x,z.y)<v.epsilon)break;J.flowpoly.add(ib);null==z&&(z=J.flowpoly.head.elt);N=1}else if(E=E.next,G++,null==E&&(E=b.polygon.gverts.next,G=0),e[G]){var Ea=J.flowpoly.head.elt,
$a=E,H=C,db=C.next;null==db&&(db=a.polygon.gverts.next);var Pa=-1,Qa=null,fb=0,pb=0,bb=db,wd=db;do{var lb=wd,Za=0;if(function(){var a=0,b=0,a=H.x-Ea.x,b=H.y-Ea.y,c=0,d=0,c=lb.x-H.x,d=lb.y-H.y,e=0,f=0,e=$a.x-Ea.x,f=$a.y-Ea.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(Za=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Za>=Pa)if(Qa=C,fb=F,++pb==N){Pa=Za;wd=bb;break}else Pa=Za;H=lb;C=wd;F++;F>=a.polygon.edgeCnt&&(F=0);wd=wd.next;
null==wd&&(wd=a.polygon.gverts.next)}while(0);for(;wd!=bb;){var Ze=wd,Sa=0;if(function(){var a=0,b=0,a=H.x-Ea.x,b=H.y-Ea.y,c=0,d=0,c=Ze.x-H.x,d=Ze.y-H.y,e=0,f=0,e=$a.x-Ea.x,f=$a.y-Ea.y,i=d*e-c*f;i*i>v.epsilon*v.epsilon?(i=1/i,e=(f*a-e*b)*i,e>v.epsilon&&e<1-v.epsilon?(a=(d*a-c*b)*i,a>v.epsilon&&a<1-v.epsilon?(Sa=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Sa>=Pa)if(Qa=C,fb=F,++pb==N){Pa=Sa;wd=bb;break}else Pa=Sa;H=Ze;C=wd;F++;F>=a.polygon.edgeCnt&&(F=0);wd=wd.next;null==wd&&(wd=a.polygon.gverts.next)}if(null==
Qa)break;var cb=Qa,nb=Qa.next;null==nb&&(nb=a.polygon.gverts.next);var yb=nb,gb=0,sb=0,Ab=Pa,gb=cb.x+(yb.x-cb.x)*Ab,sb=cb.y+(yb.y-cb.y)*Ab;if(null!=z&&Tb.vec_dsq(gb,sb,z.x,z.y)<v.epsilon)break;J.flowpoly.add(ja.get(gb,sb,null));null==z&&(z=J.flowpoly.head.elt);C=Qa;F=fb;A=!A;N=2}else{var tb=E;if(null!=z&&Tb.vec_dsq(tb.x,tb.y,z.x,z.y)<v.epsilon)break;J.flowpoly.add(tb);null==z&&(z=J.flowpoly.head.elt);N=1}if(null!=J.flowpoly.head&&null!=J.flowpoly.head.next&&null!=J.flowpoly.head.next.next){for(var ve=
0,Ga=0,Ma=0,ve=Ma=Ga=0,xd=J.flowpoly.head,Aa=xd.elt,xd=xd.next,jb=xd.elt,xd=xd.next;null!=xd;)var Wa=xd.elt,ve=ve+jb.x*(Wa.y-Aa.y),Fb=Wa.y*jb.x-Wa.x*jb.y,Ga=Ga+(jb.x+Wa.x)*Fb,Ma=Ma+(jb.y+Wa.y)*Fb,Aa=jb,jb=Wa,xd=xd.next;var xd=J.flowpoly.head,hi=xd.elt,ve=ve+jb.x*(hi.y-Aa.y),Gb=hi.y*jb.x-hi.x*jb.y,Ga=Ga+(jb.x+hi.x)*Gb,Ma=Ma+(jb.y+hi.y)*Gb,Aa=jb,jb=hi,xd=xd.next,eb=xd.elt,ve=ve+jb.x*(eb.y-Aa.y),Hb=eb.y*jb.x-eb.x*jb.y,Ga=Ga+(jb.x+eb.x)*Hb,Ma=Ma+(jb.y+eb.y)*Hb,ve=0.5*ve,Jb=1/(6*ve),Ga=Ga*Jb,Ma=Ma*Jb;
c.overlap=-ve;c.centroidx=Ga;c.centroidy=Ma;null;return!0}}}return!1}for(var zb=[],Kb=!0,hb=null,rb=null,Lb=-1.0E100,Nb=!0,Eb=b.polygon.gverts.next,Sb=0,ub=b.polygon.edges.head;null!=ub;){var ob=ub.elt,qb=ob.gnormx*a.circle.worldCOMx+ob.gnormy*a.circle.worldCOMy;if(qb>ob.gprojection+a.circle.radius){Nb=!1;break}else qb+a.circle.radius>ob.gprojection+v.epsilon&&(Kb=!1,zb[Sb]=!0);qb-=ob.gprojection+a.circle.radius;qb>Lb&&(Lb=qb,hb=ob,rb=Eb);Eb=Eb.next;Sb++;ub=ub.next}if(Nb){if(Kb)return c.overlap=a.circle.area,
c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0;var xb=rb,kb;kb=null==rb.next?b.polygon.gverts.next:rb.next;var bc=a.circle.worldCOMy*hb.gnormx-a.circle.worldCOMx*hb.gnormy;if(bc<=xb.y*hb.gnormx-xb.x*hb.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=xb.x-a.circle.worldCOMx,d=xb.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):bc>=kb.y*hb.gnormx-kb.x*hb.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=kb.x-a.circle.worldCOMx,d=kb.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):
1){for(var Db=[],Qb=0,dc=!0,wa=null,Na=0,wb=b.polygon.gverts.next;null!=wb;){var ic=wb,xc=Tb.vec_dsq(ic.x,ic.y,a.circle.worldCOMx,a.circle.worldCOMy);(Db[Qb]=xc<=a.circle.radius*a.circle.radius)?(Na=Qb,wa=wb):dc=!1;Qb++;wb=wb.next}if(dc)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;for(;null!=J.flowpoly.head;){var nc=J.flowpoly.pop_unsafe();if(!nc._inuse){var Ha=nc;null!=Ha.outer&&(Ha.outer.zpp_inner=null,Ha.outer=
null);Ha._isimmutable=null;Ha._validate=null;Ha._invalidate=null;Ha.next=ja.zpp_pool;ja.zpp_pool=Ha}}J.flowsegs.clear();var ec=null,Ia=1;null==wa?(wa=b.polygon.gverts.next,Ia=2):J.flowpoly.add(ec=wa);for(;0!=Ia;)if(1==Ia)if(wa=wa.next,null==wa&&(wa=b.polygon.gverts.next),Na++,Na>=b.polygon.edgeCnt&&(Na=0),Db[Na]){if(Tb.vec_dsq(ec.x,ec.y,wa.x,wa.y)<v.epsilon)break;J.flowpoly.add(wa)}else{var qa=J.flowpoly.head.elt,Ob=wa,Pb=0,Rb=0,Pb=Ob.x-qa.x,Rb=Ob.y-qa.y,Ub=0,Xb=0,Ub=qa.x-a.circle.worldCOMx,Xb=qa.y-
a.circle.worldCOMy,Ib=Pb*Pb+Rb*Rb,Yb=2*(Ub*Pb+Xb*Rb),yc=Math.sqrt(Yb*Yb-4*Ib*(Ub*Ub+Xb*Xb-a.circle.radius*a.circle.radius)),Ib=1/(2*Ib),Bc=(-Yb-yc)*Ib,tc=0,vc=0,Nc=Bc<v.epsilon?(-Yb+yc)*Ib:Bc,tc=qa.x+(Ob.x-qa.x)*Nc,vc=qa.y+(Ob.y-qa.y)*Nc;if(Tb.vec_dsq(ec.x,ec.y,tc,vc)<v.epsilon)break;J.flowpoly.add(ja.get(tc,vc,null));Ia=2}else if(2==Ia){var cc=wa.next;null==cc&&(cc=b.polygon.gverts.next);var ya=wa,Ia=0,vb=cc,fc=cc;do{var Xa=fc,jc=Na+1;jc==b.polygon.edgeCnt&&(jc=0);if(zb[Na])if(Db[jc]){var kc=0,lc=
0,kc=Xa.x-ya.x,lc=Xa.y-ya.y,mc=0,oc=0,mc=ya.x-a.circle.worldCOMx,oc=ya.y-a.circle.worldCOMy,Zb=kc*kc+lc*lc,uc=2*(mc*kc+oc*lc),ed=Math.sqrt(uc*uc-4*Zb*(mc*mc+oc*oc-a.circle.radius*a.circle.radius)),Zb=1/(2*Zb),hd=(-uc-ed)*Zb,Sc=0,Vc=0,jd=hd<v.epsilon?(-uc+ed)*Zb:hd,Sc=ya.x+(Xa.x-ya.x)*jd,Vc=ya.y+(Xa.y-ya.y)*jd;if(Tb.vec_dsq(ec.x,ec.y,Sc,Vc)<v.epsilon){Ia=0;fc=vb;break}var kd=ja.get(Sc,Vc,null);J.flowsegs.add(J.flowpoly.head.elt);J.flowsegs.add(kd);J.flowpoly.add(kd);Ia=1;fc=vb;break}else{var zc=0,
Ac=0,Zc,Cc=0,Dc=0,Cc=Xa.x-ya.x,Dc=Xa.y-ya.y,Ec=0,Fc=0,Ec=ya.x-a.circle.worldCOMx,Fc=ya.y-a.circle.worldCOMy,$b=Cc*Cc+Dc*Dc,sc=2*(Ec*Cc+Fc*Dc),Mb=sc*sc-4*$b*(Ec*Ec+Fc*Fc-a.circle.radius*a.circle.radius);Mb*Mb<v.epsilon?(zc=0>Mb?10:Ac=-sc/(2*$b),Zc=!1):(Mb=Math.sqrt(Mb),$b=1/(2*$b),zc=(-sc-Mb)*$b,Ac=(-sc+Mb)*$b,Zc=!0);if(zc<1-v.epsilon&&Ac>v.epsilon){var ad=0,bd=0,nd=zc,ad=ya.x+(Xa.x-ya.x)*nd,bd=ya.y+(Xa.y-ya.y)*nd;if(null!=ec&&Tb.vec_dsq(ec.x,ec.y,ad,bd)<v.epsilon){Ia=0;fc=vb;break}var od=ja.get(ad,
bd,null);null!=J.flowpoly.head&&(J.flowsegs.add(J.flowpoly.head.elt),J.flowsegs.add(od));J.flowpoly.add(od);null==ec&&(ec=J.flowpoly.head.elt);if(Zc){var pd=0,qd=0,rd=Ac,pd=ya.x+(Xa.x-ya.x)*rd,qd=ya.y+(Xa.y-ya.y)*rd;J.flowpoly.add(ja.get(pd,qd,null))}}}ya=Xa;wa=fc;Na=jc;fc=fc.next;null==fc&&(fc=b.polygon.gverts.next)}while(0);for(;fc!=vb;){var mb=fc,Ic=Na+1;Ic==b.polygon.edgeCnt&&(Ic=0);if(zb[Na])if(Db[Ic]){var Jc=0,Mc=0,Jc=mb.x-ya.x,Mc=mb.y-ya.y,Oc=0,Pc=0,Oc=ya.x-a.circle.worldCOMx,Pc=ya.y-a.circle.worldCOMy,
wc=Jc*Jc+Mc*Mc,Qc=2*(Oc*Jc+Pc*Mc),ud=Math.sqrt(Qc*Qc-4*wc*(Oc*Oc+Pc*Pc-a.circle.radius*a.circle.radius)),wc=1/(2*wc),vd=(-Qc-ud)*wc,fd=0,gd=0,Bd=vd<v.epsilon?(-Qc+ud)*wc:vd,fd=ya.x+(mb.x-ya.x)*Bd,gd=ya.y+(mb.y-ya.y)*Bd;if(Tb.vec_dsq(ec.x,ec.y,fd,gd)<v.epsilon){Ia=0;fc=vb;break}var Cd=ja.get(fd,gd,null);J.flowsegs.add(J.flowpoly.head.elt);J.flowsegs.add(Cd);J.flowpoly.add(Cd);Ia=1;fc=vb;break}else{var Tc=0,Uc=0,id,Wc=0,Xc=0,Wc=mb.x-ya.x,Xc=mb.y-ya.y,Yc=0,$c=0,Yc=ya.x-a.circle.worldCOMx,$c=ya.y-a.circle.worldCOMy,
qc=Wc*Wc+Xc*Xc,Gc=2*(Yc*Wc+$c*Xc),ac=Gc*Gc-4*qc*(Yc*Yc+$c*$c-a.circle.radius*a.circle.radius);ac*ac<v.epsilon?(Tc=0>ac?10:Uc=-Gc/(2*qc),id=!1):(ac=Math.sqrt(ac),qc=1/(2*qc),Tc=(-Gc-ac)*qc,Uc=(-Gc+ac)*qc,id=!0);if(Tc<1-v.epsilon&&Uc>v.epsilon){var sd=0,td=0,Jd=Tc,sd=ya.x+(mb.x-ya.x)*Jd,td=ya.y+(mb.y-ya.y)*Jd;if(null!=ec&&Tb.vec_dsq(ec.x,ec.y,sd,td)<v.epsilon){Ia=0;fc=vb;break}var Ld=ja.get(sd,td,null);null!=J.flowpoly.head&&(J.flowsegs.add(J.flowpoly.head.elt),J.flowsegs.add(Ld));J.flowpoly.add(Ld);
null==ec&&(ec=J.flowpoly.head.elt);if(id){var Nd=0,Od=0,Pd=Uc,Nd=ya.x+(mb.x-ya.x)*Pd,Od=ya.y+(mb.y-ya.y)*Pd;J.flowpoly.add(ja.get(Nd,Od,null))}}}ya=mb;wa=fc;Na=Ic;fc=fc.next;null==fc&&(fc=b.polygon.gverts.next)}}if(null==J.flowpoly.head)return!1;if(null==J.flowpoly.head.next){for(var Sd=!0,md=b.polygon.edges.head;null!=md;){var Gd=md.elt;if(Gd.gnormx*a.circle.worldCOMx+Gd.gnormy*a.circle.worldCOMy>Gd.gprojection){Sd=!1;break}md=md.next}return Sd?(c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,
c.centroidy=a.circle.worldCOMy,null,!0):!1}var pc=0,rc=0,Hc=0;if(null!=J.flowpoly.head.next.next){for(var oe=0,Bb=0,Cb=0,oe=Cb=Bb=0,yd=J.flowpoly.head,cd=yd.elt,yd=yd.next,gc=yd.elt,yd=yd.next;null!=yd;)var Kc=yd.elt,oe=oe+gc.x*(Kc.y-cd.y),Ud=Kc.y*gc.x-Kc.x*gc.y,Bb=Bb+(gc.x+Kc.x)*Ud,Cb=Cb+(gc.y+Kc.y)*Ud,cd=gc,gc=Kc,yd=yd.next;var yd=J.flowpoly.head,Lc=yd.elt,oe=oe+gc.x*(Lc.y-cd.y),Wd=Lc.y*gc.x-Lc.x*gc.y,Bb=Bb+(gc.x+Lc.x)*Wd,Cb=Cb+(gc.y+Lc.y)*Wd,cd=gc,gc=Lc,yd=yd.next,dd=yd.elt,oe=oe+gc.x*(dd.y-cd.y),
Xd=dd.y*gc.x-dd.x*gc.y,Bb=Bb+(gc.x+dd.x)*Xd,Cb=Cb+(gc.y+dd.y)*Xd,oe=0.5*oe,$d=1/(6*oe),Bb=Bb*$d,Cb=Cb*$d,ae=-oe,pc=pc+Bb*ae,rc=rc+Cb*ae,Hc=Hc-oe}else J.flowsegs.add(J.flowpoly.head.elt),J.flowsegs.add(J.flowpoly.head.next.elt);for(;null!=J.flowsegs.head;)var zd=J.flowsegs.pop_unsafe(),Ad=J.flowsegs.pop_unsafe(),ce=0,de=0,ce=Ad.x-zd.x,de=Ad.y-zd.y,Vb=0,Wb=0,Vb=ce,Wb=de,ee=1/Math.sqrt(Vb*Vb+Wb*Wb),Vb=Vb*ee,Wb=Wb*ee,re=Vb,Vb=-Wb,Wb=re,we=0,xe=0,we=zd.x+Ad.x,xe=zd.y+Ad.y,we=0.5*we,xe=0.5*xe,we=we-1*a.circle.worldCOMx,
xe=xe-1*a.circle.worldCOMy,Td=0,fe=0,ge=Vb*we+Wb*xe,Fd=ge/a.circle.radius,ld=Math.sqrt(1-Fd*Fd),he=Math.acos(Fd),Td=a.circle.radius*(a.circle.radius*he-ge*ld),fe=0.6666666666666666*a.circle.radius*ld*ld*ld/(he-Fd*ld),we=a.circle.worldCOMx,xe=a.circle.worldCOMy,ie=fe,we=we+Vb*ie,xe=xe+Wb*ie,je=Td,pc=pc+we*je,rc=rc+xe*je,Hc=Hc+Td;var ke=1/Hc,pc=pc*ke,rc=rc*ke;c.overlap=Hc;c.centroidx=pc;c.centroidy=rc;null;return!0}}return!1}var hc=a.circle,Rc=b.circle,Hd=0,Id=0,Hd=Rc.worldCOMx-hc.worldCOMx,Id=Rc.worldCOMy-
hc.worldCOMy,le=hc.radius+Rc.radius,Vd=Hd*Hd+Id*Id;if(Vd>le*le)return!1;if(Vd<v.epsilon*v.epsilon)hc.radius<Rc.radius?(c.overlap=hc.area,c.centroidx=hc.worldCOMx,c.centroidy=hc.worldCOMy):(c.overlap=Rc.area,c.centroidx=Rc.worldCOMx,c.centroidy=Rc.worldCOMy);else{var Kd=Math.sqrt(Vd),me=1/Kd,Md=0.5*(Kd-(Rc.radius*Rc.radius-hc.radius*hc.radius)*me);if(Md<=-hc.radius)c.overlap=hc.area,c.centroidx=hc.worldCOMx,c.centroidy=hc.worldCOMy;else{var Yd=Kd-Md;if(Yd<=-Rc.radius)c.overlap=Rc.area,c.centroidx=
Rc.worldCOMx,c.centroidy=Rc.worldCOMy;else{var Zd=0,ne=0,be=0,pe=0,Qd=Md/hc.radius,Dd=Math.sqrt(1-Qd*Qd),qe=Math.acos(Qd),Zd=hc.radius*(hc.radius*qe-Md*Dd),ne=0.6666666666666666*hc.radius*Dd*Dd*Dd/(qe-Qd*Dd),Rd=Yd/Rc.radius,Ed=Math.sqrt(1-Rd*Rd),se=Math.acos(Rd),be=Rc.radius*(Rc.radius*se-Yd*Ed),pe=0.6666666666666666*Rc.radius*Ed*Ed*Ed/(se-Rd*Ed),te=Zd+be,ue=(ne*Zd+(Kd-pe)*be)/te*me;c.overlap=te;c.centroidx=hc.worldCOMx+Hd*ue;c.centroidy=hc.worldCOMy+Id*ue}}}null;return!0};var Ik=function(){this.toiDistance=
0;this.inner=!1;this.shape=null};h["zpp_nape.geom.ZPP_ConvexRayResult"]=Ik;Ik.__name__=["zpp_nape","geom","ZPP_ConvexRayResult"];Ik.prototype={__class__:Ik};var Jk=function(){this.next=null;this.x=this.y=0};h["zpp_nape.geom.ZPP_GeomVert"]=Jk;Jk.__name__=["zpp_nape","geom","ZPP_GeomVert"];Jk.prototype={__class__:Jk};var Kk=function(){this.outer=this.vertices=null};h["zpp_nape.geom.ZPP_GeomPoly"]=Kk;Kk.__name__=["zpp_nape","geom","ZPP_GeomPoly"];Kk.prototype={__class__:Kk};var Lk=function(){this.a=
this.b=this.c=this.d=this.tx=this.ty=0};h["zpp_nape.geom.ZPP_Mat23"]=Lk;Lk.__name__=["zpp_nape","geom","ZPP_Mat23"];Lk.prototype={__class__:Lk};var Mk=function(){this.x=null;this.m=this.n=0};h["zpp_nape.geom.ZPP_MatMN"]=Mk;Mk.__name__=["zpp_nape","geom","ZPP_MatMN"];Mk.prototype={__class__:Mk};var Pa=function(){this.slipped=this.failed=this.kinematic=!1;this.c1=this.c2=this.axis=null;this.frozen1=this.frozen2=!1;this.s1=this.s2=this.arbiter=null;this.toi=0;this.next=null;this.c1=new ja;this.c2=new ja;
this.axis=new ja};h["zpp_nape.geom.ZPP_ToiEvent"]=Pa;Pa.__name__=["zpp_nape","geom","ZPP_ToiEvent"];Pa.prototype={__class__:Pa};var hd=function(){};h["zpp_nape.geom.ZPP_SweepDistance"]=hd;hd.__name__=["zpp_nape","geom","ZPP_SweepDistance"];hd.dynamicSweep=function(a,b,c,d,e){null==e&&(e=!1);var f=a.s1,i=a.s2,g=f.body,h=i.body,j=0,k=0,j=h.velx-g.velx,k=h.vely-g.vely,l=g.angvel;0>l&&(l=-l);var m=h.angvel;0>m&&(m=-m);var n=f.sweepCoef*l+i.sweepCoef*m;if(!e&&!a.kinematic&&j*j+k*k<v.dynamicSweepLinearThreshold*
v.dynamicSweepLinearThreshold&&n<v.dynamicSweepAngularThreshold)a.toi=-1,a.failed=!0;else{for(var p=a.c1,l=a.c2,m=a.axis,q=0;;){g.sweepIntegrate(c*b);g.sweepValidate(f);h.sweepIntegrate(c*b);h.sweepValidate(i);var r=hd.distance(f,i,p,l,m,null)+d,t=j*m.x+k*m.y;if(r<v.distanceThresholdCCD){if(e)break;var u=0,s=0,u=p.x-g.posx,s=p.y-g.posy,w=0,x=0,w=l.x-h.posx,x=l.y-h.posy,u=t-g.sweep_angvel*(m.y*u-m.x*s)+h.sweep_angvel*(m.y*w-m.x*x);0<u&&(a.slipped=!0);if(0>=u||r<0.5*v.distanceThresholdCCD)break}t=(n-
t)*b;if(0>=t){c=-1;break}t=r/t;1.0E-6>t&&(t=1.0E-6);c+=t;if(1<=c){c=1;g.sweepIntegrate(c*b);g.sweepValidate(f);h.sweepIntegrate(c*b);h.sweepValidate(i);b=hd.distance(f,i,p,l,m,null)+d;j=j*m.x+k*m.y;if(b<v.distanceThresholdCCD){if(e)break;k=e=0;e=p.x-g.posx;k=p.y-g.posy;d=p=0;p=l.x-h.posx;d=l.y-h.posy;g=j-g.sweep_angvel*(m.y*e-m.x*k)+h.sweep_angvel*(m.y*p-m.x*d);0<g&&(a.slipped=!0);if(0>=g||b<0.5*v.distanceThresholdCCD)break}c=-1;break}if(40<=++q){r>d&&(a.failed=!0);break}}a.toi=c}};hd.staticSweep=
function(a,b,c,d){var e=a.s1,f=a.s2,i=e.body,g=0,h=0,g=-i.velx,h=-i.vely,j=i.sweep_angvel;0>j&&(j=-j);for(var k=e.sweepCoef*j,j=a.c1,l=a.c2,m=a.axis,n=0;;){i.sweepIntegrate(c*b);i.sweepValidate(e);var p=hd.distance(e,f,j,l,m,null)+d,q=g*m.x+h*m.y;if(p<v.distanceThresholdCCD){var r=0,t=0,r=j.x-i.posx,t=j.y-i.posy,r=q-i.sweep_angvel*(m.y*r-m.x*t);0<r&&(a.slipped=!0);if(0>=r||p<0.5*v.distanceThresholdCCD)break}q=(k-q)*b;if(0>=q){c=-1;break}q=p/q;1.0E-6>q&&(q=1.0E-6);c+=q;if(1<=c){c=1;i.sweepIntegrate(c*
b);i.sweepValidate(e);b=hd.distance(e,f,j,l,m,null)+d;g=g*m.x+h*m.y;if(b<v.distanceThresholdCCD&&(d=h=0,h=j.x-i.posx,d=j.y-i.posy,i=g-i.sweep_angvel*(m.y*h-m.x*d),0<i&&(a.slipped=!0),0>=i||b<0.5*v.distanceThresholdCCD))break;c=-1;break}if(40<=++n){p>d&&(a.failed=!0);break}}a.toi=c};hd.distance=function(a,b,c,d,e,f){null==f&&(f=1.0E100);if(a.type==g.id_ShapeType_CIRCLE&&b.type==g.id_ShapeType_CIRCLE){var i=a.circle,h=b.circle,j,k=0,l=0,k=h.worldCOMx-i.worldCOMx,l=h.worldCOMy-i.worldCOMy,m=Math.sqrt(k*
k+l*l);j=m-(i.radius+h.radius);if(j<f){if(0==m)k=1,l=0;else var n=1/m,k=k*n,l=l*n;var p=i.radius;c.x=i.worldCOMx+k*p;c.y=i.worldCOMy+l*p;var q=-h.radius;d.x=h.worldCOMx+k*q;d.y=h.worldCOMy+l*q;e.x=k;e.y=l}return j}var r=!1;if(a.type==g.id_ShapeType_CIRCLE&&b.type==g.id_ShapeType_POLYGON)var t=a,a=b,b=t,u=c,c=d,d=u,r=!0;if(a.type==g.id_ShapeType_POLYGON&&b.type==g.id_ShapeType_CIRCLE){for(var s=b.circle,w=-1.0E100,x=null,z=a.polygon.edges.head;null!=z;){var B=z.elt,C=B.gnormx*s.worldCOMx+B.gnormy*
s.worldCOMy-B.gprojection-s.radius;if(C>f){w=C;break}0<C?C>w&&(w=C,x=B):0>w&&C>w&&(w=C,x=B);z=z.next}if(w<f){var E=x.gp0,D=x.gp1,A=s.worldCOMy*x.gnormx-s.worldCOMx*x.gnormy;if(A<=E.y*x.gnormx-E.x*x.gnormy){var F=0,G=0,F=s.worldCOMx-E.x,G=s.worldCOMy-E.y,J=Math.sqrt(F*F+G*G),w=J-s.radius;if(w<f){if(0==J)F=1,G=0;else var I=1/J,F=F*I,G=G*I;c.x=E.x+0*F;c.y=E.y+0*G;var M=-s.radius;d.x=s.worldCOMx+F*M;d.y=s.worldCOMy+G*M;e.x=F;e.y=G}}else if(A>=D.y*x.gnormx-D.x*x.gnormy){var N=0,K=0,N=s.worldCOMx-D.x,K=
s.worldCOMy-D.y,O=Math.sqrt(N*N+K*K),w=O-s.radius;if(w<f){if(0==O)N=1,K=0;else var Q=1/O,N=N*Q,K=K*Q;c.x=D.x+0*N;c.y=D.y+0*K;var W=-s.radius;d.x=s.worldCOMx+N*W;d.y=s.worldCOMy+K*W;e.x=N;e.y=K}}else{var S=-s.radius;d.x=s.worldCOMx+x.gnormx*S;d.y=s.worldCOMy+x.gnormy*S;var aa=-w;c.x=d.x+x.gnormx*aa;c.y=d.y+x.gnormy*aa;e.x=x.gnormx;e.y=x.gnormy}}r&&(e.x=-e.x,e.y=-e.y);return w}for(var V=a.polygon,U=b.polygon,L=-1.0E100,X=null,Z=null,ca=0,ba=V.edges.head;null!=ba;){for(var R=ba.elt,T=1.0E100,ga=U.gverts.next;null!=
ga;){var ka=ga,ha=R.gnormx*ka.x+R.gnormy*ka.y;ha<T&&(T=ha);ga=ga.next}T-=R.gprojection;if(T>f){L=T;break}0<T?T>L&&(L=T,X=R,ca=1):0>L&&T>L&&(L=T,X=R,ca=1);ba=ba.next}if(L<f){for(var ia=U.edges.head;null!=ia;){for(var da=ia.elt,y=1.0E100,oa=V.gverts.next;null!=oa;){var pa=oa,na=da.gnormx*pa.x+da.gnormy*pa.y;na<y&&(y=na);oa=oa.next}y-=da.gprojection;if(y>f){L=y;break}0<y?y>L&&(L=y,Z=da,ca=2):0>L&&y>L&&(L=y,Z=da,ca=2);ia=ia.next}if(L<f){var ma,P;if(1==ca)ma=U,P=X;else{ma=V;P=Z;var sa=c,c=d,d=sa,r=!r}for(var ja=
null,ua=1.0E100,va=ma.edges.head;null!=va;){var za=va.elt,Da=P.gnormx*za.gnormx+P.gnormy*za.gnormy;Da<ua&&(ua=Da,ja=za);va=va.next}r?(e.x=-P.gnormx,e.y=-P.gnormy):(e.x=P.gnormx,e.y=P.gnormy);if(0<=L){var fa=P.gp0,Y=P.gp1,ea=ja.gp0,ra=ja.gp1,xa=0,ta=0,wa=0,Ba=0,xa=Y.x-fa.x,ta=Y.y-fa.y,wa=ra.x-ea.x,Ba=ra.y-ea.y,Ka=1/(xa*xa+ta*ta),Ea=1/(wa*wa+Ba*Ba),Ga=-(xa*(fa.x-ea.x)+ta*(fa.y-ea.y))*Ka,Ma=-(xa*(fa.x-ra.x)+ta*(fa.y-ra.y))*Ka,Ja=-(wa*(ea.x-fa.x)+Ba*(ea.y-fa.y))*Ea,Oa=-(wa*(ea.x-Y.x)+Ba*(ea.y-Y.y))*Ea;
0>Ga?Ga=0:1<Ga&&(Ga=1);0>Ma?Ma=0:1<Ma&&(Ma=1);0>Ja?Ja=0:1<Ja&&(Ja=1);0>Oa?Oa=0:1<Oa&&(Oa=1);var Fa=0,Ia=0,ab=Ga,Fa=fa.x+xa*ab,Ia=fa.y+ta*ab,Na=0,Pa=0,Ua=Ma,Na=fa.x+xa*Ua,Pa=fa.y+ta*Ua,La=0,Va=0,H=Ja,La=ea.x+wa*H,Va=ea.y+Ba*H,Qa=0,Ta=0,Xa=Oa,Qa=ea.x+wa*Xa,Ta=ea.y+Ba*Xa,Ra=Tb.vec_dsq(Fa,Ia,ea.x,ea.y),hb=Tb.vec_dsq(Na,Pa,ra.x,ra.y),ib=Tb.vec_dsq(La,Va,fa.x,fa.y),$a=Tb.vec_dsq(Qa,Ta,Y.x,Y.y),Wa=0,db=0,Ze=null;Ra<hb?(Wa=Fa,db=Ia,Ze=ea):(Wa=Na,db=Pa,Ze=ra,Ra=hb);var la=0,Ya=0,Za=null;ib<$a?(la=La,Ya=Va,
Za=fa):(la=Qa,Ya=Ta,Za=Y,ib=$a);Ra<ib?(c.x=Wa,c.y=db,d.x=Ze.x,d.y=Ze.y,L=Math.sqrt(Ra)):(d.x=la,d.y=Ya,c.x=Za.x,c.y=Za.y,L=Math.sqrt(ib));if(0!=L){e.x=d.x-c.x;e.y=d.y-c.y;var mb=1/L;e.x*=mb;e.y*=mb;r&&(e.x=-e.x,e.y=-e.y)}return L}var Ha=0,Aa=0,Ha=ja.gp0.x,Aa=ja.gp0.y,qa=0,Sa=0,qa=ja.gp1.x,Sa=ja.gp1.y,cb=0,ob=0,cb=qa-Ha,ob=Sa-Aa,qb=P.gnormy*Ha-P.gnormx*Aa,eb=P.gnormy*qa-P.gnormx*Sa,fb=1/(eb-qb),jb=(-P.tp1-qb)*fb;jb>v.epsilon&&(Ha+=cb*jb,Aa+=ob*jb);var bb=(-P.tp0-eb)*fb;bb<-v.epsilon&&(qa+=cb*bb,Sa+=
ob*bb);var lb=Ha*P.gnormx+Aa*P.gnormy-P.gprojection,nb=qa*P.gnormx+Sa*P.gnormy-P.gprojection;if(lb<nb){d.x=Ha;d.y=Aa;var pb=-lb;c.x=d.x+P.gnormx*pb;c.y=d.y+P.gnormy*pb;return lb}d.x=qa;d.y=Sa;var gb=-nb;c.x=d.x+P.gnormx*gb;c.y=d.y+P.gnormy*gb;return nb}}return f};var ja=function(){this.length=this.x=this.y=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.weak=!1;this._isimmutable=this.outer=null;this._immutable=!1;this._invalidate=this._validate=null};h["zpp_nape.geom.ZPP_Vec2"]=ja;
ja.__name__=["zpp_nape","geom","ZPP_Vec2"];ja.get=function(a,b,c){null==c&&(c=!1);var d;null==ja.zpp_pool?d=new ja:(d=ja.zpp_pool,ja.zpp_pool=d.next,d.next=null);d.weak=!1;d._immutable=c;d.x=a;d.y=b;return d};ja.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},wrapper:function(){if(null==this.outer){this.outer=new Va;var a=this.outer.zpp_inner;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=
null;a._validate=null;a._invalidate=null;a.next=ja.zpp_pool;ja.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},erase:function(a){return this.inlined_erase(a)},
inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},
__class__:ja};var Nk=function(){this._validate=null;this.x=this.y=this.z=0};h["zpp_nape.geom.ZPP_Vec3"]=Nk;Nk.__name__=["zpp_nape","geom","ZPP_Vec3"];Nk.prototype={validate:function(){null!=this._validate&&this._validate()},__class__:Nk};var Tb=function(){};h["zpp_nape.geom.ZPP_VecMath"]=Tb;Tb.__name__=["zpp_nape","geom","ZPP_VecMath"];Tb.vec_dsq=function(a,b,c,d){var e=0,f=0,e=a-c,f=b-d;return e*e+f*f};var Ba=function(){this.userData=this.ishape=this.ibody=this.icompound=this.cbsets=this.group=this.cbTypes=
this.cbSet=null;this.id=0;this.outer_i=null;this.id=Aa.Interactor();this.cbsets=new Yj;this.cbTypes=new gd};h["zpp_nape.phys.ZPP_Interactor"]=Ba;Ba.__name__=["zpp_nape","phys","ZPP_Interactor"];Ba.get=function(a,b){var c;c=a.id<b.id?a.id:b.id;var d;d=a.id<b.id?b.id:a.id;for(var e=null,f=(a.cbsets.length<b.cbsets.length?a.cbsets:b.cbsets).head;null!=f;){var i=f.elt;if(i.id==c&&i.di==d){e=i;break}f=f.next}return e};Ba.int_callback=function(a,b,c){var d=a.int1,a=a.int2;b.options1.compatible(d.cbTypes)&&
b.options2.compatible(a.cbTypes)?(c.int1=d,c.int2=a):(c.int1=a,c.int2=d)};Ba.prototype={__iaddedToSpace:function(){null!=this.group&&this.group.interactors.add(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.add(this),a=a.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.interactors.remove(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.remove(this),a=a.next;this.dealloc_cbSet()},wake:function(){if(null!=this.ishape){var a=this.ishape.body;
null!=a&&null!=a.space&&a.space.non_inlined_wake(a);!0}else null!=this.ibody?null!=this.ibody.space?this.ibody.space.non_inlined_wake(this.ibody):!1:(null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound),!0)},insert_cbtype:function(a){if(!this.cbTypes.has(a)){var b;b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=b&&(this.dealloc_cbSet(),a.interactors.add(this));for(var c=null,d=this.cbTypes.head;null!=
d&&!(a.id<d.elt.id);){c=d;d=d.next}this.cbTypes.inlined_insert(c,a);null!=b&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;if(null!=(this.cbSet=a.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),a.freshInteractorType(this)},dealloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:
null!=this.ibody?this.ibody.space:this.icompound.space;null!=this.cbSet&&(this.cbSet.interactors.remove(this),a.nullInteractorType(this),0==--this.cbSet.count&&(a.cbsets.remove(this.cbSet),a=this.cbSet,a.free(),a.next=ta.zpp_pool,ta.zpp_pool=a),this.cbSet=null)},immutable_midstep:function(a){null!=this.ibody?null:null!=this.ishape?this.ishape.__immutable_midstep(a):this.icompound.__imutable_midstep(a)},lookup_group:function(){for(var a=this;null!=a&&null==a.group;)a=null!=a.ishape?a.ishape.body:null!=
a.icompound?a.icompound.compound:a.ibody.compound;return null==a?null:a.group},__class__:Ba};var Gc=function(){this.wrap_localCOM=this.wrap_worldCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_aabb=!1;this.aabb=null;this.norotate=!1;this.cinertia=this.iinertia=this.sinertia=0;this.zip_inertia=!1;this.inertiaMode=this.inertia=0;this.zip_gravMassScale=!1;this.gravMassMode=this.gravMassScale=0;this.zip_gravMass=!1;this.gravMass=
0;this.nomove=!1;this.massMode=this.imass=this.smass=this.cmass=0;this.zip_mass=!1;this.mass=0;this.zip_axis=!1;this.forcex=this.forcey=this.kinvelx=this.kinvely=this.svelx=this.svely=this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=this.axisx=this.axisy=0;this.wrap_vel=null;this.velx=this.vely=0;this.wrap_pos=null;this.pre_posx=this.pre_posy=this.posx=this.posy=0;this.bullet=this.bulletEnabled=this.disableCCD=!1;this.sweepRadius=0;this.sweepFrozen=!1;this.sweepTime=this.sweep_angvel=
0;this.compound=this.shapes=this.wrap_shapes=this.space=this.arbiters=this.constraints=this.component=null;this.type=0;this.world=!1;this.outer=null;Ba.call(this);this.ibody=this;this.bulletEnabled=this.world=!1;this.sweep_angvel=this.sweepTime=0;this.disableCCD=this.norotate=this.nomove=!1;this.axisx=this.rot=this.posy=this.posx=0;this.axisy=1;this.torque=this.angvel=this.kinangvel=this.forcey=this.forcex=this.kinvely=this.kinvelx=this.vely=this.velx=this.svely=this.svelx=0;this.pre_rot=this.pre_posy=
this.pre_posx=Infinity;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.zip_aabb=!0;this.aabb=la.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=u(this,this.aabb_validate);this.massMode=g.id_MassMode_DEFAULT;this.gravMassMode=g.id_GravMassMode_DEFAULT;this.gravMassScale=1;this.inertiaMode=g.id_InertiaMode_DEFAULT;this.arbiters=new Sf;this.constraints=new dd;this.shapes=new Ye;this.wrap_shapes=Cb.get(this.shapes);this.wrap_shapes.zpp_inner.adder=u(this,this.shapes_adder);
this.wrap_shapes.zpp_inner.subber=u(this,this.shapes_subber);this.wrap_shapes.zpp_inner._invalidate=u(this,this.shapes_invalidate);this.kinematicDelaySleep=!1};h["zpp_nape.phys.ZPP_Body"]=Gc;Gc.__name__=["zpp_nape","phys","ZPP_Body"];Gc.__static=function(){null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);var a=new Hc(g.BodyType_STATIC),b=a.zpp_inner;b.world=!0;b.wrap_shapes.zpp_inner.immutable=!0;b.smass=b.imass=b.cmass=b.mass=b.gravMass=0;b.sinertia=b.iinertia=b.cinertia=
b.inertia=0;b.cbTypes.clear();return a};Gc.__super__=Ba;Gc.prototype=x(Ba.prototype,{invalidate_type:function(){this.invalidate_mass();this.invalidate_inertia()},invalidate_shapes:function(){this.zip_worldCOM=this.zip_localCOM=this.zip_aabb=!0;this.invalidate_mass();this.invalidate_inertia()},atRest:function(a){if(this.type!=g.id_BodyType_DYNAMIC)return this.component.sleeping;var b=v.linearSleepThreshold,b=b*b;if(this.velx*this.velx+this.vely*this.vely>b)a=!1;else if(Tb.vec_dsq(this.posx,this.posy,
this.pre_posx,this.pre_posy)>0.25*b*a*a)a=!1;else{var c=b=0,b=this.aabb.maxx-this.aabb.minx,c=this.aabb.maxy-this.aabb.miny,b=b*b+c*c,c=v.angularSleepThreshold,c=c*c;if(4*this.angvel*this.angvel*b>c)a=!1;else var d=this.rot-this.pre_rot,a=d*d*b>c*a*a?!1:!0}a||(this.component.waket=this.space.stamp);return this.component.waket+v.sleepDelay<this.space.stamp},refreshArbiters:function(){for(var a=this.arbiters.head;null!=a;)a.elt.invalidated=!0,a=a.next},sweepIntegrate:function(a){var b=a-this.sweepTime;
0!=b&&(this.sweepTime=a,this.posx+=this.velx*b,this.posy+=this.vely*b,0!=this.angvel&&this.delta_rot(this.sweep_angvel*b))},sweepValidate:function(a){if(a.type==g.id_ShapeType_CIRCLE)a.worldCOMx=this.posx+(this.axisy*a.localCOMx-this.axisx*a.localCOMy),a.worldCOMy=this.posy+(a.localCOMx*this.axisx+a.localCOMy*this.axisy);else{for(var a=a.polygon,b=a.lverts.next,c=a.gverts.next;null!=c;){var d=c,e=b,b=b.next;d.x=this.posx+(this.axisy*e.x-this.axisx*e.y);d.y=this.posy+(e.x*this.axisx+e.y*this.axisy);
c=c.next}c=a.edges.head;b=d=a.gverts.next;for(d=d.next;null!=d;){var e=d,f=c.elt,c=c.next;f.gnormx=this.axisy*f.lnormx-this.axisx*f.lnormy;f.gnormy=f.lnormx*this.axisx+f.lnormy*this.axisy;f.gprojection=this.posx*f.gnormx+this.posy*f.gnormy+f.lprojection;f.tp0=b.y*f.gnormx-b.x*f.gnormy;f.tp1=e.y*f.gnormx-e.x*f.gnormy;b=e;d=d.next}a=a.gverts.next;c=c.elt;c.gnormx=this.axisy*c.lnormx-this.axisx*c.lnormy;c.gnormy=c.lnormx*this.axisx+c.lnormy*this.axisy;c.gprojection=this.posx*c.gnormx+this.posy*c.gnormy+
c.lprojection;c.tp0=b.y*c.gnormx-b.x*c.gnormy;c.tp1=a.y*c.gnormx-a.x*c.gnormy}},invalidate_pos:function(){for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==g.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},pos_invalidate:function(a){this.immutable_midstep("Body::position");this.posx==a.x&&this.posy==a.y||(this.posx=a.x,this.posy=a.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=
this.posx;this.wrap_pos.zpp_inner.y=this.posy},vel_invalidate:function(a){this.velx=a.x;this.vely=a.y;this.wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx;this.wrap_vel.zpp_inner.y=this.vely},setupPosition:function(){this.wrap_pos=Va.get(this.posx,this.posy,null);this.wrap_pos.zpp_inner._inuse=!0;this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=u(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=u(this,this.pos_validate))},setupVelocity:function(){this.wrap_vel=
Va.get(this.velx,this.vely,null);this.wrap_vel.zpp_inner._inuse=!0;this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=u(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=u(this,this.vel_validate))},invalidate_rot:function(){this.zip_axis=!0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==g.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},validate_axis:function(){this.zip_axis&&
(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null)},delta_rot:function(a){this.rot+=a;if(1.0E-4<a*a)this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null;else{var b=a*a,c=1-0.5*b,b=1-b*b/8,d=(c*this.axisx+a*this.axisy)*b;this.axisy=(c*this.axisy-a*this.axisx)*b;this.axisx=d}},invalidate_mass:function(){this.zip_mass=!0;this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass){this.zip_mass=!1;if(this.massMode==g.id_MassMode_DEFAULT){this.cmass=
0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cmass+=b.area*b.material.density;a=a.next}}this.type==g.id_BodyType_DYNAMIC&&!this.nomove?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Infinity,this.imass=this.smass=0)}},invalidate_gravMass:function(){this.gravMassMode!=g.id_GravMassMode_FIXED&&(this.zip_gravMass=!0);this.gravMassMode!=g.id_GravMassMode_SCALED&&(this.zip_gravMassScale=!0);this.wake()},
validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),this.gravMassMode==g.id_GravMassMode_DEFAULT?(this.validate_mass(),this.gravMass=this.cmass):this.gravMassMode==g.id_GravMassMode_SCALED&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_inertia:function(){this.zip_inertia=!0;this.wake()},validate_inertia:function(){if(this.zip_inertia){this.zip_inertia=!1;if(this.inertiaMode==g.id_InertiaMode_DEFAULT){this.cinertia=0;for(var a=
this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cinertia+=b.inertia*b.area*b.material.density;a=a.next}}this.type==g.id_BodyType_DYNAMIC&&!this.norotate?(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia):(this.inertia=Infinity,this.sinertia=this.iinertia=0)}},validate_aabb:function(){if(this.zip_aabb){this.zip_aabb=!1;this.aabb.minx=Infinity;this.aabb.miny=Infinity;this.aabb.maxx=-Infinity;this.aabb.maxy=-Infinity;
for(var a=this.shapes.head;null!=a;){var b=a.elt;b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==g.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb());this.aabb.combine(b.aabb);a=a.next}}},invalidate_localCOM:function(){this.zip_worldCOM=this.zip_localCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var a=0,b=0,c=0,d=this.shapes.head;null!=d;){var e=d.elt;e.zip_localCOM&&(e.zip_localCOM=!1,e.type==g.id_ShapeType_POLYGON&&e.polygon.__validate_localCOM(),
null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy));e.validate_area_inertia();var f=e.area*e.material.density,a=a+e.localCOMx*f,b=b+e.localCOMy*f,c=c+e.area*e.material.density,d=d.next}0!=c&&(d=1/c,this.localCOMx=a*d,this.localCOMy=b*d);null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy);this.zip_mass&&this.massMode==g.id_MassMode_DEFAULT&&(this.zip_mass=!1,this.cmass=c,this.type==
g.id_BodyType_DYNAMIC?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Infinity,this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&
(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},aabb_validate:function(){this.validate_aabb()},shapes_adder:function(a){return a.zpp_inner.body!=this?(null!=a.zpp_inner.body&&a.zpp_inner.body.wrap_shapes.remove(a),a.zpp_inner.body=this,a.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(a.zpp_inner,null),a.zpp_inner.type==g.id_ShapeType_POLYGON&&(a.zpp_inner.polygon.invalidate_gaxi(),a.zpp_inner.polygon.invalidate_gverts()),!0):!1},shapes_subber:function(a){null!=
this.space&&this.space.removed_shape(a.zpp_inner);a.zpp_inner.body=null;a.zpp_inner.removedFromBody()},shapes_invalidate:function(){this.invalidate_shapes()},addedToSpace:function(){null==wa.zpp_pool?this.component=new wa:(this.component=wa.zpp_pool,wa.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!0;this.component.body=this;this.__iaddedToSpace()},removedFromSpace:function(){for(;null!=this.arbiters.head;){var a=this.arbiters.pop_unsafe();a.cleared=!0;a.b2==this&&
a.b1.arbiters.inlined_try_remove(a);a.b1==this&&a.b2.arbiters.inlined_try_remove(a);null!=a.pair&&(a.pair.arb=null,a.pair=null);a.active=!1;this.space.f_arbiters.modified=!0}a=this.component;a.body=null;a.constraint=null;null;a.next=wa.zpp_pool;wa.zpp_pool=a;this.component=null;this.__iremovedFromSpace()},__class__:Gc});var Zj=function(){this.compound=this.space=null;this.depth=0;this.outer=this.bodies=this.constraints=this.compounds=this.wrap_constraints=null};h["zpp_nape.phys.ZPP_Compound"]=Zj;
Zj.__name__=["zpp_nape","phys","ZPP_Compound"];Zj.__super__=Ba;Zj.prototype=x(Ba.prototype,{__imutable_midstep:function(){},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},__class__:Zj});var Ok=function(){this.wrap_gravity=null;this.viscosity=this.density=this.gravityx=this.gravityy=0;this.shapes=null};h["zpp_nape.phys.ZPP_FluidProperties"]=Ok;Ok.__name__=["zpp_nape","phys","ZPP_FluidProperties"];Ok.prototype={__class__:Ok};var na=function(){this.dynamicFriction=
this.staticFriction=this.density=this.elasticity=this.rollingFriction=0;this.next=this.outer=this.shapes=null;this.shapes=new Ye;this.elasticity=0;this.dynamicFriction=1;this.staticFriction=2;this.density=0.001;this.rollingFriction=0.01};h["zpp_nape.phys.ZPP_Material"]=na;na.__name__=["zpp_nape","phys","ZPP_Material"];na.prototype={wrapper:function(){if(null==this.outer){this.outer=new ra;var a=this.outer.zpp_inner;a.outer=null;a.next=na.zpp_pool;na.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},
set:function(a){this.dynamicFriction=a.dynamicFriction;this.staticFriction=a.staticFriction;this.density=a.density;this.elasticity=a.elasticity;this.rollingFriction=a.rollingFriction},invalidate:function(a){for(var b=this.shapes.head;null!=b;)b.elt.invalidate_material(a),b=b.next},__class__:na};var Od=function(a){this.zip_aabb=!1;this.sweep=this.node=this.pairs=this.aabb=null;this.fluidEnabled=this.sensorEnabled=!1;this.circle=this.polygon=this.refmaterial=this.material=this.filter=this.fluidProperties=
null;this.sweepCoef=0;this.zip_sweepRadius=!1;this.sweepRadius=0;this.wrap_localCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_angDrag=!1;this.inertia=this.angDrag=0;this.zip_area_inertia=!1;this.type=this.area=0;this.outer=this.body=null;Ba.call(this);this.pairs=new $j;this.ishape=this;this.type=a;this.aabb=la.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=u(this,this.aabb_validate);this.zip_area_inertia=this.zip_angDrag=
this.zip_localCOM=this.zip_sweepRadius=!0;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.sensorEnabled=this.fluidEnabled=!1;this.body=this.fluidProperties=null;this.refmaterial=new na;this.sweepRadius=this.sweepCoef=0};h["zpp_nape.shape.ZPP_Shape"]=Od;Od.__name__=["zpp_nape","shape","ZPP_Shape"];Od.__super__=Ba;Od.prototype=x(Ba.prototype,{validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_sweepRadius():
this.polygon.__validate_sweepRadius())},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){if(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_angDrag():this.polygon.__validate_angDrag()},
validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==g.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+
this.localCOMy*this.body.axisy))},invalidate_area_inertia:function(){this.zip_area_inertia=!0;null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0;this.invalidate_area_inertia();this.type==g.id_ShapeType_CIRCLE&&(this.zip_sweepRadius=!0);this.invalidate_angDrag();this.invalidate_worldCOM();null!=this.body&&this.body.invalidate_localCOM()},
invalidate_worldCOM:function(){this.zip_aabb=this.zip_worldCOM=!0;null!=this.body&&(this.body.zip_aabb=!0)},invalidate_material:function(a){0!=(a&na.WAKE)&&this.wake();0!=(a&na.ARBITERS)&&null!=this.body&&this.body.refreshArbiters();0!=(a&na.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia());0!=(a&na.ANGDRAG)&&this.invalidate_angDrag();this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},aabb_validate:function(){this.zip_aabb&&
null!=this.body&&(this.zip_aabb=!1,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_aabb():this.polygon.__validate_aabb())},setMaterial:function(a){this.material!=a&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(a){this.filter!=a&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&
this.filter.shapes.remove(this),this.filter=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake())},__immutable_midstep:function(){},addedToBody:function(){this.invalidate_worldCOM();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0)},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace();this.material.shapes.add(this);this.filter.shapes.add(this);null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},removedFromSpace:function(){this.__iremovedFromSpace();
this.material.shapes.remove(this);this.filter.shapes.remove(this);null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},__class__:Od});var Ig=function(){this.radius=0;this.outer_zn=null;Od.call(this,g.id_ShapeType_CIRCLE);this.circle=this;this.zip_localCOM=!1};h["zpp_nape.shape.ZPP_Circle"]=Ig;Ig.__name__=["zpp_nape","shape","ZPP_Circle"];Ig.__super__=Od;Ig.prototype=x(Od.prototype,{invalidate_radius:function(){this.invalidate_area_inertia();this.invalidate_angDrag();this.zip_aabb=
!0;null!=this.body&&(this.body.zip_aabb=!0);null!=this.body&&this.body.wake()},__validate_aabb:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==g.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),
this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));var a=this.radius,b=this.radius;this.aabb.minx=this.worldCOMx-a;this.aabb.miny=this.worldCOMy-b;this.aabb.maxx=this.worldCOMx+a;this.aabb.maxy=this.worldCOMy+b},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy);this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy);this.aabb.minx=this.worldCOMx-
this.radius;this.aabb.miny=this.worldCOMy-this.radius;this.aabb.maxx=this.worldCOMx+this.radius;this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy);this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var a=this.radius*this.radius;this.area=a*Math.PI;this.inertia=0.5*a+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},__validate_angDrag:function(){var a=
this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,b=this.radius*this.radius;this.angDrag=(a+2*b)*this.material.dynamicFriction*v.fluidAngularDragFriction+0.5*v.fluidAngularDrag*(1+v.fluidVacuumDrag)*a;this.angDrag/=2*(a+0.5*b)},__class__:Ig});var Ja=function(){this.tp0=this.tp1=0;this.lp0=this.gp0=this.lp1=this.gp1=null;this.length=this.lprojection=this.gprojection=0;this.wrap_gnorm=null;this.gnormx=this.gnormy=0;this.wrap_lnorm=null;this.lnormx=this.lnormy=0;this.next=this.polygon=this.outer=
null;this.gprojection=this.lprojection=this.length=this.gnormy=this.gnormx=this.lnormy=this.lnormx=0};h["zpp_nape.shape.ZPP_Edge"]=Ja;Ja.__name__=["zpp_nape","shape","ZPP_Edge"];Ja.prototype={wrapper:function(){null==this.outer&&(Ja.internal=!0,this.outer=new ij,Ja.internal=!1,this.outer.zpp_inner=this);return this.outer},__class__:Ja};var Kg=function(){this.reverse_flag=this.zip_lverts=this.zip_laxi=this.zip_gverts=this.zip_gaxi=this.zip_valid=this.zip_sanitation=!1;this.edgeCnt=0;this.outer_zn=
this.lverts=this.wrap_lverts=this.gverts=this.wrap_gverts=this.edges=this.wrap_edges=null;Od.call(this,g.id_ShapeType_POLYGON);this.polygon=this;this.lverts=new ja;this.gverts=new ja;this.edges=new ak;this.edgeCnt=0};h["zpp_nape.shape.ZPP_Polygon"]=Kg;Kg.__name__=["zpp_nape","shape","ZPP_Polygon"];Kg.__super__=Od;Kg.prototype=x(Od.prototype,{lverts_pa_invalidate:function(){this.invalidate_lverts()},gverts_pa_validate:function(){this.validate_gverts()},lverts_post_adder:function(a){a.zpp_inner._invalidate=
u(this,this.lverts_pa_invalidate);for(var b=null,c=null,d=this.lverts.next;null!=d&&!(d==a.zpp_inner);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=ja.get(0,0,!0);this.gverts.insert(b,a);null!=this.lverts.next.next&&(null==this.lverts.next.next.next?(null==Ja.zpp_pool?c=new Ja:(c=Ja.zpp_pool,Ja.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),null==Ja.zpp_pool?c=new Ja:(c=Ja.zpp_pool,Ja.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),
this.edgeCnt+=2):(null==Ja.zpp_pool?b=new Ja:(b=Ja.zpp_pool,Ja.zpp_pool=b.next,b.next=null),null,b.polygon=this,this.edges.insert(c,b),this.edgeCnt++));a._validate=u(this,this.gverts_pa_validate)},lverts_subber:function(a){this.cleanup_lvert(a.zpp_inner)},lverts_invalidate:function(){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=$e.get(this.lverts);this.wrap_lverts.zpp_inner.post_adder=u(this,this.lverts_post_adder);this.wrap_lverts.zpp_inner.subber=
u(this,this.lverts_subber);this.wrap_lverts.zpp_inner._invalidate=u(this,this.lverts_invalidate);this.wrap_lverts.zpp_inner._validate=u(this,this.lverts_validate);this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},invalidate_lverts:function(){this.invalidate_laxi();this.invalidate_area_inertia();this.invalidate_angDrag();this.invalidate_localCOM();this.invalidate_gverts();this.zip_sanitation=this.zip_valid=this.zip_lverts=!0;null!=this.body&&this.body.wake()},invalidate_laxi:function(){this.invalidate_gaxi();
this.zip_laxi=this.zip_sweepRadius=!0},invalidate_gverts:function(){this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);this.zip_gverts=!0},invalidate_gaxi:function(){this.zip_gaxi=!0},validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.length&&(this.validate_area_inertia(),0>this.area&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(a){for(var b=null,c=null,d=this.lverts.next;null!=d&&!(d==a);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:
c.next;d=d.next}a=null==b?this.gverts.next:b.next;this.gverts.erase(b);null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=ja.zpp_pool;ja.zpp_pool=a;2==this.edgeCnt?(c=this.edges.pop_unsafe(),c.polygon=null,c.next=Ja.zpp_pool,Ja.zpp_pool=c,c=this.edges.pop_unsafe(),c.polygon=null,c.next=Ja.zpp_pool,Ja.zpp_pool=c,this.edgeCnt=0):0!=this.edgeCnt&&(b=null==c?this.edges.head.elt:c.next.elt,this.edges.erase(c),b.polygon=null,b.next=Ja.zpp_pool,
Ja.zpp_pool=b,this.edgeCnt--)},splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(!(null==this.lverts.next||null==this.lverts.next.next)&&null!=this.lverts.next.next.next){for(var a=null,b=this.lverts.next;null!=b;){var c=b,d=null==b.next?this.lverts.next:b.next;Tb.vec_dsq(c.x,c.y,d.x,d.y)<v.epsilon*v.epsilon?(this.cleanup_lvert(b),b=this.lverts.erase(a)):(a=b,b=b.next)}if(null!=this.lverts.next){do{a=!1;for(b=
this.lverts.next;null!=b;){var c=null==b.next?this.lverts.next:b.next,e=b,d=c,f=null==c.next?this.lverts.next:c.next,i=0,g=0,i=d.x-e.x,g=d.y-e.y,h=e=0,e=f.x-d.x,h=f.y-d.y,d=h*i-e*g;d*d>=v.epsilon*v.epsilon||(this.cleanup_lvert(c),this.lverts.erase(null==b.next?null:b),a=!0);b=b.next}}while(a)}}},reverse_vertices:function(){this.lverts.reverse();this.gverts.reverse();this.edges.reverse();var a=this.edges.iterator_at(this.edgeCnt-1),b=this.edges.pop_unsafe();this.edges.insert(a,b);this.reverse_flag=
!this.reverse_flag;null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1;this.validate_lverts();for(var a=this.edges.head,b=this.lverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.lp0=c;e.lp1=d;var f=0,i=0,f=c.x-d.x,i=c.y-d.y,g=Math.sqrt(f*
f+i*i);e.length=g;g=1/g;f*=g;i*=g;g=f;f=-i;i=g;e.lprojection=f*c.x+i*c.y;e.lnormx=f;e.lnormy=i;null!=e.wrap_lnorm&&(e.wrap_lnorm.zpp_inner.x=f,e.wrap_lnorm.zpp_inner.y=i);c=d;b=b.next}e=this.lverts.next;a=a.elt;a.lp0=c;a.lp1=e;d=b=0;b=c.x-e.x;d=c.y-e.y;e=Math.sqrt(b*b+d*d);a.length=e;e=1/e;f=b*e;b=-(d*e);d=f;a.lprojection=b*c.x+d*c.y;a.lnormx=b;a.lnormy=d;null!=a.wrap_lnorm&&(a.wrap_lnorm.zpp_inner.x=b,a.wrap_lnorm.zpp_inner.y=d)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=
!1;this.validate_lverts();this.body.validate_axis();for(var a=this.lverts.next,b=this.gverts.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);b=b.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1;this.validate_laxi();this.body.validate_axis();this.validate_gverts();for(var a=this.edges.head,b=this.gverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;
e.gp0=c;e.gp1=d;e.gnormx=this.body.axisy*e.lnormx-this.body.axisx*e.lnormy;e.gnormy=e.lnormx*this.body.axisx+e.lnormy*this.body.axisy;e.gprojection=this.body.posx*e.gnormx+this.body.posy*e.gnormy+e.lprojection;null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy);e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy;e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy;c=d;b=b.next}b=this.gverts.next;a=a.elt;a.gp0=c;a.gp1=b;a.gnormx=this.body.axisy*a.lnormx-this.body.axisx*a.lnormy;a.gnormy=
a.lnormx*this.body.axisx+a.lnormy*this.body.axisy;a.gprojection=this.body.posx*a.gnormx+this.body.posy*a.gnormy+a.lprojection;null!=a.wrap_gnorm&&(a.wrap_gnorm.zpp_inner.x=a.gnormx,a.wrap_gnorm.zpp_inner.y=a.gnormy);a.tp0=a.gp0.y*a.gnormx-a.gp0.x*a.gnormy;a.tp1=a.gp1.y*a.gnormx-a.gp1.x*a.gnormy}},__validate_aabb:function(){this.validate_gverts();var a=this.gverts.next;this.aabb.minx=a.x;this.aabb.miny=a.y;this.aabb.maxx=a.x;this.aabb.maxy=a.y;for(a=this.gverts.next.next;null!=a;){var b=a;b.x<this.aabb.minx&&
(this.aabb.minx=b.x);b.x>this.aabb.maxx&&(this.aabb.maxx=b.x);b.y<this.aabb.miny&&(this.aabb.miny=b.y);b.y>this.aabb.maxy&&(this.aabb.maxy=b.y);a=a.next}},_force_validate_aabb:function(){var a=this.lverts.next,b=this.gverts.next,c=a,a=a.next;b.x=this.body.posx+(this.body.axisy*c.x-this.body.axisx*c.y);b.y=this.body.posy+(c.x*this.body.axisx+c.y*this.body.axisy);this.aabb.minx=b.x;this.aabb.miny=b.y;this.aabb.maxx=b.x;this.aabb.maxy=b.y;for(b=this.gverts.next.next;null!=b;){var c=b,d=a,a=a.next;c.x=
this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);c.x<this.aabb.minx&&(this.aabb.minx=c.x);c.x>this.aabb.maxx&&(this.aabb.maxx=c.x);c.y<this.aabb.miny&&(this.aabb.miny=c.y);c.y>this.aabb.maxy&&(this.aabb.maxy=c.y);b=b.next}},__validate_sweepRadius:function(){var a=0,b=0;this.validate_laxi();for(var c=this.lverts.next;null!=c;){var d=c,d=d.x*d.x+d.y*d.y;d>a&&(a=d);c=c.next}for(c=this.edges.head;null!=c;){d=c.elt;if(d.lprojection<b&&
(b=d.lprojection,0>b))break;c=c.next}0>b&&(b=0);this.sweepRadius=Math.sqrt(a);this.sweepCoef=this.sweepRadius-b},__validate_area_inertia:function(){if(null==this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.inertia=this.area=0;else{for(var a=this.area=0,b=0,c=this.lverts.next,d=c,e=c=c.next,c=c.next;null!=c;){var f=c,i=e.y*d.x-e.x*d.y,a=a+i*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y)),b=b+i;this.area+=e.x*(f.y-d.y);d=e;e=f;c=c.next}i=c=this.lverts.next;
f=e.y*d.x-e.x*d.y;a+=f*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(i.y-d.y);d=e;e=i;c=c.next;i=e.y*d.x-e.x*d.y;a+=i*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(c.y-d.y);this.inertia=a/(6*(b+f+i));this.area*=0.5;0>this.area&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){this.validate_area_inertia();this.validate_laxi();for(var a=0,b=this.edges.head,c=0,d=this.lverts.next,e=d,d=d.next;null!=d;){var f=d,i=b.elt,b=b.next,
c=c+i.length,g=0,h=0,g=f.x-e.x,h=f.y-e.y,a=a+i.length*v.fluidAngularDragFriction*this.material.dynamicFriction*i.lprojection*i.lprojection,j=-(e.y*i.lnormx-e.x*i.lnormy)/(h*i.lnormx-g*i.lnormy);if(0<j){var k;k=1<j?1:j;var l=0,m=0,l=e.x,m=e.y,n=k,l=l+g*n,m=m+h*n,n=i.lnormy*e.x-i.lnormx*e.y,l=i.lnormy*l-i.lnormx*m,a=a+(l*l*l-n*n*n)/(3*(l-n))*k*i.length*v.fluidAngularDrag}1>j&&(j=0>j?0:j,l=k=0,k=e.x,l=e.y,e=j,k+=g*e,l+=h*e,e=i.lnormy*k-i.lnormx*l,g=i.lnormy*f.x-i.lnormx*f.y,a+=(g*g*g-e*e*e)/(3*(g-e))*
v.fluidVacuumDrag*(1-j)*i.length*v.fluidAngularDrag);e=f;d=d.next}d=this.lverts.next;b=b.elt;c+=b.length;i=f=0;f=d.x-e.x;i=d.y-e.y;a+=b.length*v.fluidAngularDragFriction*this.material.dynamicFriction*b.lprojection*b.lprojection;g=-(e.y*b.lnormx-e.x*b.lnormy)/(i*b.lnormx-f*b.lnormy);0<g&&(h=1<g?1:g,l=k=0,k=e.x,l=e.y,j=b.lnormy*e.x-b.lnormx*e.y,k=b.lnormy*(k+f*h)-b.lnormx*(l+i*h),a+=(k*k*k-j*j*j)/(3*(k-j))*h*b.length*v.fluidAngularDrag);1>g&&(g=0>g?0:g,j=h=0,h=e.x,j=e.y,e=b.lnormy*(h+f*g)-b.lnormx*
(j+i*g),d=b.lnormy*d.x-b.lnormx*d.y,a+=(d*d*d-e*e*e)/(3*(d-e))*v.fluidVacuumDrag*(1-g)*b.length*v.fluidAngularDrag);this.angDrag=a/(this.inertia*c)},__validate_localCOM:function(){if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y,this.localCOMx+=1*this.lverts.next.next.x,this.localCOMy+=1*this.lverts.next.next.y,this.localCOMx*=0.5,this.localCOMy*=
0.5;else{for(var a=this.localCOMy=this.localCOMx=0,b=this.lverts.next,c=b,d=b=b.next,b=b.next;null!=b;){var e=b,a=a+d.x*(e.y-c.y),c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next}e=b=this.lverts.next;a+=d.x*(e.y-c.y);c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next;a+=d.x*(b.y-c.y);c=b.y*d.x-b.x*d.y;this.localCOMx+=(d.x+b.x)*c;this.localCOMy+=(d.y+b.y)*c;a=1/(3*a);this.localCOMx*=a;this.localCOMy*=a}},__class__:Kg});
var ae=function(){this.sweep=this.dynab=null;this.is_sweep=!1;this.space=null};h["zpp_nape.space.ZPP_Broadphase"]=ae;ae.__name__=["zpp_nape","space","ZPP_Broadphase"];ae.prototype={insert:function(a){this.is_sweep?this.sweep.__insert(a):this.dynab.__insert(a)},remove:function(a){this.is_sweep?this.sweep.__remove(a):this.dynab.__remove(a)},sync:function(a){this.is_sweep?!this.sweep.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,a.type==g.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()):
this.dynab.__sync(a)},broadphase:function(){},__class__:ae};var eb=function(){this.synced=this.first_sync=!1;this.snext=null;this.moved=!1;this.next=this.mnext=null;this.height=0;this.parent=this.child1=this.child2=null;this.dyn=!1;this.aabb=this.shape=null;this.height=-1};h["zpp_nape.space.ZPP_AABBNode"]=eb;eb.__name__=["zpp_nape","space","ZPP_AABBNode"];eb.prototype={free:function(){this.height=-1;var a=this.aabb;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a.wrap_min=a.wrap_max=null;a._invalidate=
null;a._validate=null;a.next=la.zpp_pool;la.zpp_pool=a;this.mnext=this.snext=this.next=this.child1=this.child2=this.parent=null},__class__:eb};var Ka=function(){this.arb=this.next=null;this.id=this.di=0;this.first=this.sleeping=!1;this.n1=this.n2=null};h["zpp_nape.space.ZPP_AABBPair"]=Ka;Ka.__name__=["zpp_nape","space","ZPP_AABBPair"];Ka.prototype={__class__:Ka};var Ub=function(){this.root=null};h["zpp_nape.space.ZPP_AABBTree"]=Ub;Ub.__name__=["zpp_nape","space","ZPP_AABBTree"];Ub.prototype={inlined_insertLeaf:function(a){if(null==
this.root)this.root=a,this.root.parent=null;else{for(var b=a.aabb,c=this.root;null!=c.child1;){var d=c.child1,e=c.child2,f=c.aabb.perimeter();Ub.tmpaabb.setCombine(c.aabb,b);var i=Ub.tmpaabb.perimeter(),g=2*i,f=2*(i-f);Ub.tmpaabb.setCombine(b,d.aabb);null==d.child1?i=Ub.tmpaabb.perimeter()+f:(i=d.aabb.perimeter(),i=Ub.tmpaabb.perimeter()-i+f);Ub.tmpaabb.setCombine(b,e.aabb);if(null==e.child1)f=Ub.tmpaabb.perimeter()+f;else var h=e.aabb.perimeter(),f=Ub.tmpaabb.perimeter()-h+f;if(g<i&&g<f)break;else c=
i<f?d:e}d=c.parent;null==eb.zpp_pool?e=new eb:(e=eb.zpp_pool,eb.zpp_pool=e.next,e.next=null);null==la.zpp_pool?e.aabb=new la:(e.aabb=la.zpp_pool,la.zpp_pool=e.aabb.next,e.aabb.next=null);null;e.moved=!1;e.synced=!1;e.first_sync=!1;e.parent=d;e.aabb.setCombine(b,c.aabb);e.height=c.height+1;null!=d?(d.child1==c?d.child1=e:d.child2=e,e.child1=c,e.child2=a,c.parent=e,a.parent=e):(e.child1=c,e.child2=a,c.parent=e,this.root=a.parent=e);for(c=a.parent;null!=c;)c=this.balance(c),a=c.child1,b=c.child2,d=a.height,
e=b.height,c.height=1+(d>e?d:e),c.aabb.setCombine(a.aabb,b.aabb),c=c.parent}},removeLeaf:function(a){this.inlined_removeLeaf(a)},inlined_removeLeaf:function(a){if(a==this.root)this.root=null;else{var b=a.parent,c=b.parent,a=b.child1==a?b.child2:b.child1;if(null!=c){c.child1==b?c.child1=a:c.child2=a;a.parent=c;b.free();b.next=eb.zpp_pool;eb.zpp_pool=b;for(b=c;null!=b;)b=this.balance(b),a=b.child1,c=b.child2,b.aabb.setCombine(a.aabb,c.aabb),a=a.height,c=c.height,b.height=1+(a>c?a:c),b=b.parent}else this.root=
a,a.parent=null,b.free(),b.next=eb.zpp_pool,eb.zpp_pool=b}},balance:function(a){if(null==a.child1||2>a.height)return a;var b=a.child1,c=a.child2,d=c.height-b.height;if(1<d){var e=c.child1,f=c.child2;c.child1=a;c.parent=a.parent;a.parent=c;null!=c.parent?c.parent.child1==a?c.parent.child1=c:c.parent.child2=c:this.root=c;e.height>f.height?(c.child2=e,a.child2=f,f.parent=a,a.aabb.setCombine(b.aabb,f.aabb),c.aabb.setCombine(a.aabb,e.aabb),a.height=1+function(){var a=b.height,c=f.height;return a>c?a:c}(this),
c.height=1+function(){var b=a.height,c=e.height;return b>c?b:c}(this)):(c.child2=f,a.child2=e,e.parent=a,a.aabb.setCombine(b.aabb,e.aabb),c.aabb.setCombine(a.aabb,f.aabb),a.height=1+function(){var a=b.height,c=e.height;return a>c?a:c}(this),c.height=1+function(){var b=a.height,c=f.height;return b>c?b:c}(this));return c}if(-1>d){var g=b.child1,h=b.child2;b.child1=a;b.parent=a.parent;a.parent=b;null!=b.parent?b.parent.child1==a?b.parent.child1=b:b.parent.child2=b:this.root=b;g.height>h.height?(b.child2=
g,a.child1=h,h.parent=a,a.aabb.setCombine(c.aabb,h.aabb),b.aabb.setCombine(a.aabb,g.aabb),a.height=1+function(){var a=c.height,b=h.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=g.height;return b>c?b:c}(this)):(b.child2=h,a.child1=g,g.parent=a,a.aabb.setCombine(c.aabb,g.aabb),b.aabb.setCombine(a.aabb,h.aabb),a.height=1+function(){var a=c.height,b=g.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=h.height;return b>c?b:c}(this));return b}return a},__class__:Ub};
var ii=function(a){this.stree=this.dtree=this.pairs=this.syncs=this.moves=null;ae.call(this);this.space=a;this.is_sweep=!1;this.dynab=this;this.stree=new Ub;this.dtree=new Ub};h["zpp_nape.space.ZPP_DynAABBPhase"]=ii;ii.__name__=["zpp_nape","space","ZPP_DynAABBPhase"];ii.__super__=ae;ii.prototype=x(ae.prototype,{__insert:function(a){var b;null==eb.zpp_pool?b=new eb:(b=eb.zpp_pool,eb.zpp_pool=b.next,b.next=null);null==la.zpp_pool?b.aabb=new la:(b.aabb=la.zpp_pool,la.zpp_pool=b.aabb.next,b.aabb.next=
null);null;b.moved=!1;b.synced=!1;b.first_sync=!1;b.shape=a;a.node=b;b.synced=!0;b.first_sync=!0;b.snext=this.syncs;this.syncs=b},__remove:function(a){var b=a.node;b.first_sync||(b.dyn?this.dtree.removeLeaf(b):this.stree.removeLeaf(b));a.node=null;if(b.synced){for(var c=null,d=this.syncs;null!=d&&!(d==b);){c=d;d=d.snext}null==c?this.syncs=d.snext:c.snext=d.snext;d.snext=null;b.synced=!1}if(b.moved){c=null;for(d=this.moves;null!=d&&!(d==b);){c=d;d=d.mnext}null==c?this.moves=d.mnext:c.mnext=d.mnext;
d.mnext=null;b.moved=!1}for(var c=null,e=this.pairs;null!=e;)d=e.next,e.n1==b||e.n2==b?(null==c?this.pairs=d:c.next=d,null!=e.arb&&(e.arb.pair=null),e.arb=null,e.n1.shape.pairs.remove(e),e.n2.shape.pairs.remove(e),e.n1=e.n2=null,e.sleeping=!1,e.next=Ka.zpp_pool,Ka.zpp_pool=e):c=e,e=d;for(;null!=a.pairs.head;)c=a.pairs.pop_unsafe(),c.n1==b?c.n2.shape.pairs.remove(c):c.n1.shape.pairs.remove(c),null!=c.arb&&(c.arb.pair=null),c.arb=null,c.n1=c.n2=null,c.sleeping=!1,c.next=Ka.zpp_pool,Ka.zpp_pool=c;b.free();
b.next=eb.zpp_pool;eb.zpp_pool=b},__sync:function(a){var b=a.node;if(!b.synced&&(!this.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,a.type==g.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()),b.dyn!=(a.body.type==g.id_BodyType_STATIC?!1:!a.body.component.sleeping)||!b.aabb.contains(a.aabb)))b.synced=!0,b.snext=this.syncs,this.syncs=b},broadphase:function(a,b){for(var c=this.syncs;null!=c;){var d=c.shape;c.first_sync?c.first_sync=!1:(c.dyn?this.dtree:this.stree).inlined_removeLeaf(c);
var e=c.aabb;!a.continuous&&d.zip_aabb&&null!=d.body&&(d.zip_aabb=!1,d.type==g.id_ShapeType_CIRCLE?d.circle.__validate_aabb():d.polygon.__validate_aabb());e.setExpand(d.aabb,3);((d.body.type==g.id_BodyType_STATIC?c.dyn=!1:c.dyn=!d.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(c);c.synced=!1;c=c.snext}for(;null!=this.syncs;)if(c=this.syncs,this.syncs=c.snext,c.snext=null,!c.moved&&(c.moved=!1,d=c.shape,!d.body.component.sleeping)){var e=c.aabb,f=null;null!=this.dtree.root&&(this.dtree.root.next=
f,f=this.dtree.root);for(;null!=f;){var i;i=f;f=i.next;i.next=null;if(i!=c)if(null==i.child1){var h=i.shape;if(h.body!=d.body&&!(h.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(i.aabb)){var j,k;d.id<h.id?(j=d.id,k=h.id):(j=h.id,k=d.id);for(var l=null,m=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=m;){var n=m.elt;if(n.id==j&&n.di==k){l=n;break}m=m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==Ka.zpp_pool?l=new Ka:
(l=Ka.zpp_pool,Ka.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=i,l.id=j,l.di=k,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),h.pairs.inlined_add(l))}}else e.intersect(i.aabb)&&(null!=i.child1&&(i.child1.next=f,f=i.child1),null!=i.child2&&(i.child2.next=f,f=i.child2))}null!=this.stree.root&&(this.stree.root.next=f,f=this.stree.root);for(;null!=f;)if(i=f,f=i.next,i.next=null,i!=c)if(null==i.child1){if(h=i.shape,h.body!=d.body&&!(h.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&
e.intersect(i.aabb)){d.id<h.id?(j=d.id,k=h.id):(j=h.id,k=d.id);l=null;for(m=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=m;){n=m.elt;if(n.id==j&&n.di==k){l=n;break}m=m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==Ka.zpp_pool?l=new Ka:(l=Ka.zpp_pool,Ka.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=i,l.id=j,l.di=k,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),h.pairs.inlined_add(l))}}else e.intersect(i.aabb)&&(null!=i.child1&&(i.child1.next=
f,f=i.child1),null!=i.child2&&(i.child2.next=f,f=i.child2))}for(;null!=this.moves;)if(c=this.moves,this.moves=c.mnext,c.mnext=null,c.moved=!1,d=c.shape,!d.body.component.sleeping){e=c.aabb;f=null;null!=this.dtree.root&&(this.dtree.root.next=f,f=this.dtree.root);for(;null!=f;)if(i=f,f=i.next,i.next=null,i!=c)if(null==i.child1){if(h=i.shape,h.body!=d.body&&!(h.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(i.aabb)){d.id<h.id?(j=d.id,k=h.id):(j=h.id,k=d.id);l=null;for(m=
(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=m;){n=m.elt;if(n.id==j&&n.di==k){l=n;break}m=m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==Ka.zpp_pool?l=new Ka:(l=Ka.zpp_pool,Ka.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=i,l.id=j,l.di=k,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),h.pairs.inlined_add(l))}}else e.intersect(i.aabb)&&(null!=i.child1&&(i.child1.next=f,f=i.child1),null!=i.child2&&(i.child2.next=f,f=i.child2));null!=
this.stree.root&&(this.stree.root.next=f,f=this.stree.root);for(;null!=f;)if(i=f,f=i.next,i.next=null,i!=c)if(null==i.child1){if(h=i.shape,h.body!=d.body&&!(h.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(i.aabb)){d.id<h.id?(j=d.id,k=h.id):(j=h.id,k=d.id);l=null;for(m=(d.pairs.length<h.pairs.length?d:h).pairs.head;null!=m;){n=m.elt;if(n.id==j&&n.di==k){l=n;break}m=m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==Ka.zpp_pool?
l=new Ka:(l=Ka.zpp_pool,Ka.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=i,l.id=j,l.di=k,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),h.pairs.inlined_add(l))}}else e.intersect(i.aabb)&&(null!=i.child1&&(i.child1.next=f,f=i.child1),null!=i.child2&&(i.child2.next=f,f=i.child2))}c=null;for(d=this.pairs;null!=d;)!d.first&&!d.n1.aabb.intersect(d.n2.aabb)?(null==c?this.pairs=d.next:c.next=d.next,d.n1.shape.pairs.inlined_try_remove(d),d.n2.shape.pairs.inlined_try_remove(d),e=d.next,null!=
d.arb&&(d.arb.pair=null),d.arb=null,d.n1=d.n2=null,d.sleeping=!1,d.next=Ka.zpp_pool,Ka.zpp_pool=d,d=e):(e=d.n1.shape,f=e.body,i=d.n2.shape,h=i.body,!d.first&&(f.component.sleeping||f.type==g.id_BodyType_STATIC)&&(h.component.sleeping||h.type==g.id_BodyType_STATIC)?(d.sleeping=!0,null==c?this.pairs=d.next:c.next=d.next):(d.first=!1,e.aabb.intersect(i.aabb)&&(c=d.arb,d.arb=b?a.narrowPhase(e,i,f.type!=g.id_BodyType_DYNAMIC||h.type!=g.id_BodyType_DYNAMIC,d.arb,!1):a.continuousEvent(e,i,f.type!=g.id_BodyType_DYNAMIC||
h.type!=g.id_BodyType_DYNAMIC,d.arb,!1),null==d.arb?null!=c&&(c.pair=null):d.arb.pair=d),c=d),d=d.next)},__class__:ii});var Sc=function(){this.waket=0;this.sleep=!1;this.comps=null;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.comps=new bk};h["zpp_nape.space.ZPP_Island"]=Sc;Sc.__name__=["zpp_nape","space","ZPP_Island"];Sc.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},__class__:Sc};var wa=function(){this.woken=!1;this.waket=0;this.sleeping=!1;this.body=this.constraint=this.island=null;this.isBody=!1;this.rank=0;this.next=this.parent=null;this.sleeping=!1;this.island=null;this.parent=this;this.rank=0;this.woken=!1};h["zpp_nape.space.ZPP_Component"]=wa;wa.__name__=
["zpp_nape","space","ZPP_Component"];wa.prototype={__class__:wa};var Hb=function(){this.freed=this.lazydel=!1;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.int1=this.int2=this.next=null;this.id=this.di=0;this.arbiters=new Sf};h["zpp_nape.space.ZPP_CallbackSet"]=Hb;Hb.__name__=["zpp_nape","space","ZPP_CallbackSet"];Hb.get=function(a,b){var c;null==Hb.zpp_pool?c=new Hb:(c=Hb.zpp_pool,Hb.zpp_pool=c.next,c.next=null);c.freed=!1;c.lazydel=!1;c.COLLISIONstate=g.id_PreFlag_ACCEPT;c.COLLISIONstamp=
0;c.SENSORstate=g.id_PreFlag_ACCEPT;c.SENSORstamp=0;c.FLUIDstate=g.id_PreFlag_ACCEPT;c.FLUIDstamp=0;a.id<b.id?(c.int1=a,c.int2=b):(c.int1=b,c.int2=a);c.id=c.int1.id;c.di=c.int2.id;return c};Hb.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=
!0;this.length--;this.pushmod=!0;return c},remove_arb:function(a){this.arbiters.inlined_try_remove(a)},empty_arb:function(a){var b;b=!0;for(var c=this.arbiters.head;null!=c;)if(0==(c.elt.type&a))c=c.next;else{b=!1;break}return b},sleeping:function(){var a;a=!0;for(var b=this.arbiters.head;null!=b;)if(b.elt.sleeping)b=b.next;else{a=!1;break}return a},__class__:Hb};var ck=function(a){this.cbsets=this.space=null;null==vb.zpp_pool?this.cbsets=new vb:(this.cbsets=vb.zpp_pool,vb.zpp_pool=this.cbsets.next,
this.cbsets.next=null);null;this.cbsets.lt=ta.setlt;this.space=a};h["zpp_nape.space.ZPP_CbSetManager"]=ck;ck.__name__=["zpp_nape","space","ZPP_CbSetManager"];ck.prototype={get:function(a){if(null==a.head)return null;var b;null==ta.zpp_pool?b=new ta:(b=ta.zpp_pool,ta.zpp_pool=b.next,b.next=null);null;var c=b.cbTypes;b.cbTypes=a;var d=this.cbsets.find_weak(b);null!=d?a=d.data:(a=ta.get(a),this.cbsets.insert(a),a.manager=this);b.cbTypes=c;b.free();b.next=ta.zpp_pool;ta.zpp_pool=b;return a},remove:function(a){for(this.cbsets.remove(a);null!=
a.cbpairs.head;){var b=a.cbpairs.pop_unsafe();b.a!=b.b&&(a==b.a?b.b.cbpairs.remove(b):b.a.cbpairs.remove(b));b.a=b.b=null;b.listeners.clear();b.next=Sb.zpp_pool;Sb.zpp_pool=b}a.manager=null},validate:function(){if(!this.cbsets.empty()){for(var a=this.cbsets.parent;null!=a.prev;)a=a.prev;for(;null!=a;)if(a.data.validate(),null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}},pair:function(a,b){for(var c=null,d=(a.cbpairs.length<b.cbpairs.length?
a.cbpairs:b.cbpairs).head;null!=d;){var e=d.elt;if(e.a==a&&e.b==b||e.a==b&&e.b==a){c=e;break}d=d.next}null==c&&(c=Sb.get(a,b),a.cbpairs.add(c),b!=a&&b.cbpairs.add(c));c.zip_listeners&&(c.zip_listeners=!1,c.__validate());return c},__class__:ck};var kj=function(a,b){this.precb=this.prelisteners=null;this.continuous=!1;this.toiEvents=null;this.pre_dt=0;this.c_arbiters_true=this.c_arbiters_false=this.f_arbiters=this.s_arbiters=this.live=this.wrap_live=this.live_constraints=this.wrap_livecon=this.staticsleep=
this.islands=this.listeners=this.wrap_listeners=this.callbacks=this.callbackset_list=this.cbsets=null;this.sortcontacts=!1;this.time=0;this.midstep=!1;this.global_lin_drag=this.global_ang_drag=this.stamp=0;this.bodies=this.wrap_bodies=this.compounds=this.wrap_compounds=this.constraints=this.wrap_constraints=this.kinematics=this.bphase=this.__static=null;this.gravityx=this.gravityy=0;this.outer=null;this.toiEvents=new dk;this.global_ang_drag=this.global_lin_drag=0.015;this.precb=new Dg;this.precb.zpp_inner=
new fd;this.sortcontacts=!0;this.pre_dt=0;var c;if(!(c=null==b))null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new Ge,g.internal=!1),c=b==g.Broadphase_DYNAMIC_AABB_TREE;c?this.bphase=new ii(this):(null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new Ge,g.internal=!1),b==g.Broadphase_SWEEP_AND_PRUNE&&(this.bphase=new ji(this)));this.time=0;null!=a?(this.gravityx=a.x,this.gravityy=a.y):this.gravityy=this.gravityx=0;this.bodies=new be;
this.wrap_bodies=ac.get(this.bodies);this.wrap_bodies.zpp_inner.adder=u(this,this.bodies_adder);this.wrap_bodies.zpp_inner.subber=u(this,this.bodies_subber);this.compounds=new ki;this.wrap_compounds=Bb.get(this.compounds);this.wrap_compounds.zpp_inner.adder=u(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=u(this,this.compounds_subber);this.kinematics=new be;this.c_arbiters_true=new li;this.c_arbiters_false=new li;this.f_arbiters=new ek;this.s_arbiters=new fk;this.islands=new Sc;this.live=
new be;this.wrap_live=ac.get(this.live,!0);this.staticsleep=new be;this.constraints=new dd;this.wrap_constraints=qc.get(this.constraints);this.wrap_constraints.zpp_inner.adder=u(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=u(this,this.constraints_subber);this.live_constraints=new dd;this.wrap_livecon=qc.get(this.live_constraints,!0);this.__static=Gc.__static();this.__static.zpp_inner.space=this;this.callbacks=new fd;this.midstep=!1;this.listeners=new mi;this.wrap_listeners=
pc.get(this.listeners);this.wrap_listeners.zpp_inner.adder=u(this,this.listeners_adder);this.wrap_listeners.zpp_inner.subber=u(this,this.listeners_subber);this.callbackset_list=new Hb;this.mrca1=new Xd;this.mrca2=new Xd;this.prelisteners=new Me;this.cbsets=new ck(this)};h["zpp_nape.space.ZPP_Space"]=kj;kj.__name__=["zpp_nape","space","ZPP_Space"];kj.prototype={bodies_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(a),
this.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){this.remBody(a.zpp_inner)},compounds_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_compounds.remove(a),this.addCompound(a.zpp_inner),!0):!1},compounds_subber:function(a){this.remCompound(a.zpp_inner)},constraints_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(a),this.addConstraint(a.zpp_inner),!0):!1},
constraints_subber:function(a){this.remConstraint(a.zpp_inner)},listeners_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(a),this.addListener(a.zpp_inner),!0):!1},listeners_subber:function(a){this.remListener(a.zpp_inner)},addListener:function(a){a.space=this;a.addedToSpace();null!=a.interaction&&null},remListener:function(a){null!=a.interaction&&null;a.removedFromSpace();a.space=null},add_callbackset:function(a){a.int1.cbsets.inlined_add(a);
a.int2.cbsets.inlined_add(a);this.callbackset_list.inlined_add(a)},remove_callbackset:function(a){a.lazydel=!0;a.int1.cbsets.inlined_try_remove(a);a.int2.cbsets.inlined_try_remove(a)},transmitType:function(a,b){a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1));a.type==g.id_BodyType_DYNAMIC?this.live.remove(a):a.type==g.id_BodyType_KINEMATIC?(this.kinematics.remove(a),this.staticsleep.remove(a)):
a.type==g.id_BodyType_STATIC&&this.staticsleep.remove(a);a.type=b;a.type==g.id_BodyType_KINEMATIC&&this.kinematics.add(a);a.type==g.id_BodyType_STATIC&&this.static_validation(a);a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0))},added_shape:function(a,b){null==b&&(b=!1);if(!b){var c=a.body;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==g.id_BodyType_KINEMATIC&&
(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1))}this.bphase.insert(a);a.addedToSpace()},removed_shape:function(a,b){null==b&&(b=!1);var c=this,d=a.body;b||d.wake();for(var e=null,f=d.arbiters.head;null!=f;){var i=[f.elt];if(i[0].ws1==a||i[0].ws2==a){if(0!=i[0].present){this.MRCA_chains(i[0].ws1,i[0].ws2);for(f=this.mrca1.head;null!=f;){for(var h=f.elt,j=this.mrca2.head;null!=j;){var k=j.elt,l=h.cbSet,m=k.cbSet;l.validate();m.validate();l.manager.pair(l,m).empty_intersection()||
(k=[Ba.get(h,k)],k[0].remove_arb(i[0]),i[0].present--,l.manager.pair(l,m).forall(g.id_CbEvent_END,function(a,b){return function(d){if(0!=(d.itype&b[0].type)&&a[0].empty_arb(d.itype)){var e=c.push_callback(d);e.event=g.id_CbEvent_END;Ba.int_callback(a[0],d,e);e.set=a[0]}}}(k,i)),null==k[0].arbiters.head&&this.remove_callbackset(k[0]));j=j.next}f=f.next}}i[0].b1!=d&&i[0].b1.type==g.id_BodyType_DYNAMIC&&(f=i[0].b1,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==g.id_BodyType_KINEMATIC&&
(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));i[0].b2!=d&&i[0].b2.type==g.id_BodyType_DYNAMIC&&(f=i[0].b2,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==g.id_BodyType_KINEMATIC&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));i[0].cleared=!0;(null==d||i[0].b2==d)&&i[0].b1.arbiters.inlined_try_remove(i[0]);(null==d||i[0].b1==d)&&i[0].b2.arbiters.inlined_try_remove(i[0]);null!=i[0].pair&&(i[0].pair.arb=null,i[0].pair=null);i[0].active=
!1;this.f_arbiters.modified=!0;f=d.arbiters.erase(e)}else e=f,f=f.next}this.bphase.remove(a);a.removedFromSpace()},addConstraint:function(a){a.space=this;a.addedToSpace();a.active&&(a.component.sleeping=!0,this.wake_constraint(a,!0))},remConstraint:function(a){a.active&&(this.wake_constraint(a,!0),this.live_constraints.remove(a));a.removedFromSpace();a.space=null},addCompound:function(a){a.space=this;a.addedToSpace();for(var b=a.bodies.head;null!=b;)this.addBody(b.elt),b=b.next;for(b=a.constraints.head;null!=
b;)this.addConstraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.addCompound(a.elt),a=a.next},remCompound:function(a){for(var b=a.bodies.head;null!=b;)this.remBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.remConstraint(b.elt),b=b.next;for(b=a.compounds.head;null!=b;)this.remCompound(b.elt),b=b.next;a.removedFromSpace();a.space=null},addBody:function(a,b){null==b&&(b=-1);a.space=this;a.addedToSpace();a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?
0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0));for(var c=a.shapes.head;null!=c;)this.added_shape(c.elt,!0),c=c.next;a.type==g.id_BodyType_STATIC?this.static_validation(a):a.type!=g.id_BodyType_DYNAMIC&&b!=g.id_BodyType_KINEMATIC&&this.kinematics.add(a)},remBody:function(a,b){null==b&&(b=-1);a.type==g.id_BodyType_STATIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),
a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a)):a.type==g.id_BodyType_DYNAMIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.live.remove(a)):(b!=g.id_BodyType_KINEMATIC&&this.kinematics.remove(a),a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,
!0)),this.staticsleep.remove(a));for(var c=a.shapes.head;null!=c;)this.removed_shape(c.elt,!0),c=c.next;a.removedFromSpace();a.space=null},push_callback:function(a){var b;null==fd.zpp_pool?b=new fd:(b=fd.zpp_pool,fd.zpp_pool=b.next,b.next=null);null;this.callbacks.push(b);b.listener=a;return b},step:function(a,b,c){var d=this;this.time+=a;this.pre_dt=a;this.midstep=!0;this.stamp++;this.validation();this.bphase.broadphase(this,!0);this.prestep(a);if(this.sortcontacts){var e=this.c_arbiters_false;if(null!=
e.head&&null!=e.head.next){var f=e.head,i=null,h=null,j=null,k=null,l=1,m,n,p;do{m=0;h=f;for(i=f=null;null!=h;){m++;j=h;n=0;for(p=l;null!=j&&n<l;)n++,j=j.next;for(;0<n||0<p&&null!=j;)0==n?(k=j,j=j.next,p--):0==p||null==j?(k=h,h=h.next,n--):(h.elt.active&&j.elt.active?h.elt.oc1.dist<j.elt.oc1.dist:1)?(k=h,h=h.next,n--):(k=j,j=j.next,p--),null!=i?i.next=k:f=k,i=k;h=j}i.next=null;l<<=1}while(1<m);e.head=f;e.modified=!0;e.pushmod=!0}}this.updateVel(a);this.warmStart();this.iterateVel(b);for(b=this.kinematics.head;null!=
b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;for(b=this.live.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;this.updatePos(a);this.continuous=!0;this.continuousCollisions(a);this.continuous=!1;this.iteratePos(c);for(c=this.kinematics.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;for(c=this.live.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&
b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;c=null;for(b=this.staticsleep.head;null!=b;)e=b.elt,e.type!=g.id_BodyType_KINEMATIC||0==e.velx&&0==e.vely&&0==e.angvel?e.kinematicDelaySleep?(e.kinematicDelaySleep=!1,b=b.next):(e.component.sleeping=!0,b=this.staticsleep.inlined_erase(c)):(c=b,b=b.next);this.doForests(a);this.sleepArbiters();this.midstep=!1;c=null;for(a=this.callbackset_list.next;null!=a;)b=[a],null==b[0].arbiters.head?(a=this.callbackset_list.inlined_erase(c),
b=b[0],b.int1=b.int2=null,b.id=b.di=-1,b.freed=!0,null,b.next=Hb.zpp_pool,Hb.zpp_pool=b):(c=[b[0].sleeping()],ta.find_all(b[0].int1.cbSet,b[0].int2.cbSet,g.id_CbEvent_ONGOING,function(a,b){return function(c){if((!a[0]||c.allowSleepingCallbacks)&&!b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=g.id_CbEvent_ONGOING;Ba.int_callback(b[0],c,e);e.set=b[0]}}}(c,b)),c=a,a=a.next);for(;!this.callbacks.empty();)a=this.callbacks.pop(),a.listener.type==g.id_ListenerType_BODY?a.listener.body.handler(a.wrapper_body()):
a.listener.type==g.id_ListenerType_CONSTRAINT?a.listener.constraint.handler(a.wrapper_con()):a.listener.type==g.id_ListenerType_INTERACTION&&a.listener.interaction.handleri(a.wrapper_int()),a.int1=a.int2=null,a.body=null,a.constraint=null,a.listener=null,null!=a.wrap_arbiters&&(a.wrap_arbiters.zpp_inner.inner=null),a.set=null,a.next=fd.zpp_pool,fd.zpp_pool=a},continuousCollisions:function(a){var b=2*Math.PI/a;this.bphase.broadphase(this,!1);for(var c=0;1>c&&null!=this.toiEvents.head;){for(var d=null,
c=2,e=!1,f=null,i=null,h=this.toiEvents.head;null!=h;){var j=h.elt,k=j.s1.body,l=j.s2.body;if(k.sweepFrozen&&l.sweepFrozen)if(0!=j.toi&&J.testCollide_safe(j.s1,j.s2))j.toi=0;else{h=this.toiEvents.erase(i);j.next=Pa.zpp_pool;Pa.zpp_pool=j;continue}if(j.frozen1!=k.sweepFrozen||j.frozen2!=l.sweepFrozen)if(j.kinematic){h=this.toiEvents.erase(i);j.next=Pa.zpp_pool;Pa.zpp_pool=j;continue}else if(j.frozen1=k.sweepFrozen,j.frozen2=l.sweepFrozen,j.frozen1&&(k=j.s1,j.s1=j.s2,j.s2=k,j.frozen1=!1,j.frozen2=!0),
hd.staticSweep(j,a,0,v.collisionSlopCCD),0>j.toi){h=this.toiEvents.erase(i);j.next=Pa.zpp_pool;Pa.zpp_pool=j;continue}if(0<=j.toi&&(j.toi<c||!e&&j.kinematic))d=j,c=j.toi,e=j.kinematic,f=i;i=h;h=h.next}if(null==d)break;this.toiEvents.erase(f);c=d.toi;e=d.s1.body;f=d.s2.body;e.sweepFrozen||(e.sweepIntegrate(c*a),e.sweepValidate(d.s1));f.sweepFrozen||(f.sweepIntegrate(c*a),f.sweepValidate(d.s2));i=this.narrowPhase(d.s1,d.s2,!0,d.arbiter,!0);null==i?null!=d.arbiter&&null!=d.arbiter.pair&&(d.arbiter.pair.arb=
null,d.arbiter.pair=null):!this.presteparb(i,a,!0)&&i.type==pa.COL&&i.active&&0!=(i.immState&g.id_ImmState_ACCEPT)&&(i.colarb.warmStart(),i.colarb.applyImpulseVel(),i.colarb.applyImpulseVel(),i.colarb.applyImpulseVel(),i.colarb.applyImpulseVel(),e.sweep_angvel=e.angvel%b,f.sweep_angvel=f.angvel%b);null!=i&&i.active&&0!=(i.immState&g.id_ImmState_ACCEPT)&&i.type==pa.COL&&(!e.sweepFrozen&&e.type!=g.id_BodyType_KINEMATIC&&(e.sweepFrozen=!0,e.angvel=d.failed?e.sweep_angvel=0:d.slipped?e.sweep_angvel*=
v.angularCCDSlipScale:e.sweep_angvel),!f.sweepFrozen&&f.type!=g.id_BodyType_KINEMATIC&&(f.sweepFrozen=!0,f.angvel=d.failed?f.sweep_angvel=0:d.slipped?f.sweep_angvel*=v.angularCCDSlipScale:f.sweep_angvel));d.next=Pa.zpp_pool;Pa.zpp_pool=d}for(;null!=this.toiEvents.head;)b=this.toiEvents.pop_unsafe(),b.next=Pa.zpp_pool,Pa.zpp_pool=b;for(b=this.kinematics.head;null!=b;)d=b.elt,d.sweepIntegrate(a),d.sweepTime=0,b=b.next;for(b=this.live.head;null!=b;)d=b.elt,d.sweepFrozen||d.sweepIntegrate(a),d.sweepTime=
0,b=b.next},continuousEvent:function(a,b,c,d){if(a.body.sweepFrozen&&b.body.sweepFrozen||a.body.disableCCD||b.body.disableCCD||null!=d&&null==d.colarb||0>=this.interactionType(a,b,a.body,b.body))return d;var e=a.body,f=b.body;if(c||e.bullet||f.bullet){var i;null==Pa.zpp_pool?i=new Pa:(i=Pa.zpp_pool,Pa.zpp_pool=i.next,i.next=null);i.failed=!1;i.s1=i.s2=null;i.arbiter=null;e=e.type==g.id_BodyType_KINEMATIC||f.type==g.id_BodyType_KINEMATIC;c&&!e?(a.body.type!=g.id_BodyType_DYNAMIC?(i.s2=a,i.s1=b):(i.s1=
a,i.s2=b),i.kinematic=!1,hd.staticSweep(i,this.pre_dt,0,v.collisionSlopCCD)):(i.s1=a,i.s2=b,i.kinematic=e,i.s1.body.sweepFrozen||i.s2.body.sweepFrozen?(i.s1.body.sweepFrozen&&(a=i.s1,i.s1=i.s2,i.s2=a,i.frozen1=!1,i.frozen2=!0),hd.staticSweep(i,this.pre_dt,0,v.collisionSlopCCD)):hd.dynamicSweep(i,this.pre_dt,0,v.collisionSlopCCD));c&&0>i.toi||i.failed?(c=i,c.next=Pa.zpp_pool,Pa.zpp_pool=c):(this.toiEvents.add(i),i.frozen1=i.s1.body.sweepFrozen,i.frozen2=i.s2.body.sweepFrozen,i.arbiter=null!=d?d.colarb:
null)}return d},bodyCbWake:function(a){if(a.type==g.id_BodyType_DYNAMIC&&null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=g.id_CbEvent_WAKE,c.body=a);b=b.next}else a.component.woken=!0},bodyCbSleep:function(a){if(a.type==g.id_BodyType_DYNAMIC&&null!=a.cbSet)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=g.id_CbEvent_SLEEP,c.body=
a);b=b.next}},constraintCbWake:function(a){if(null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=g.id_CbEvent_WAKE,c.constraint=a);b=b.next}else a.component.woken=!0},constraintCbSleep:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=g.id_CbEvent_SLEEP,c.constraint=a);b=b.next}},constraintCbBreak:function(a){if(null!=
a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_BREAK&&(c=this.push_callback(c),c.event=g.id_CbEvent_BREAK,c.constraint=a);b=b.next}},nullListenerType:function(a,b){for(var c=new Xd,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),
d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=e;){var f=e.elt;if(0!=f.present&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(f=this.mrca1.head;null!=f;){var g=f.elt;if(!(g.cbSet!=a&&g.cbSet!=b))for(var h=this.mrca2.head;null!=h;){var j=h.elt;if(!(g.cbSet==a&&j.cbSet!=b||g.cbSet==b&&j.cbSet!=a))if(j=Ba.get(g,j),null!=j){for(;null!=j.arbiters.head;)j.arbiters.pop_unsafe().present--;this.remove_callbackset(j)}h=h.next}f=
f.next}}e=e.next}}},nullInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.nullInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.nullInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(0!=e.present&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var g=f.elt,
h=this.mrca2.head;null!=h;){var j=h.elt;g!=b&&j!=b||(j=Ba.get(g,j),null!=j&&(e.present--,j.remove_arb(e),null==j.arbiters.head&&this.remove_callbackset(j)));h=h.next}f=f.next}}d=d.next}}},freshListenerType:function(a,b){for(var c=new Xd,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=
d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=e;){var f=e.elt;if(f.presentable&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.head;null!=g;){var h=g.elt;if(!(h.cbSet!=a&&h.cbSet!=b))for(var j=this.mrca2.head;null!=j;){var k=j.elt;if(!(h.cbSet==a&&k.cbSet!=b||h.cbSet==b&&k.cbSet!=a)){var l=Ba.get(h,k);null==l&&(l=Hb.get(h,k),this.add_callbackset(l));if(k=!l.arbiters.inlined_has(f))l.arbiters.inlined_add(f),
k=!0;k&&f.present++}j=j.next}g=g.next}}e=e.next}}},freshInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.freshInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.freshInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(e.presentable&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=
f;){for(var g=f.elt,h=this.mrca2.head;null!=h;){var j=h.elt;if(!(g!=b&&j!=b)){var k=g.cbSet,l=j.cbSet;k.validate();l.validate();if(!k.manager.pair(k,l).empty_intersection()){k=Ba.get(g,j);null==k&&(k=Hb.get(g,j),this.add_callbackset(k));if(j=!k.arbiters.inlined_has(e))k.arbiters.inlined_add(e),j=!0;j&&e.present++}}h=h.next}f=f.next}}d=d.next}}},wakeCompound:function(a){for(var b=a.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==g.id_BodyType_KINEMATIC&&
(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=a.constraints.head;null!=b;)this.wake_constraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.wakeCompound(a.elt),a=a.next},wakeIsland:function(a){for(;null!=a.comps.head;){var b=a.comps.pop_unsafe();b.waket=this.stamp+(this.midstep?0:1);if(b.isBody){var c=b.body;this.live.add(c);for(var d=c.arbiters.head;null!=d;){var e=d.elt;e.sleeping&&(e.sleeping=!1,e.up_stamp+=this.stamp-e.sleep_stamp,e.type==pa.COL?
(e=e.colarb,e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)):e.type==pa.FLUID?this.f_arbiters.inlined_add(e.fluidarb):this.s_arbiters.inlined_add(e.sensorarb));d=d.next}this.bodyCbWake(c);b.sleeping=!1;b.island=null;b.parent=b;b.rank=0;if(c.type!=g.id_BodyType_STATIC)for(b=c.shapes.head;null!=b;)c=b.elt,null!=c.node&&this.bphase.sync(c),b=b.next}else c=b.constraint,this.live_constraints.inlined_add(c),this.constraintCbWake(c),b.sleeping=!1,b.island=null,b.parent=b,
b.rank=0}a.next=Sc.zpp_pool;Sc.zpp_pool=a},non_inlined_wake:function(a,b){null==b&&(b=!1);a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,b))},really_wake:function(a,b){null==b&&(b=!1);if(null==a.component.island){a.component.sleeping=!1;a.type==g.id_BodyType_KINEMATIC||a.type==g.id_BodyType_STATIC?this.staticsleep.inlined_add(a):this.live.inlined_add(a);for(var c=a.constraints.head;null!=
c;){var d=c.elt;d.space==this&&this.wake_constraint(d);c=c.next}for(c=a.arbiters.head;null!=c;){d=c.elt;if(d.sleeping)if(d.sleeping=!1,d.up_stamp+=this.stamp+(this.midstep?0:1)-d.sleep_stamp,d.type==pa.COL){var e=d.colarb;e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)}else d.type==pa.FLUID?this.f_arbiters.inlined_add(d.fluidarb):this.s_arbiters.inlined_add(d.sensorarb);d.type!=pa.SENSOR&&!d.cleared&&d.up_stamp>=this.stamp&&0!=(d.immState&g.id_ImmState_ACCEPT)&&(d.b1.type==
g.id_BodyType_DYNAMIC&&d.b1.component.sleeping&&(e=d.b1,e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==g.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1))),d.b2.type==g.id_BodyType_DYNAMIC&&d.b2.component.sleeping&&(d=d.b2,d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.type==g.id_BodyType_KINEMATIC&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))));c=c.next}!b&&a.type==g.id_BodyType_DYNAMIC&&this.bodyCbWake(a);
if(!b&&!this.bphase.is_sweep&&a.type!=g.id_BodyType_STATIC)for(c=a.shapes.head;null!=c;)d=c.elt,null!=d.node&&this.bphase.sync(d),c=c.next}else this.wakeIsland(a.component.island)},wake_constraint:function(a,b){null==b&&(b=!1);return a.active&&(a.component.waket=this.stamp+(this.midstep?0:1),a.component.sleeping)?(null==a.component.island?(a.component.sleeping=!1,this.live_constraints.inlined_add(a),a.wake_connected(),b||this.constraintCbWake(a)):this.wakeIsland(a.component.island),!0):!1},doForests:function(a){for(var b=
this.c_arbiters_false.head;null!=b;){var c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&g.id_ImmState_ACCEPT)&&c.b1.type==g.id_BodyType_DYNAMIC&&c.b2.type==g.id_BodyType_DYNAMIC){var d;if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(var e=null;d!=d.parent;){var f=d.parent;d.parent=e;e=d;d=f}for(;null!=e;)f=e.parent,e.parent=d,e=f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=
e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.f_arbiters.head;null!=b;){c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&g.id_ImmState_ACCEPT)&&c.b1.type==g.id_BodyType_DYNAMIC&&c.b2.type==g.id_BodyType_DYNAMIC){if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(e=null;d!=d.parent;)f=d.parent,d.parent=e,e=d,d=f;for(;null!=e;)f=e.parent,e.parent=d,e=
f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.live_constraints.head;null!=b;)b.elt.forest(),b=b.next;for(;null!=this.live.head;){d=this.live.inlined_pop_unsafe();b=d.component;if(b==b.parent)c=b;else{c=b;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=
e.parent,e.parent=c,e=f}null==c.island&&(null==Sc.zpp_pool?c.island=new Sc:(c.island=Sc.zpp_pool,Sc.zpp_pool=c.island.next,c.island.next=null),c.island.waket=0,this.islands.inlined_add(c.island),c.island.sleep=!0);b.island=c.island;b.island.comps.inlined_add(b);d=d.atRest(a);b.island.sleep=b.island.sleep&&d;b.waket>b.island.waket&&(b.island.waket=b.waket)}for(;null!=this.live_constraints.head;){a=this.live_constraints.inlined_pop_unsafe().component;if(a==a.parent)b=a;else{b=a;for(d=null;b!=b.parent;)c=
b.parent,b.parent=d,d=b,b=c;for(;null!=d;)c=d.parent,d.parent=b,d=c}a.island=b.island;a.island.comps.inlined_add(a);a.waket>a.island.waket&&(a.island.waket=a.waket)}for(;null!=this.islands.next;)if(a=this.islands.inlined_pop_unsafe(),a.sleep)for(a=a.comps.head;null!=a;){d=a.elt;if(d.isBody){b=d.body;b.velx=0;b.vely=0;b.angvel=0;d.sleeping=!0;for(d=b.shapes.head;null!=d;)this.bphase.sync(d.elt),d=d.next;this.bodyCbSleep(b)}else this.constraintCbSleep(d.constraint),d.sleeping=!0;a=a.next}else{for(;null!=
a.comps.head;)b=a.comps.inlined_pop_unsafe(),b.waket=a.waket,b.isBody?this.live.inlined_add(b.body):this.live_constraints.inlined_add(b.constraint),b.sleeping=!1,b.island=null,b.parent=b,b.rank=0;a.next=Sc.zpp_pool;Sc.zpp_pool=a}},sleepArbiters:function(){var a=null,b=this.c_arbiters_true,c=b.head,d=null!=this.c_arbiters_false;d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null);for(;null!=c;){var e=c.elt;e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,
e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next);d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null)}a=null;b=this.f_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,a=b=null);a=null;b=this.s_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):
(a=c,c=c.next),d&&null==c&&(d=!1,a=b=null)},static_validation:function(a){null!=a.shapes.head&&a.validate_aabb();a.validate_mass();a.validate_inertia();for(var b=a.shapes.head;null!=b;){var c=b.elt;c.type==g.id_ShapeType_POLYGON&&(c.polygon.splice_collinear(),c.polygon.validate_gaxi());b=b.next}a.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var a=this.live.head;null!=a;){var b=a.elt;b.sweepRadius=0;for(var c=b.shapes.head;null!=c;){var d=c.elt;d.type==g.id_ShapeType_POLYGON&&(d.polygon.splice_collinear(),
d.polygon.validate_gaxi());d.validate_sweepRadius();d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.bodylisteners.head;null!=c;)d=c.elt,d.event==g.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=g.id_CbEvent_WAKE,d.body=b),c=
c.next;b.component.woken=!1;for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.kinematics.head;null!=a;){b=a.elt;b.sweepRadius=0;for(c=b.shapes.head;null!=c;)d=c.elt,d.type==g.id_ShapeType_POLYGON&&(d.polygon.splice_collinear(),d.polygon.validate_gaxi()),d.validate_sweepRadius(),d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius),c=c.next;b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();
b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.live_constraints.head;null!=a;){b=a.elt;if(b.active){if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.conlisteners.head;null!=c;)d=c.elt,d.event==g.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=g.id_CbEvent_WAKE,d.constraint=b),c=c.next;b.component.woken=!1}a=a.next}},updateVel:function(a){for(var b=1-a*this.global_lin_drag,c=1-a*this.global_ang_drag,
d=this.live.head;null!=d;){var e=d.elt;if(0!=e.smass){var f=a*e.imass;e.velx=b*e.velx+(e.forcex+this.gravityx*e.gravMass)*f;e.vely=b*e.vely+(e.forcey+this.gravityy*e.gravMass)*f}if(0!=e.sinertia){var g=f=0,f=e.worldCOMx-e.posx,g=e.worldCOMy-e.posy;e.angvel=c*e.angvel+(e.torque+(this.gravityy*f-this.gravityx*g)*e.gravMass)*a*e.iinertia}d=d.next}},updatePos:function(a){for(var b=2*Math.PI/a,c=this.live.head;null!=c;){var d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=
d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else{var e=v.staticCCDLinearThreshold*d.sweepRadius,f=v.staticCCDAngularThreshold;if((d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||d.type==g.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);for(var f=1/e,i=d.shapes.head;null!=i;){var h=i.elt,j=h.aabb,k=j.minx,l=j.miny,m=j.maxx,n=j.maxy,p=0.008333333333333333*e*a*h.sweepCoef|0;8<p&&(p=8);var q=e*a/p;d.sweepIntegrate(a);h.type==g.id_ShapeType_CIRCLE?h.circle._force_validate_aabb():
h.polygon._force_validate_aabb();k<j.minx?j.minx=k:k=j.minx;l<j.miny?j.miny=l:l=j.miny;m>j.maxx?j.maxx=m:m=j.maxx;n>j.maxy?j.maxy=n:n=j.maxy;for(var r=1;r<p;){var t=r++;d.sweepIntegrate(q*t*f);h.type==g.id_ShapeType_CIRCLE?h.circle._force_validate_aabb():h.polygon._force_validate_aabb();k<j.minx?j.minx=k:k=j.minx;l<j.miny?j.miny=l:l=j.miny;m>j.maxx?j.maxx=m:m=j.maxx;n>j.maxy?j.maxy=n:n=j.maxy}this.bphase.sync(h);i=i.next}d.sweepFrozen=!1;if(d.type==g.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=v.bulletCCDLinearThreshold*
d.sweepRadius,f=v.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1}c=c.next}for(c=this.kinematics.head;null!=c;){d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else if(e=v.staticCCDLinearThreshold*d.sweepRadius,f=v.staticCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*
a*a>f*f||d.type==g.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);f=1/e;for(i=d.shapes.head;null!=i;){h=i.elt;j=h.aabb;k=j.minx;l=j.miny;m=j.maxx;n=j.maxy;p=0.008333333333333333*e*a*h.sweepCoef|0;8<p&&(p=8);q=e*a/p;d.sweepIntegrate(a);h.type==g.id_ShapeType_CIRCLE?h.circle._force_validate_aabb():h.polygon._force_validate_aabb();k<j.minx?j.minx=k:k=j.minx;l<j.miny?j.miny=l:l=j.miny;m>j.maxx?j.maxx=m:m=j.maxx;n>j.maxy?j.maxy=n:n=j.maxy;for(r=1;r<p;)t=r++,d.sweepIntegrate(q*t*f),h.type==g.id_ShapeType_CIRCLE?
h.circle._force_validate_aabb():h.polygon._force_validate_aabb(),k<j.minx?j.minx=k:k=j.minx,l<j.miny?j.miny=l:l=j.miny,m>j.maxx?j.maxx=m:m=j.maxx,n>j.maxy?j.maxy=n:n=j.maxy;this.bphase.sync(h);i=i.next}d.sweepFrozen=!1;if(d.type==g.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=v.bulletCCDLinearThreshold*d.sweepRadius,f=v.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1;c=c.next}},presteparb:function(a,b,c){null==c&&
(c=!1);var d=this;if(!a.cleared&&a.b1.component.sleeping&&a.b2.component.sleeping)return a.sleep_stamp=this.stamp,a.sleeping=!0;if(!a.cleared||0!=a.present||a.intchange){var e=!c&&a.up_stamp==this.stamp-1&&!a.cleared&&!a.intchange,c=a.fresh&&!a.cleared&&!a.intchange;e&&(a.endGenerated=this.stamp);if(c||e||a.cleared||a.intchange){this.inlined_MRCA_chains(a.ws1,a.ws2);for(e=this.mrca1.head;null!=e;){for(var f=e.elt,i=this.mrca2.head;null!=i;){var h=i.elt,j=f.cbSet,k=h.cbSet;if(!j.manager.pair(j,k).empty_intersection()){var l=
[Ba.get(f,h)];if(c||a.intchange){null==l[0]&&(l[0]=Hb.get(f,h),this.add_callbackset(l[0]));j.manager.pair(j,k).forall(g.id_CbEvent_BEGIN,function(b){return function(c){if(0!=(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=g.id_CbEvent_BEGIN;Ba.int_callback(b[0],c,e);e.set=b[0]}}}(l));if(h=!l[0].arbiters.inlined_has(a))l[0].arbiters.inlined_add(a),h=!0;h&&a.present++}else a.present--,l[0].remove_arb(a),j.manager.pair(j,k).forall(g.id_CbEvent_END,function(b){return function(c){if(0!=
(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=g.id_CbEvent_END;Ba.int_callback(b[0],c,e);e.set=b[0]}}}(l)),null==l[0].arbiters.head&&this.remove_callbackset(l[0])}i=i.next}e=e.next}}a.fresh=!1;a.intchange=!1}if(a.cleared||a.up_stamp+(a.type==pa.COL?v.arbiterExpirationDelay:0)<this.stamp)return a.type==pa.SENSOR?a.sensorarb.retire():a.type==pa.FLUID?a.fluidarb.retire():a.colarb.retire(),!0;c=a.active;a.active=a.presentable=a.up_stamp==this.stamp;0!=(a.immState&g.id_ImmState_ACCEPT)?
a.active&&a.type!=pa.SENSOR&&(null!=a.colarb?a.colarb.preStep(b)&&(a.active=!1):a.fluidarb.preStep(this,b)):null!=a.colarb&&a.colarb.cleanupContacts()&&(a.active=!1);c!=a.active&&(a.b1.arbiters.modified=!0,a.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0);return!1},prestep:function(a){for(var b=null,c=this.live_constraints.head;null!=c;){var d=c.elt;d.preStep(a)?(c=this.live_constraints.erase(b),d.broken(),
this.constraintCbBreak(d),d.removeOnBreak?(d.component.sleeping=!0,this.midstep=!1,null!=d.compound?d.compound.wrap_constraints.remove(d.outer):this.wrap_constraints.remove(d.outer),this.midstep=!0):d.active=!1,d.clearcache()):(b=c,c=c.next)}var b=null,c=this.c_arbiters_true,d=c.head,e=null!=this.c_arbiters_false;e&&null==d&&(e=!1,d=this.c_arbiters_false.head,c=this.c_arbiters_false,b=null);for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=this.c_arbiters_false.head,
c=this.c_arbiters_false,b=null);b=null;c=this.f_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,b=c=null);b=null;c=this.s_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,b=c=null)},warmStart:function(){for(var a=this.f_arbiters.head;null!=a;){var b=a.elt;b.active&&0!=(b.immState&g.id_ImmState_ACCEPT)&&b.warmStart();a=a.next}a=this.c_arbiters_false.head;b=!0;null==
a&&(a=this.c_arbiters_true.head,b=!1);for(;null!=a;){var c=a.elt;c.active&&0!=(c.immState&g.id_ImmState_ACCEPT)&&c.warmStart();a=a.next;b&&null==a&&(a=this.c_arbiters_true.head,b=!1)}for(a=this.live_constraints.head;null!=a;)a.elt.warmStart(),a=a.next},iterateVel:function(a){for(var b=0;b<a;){b++;for(var c=this.f_arbiters.head;null!=c;){var d=c.elt;d.active&&0!=(d.immState&g.id_ImmState_ACCEPT)&&d.applyImpulseVel();c=c.next}c=null;for(d=this.live_constraints.head;null!=d;){var e=d.elt;e.applyImpulseVel()?
(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&g.id_ImmState_ACCEPT)&&e.applyImpulseVel(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,
d=!1)}},iteratePos:function(a){for(var b=0;b<a;){b++;for(var c=null,d=this.live_constraints.head;null!=d;){var e=d.elt;!e.__velocity&&e.stiff&&e.applyImpulsePos()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,
d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&g.id_ImmState_ACCEPT)&&e.applyImpulsePos(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,d=!1)}},group_ignore:function(a,b){var c=a.lookup_group();if(null==c)return!1;var d=b.lookup_group();if(null==d)return!1;for(var e=!1;null!=c&&null!=d;){if(c==d){e=c.ignore;break}c.depth<d.depth?d=d.group:c=c.group}return e},interactionType:function(a,b,c,d){var e;e=!1;for(var f=c.constraints.head;null!=f;){var g=f.elt;if(g.ignore&&g.pair_exists(c.id,d.id)){e=
!0;break}f=f.next}return!e&&!this.group_ignore(a,b)?(a.sensorEnabled||b.sensorEnabled)&&a.filter.shouldSense(b.filter)?2:(a.fluidEnabled||b.fluidEnabled)&&a.filter.shouldFlow(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?0:a.filter.shouldCollide(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?1:-1:-1},narrowPhase:function(a,b,c,d,e){var f=this,i=null,h=a.body,j=b.body,k=this.interactionType(a,b,h,j);if(-1!=k){var l,m;a.type>b.type?(l=b,m=a):a.type==b.type?a.id<
b.id?(l=a,m=b):(m=a,l=b):(l=a,m=b);var n=l==b;if(0==k){var p;if(null==d){for(var q=null,r=(h.arbiters.length<j.arbiters.length?h:j).arbiters.head;null!=r;){var t=r.elt;if(t.id==l.id&&t.di==m.id){q=t;break}r=r.next}p=q}else p=d;var u=null==p,s,v=!1;u?(null==ob.zpp_pool?s=new ob:(s=ob.zpp_pool,ob.zpp_pool=s.next,s.next=null),null):null==p.fluidarb?(p.cleared=!0,p.b1.arbiters.inlined_try_remove(p),p.b2.arbiters.inlined_try_remove(p),null!=p.pair&&(p.pair.arb=null,p.pair=null),p.active=!1,this.f_arbiters.modified=
!0,null==ob.zpp_pool?s=new ob:(s=ob.zpp_pool,ob.zpp_pool=s.next,s.next=null),null,v=u=s.intchange=!0):s=p.fluidarb;var w=g.id_InteractionType_FLUID;if(u||s.stamp!=this.stamp||e)if(s.stamp=this.stamp,J.flowCollide(l,m,s)){u?(s.b1=a.body,s.ws1=a,s.b2=b.body,s.ws2=b,s.id=l.id,s.di=m.id,s.b1.arbiters.inlined_add(s),s.b2.arbiters.inlined_add(s),s.active=!0,s.present=0,s.cleared=!1,s.sleeping=!1,s.fresh=!1,s.presentable=!1,s.nx=0,s.ny=1,s.dampx=0,s.dampy=0,s.adamp=0,this.f_arbiters.inlined_add(s),s.fresh=
!v):s.fresh=s.up_stamp<this.stamp-1||s.endGenerated==this.stamp&&e;s.up_stamp=s.stamp;if(s.fresh||0==(s.immState&g.id_ImmState_ALWAYS)){s.immState=g.id_ImmState_ACCEPT;var x=!1;this.inlined_MRCA_chains(s.ws1.id>s.ws2.id?s.ws2:s.ws1,s.ws1.id>s.ws2.id?s.ws1:s.ws2);for(var z=this.mrca1.head;null!=z;){for(var B=z.elt,C=this.mrca2.head;null!=C;){var E=C.elt,D=B.cbSet,F=E.cbSet;if(!D.manager.pair(D,F).empty_intersection()){var A=null,G=null;this.prelisteners.inlined_clear();D.manager.pair(D,F).forall(g.id_CbEvent_PRE,
function(a){return function(b){0!=(b.itype&w)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),x=x||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(A=Ba.get(B,E),null==A&&(G=Hb.get(B,E),this.add_callbackset(G)),null==A||(A.FLUIDstamp!=this.stamp||e)&&0==(A.FLUIDstate&g.id_ImmState_ALWAYS)){null!=G&&(A=G);if(null!=A)for(var I=this.prelisteners.head;null!=I;)I.elt.itype==g.id_InteractionType_ANY&&(A.COLLISIONstamp=this.stamp,A.SENSORstamp=this.stamp),A.FLUIDstamp=this.stamp,I=I.next;var N=s.active;
s.active=!0;this.precb.zpp_inner.pre_arbiter=s;this.precb.zpp_inner.set=A;for(var K=this.prelisteners.head;null!=K;){var M=K.elt;this.precb.zpp_inner.listener=M;Ba.int_callback(A,M,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=B!=this.precb.zpp_inner.int1;var L=M.handlerp(this.precb);if(null!=L){var O=s,P=L,Q;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ib,g.internal=!1);if(P==g.PreFlag_ACCEPT)Q=g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS;else{var W=L,S;null==g.PreFlag_ACCEPT_ONCE&&
(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ib,g.internal=!1);if(W==g.PreFlag_ACCEPT_ONCE)S=g.id_ImmState_ACCEPT;else{var aa=L;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ib,g.internal=!1);S=aa==g.PreFlag_IGNORE?g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS:g.id_ImmState_IGNORE}Q=S}O.immState=Q}K=K.next}s.active=N;if(null!=A)for(var V=this.prelisteners.head;null!=V;)V.elt.itype==g.id_InteractionType_ANY&&(A.COLLISIONstate=s.immState,A.SENSORstate=s.immState),A.FLUIDstate=s.immState,V=V.next}else null==
A?0==(s.immState&g.id_ImmState_ALWAYS)&&(s.immState=g.id_ImmState_ACCEPT):s.immState=A.FLUIDstate}C=C.next}z=z.next}if(x&&0==(s.immState&g.id_ImmState_ALWAYS)){if(s.b1.type==g.id_BodyType_DYNAMIC){var T=s.b1;T.world||(T.component.waket=this.stamp+(this.midstep?0:1),T.type==g.id_BodyType_KINEMATIC&&(T.kinematicDelaySleep=!0),T.component.sleeping&&this.really_wake(T,!1))}if(s.b1.type==g.id_BodyType_DYNAMIC){var U=s.b2;U.world||(U.component.waket=this.stamp+(this.midstep?0:1),U.type==g.id_BodyType_KINEMATIC&&
(U.kinematicDelaySleep=!0),U.component.sleeping&&this.really_wake(U,!1))}}}if(0!=(s.immState&g.id_ImmState_ACCEPT)){if(s.b1.type==g.id_BodyType_DYNAMIC&&s.b1.component.sleeping){var X=s.b1;X.world||(X.component.waket=this.stamp+(this.midstep?0:1),X.type==g.id_BodyType_KINEMATIC&&(X.kinematicDelaySleep=!0),X.component.sleeping&&this.really_wake(X,!1))}if(s.b2.type==g.id_BodyType_DYNAMIC&&s.b2.component.sleeping){var Z=s.b2;Z.world||(Z.component.waket=this.stamp+(this.midstep?0:1),Z.type==g.id_BodyType_KINEMATIC&&
(Z.kinematicDelaySleep=!0),Z.component.sleeping&&this.really_wake(Z,!1))}}s.sleeping&&(s.sleeping=!1,this.f_arbiters.inlined_add(s));i=s}else if(u){var ca=s;ca.next=ob.zpp_pool;ob.zpp_pool=ca;i=null}else i=s;else i=s}else if(1==k){var ba;ba=c?this.c_arbiters_true:this.c_arbiters_false;var R;if(null==d){for(var fa=null,ea=(h.arbiters.length<j.arbiters.length?h:j).arbiters.head;null!=ea;){var ga=ea.elt;if(ga.id==l.id&&ga.di==m.id){fa=ga;break}ea=ea.next}R=fa}else R=d;var da=null==R,y,ia=!1;da?(null==
qb.zpp_pool?y=new qb:(y=qb.zpp_pool,qb.zpp_pool=y.next,y.next=null),null,y.stat=c):null==R.colarb?(R.cleared=!0,R.b1.arbiters.inlined_try_remove(R),R.b2.arbiters.inlined_try_remove(R),null!=R.pair&&(R.pair.arb=null,R.pair=null),R.active=!1,this.f_arbiters.modified=!0,null==qb.zpp_pool?y=new qb:(y=qb.zpp_pool,qb.zpp_pool=y.next,y.next=null),null,y.intchange=!0,y.stat=c,ia=da=!0):(y=R.colarb,n=l!=y.s1,y.stat!=c&&(y.stat=c,y.sleeping||((c?this.c_arbiters_false:this.c_arbiters_true).remove(y),ba.add(y))));
var oa=g.id_InteractionType_COLLISION;if(da||y.stamp!=this.stamp||e)if(y.stamp=this.stamp,J.contactCollide(l,m,y,n)){da?(y.b1=a.body,y.ws1=a,y.b2=b.body,y.ws2=b,y.id=l.id,y.di=m.id,y.b1.arbiters.inlined_add(y),y.b2.arbiters.inlined_add(y),y.active=!0,y.present=0,y.cleared=!1,y.sleeping=!1,y.fresh=!1,y.presentable=!1,y.s1=a,y.s2=b,y.userdef_restitution||(y.restitution=-Infinity>=y.s1.material.elasticity||-Infinity>=y.s2.material.elasticity?0:Infinity<=y.s1.material.elasticity||Infinity<=y.s2.material.elasticity?
1:(y.s1.material.elasticity+y.s2.material.elasticity)/2,0>y.restitution&&(y.restitution=0),1<y.restitution&&(y.restitution=1)),y.userdef_dyn_fric||(y.dyn_fric=Math.sqrt(y.s1.material.dynamicFriction*y.s2.material.dynamicFriction)),y.userdef_stat_fric||(y.stat_fric=Math.sqrt(y.s1.material.staticFriction*y.s2.material.staticFriction)),y.userdef_rfric||(y.rfric=Math.sqrt(y.s1.material.rollingFriction*y.s2.material.rollingFriction)),ba.inlined_add(y),y.fresh=!ia):y.fresh=y.up_stamp<this.stamp-1||y.endGenerated==
this.stamp&&e;y.up_stamp=y.stamp;if(y.fresh||0==(y.immState&g.id_ImmState_ALWAYS)){y.immState=g.id_ImmState_ACCEPT;var ka=!1;this.inlined_MRCA_chains(y.ws1.id>y.ws2.id?y.ws2:y.ws1,y.ws1.id>y.ws2.id?y.ws1:y.ws2);for(var ha=this.mrca1.head;null!=ha;){for(var ja=ha.elt,ma=this.mrca2.head;null!=ma;){var pa=ma.elt,na=ja.cbSet,va=pa.cbSet;if(!na.manager.pair(na,va).empty_intersection()){var Y=null,ra=null;this.prelisteners.inlined_clear();na.manager.pair(na,va).forall(g.id_CbEvent_PRE,function(a){return function(b){0!=
(b.itype&oa)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),ka=ka||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(Y=Ba.get(ja,pa),null==Y&&(ra=Hb.get(ja,pa),this.add_callbackset(ra)),null==Y||(Y.COLLISIONstamp!=this.stamp||e)&&0==(Y.COLLISIONstate&g.id_ImmState_ALWAYS)){null!=ra&&(Y=ra);if(null!=Y)for(var sa=this.prelisteners.head;null!=sa;)sa.elt.itype==g.id_InteractionType_ANY?(Y.COLLISIONstamp=this.stamp,Y.SENSORstamp=this.stamp,Y.FLUIDstamp=this.stamp):Y.COLLISIONstamp=this.stamp,sa=sa.next;
var xa=y.active;y.active=!0;y.cleanupContacts();this.precb.zpp_inner.pre_arbiter=y;this.precb.zpp_inner.set=Y;for(var ta=this.prelisteners.head;null!=ta;){var wa=ta.elt;this.precb.zpp_inner.listener=wa;Ba.int_callback(Y,wa,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=ja!=this.precb.zpp_inner.int1;var ua=wa.handlerp(this.precb);if(null!=ua){var za=y,Da=ua,Ga;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ib,g.internal=!1);if(Da==g.PreFlag_ACCEPT)Ga=g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS;
else{var Ma=ua,Ja;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ib,g.internal=!1);if(Ma==g.PreFlag_ACCEPT_ONCE)Ja=g.id_ImmState_ACCEPT;else{var Oa=ua;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ib,g.internal=!1);Ja=Oa==g.PreFlag_IGNORE?g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS:g.id_ImmState_IGNORE}Ga=Ja}za.immState=Ga}ta=ta.next}y.active=xa;if(null!=Y)for(var Ka=this.prelisteners.head;null!=Ka;)Ka.elt.itype==g.id_InteractionType_ANY?(Y.COLLISIONstate=y.immState,
Y.SENSORstate=y.immState,Y.FLUIDstate=y.immState):Y.COLLISIONstate=y.immState,Ka=Ka.next}else null==Y?0==(y.immState&g.id_ImmState_ALWAYS)&&(y.immState=g.id_ImmState_ACCEPT):y.immState=Y.COLLISIONstate}ma=ma.next}ha=ha.next}if(ka&&0==(y.immState&g.id_ImmState_ALWAYS)){if(y.b1.type==g.id_BodyType_DYNAMIC){var Ea=y.b1;Ea.world||(Ea.component.waket=this.stamp+(this.midstep?0:1),Ea.type==g.id_BodyType_KINEMATIC&&(Ea.kinematicDelaySleep=!0),Ea.component.sleeping&&this.really_wake(Ea,!1))}if(y.b1.type==
g.id_BodyType_DYNAMIC){var Fa=y.b2;Fa.world||(Fa.component.waket=this.stamp+(this.midstep?0:1),Fa.type==g.id_BodyType_KINEMATIC&&(Fa.kinematicDelaySleep=!0),Fa.component.sleeping&&this.really_wake(Fa,!1))}}}if(0!=(y.immState&g.id_ImmState_ACCEPT)){if(y.b1.type==g.id_BodyType_DYNAMIC&&y.b1.component.sleeping){var Ha=y.b1;Ha.world||(Ha.component.waket=this.stamp+(this.midstep?0:1),Ha.type==g.id_BodyType_KINEMATIC&&(Ha.kinematicDelaySleep=!0),Ha.component.sleeping&&this.really_wake(Ha,!1))}if(y.b2.type==
g.id_BodyType_DYNAMIC&&y.b2.component.sleeping){var Ia=y.b2;Ia.world||(Ia.component.waket=this.stamp+(this.midstep?0:1),Ia.type==g.id_BodyType_KINEMATIC&&(Ia.kinematicDelaySleep=!0),Ia.component.sleeping&&this.really_wake(Ia,!1))}}y.sleeping&&(y.sleeping=!1,ba.inlined_add(y));i=y}else if(da){var Aa=y;Aa.userdef_dyn_fric=!1;Aa.userdef_stat_fric=!1;Aa.userdef_restitution=!1;Aa.userdef_rfric=!1;Aa.__ref_edge1=Aa.__ref_edge2=null;Aa.next=qb.zpp_pool;qb.zpp_pool=Aa;i=null}else i=y;else i=y}else{var qa;
if(null==d){for(var Sa=null,Na=(h.arbiters.length<j.arbiters.length?h:j).arbiters.head;null!=Na;){var Pa=Na.elt;if(Pa.id==l.id&&Pa.di==m.id){Sa=Pa;break}Na=Na.next}qa=Sa}else qa=d;var La=null==qa,H,Va=!1;La?(null==ub.zpp_pool?H=new ub:(H=ub.zpp_pool,ub.zpp_pool=H.next,H.next=null),null):null==qa.sensorarb?(qa.cleared=!0,qa.b1.arbiters.inlined_try_remove(qa),qa.b2.arbiters.inlined_try_remove(qa),null!=qa.pair&&(qa.pair.arb=null,qa.pair=null),qa.active=!1,this.f_arbiters.modified=!0,null==ub.zpp_pool?
H=new ub:(H=ub.zpp_pool,ub.zpp_pool=H.next,H.next=null),null,Va=La=H.intchange=!0):H=qa.sensorarb;var ab=g.id_InteractionType_SENSOR;if(La||H.stamp!=this.stamp||e)if(H.stamp=this.stamp,J.testCollide(l,m)){La?(H.b1=a.body,H.ws1=a,H.b2=b.body,H.ws2=b,H.id=l.id,H.di=m.id,H.b1.arbiters.inlined_add(H),H.b2.arbiters.inlined_add(H),H.active=!0,H.present=0,H.cleared=!1,H.sleeping=!1,H.fresh=!1,H.presentable=!1,this.s_arbiters.inlined_add(H),H.fresh=!Va):H.fresh=H.up_stamp<this.stamp-1||H.endGenerated==this.stamp&&
e;H.up_stamp=H.stamp;if(H.fresh||0==(H.immState&g.id_ImmState_ALWAYS)){H.immState=g.id_ImmState_ACCEPT;var Ua=!1;this.inlined_MRCA_chains(H.ws1.id>H.ws2.id?H.ws2:H.ws1,H.ws1.id>H.ws2.id?H.ws1:H.ws2);for(var Qa=this.mrca1.head;null!=Qa;){for(var Ra=Qa.elt,Ta=this.mrca2.head;null!=Ta;){var Za=Ta.elt,Wa=Ra.cbSet,db=Za.cbSet;if(!Wa.manager.pair(Wa,db).empty_intersection()){var la=null,Xa=null;this.prelisteners.inlined_clear();Wa.manager.pair(Wa,db).forall(g.id_CbEvent_PRE,function(a){return function(b){0!=
(b.itype&ab)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),Ua=Ua||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(la=Ba.get(Ra,Za),null==la&&(Xa=Hb.get(Ra,Za),this.add_callbackset(Xa)),null==la||(la.SENSORstamp!=this.stamp||e)&&0==(la.SENSORstate&g.id_ImmState_ALWAYS)){null!=Xa&&(la=Xa);if(null!=la)for(var Ya=this.prelisteners.head;null!=Ya;)Ya.elt.itype==g.id_InteractionType_ANY?(la.COLLISIONstamp=this.stamp,la.SENSORstamp=this.stamp,la.FLUIDstamp=this.stamp):la.SENSORstamp=this.stamp,Ya=Ya.next;
var hb=H.active;H.active=!0;this.precb.zpp_inner.pre_arbiter=H;this.precb.zpp_inner.set=la;for(var $a=this.prelisteners.head;null!=$a;){var cb=$a.elt;this.precb.zpp_inner.listener=cb;Ba.int_callback(la,cb,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=Ra!=this.precb.zpp_inner.int1;var bb=cb.handlerp(this.precb);if(null!=bb){var lb=H,mb=bb,eb;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ib,g.internal=!1);if(mb==g.PreFlag_ACCEPT)eb=g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS;else{var nb=
bb,fb;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ib,g.internal=!1);if(nb==g.PreFlag_ACCEPT_ONCE)fb=g.id_ImmState_ACCEPT;else{var pb=bb;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ib,g.internal=!1);fb=pb==g.PreFlag_IGNORE?g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS:g.id_ImmState_IGNORE}eb=fb}lb.immState=eb}$a=$a.next}H.active=hb;if(null!=la)for(var gb=this.prelisteners.head;null!=gb;)gb.elt.itype==g.id_InteractionType_ANY?(la.COLLISIONstate=H.immState,la.SENSORstate=
H.immState,la.FLUIDstate=H.immState):la.SENSORstate=H.immState,gb=gb.next}else null==la?0==(H.immState&g.id_ImmState_ALWAYS)&&(H.immState=g.id_ImmState_ACCEPT):H.immState=la.SENSORstate}Ta=Ta.next}Qa=Qa.next}if(Ua&&0==(H.immState&g.id_ImmState_ALWAYS)){if(H.b1.type!=g.id_BodyType_STATIC){var jb=H.b1;jb.world||(jb.component.waket=this.stamp+(this.midstep?0:1),jb.type==g.id_BodyType_KINEMATIC&&(jb.kinematicDelaySleep=!0),jb.component.sleeping&&this.really_wake(jb,!1))}if(H.b2.type!=g.id_BodyType_STATIC){var kb=
H.b2;kb.world||(kb.component.waket=this.stamp+(this.midstep?0:1),kb.type==g.id_BodyType_KINEMATIC&&(kb.kinematicDelaySleep=!0),kb.component.sleeping&&this.really_wake(kb,!1))}}}H.sleeping&&(H.sleeping=!1,this.s_arbiters.inlined_add(H));i=H}else if(La){var rb=H;rb.next=ub.zpp_pool;ub.zpp_pool=rb;i=null}else i=H;else i=H}}return i},MRCA_chains:function(a,b){this.inlined_MRCA_chains(a,b)},inlined_MRCA_chains:function(a,b){this.mrca1.inlined_clear();this.mrca2.inlined_clear();null!=a.cbSet&&this.mrca1.inlined_add(a);
null!=a.body.cbSet&&this.mrca1.inlined_add(a.body);null!=b.cbSet&&this.mrca2.inlined_add(b);null!=b.body.cbSet&&this.mrca2.inlined_add(b.body);for(var c=a.body.compound,d=b.body.compound;c!=d;)(null==c?0:c.depth)<(null==d?0:d.depth)?(null!=d.cbSet&&this.mrca2.inlined_add(d),d=d.compound):(null!=c.cbSet&&this.mrca1.inlined_add(c),c=c.compound)},__class__:kj};var zd=function(){this.next=this.prev=this.shape=this.aabb=null};h["zpp_nape.space.ZPP_SweepData"]=zd;zd.__name__=["zpp_nape","space","ZPP_SweepData"];
zd.prototype={__class__:zd};var ji=function(a){this.list=null;ae.call(this);this.space=a;this.is_sweep=!0;this.sweep=this};h["zpp_nape.space.ZPP_SweepPhase"]=ji;ji.__name__=["zpp_nape","space","ZPP_SweepPhase"];ji.__super__=ae;ji.prototype=x(ae.prototype,{__insert:function(a){var b;null==zd.zpp_pool?b=new zd:(b=zd.zpp_pool,zd.zpp_pool=b.next,b.next=null);null;a.sweep=b;b.shape=a;b.aabb=a.aabb;b.next=this.list;null!=this.list&&(this.list.prev=b);this.list=b},__remove:function(a){var b=a.sweep;null==
b.prev?this.list=b.next:b.prev.next=b.next;null!=b.next&&(b.next.prev=b.prev);a.sweep=null;b.prev=null;b.shape=null;b.aabb=null;b.next=zd.zpp_pool;zd.zpp_pool=b},sync_broadphase_fast:function(){for(var a=this.list.next;null!=a;){var b=a.next,c=a.prev;if(!(a.aabb.minx>c.aabb.minx)){for(;null!=c.prev&&c.prev.aabb.minx>a.aabb.minx;)c=c.prev;var d=a.prev;d.next=a.next;null!=a.next&&(a.next.prev=d);null==c.prev?(a.prev=null,this.list=a,a.next=c,c.prev=a):(a.prev=c.prev,c.prev=a,a.prev.next=a,a.next=c)}a=
b}},broadphase:function(a,b){if(null!=this.list){this.sync_broadphase_fast();for(var c=this.list;null!=c;){for(var d=c.next,e=c.shape,f=e.body,i=c.aabb.maxx;null!=d&&!(d.aabb.minx>i);){var h=d.shape,j=h.body;if(j!=f&&!(f.type==g.id_BodyType_STATIC&&j.type==g.id_BodyType_STATIC)&&(!f.component.sleeping||!j.component.sleeping))e.aabb.intersectY(h.aabb)&&(b?a.narrowPhase(e,h,f.type!=g.id_BodyType_DYNAMIC||j.type!=g.id_BodyType_DYNAMIC,null,!1):a.continuousEvent(e,h,f.type!=g.id_BodyType_DYNAMIC||j.type!=
g.id_BodyType_DYNAMIC,null,!1));d=d.next}c=c.next}}},__class__:ji});var Yj=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CallbackSet"]=Yj;Yj.__name__=["zpp_nape","util","ZNPList_ZPP_CallbackSet"];Yj.prototype={inlined_add:function(a){var b;null==Ad.zpp_pool?b=new Ad:(b=Ad.zpp_pool,Ad.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_try_remove:function(a){for(var b=null,c=this.head,
d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ad.zpp_pool;Ad.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Yj};var Ye=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Shape"]=Ye;Ye.__name__=["zpp_nape",
"util","ZNPList_ZPP_Shape"];Ye.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Xa.zpp_pool?b=new Xa:(b=Xa.zpp_pool,Xa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Xa.zpp_pool?c=new Xa:(c=Xa.zpp_pool,Xa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,
a.next=c);this.pushmod=this.modified=!0;this.length++;return c},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=
!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ye};var be=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Body"]=be;be.__name__=["zpp_nape","util","ZNPList_ZPP_Body"];be.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==wb.zpp_pool?b=new wb:(b=wb.zpp_pool,wb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==wb.zpp_pool?c=new wb:(c=wb.zpp_pool,wb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=wb.zpp_pool;wb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=wb.zpp_pool;wb.zpp_pool=a;this.modified=!0;this.length--;
this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:be};var ki=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Compound"]=ki;ki.__name__=["zpp_nape","util","ZNPList_ZPP_Compound"];ki.prototype={remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ni.zpp_pool;ni.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:ki};var Sf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Arbiter"]=Sf;Sf.__name__=["zpp_nape","util","ZNPList_ZPP_Arbiter"];
Sf.prototype={inlined_add:function(a){var b;null==Bd.zpp_pool?b=new Bd:(b=Bd.zpp_pool,Bd.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Bd.zpp_pool;Bd.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;
this.pop();return a},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Bd.zpp_pool;Bd.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_has:function(a){var b;
b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},__class__:Sf};var Vj=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_CbSetPair"]=Vj;Vj.__name__=["zpp_nape","util","ZNPList_ZPP_CbSetPair"];Vj.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Cd.zpp_pool?b=new Cd:(b=Cd.zpp_pool,Cd.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Cd.zpp_pool;Cd.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=
c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Cd.zpp_pool;Cd.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Vj};var $j=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_AABBPair"]=$j;$j.__name__=["zpp_nape","util","ZNPList_ZPP_AABBPair"];$j.prototype={inlined_add:function(a){var b;
null==Tc.zpp_pool?b=new Tc:(b=Tc.zpp_pool,Tc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Tc.zpp_pool;Tc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Tc.zpp_pool;Tc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:$j};var ak=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};
h["zpp_nape.util.ZNPList_ZPP_Edge"]=ak;ak.__name__=["zpp_nape","util","ZNPList_ZPP_Edge"];ak.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ic.zpp_pool?b=new ic:(b=ic.zpp_pool,ic.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==ic.zpp_pool?c=new ic:(c=ic.zpp_pool,ic.zpp_pool=c.next,c.next=null);null;
c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ic.zpp_pool;ic.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},
inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ic.zpp_pool;ic.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:ak};var bk=function(){this.length=
0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Component"]=bk;bk.__name__=["zpp_nape","util","ZNPList_ZPP_Component"];bk.prototype={inlined_add:function(a){var b;null==ce.zpp_pool?b=new ce:(b=ce.zpp_pool,ce.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ce.zpp_pool;ce.zpp_pool=a;null==this.head&&
(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:bk};var Pk=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_InteractionGroup"]=Pk;Pk.__name__=["zpp_nape","util","ZNPList_ZPP_InteractionGroup"];Pk.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Pk};var ek=function(){this.length=
0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_FluidArbiter"]=ek;ek.__name__=["zpp_nape","util","ZNPList_ZPP_FluidArbiter"];ek.prototype={inlined_add:function(a){var b;null==de.zpp_pool?b=new de:(b=de.zpp_pool,de.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&
(this.pushmod=!0));a=b;a.elt=null;a.next=de.zpp_pool;de.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:ek};var fk=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_SensorArbiter"]=fk;fk.__name__=["zpp_nape","util","ZNPList_ZPP_SensorArbiter"];fk.prototype={inlined_add:function(a){var b;null==Vb.zpp_pool?b=new Vb:(b=Vb.zpp_pool,Vb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;
this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Vb.zpp_pool;Vb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:fk};var li=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_ColArbiter"]=li;li.__name__=["zpp_nape","util","ZNPList_ZPP_ColArbiter"];li.prototype=
{add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Wb.zpp_pool?b=new Wb:(b=Wb.zpp_pool,Wb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==
this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Wb.zpp_pool;Wb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:li};var mi=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_Listener"]=mi;mi.__name__=["zpp_nape","util","ZNPList_ZPP_Listener"];mi.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==jc.zpp_pool?b=new jc:(b=jc.zpp_pool,
jc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==jc.zpp_pool?c=new jc:(c=jc.zpp_pool,jc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,
c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=jc.zpp_pool;jc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:mi};var dk=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_ToiEvent"]=dk;dk.__name__=["zpp_nape","util","ZNPList_ZPP_ToiEvent"];dk.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Uc.zpp_pool?b=new Uc:(b=Uc.zpp_pool,Uc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Uc.zpp_pool;Uc.zpp_pool=
a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Uc.zpp_pool;Uc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=
!0;return c},__class__:dk};var Qk=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ConvexResult"]=Qk;Qk.__name__=["zpp_nape","util","ZNPList_ConvexResult"];Qk.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Qk};var Rk=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_ZPP_GeomPoly"]=Rk;Rk.__name__=["zpp_nape","util","ZNPList_ZPP_GeomPoly"];Rk.prototype={iterator_at:function(a){for(var b=
this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Rk};var Sk=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};h["zpp_nape.util.ZNPList_RayResult"]=Sk;Sk.__name__=["zpp_nape","util","ZNPList_RayResult"];Sk.prototype={iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Sk};var dc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CbType"]=dc;dc.__name__=["zpp_nape","util","ZNPNode_ZPP_CbType"];dc.prototype={__class__:dc};
var Ad=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CallbackSet"]=Ad;Ad.__name__=["zpp_nape","util","ZNPNode_ZPP_CallbackSet"];Ad.prototype={__class__:Ad};var Xa=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Shape"]=Xa;Xa.__name__=["zpp_nape","util","ZNPNode_ZPP_Shape"];Xa.prototype={__class__:Xa};var wb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Body"]=wb;wb.__name__=["zpp_nape","util","ZNPNode_ZPP_Body"];wb.prototype={__class__:wb};var wc=
function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Constraint"]=wc;wc.__name__=["zpp_nape","util","ZNPNode_ZPP_Constraint"];wc.prototype={__class__:wc};var ni=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Compound"]=ni;ni.__name__=["zpp_nape","util","ZNPNode_ZPP_Compound"];ni.prototype={__class__:ni};var Db=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_InteractionListener"]=Db;Db.__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionListener"];Db.prototype=
{__class__:Db};var ud=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CbSet"]=ud;ud.__name__=["zpp_nape","util","ZNPNode_ZPP_CbSet"];ud.prototype={__class__:ud};var Qc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Interactor"]=Qc;Qc.__name__=["zpp_nape","util","ZNPNode_ZPP_Interactor"];Qc.prototype={__class__:Qc};var Oc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_BodyListener"]=Oc;Oc.__name__=["zpp_nape","util","ZNPNode_ZPP_BodyListener"];Oc.prototype=
{__class__:Oc};var Bd=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Arbiter"]=Bd;Bd.__name__=["zpp_nape","util","ZNPNode_ZPP_Arbiter"];Bd.prototype={__class__:Bd};var Pc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_ConstraintListener"]=Pc;Pc.__name__=["zpp_nape","util","ZNPNode_ZPP_ConstraintListener"];Pc.prototype={__class__:Pc};var Cd=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_CbSetPair"]=Cd;Cd.__name__=["zpp_nape","util","ZNPNode_ZPP_CbSetPair"];
Cd.prototype={__class__:Cd};var Tc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_AABBPair"]=Tc;Tc.__name__=["zpp_nape","util","ZNPNode_ZPP_AABBPair"];Tc.prototype={__class__:Tc};var ic=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Edge"]=ic;ic.__name__=["zpp_nape","util","ZNPNode_ZPP_Edge"];ic.prototype={__class__:ic};var Na=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Vec2"]=Na;Na.__name__=["zpp_nape","util","ZNPNode_ZPP_Vec2"];Na.prototype=
{__class__:Na};var ce=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Component"]=ce;ce.__name__=["zpp_nape","util","ZNPNode_ZPP_Component"];ce.prototype={__class__:ce};var Tk=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_InteractionGroup"]=Tk;Tk.__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionGroup"];Tk.prototype={__class__:Tk};var de=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_FluidArbiter"]=de;de.__name__=["zpp_nape","util","ZNPNode_ZPP_FluidArbiter"];
de.prototype={__class__:de};var Vb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_SensorArbiter"]=Vb;Vb.__name__=["zpp_nape","util","ZNPNode_ZPP_SensorArbiter"];Vb.prototype={__class__:Vb};var Wb=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_ColArbiter"]=Wb;Wb.__name__=["zpp_nape","util","ZNPNode_ZPP_ColArbiter"];Wb.prototype={__class__:Wb};var jc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_Listener"]=jc;jc.__name__=["zpp_nape","util","ZNPNode_ZPP_Listener"];
jc.prototype={__class__:jc};var Uc=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_ToiEvent"]=Uc;Uc.__name__=["zpp_nape","util","ZNPNode_ZPP_ToiEvent"];Uc.prototype={__class__:Uc};var Uk=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ConvexResult"]=Uk;Uk.__name__=["zpp_nape","util","ZNPNode_ConvexResult"];Uk.prototype={__class__:Uk};var Vk=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_ZPP_GeomPoly"]=Vk;Vk.__name__=["zpp_nape","util","ZNPNode_ZPP_GeomPoly"];
Vk.prototype={__class__:Vk};var Wk=function(){this.next=this.elt=null};h["zpp_nape.util.ZNPNode_RayResult"]=Wk;Wk.__name__=["zpp_nape","util","ZNPNode_RayResult"];Wk.prototype={__class__:Wk};var $e=function(){this.at_index=0;this.at_ite=null;this.zip_length=!1;this._length=0;this.inner=null;je.call(this);this.at_ite=null;this.at_index=0;this.zip_length=!0;this._length=0};h["zpp_nape.util.ZPP_MixVec2List"]=$e;$e.__name__=["zpp_nape","util","ZPP_MixVec2List"];$e.get=function(a,b){null==b&&(b=!1);var c=
new $e;c.inner=a;c.zpp_inner.immutable=b;return c};$e.__super__=je;$e.prototype=x(je.prototype,{zpp_gl:function(){this.zpp_vm();if(this.zip_length){this._length=0;for(var a=this.inner.next;null!=a;)this._length++,a=a.next;this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate();this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.at_index||null==this.at_ite){this.at_index=
0;for(this.at_ite=this.inner.next;;)break}for(;this.at_index!=a;){this.at_index++;for(this.at_ite=this.at_ite.next;;)break}return this.at_ite.wrapper()},push:function(a){this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.inner.add(a.zpp_inner):this.inner.insert(this.inner.iterator_at(this.zpp_gl()-1),a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},
__class__:$e});var qc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new dd;this._invalidated=!0};h["zpp_nape.util.ZPP_ConstraintList"]=qc;qc.__name__=["zpp_nape","util","ZPP_ConstraintList"];qc.get=function(a,b){null==b&&(b=!1);var c=new aj;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=
!0);c.zpp_inner.zip_length=!0;return c};qc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:qc};var ac=function(){this.user_length=
0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new be;this._invalidated=!0};h["zpp_nape.util.ZPP_BodyList"]=ac;ac.__name__=["zpp_nape","util","ZPP_BodyList"];ac.get=function(a,b){null==b&&(b=!1);var c=new fj;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};
ac.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:ac};var yf=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=
null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_InteractorList"]=yf;yf.__name__=["zpp_nape","util","ZPP_InteractorList"];yf.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:yf};
var Bb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new ki;this._invalidated=!0};h["zpp_nape.util.ZPP_CompoundList"]=Bb;Bb.__name__=["zpp_nape","util","ZPP_CompoundList"];Bb.get=function(a,b){null==b&&(b=!1);var c=new hj;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=
!0;return c};Bb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Bb};var pc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=
this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new mi;this._invalidated=!0};h["zpp_nape.util.ZPP_ListenerList"]=pc;pc.__name__=["zpp_nape","util","ZPP_ListenerList"];pc.get=function(a,b){null==b&&(b=!1);var c=new Zi;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};pc.prototype={valmod:function(){this.validate();
this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:pc};var $c=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;
this._validate=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new gd;this._invalidated=!0};h["zpp_nape.util.ZPP_CbTypeList"]=$c;$c.__name__=["zpp_nape","util","ZPP_CbTypeList"];$c.get=function(a,b){null==b&&(b=!1);var c=new Ag;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};$c.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=
!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:$c};var Ee=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Rf;this._invalidated=!0};h["zpp_nape.util.ZPP_Vec2List"]=Ee;Ee.__name__=["zpp_nape",
"util","ZPP_Vec2List"];Ee.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Ee};var tf=function(){this.user_length=0;this.zip_length=
!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_GeomPolyList"]=tf;tf.__name__=["zpp_nape","util","ZPP_GeomPolyList"];tf.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},
__class__:tf};var uf=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_RayResultList"]=uf;uf.__name__=["zpp_nape","util","ZPP_RayResultList"];uf.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:uf};var sf=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_ConvexResultList"]=sf;sf.__name__=["zpp_nape","util","ZPP_ConvexResultList"];sf.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=
!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:sf};var zf=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_EdgeList"]=zf;zf.__name__=["zpp_nape","util","ZPP_EdgeList"];zf.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&
(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:zf};var Cb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=
new Ye;this._invalidated=!0};h["zpp_nape.util.ZPP_ShapeList"]=Cb;Cb.__name__=["zpp_nape","util","ZPP_ShapeList"];Cb.get=function(a,b){null==b&&(b=!1);var c=new jj;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Cb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Cb};var rf=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_InteractionGroupList"]=rf;rf.__name__=["zpp_nape","util","ZPP_InteractionGroupList"];rf.prototype={valmod:function(){this.validate();
this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:rf};var rc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Sf;this._invalidated=
!0};h["zpp_nape.util.ZPP_ArbiterList"]=rc;rc.__name__=["zpp_nape","util","ZPP_ArbiterList"];rc.get=function(a,b){null==b&&(b=!1);var c=new bj;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};rc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&
this._validate())},__class__:rc};var qf=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._validate=null;this._invalidated=!1;this.inner=null};h["zpp_nape.util.ZPP_ContactList"]=qf;qf.__name__=["zpp_nape","util","ZPP_ContactList"];qf.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:qf};var Qf=function(){};h["zpp_nape.util.ZPP_Math"]=Qf;Qf.__name__=["zpp_nape","util","ZPP_Math"];Qf.sqr=function(a){return a*a};var vf=function(){};h["zpp_nape.util.ZPP_PubPool"]=vf;vf.__name__=["zpp_nape","util","ZPP_PubPool"];var ab=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};h["zpp_nape.util.ZPP_Set_ZPP_CbSetPair"]=ab;ab.__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSetPair"];
ab.prototype={clear_with:function(a){if(null!=this.parent){for(var b=this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=ab.zpp_pool;ab.zpp_pool=a;return c},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,h,j,k;b==c.prev?(f=c,k=c.next,a==b.prev?
(d=a,e=b,g=a.prev,h=a.next,j=b.next):(d=b,e=a,g=b.prev,h=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,h=a.prev,j=a.next,k=b.next):(e=b,f=a,h=b.prev,j=a.prev,k=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=h;null!=h&&(h.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=f);f.next=k;null!=k&&(k.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=
1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==ab.zpp_pool?b=new ab:(b=ab.zpp_pool,ab.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ab.zpp_pool?b=new ab:(b=ab.zpp_pool,ab.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ab.zpp_pool?b=new ab:(b=ab.zpp_pool,
ab.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:ab};var vb=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};h["zpp_nape.util.ZPP_Set_ZPP_CbSet"]=vb;vb.__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSet"];vb.prototype={empty:function(){return null==this.parent},find:function(a){for(var b=this.parent;null!=
b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},remove:function(a){this.remove_node(this.find(a))},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=
1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);
break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=vb.zpp_pool;vb.zpp_pool=a},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,d.data);
d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},__fix_dbl_red:function(a){for(;;){var b=
a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,h,j,k;b==c.prev?(f=c,k=c.next,a==b.prev?(d=a,e=b,g=a.prev,h=a.next,j=b.next):(d=b,e=a,g=b.prev,h=a.prev,j=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,h=a.prev,j=a.next,k=b.next):(e=b,f=a,h=b.prev,j=a.prev,k=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=h;null!=h&&(h.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=j;null!=j&&(j.parent=
f);f.next=k;null!=k&&(k.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},insert:function(a){var b;null==vb.zpp_pool?b=new vb:(b=vb.zpp_pool,vb.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==
b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:vb};var Fb,hl=0;h.Math=Math;String.prototype.__class__=h.String=String;String.__name__=["String"];h.Array=Array;Array.__name__=["Array"];Date.prototype.__class__=h.Date=Date;Date.__name__=["Date"];var il=h.Int={__name__:["Int"]},jl=h.Dynamic={__name__:["Dynamic"]},cl=h.Float=Number;cl.__name__=["Float"];var dl=h.Bool=Boolean;dl.__ename__=["Bool"];var al=h.Class={__name__:["Class"]},bl={},Oa={},ok=Function("return typeof ArrayBuffer != 'undefined' ? ArrayBuffer : null")()||
Zc;null==ok.prototype.slice&&(ok.prototype.slice=Zc.sliceImpl);Function("return typeof DataView != 'undefined' ? DataView : null")();var nk=Function("return typeof Uint8Array != 'undefined' ? Uint8Array : null")()||md._new;q.Element=0;q.PCData=1;q.CData=2;q.Comment=3;q.DocType=4;q.ProcessingInstruction=5;q.Document=6;Vc.instance=new Vc;Ea.DISPATCHING_SENTINEL=new Rd(null,null);G.root=new Ua;G.uncaughtError=new ma;G.hidden=new Qa(!1);G.volume=new Q(1);G._platform=Vc.instance;G._calledInit=!1;ha.logger=
new bf(G._platform.createLogHandler("flambe"));Sd.__meta__={obj:{assets:[{"dummy.txt":[]}]}};Sd._supportsCrossOrigin=function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?!1:null!=(new XMLHttpRequest).withCredentials;a||ha.logger.warn("This browser does not support cross-domain asset loading, any Manifest.remoteBase setting will be ignored.",null);return a}();E._scratchPoint=new jd;re.NEWLINE=new dg(10);kc._sharedEvent=new xi;nc._sharedEvent=new fg;nb._sharedEvent=new gg;qe.CANVAS_TEXTURES=
(new xb("(iPhone|iPod|iPad)","")).match(window.navigator.userAgent);za._mediaRefCount=0;za._detectBlobSupport=!0;U.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];U.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new xb("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);va._detectSupport=!0;oc._scratchMatrix=new Ib;Yc.USE_CACHE=!1;Yc.USE_ENUM_INDEX=!1;Yc.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";hb.DEFAULT_RESOLVER=Y;hb.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";
Fa.count=0;Ac.i64tmp=new Qi(0,0);W.blanks=new xb("^[ \r\n\t]*$","");Pd.escapes=function(){var a=new M;null!=Oa.lt?a.setReserved("lt","<"):a.h.lt="<";null!=Oa.gt?a.setReserved("gt",">"):a.h.gt=">";null!=Oa.amp?a.setReserved("amp","&"):a.h.amp="&";null!=Oa.quot?a.setReserved("quot",'"'):a.h.quot='"';null!=Oa.apos?a.setReserved("apos","'"):a.h.apos="'";return a}(this);w.__toStr={}.toString;md.BYTES_PER_ELEMENT=1;v.epsilon=1.0E-8;v.fluidAngularDragFriction=2.5;v.fluidAngularDrag=100;v.fluidVacuumDrag=
0.5;v.fluidLinearDrag=0.5;v.collisionSlop=0.2;v.collisionSlopCCD=0.5;v.distanceThresholdCCD=0.05;v.staticCCDLinearThreshold=0.05;v.staticCCDAngularThreshold=0.005;v.bulletCCDLinearThreshold=0.125;v.bulletCCDAngularThreshold=0.0125;v.dynamicSweepLinearThreshold=17;v.dynamicSweepAngularThreshold=0.6;v.angularCCDSlipScale=0.75;v.arbiterExpirationDelay=6;v.staticFrictionThreshold=2;v.elasticThreshold=20;v.sleepDelay=60;v.linearSleepThreshold=0.2;v.angularSleepThreshold=0.4;v.contactBiasCoef=0.3;v.contactStaticBiasCoef=
0.6;v.contactContinuousBiasCoef=0.4;v.contactContinuousStaticBiasCoef=0.5;v.illConditionedThreshold=2E8;ba._rect=new Jb;La.ANY_SHAPE=new Gd;La.ANY_BODY=new Gd;La.ANY_COMPOUND=new Gd;La.ANY_CONSTRAINT=new Gd;Aa._Interactor=0;Aa._CbType=0;Aa._CbSet=0;Aa._Listener=0;qa.BIPED_FEET=new Gd;N.blanks=new xb("^[ \r\n\t]*$","");g.internal=!1;g.id_ImmState_ACCEPT=1;g.id_ImmState_IGNORE=2;g.id_ImmState_ALWAYS=4;g.id_GravMassMode_DEFAULT=0;g.id_GravMassMode_FIXED=1;g.id_GravMassMode_SCALED=2;g.id_InertiaMode_DEFAULT=
0;g.id_InertiaMode_FIXED=1;g.id_MassMode_DEFAULT=0;g.id_BodyType_STATIC=1;g.id_BodyType_DYNAMIC=2;g.id_BodyType_KINEMATIC=3;g.id_ListenerType_BODY=0;g.id_ListenerType_CONSTRAINT=1;g.id_PreFlag_ACCEPT=1;g.id_ListenerType_INTERACTION=2;g.id_ListenerType_PRE=3;g.id_CbEvent_BEGIN=0;g.id_CbEvent_ONGOING=6;g.id_InteractionType_COLLISION=1;g.id_CbEvent_END=1;g.id_InteractionType_SENSOR=2;g.id_CbEvent_WAKE=2;g.id_InteractionType_FLUID=4;g.id_CbEvent_SLEEP=3;g.id_InteractionType_ANY=7;g.id_CbEvent_BREAK=4;
g.id_CbEvent_PRE=5;g.id_ShapeType_CIRCLE=0;g.id_ShapeType_POLYGON=1;Ab.UCbSet=new Ne;Ab.VCbSet=new Ne;Ab.WCbSet=new Ne;Ab.UCbType=new gd;Ab.VCbType=new gd;Ab.WCbType=new gd;pa.internal=!1;pa.COL=1;pa.FLUID=4;pa.SENSOR=2;Gb.internal=!1;J.flowpoly=new Rf;J.flowsegs=new Rf;var el;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);el=g.BodyType_STATIC;var fl;null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);fl=g.BodyType_DYNAMIC;null==g.BodyType_KINEMATIC&&
(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1);Gc.types=[null,el,fl,g.BodyType_KINEMATIC];na.WAKE=1;na.PROPS=2;na.ANGDRAG=4;na.ARBITERS=8;Ja.internal=!1;Ub.tmpaabb=new la;qc.internal=!1;ac.internal=!1;yf.internal=!1;Bb.internal=!1;pc.internal=!1;$c.internal=!1;Ee.internal=!1;tf.internal=!1;uf.internal=!1;sf.internal=!1;zf.internal=!1;Cb.internal=!1;rf.internal=!1;rc.internal=!1;qf.internal=!1;Lc.main()})("undefined"!=typeof window?window:exports);
